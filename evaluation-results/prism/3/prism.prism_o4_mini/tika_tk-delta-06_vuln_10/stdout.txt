[2;36m[12/29/25 21:59:41][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=868073;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=19583;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpra77tcqk[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/tika_tk-delta-06_vuln_10/[0m[95magent-output-1[0m [2m               [0m
[2;36m                    [0m         [95m767045581.158314[0m                                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-06_vuln_10.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=765553;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=768110;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 22:01:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m97.61[0m  ]8;id=189986;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=771725;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=965145;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=706065;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=742418;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=838751;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=678134;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=627642;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m97[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=723261;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=429646;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 22:01:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.04[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=696220;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=463918;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 22:01:21][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=363586;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=534582;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=319041;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=64801;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=263383;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=870131;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=998508;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=18381;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 22:01:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.52[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=599828;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=317885;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=205205;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=948887;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 22:01:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.07[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=93542;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=684151;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 22:01:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=461820;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=264517;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 22:01:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.98[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=798275;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=820937;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running a pov[1m)[0m Started[33m...[0m                           ]8;id=719444;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=930082;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/29/25 22:02:30][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running a pov[1m)[0m Took [1;36m31.93[0m seconds; [33mexception[0m=[3;92mTrue[0m  ]8;id=552053;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=292333;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 22:02:31][0m[2;36m [0m[33mWARNING [0m Crash analysis results is empty. This should not happen.                              ]8;id=273236;file:///home/qqor/crete/packages/crete/commons/crash_analysis/functions/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=626402;file:///home/qqor/crete/packages/crete/commons/crash_analysis/functions/__init__.py#41\[2m41[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=680409;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=39655;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.99[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=789581;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=328689;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[12/29/25 22:03:09][0m[2;36m [0m[34mINFO    [0m Found jstack output at                                                                ]8;id=762171;file:///home/qqor/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=162405;file:///home/qqor/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py#43\[2m43[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/tika/[0m[95mjstack.txt[0m         [2m              [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=158927;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=225872;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 22:03:18][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=667772;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=13939;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/29/25 22:04:35][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=301564;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=317268;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/29/25 22:06:51][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=904308;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=600136;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=360736;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=738956;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         The patch did not apply, here are some possible reasons:                            [2m                [0m
[2;36m                    [0m         - Trying to patch a file that does not exist in the repository.                     [2m                [0m
[2;36m                    [0m         - Trying to patch fuzzer or harness related file. [1m([0mThese files are used to test the [2m                [0m
[2;36m                    [0m         validity of the patch.[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         - Incorrect patch format. [1m([0mFocus on the patch formatting instructions.[1m)[0m             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A fuzzing run using libFuzzer terminated with an ‚ÄúERROR: libFuzzer: timeout‚Äù        [2m                [0m
[2;36m                    [0m         message. The fuzzer did not complete its execution of the target harness within the [2m                [0m
[2;36m                    [0m         allotted time, causing the session to abort.                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Issue Overview                                                                    [2m                [0m
[2;36m                    [0m           During a libFuzzer session against the provided harness and underlying code, a    [2m                [0m
[2;36m                    [0m         timeout error was emitted. This indicates that at least one test case or code path  [2m                [0m
[2;36m                    [0m         exceeded libFuzzer‚Äôs built-in time limit for execution or for a sequence of harness [2m                [0m
[2;36m                    [0m         invocations.                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Vulnerability Type                                                                [2m                [0m
[2;36m                    [0m           No specific vulnerability or security flaw is identified in the issue report      [2m                [0m
[2;36m                    [0m         itself. The report solely documents a fuzzer timeout rather than a crash, memory    [2m                [0m
[2;36m                    [0m         corruption, or other exploit condition.                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Key Observations and Findings                                                     [2m                [0m
[2;36m                    [0m           ‚Ä¢ The fuzzer harness served as the entry point for test inputs.                   [2m                [0m
[2;36m                    [0m           ‚Ä¢ libFuzzer monitors the execution time of individual runs and of the overall     [2m                [0m
[2;36m                    [0m         fuzzing session; it enforces timeouts to prevent hung or excessively long runs.     [2m                [0m
[2;36m                    [0m           ‚Ä¢ The timeout suggests that one or more code paths invoked by the harness are     [2m                [0m
[2;36m                    [0m         taking unusually long to process inputs or may be blocking indefinitely.            [2m                [0m
[2;36m                    [0m           ‚Ä¢ No details on input size, loop constructs, external calls, or resource locks    [2m                [0m
[2;36m                    [0m         are provided in the report; thus, the specific location of the delay is not         [2m                [0m
[2;36m                    [0m         explicit.                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         - Codebase Areas for Investigation                                                  [2m                [0m
[2;36m                    [0m           To gain a complete understanding of the timeout issue, the following areas should [2m                [0m
[2;36m                    [0m         be reviewed:                                                                        [2m                [0m
[2;36m                    [0m           [1;36m1[0m. Fuzz Target Implementation ‚Äì examine the harness [1;35mfunction[0m[1m([0ms[1m)[0m to see which      [2m                [0m
[2;36m                    [0m         library or application logic is exercised and whether it contains long loops,       [2m                [0m
[2;36m                    [0m         recursion, or blocking I/O.                                                         [2m                [0m
[2;36m                    [0m           [1;36m2[0m. Core Library/Module under Test ‚Äì identify functions invoked by the harness     [2m                [0m
[2;36m                    [0m         that perform heavy computation, network or file operations, or use synchronization  [2m                [0m
[2;36m                    [0m         primitives.                                                                         [2m                [0m
[2;36m                    [0m           [1;36m3[0m. Third-Party Dependencies ‚Äì check if any external libraries or system calls     [2m                [0m
[2;36m                    [0m         invoked during fuzzing could introduce delays [1m([0me.g., heavy regex processing, large  [2m                [0m
[2;36m                    [0m         memory allocations, slow parsers[1m)[0m.                                                  [2m                [0m
[2;36m                    [0m           [1;36m4[0m. libFuzzer Configuration ‚Äì review timeout settings, custom mutators or custom   [2m                [0m
[2;36m                    [0m         loops within the harness that may bypass or conflict with libFuzzer‚Äôs internal      [2m                [0m
[2;36m                    [0m         timing controls.                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         By inspecting these components, one can map out where execution time accumulates    [2m                [0m
[2;36m                    [0m         and obtain a holistic view of why the fuzzer session exceeded its time limits.      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:136[0m[39m-[0m[1;36m244[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;35mfuture.cancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mwriteErrFile[0m[1;39m([0m[39mtarget, [0m[32m".timeout"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException | ExecutionException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem parsing "[0m[39m + target, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mexecutor.shutdownNow[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    private void [0m[1;35mwriteErrFile[0m[1;39m([0m[39mPath target, String ext[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            Path err = [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m + ext[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;35mFiles.write[0m[1;39m([0m[39merr, new byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"things aren't going right today."[0m[39m, e[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    private void [0m[1;35mhandleThrowable[0m[1;39m([0m[39mPath target, Throwable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            Path errMsg =[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                    [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m".stacktrace"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            [0m[1;35mFiles.write[0m[1;39m([0m[39merrMsg, [0m                                                [2m                [0m
[2;36m                    [0m         [1;35mExceptionUtils.getStackTrace[0m[1;39m([0m[39mt[0m[1;39m)[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.UTF_8[0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"things aren't going right today."[0m[39m, t[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    private void [0m[1;35mtransformFile[0m[1;39m([0m[39mTransformer transformer, Path src, Path target[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            throws IOException, TikaException [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[39msrc[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                OutputStream os = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mtransformer.transform[0m[1;39m([0m[39mis, os[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    private static class FuzzOneConfig [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        int perFileIterations;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        int maxTransformers;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        int threadNum;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        int retryNum;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:        long timeoutMs;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        private Path inputFile;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        private Path outputFileBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        static FuzzOneConfig [0m[1;35mparse[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws ParseException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            CommandLineParser parser = new [0m[1;35mDefaultParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            CommandLine commandLine = [0m[1;35mparser.parse[0m[1;39m([0m[1;33mOPTIONS[0m[39m, args[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            FuzzOneConfig config = new [0m[1;35mFuzzOneConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:            config.inputFile = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"i"[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            config.outputFileBase = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"o"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            config.perFileIterations = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            config.maxTransformers = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"t"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            config.threadNum = [0m                                                 [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"n"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            config.retryNum = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"r"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            config.timeoutMs = [0m                                                 [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"m"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            return config;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    private class ParseTask implements Callable<Integer> [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        private final Path target;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        public [0m[1;35mParseTask[0m[1;39m([0m[39mPath target[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            this.target = target;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:         * @return [0m[1;36m1[0m[39m if success[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:         * @throws Exception[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        public Integer [0m[1;35mcall[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            boolean success = false;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"parsing "[0m[39m + target[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;35mparser.parse[0m[1;39m([0m[39mis, new [0m[1;35mDefaultHandler[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m, new [0m     [2m                [0m
[2;36m                    [0m         [1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                success = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                if [0m[1;39m([0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m != null && [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m instanceof [0m            [2m                [0m
[2;36m                    [0m         [39mRuntimeException[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                    [0m[35m/[0m[35m/[0m[95mhandleThrowable[0m[1;39m([0m[39mtarget, [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                    success = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                    success = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                success = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mThrowable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mhandleThrowable[0m[1;39m([0m[39mtarget, t[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                if [0m[1;39m([0m[39msuccess[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;35mFiles.delete[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"couldn't delete: "[0m[39m + [0m                         [2m                [0m
[2;36m                    [0m         [1;35mtarget.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"FOUND PROBLEM: "[0m[39m + target[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:            return success ? [0m[1;36m1[0m[39m : [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:94[0m[39m-[0m[1;36m111[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    private void [0m[1;35mexecute[0m[1;39m([0m[39mFuzzOneConfig config[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        Path src = config.inputFile;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        Path targetDir = config.outputFileBase;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        AutoDetectTransformer transformer = new [0m[1;35mAutoDetectTransformer[0m[1;39m([0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < config.perFileIterations; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                String ext = [0m[32m"-"[0m[39m + config.threadNum + [0m[32m"-"[0m[39m + config.retryNum + [0m  [2m                [0m
[2;36m                    [0m         [32m"-"[0m[39m + i;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                [0m[1;35mfuzz[0m[1;39m([0m[39mext, src, targetDir, transformer, config.timeoutMs[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem transforming file"[0m[39m, e[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCantFuzzException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"can't fuzz this file "[0m[39m + src, e[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                [0m[1;35me.printStackTrace[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:168[0m[39m-[0m[1;36m175[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    private void [0m[1;35mtransformFile[0m[1;39m([0m[39mTransformer transformer, Path src, Path target[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            throws IOException, TikaException [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[39msrc[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                OutputStream os = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mtransformer.transform[0m[1;39m([0m[39mis, os[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/AutoDetectTransformer.jav[0m[1;92ma:67[0m[39m-[0m[1;36m74[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[35m/[0m[35m/[0m[39m Automatically detect the MIME type of the document[0m                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            MediaType type = [0m[1;35mdetector.detect[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            Transformer transformer = [0m[1;35mgetTransformer[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;35mtransformer.transform[0m[1;39m([0m[39mtis, os[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/pdf/PDFTransformer.jav[0m[1;92ma:1[0m[39m-[0m[1;36m62[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing.pdf;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.pdfbox.Loader;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.pdfbox.io.RandomAccessReadBuffer;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.pdfbox.pdmodel.encryption.InvalidPasswordException;[0m            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.fuzzing.Transformer;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.fuzzing.exceptions.CantFuzzException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:public class PDFTransformer implements Transformer [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES =[0m                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:            [0m[1;35mCollections.singleton[0m[1;39m([0m[1;35mMediaType.application[0m[1;39m([0m[32m"pdf"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private PDFTransformerConfig config = new [0m[1;35mPDFTransformerConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        try [0m[1;39m([0m[39mPDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[39mnew [0m                         [2m                [0m
[2;36m                    [0m         [1;35mRandomAccessReadBuffer[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[35m/[0m[35m/[0m[95msome[0m[39m docs have security which prevents mods and writing[0m            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[35m/[0m[35m/[0m[95mgiven[0m[39m our purposes here, we should remove security[0m                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;35mpdDocument.setAllSecurityToBeRemoved[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m([0m[39mEvilCOSWriter cosWriter = new [0m[1;35mEvilCOSWriter[0m[1;39m([0m[39mos, config[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mcosWriter.write[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInvalidPasswordException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            throw new [0m[1;35mCantFuzzException[0m[1;39m([0m[32m"encrypted doc"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    public void [0m[1;35msetConfig[0m[1;39m([0m[39mPDFTransformerConfig pdfTransformerConfig[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        this.config = pdfTransformerConfig;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/pdf/EvilCOSWriter.jav[0m[1;92ma:1[0m[39m-[0m[1;36m150[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing.pdf;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.BufferedOutputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.ByteArrayInputStream;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.ByteArrayOutputStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.Closeable;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.SequenceInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.security.MessageDigest;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.security.NoSuchAlgorithmException;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.text.DecimalFormat;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.text.DecimalFormatSymbols;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.text.NumberFormat;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.Deque;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.util.Hashtable;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.LinkedList;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import java.util.Random;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.commons.io.output.UnsynchronizedByteArrayOutputStream;[0m         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.pdfbox.cos.COSBase;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.pdfbox.cos.COSBoolean;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.pdfbox.cos.COSDocument;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.apache.pdfbox.cos.COSFloat;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.pdfbox.cos.COSInteger;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import org.apache.pdfbox.cos.COSNull;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.apache.pdfbox.cos.COSNumber;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import org.apache.pdfbox.cos.COSObject;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.pdfbox.cos.COSObjectKey;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.apache.pdfbox.cos.COSStream;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:import org.apache.pdfbox.cos.COSString;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:import org.apache.pdfbox.cos.COSUpdateInfo;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:import org.apache.pdfbox.cos.ICOSVisitor;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:import org.apache.pdfbox.filter.Filter;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:import org.apache.pdfbox.filter.FilterFactory;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:import org.apache.pdfbox.io.IOUtils;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:import org.apache.pdfbox.io.RandomAccessInputStream;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:import org.apache.pdfbox.io.RandomAccessRead;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:import org.apache.pdfbox.pdfparser.PDFXRefStream;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:import org.apache.pdfbox.pdfparser.xref.FreeXReference;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:import org.apache.pdfbox.pdfparser.xref.NormalXReference;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:import org.apache.pdfbox.pdfparser.xref.XReferenceEntry;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:import org.apache.pdfbox.pdfwriter.COSStandardOutputStream;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:import org.apache.pdfbox.pdfwriter.COSWriter;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:import org.apache.pdfbox.pdmodel.common.PDStream;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:import org.apache.pdfbox.pdmodel.encryption.SecurityHandler;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:import org.apache.pdfbox.pdmodel.fdf.FDFDocument;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.pdfbox.pdmodel.interactive.digitalsignature.COSFilterInputStream;[0m        [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:import [0m                                                                          [2m                [0m
[2;36m                    [0m         [39morg.apache.pdfbox.pdmodel.interactive.digitalsignature.SignatureInterface;[0m          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:import org.apache.pdfbox.util.Hex;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:import org.apache.tika.fuzzing.Transformer;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:import org.apache.tika.io.TemporaryResources;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m[35m/[0m[35m/[0m[95mTODO[0m[39m PDFBOX30 replace COSWriterXRefEntry with XReferenceEntry [0m[1;39m([0m[39mand much more[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:public class EvilCOSWriter implements ICOSVisitor, Closeable [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:     * The dictionary open token.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m DICT_OPEN = [0m                                     [2m                [0m
[2;36m                    [0m         [32m"<<"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     * The dictionary close token.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m DICT_CLOSE = [0m                                    [2m                [0m
[2;36m                    [0m         [32m">>"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:     * space character.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m SPACE = [0m[1;39m{[0m[32m' '[0m[1;39m}[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * The start to a PDF comment.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m COMMENT = [0m[1;39m{[0m[32m'%'[0m[1;39m}[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:     * The output version of the PDF.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m VERSION = [0m                                       [2m                [0m
[2;36m                    [0m         [32m"PDF-1.4"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * Garbage bytes used to create the PDF header.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m GARBAGE =[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            new byte[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;39m([0m[39mbyte[0m[1;39m)[0m[39m [0m[1;36m0xf6[0m[39m, [0m[1;39m([0m[39mbyte[0m[1;39m)[0m[39m [0m[1;36m0xe4[0m[39m, [0m[1;39m([0m[39mbyte[0m[1;39m)[0m[39m [0m[1;36m0xfc[0m[39m, [0m[1;39m([0m[39mbyte[0m[1;39m)[0m[39m [0m[1;36m0xdf[0m[1;39m}[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:     * The EOF constant.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m EOF = [0m                                           [2m                [0m
[2;36m                    [0m         [32m"%%EOF"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:     * The reference token.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m REFERENCE = [0m                                     [2m                [0m
[2;36m                    [0m         [32m"R"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:    [0m[35m/[0m[35m/[0m[39m pdf tokens[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:     * The XREF token.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m XREF = [0m                                          [2m                [0m
[2;36m                    [0m         [32m"xref"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:     * The xref free token.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m XREF_FREE = [0m                                     [2m                [0m
[2;36m                    [0m         [32m"f"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:     * The xref used token.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m XREF_USED = [0m                                     [2m                [0m
[2;36m                    [0m         [32m"n"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:     * The trailer token.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m TRAILER = [0m                                       [2m                [0m
[2;36m                    [0m         [32m"trailer"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     * The start xref token.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public static final byte[0m[1;39m[[0m[1;39m][0m[39m STARTXREF = [0m                                     [2m                [0m
[2;36m                    [0m         [32m"startxref"[0m[1;35m.getBytes[0m[1;39m([0m[39mStandardCharsets.US_ASCII[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/pdf/PDFTransformer.jav[0m[1;92ma:45[0m[39m-[0m[1;36m57[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        try [0m[1;39m([0m[39mPDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[39mnew [0m                         [2m                [0m
[2;36m                    [0m         [1;35mRandomAccessReadBuffer[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[35m/[0m[35m/[0m[95msome[0m[39m docs have security which prevents mods and writing[0m            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[35m/[0m[35m/[0m[95mgiven[0m[39m our purposes here, we should remove security[0m                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;35mpdDocument.setAllSecurityToBeRemoved[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m([0m[39mEvilCOSWriter cosWriter = new [0m[1;35mEvilCOSWriter[0m[1;39m([0m[39mos, config[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mcosWriter.write[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInvalidPasswordException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            throw new [0m[1;35mCantFuzzException[0m[1;39m([0m[32m"encrypted doc"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:113[0m[39m-[0m[1;36m121[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    private void [0m[1;35mfuzz[0m[1;39m([0m[39mString ext, Path src, Path targetFileBase, Transformer [0m   [2m                [0m
[2;36m                    [0m         [39mtransformer,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                      long timeoutMs[0m[1;39m)[0m[39m throws IOException, TikaException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        Path target =[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mtargetFileBase.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtargetFileBase.getFileName[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m + ext[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;35mtransformFile[0m[1;39m([0m[39mtransformer, src, target[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mThrowable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 22:07:00][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=845160;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=240394;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 22:08:34][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=358352;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=775121;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 22:10:10][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=654867;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=265028;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=386448;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=266175;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         The patch did not apply, here are some possible reasons:                            [2m                [0m
[2;36m                    [0m         - Trying to patch a file that does not exist in the repository.                     [2m                [0m
[2;36m                    [0m         - Trying to patch fuzzer or harness related file. [1m([0mThese files are used to test the [2m                [0m
[2;36m                    [0m         validity of the patch.[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         - Incorrect patch format. [1m([0mFocus on the patch formatting instructions.[1m)[0m             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m         The initial issue is a libFuzzer run terminating with a timeout error [1m([0m`ERROR:      [2m                [0m
[2;36m                    [0m         libFuzzer: timeout`[1m)[0m. There was no concrete patch provided‚Äîan empty or improperly   [2m                [0m
[2;36m                    [0m         formatted patch was attempted. Upon applying this patch, the tooling reported that  [2m                [0m
[2;36m                    [0m         the patch did not apply, offering three generic failure reasons: non-existent       [2m                [0m
[2;36m                    [0m         target file, patching of fuzzer/harness files, or incorrect patch format.           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1[0m. Initial Issue                                                                    [2m                [0m
[2;36m                    [0m            - The fuzzer execution halted due to a timeout condition reported by libFuzzer.  [2m                [0m
[2;36m                    [0m            - No additional error messages or stack traces were produced beyond the timeout  [2m                [0m
[2;36m                    [0m         notification.                                                                       [2m                [0m
[2;36m                    [0m            - This indicates that libFuzzer reached its execution time limit without         [2m                [0m
[2;36m                    [0m         completing its test cycles.                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. Important Observations                                                           [2m                [0m
[2;36m                    [0m            - The only visible symptom is the ‚Äútimeout‚Äù message from libFuzzer; there is no  [2m                [0m
[2;36m                    [0m         direct indication of a crash or memory error.                                       [2m                [0m
[2;36m                    [0m            - The harness code, which is the fuzzer entry point, simply invokes the code     [2m                [0m
[2;36m                    [0m         under test and is unlikely the root cause of the timeout.                           [2m                [0m
[2;36m                    [0m            - No patches or source modifications were actually applied; the failure occurred [2m                [0m
[2;36m                    [0m         at the patch application stage.                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. Patch Attempt and Application Log                                                [2m                [0m
[2;36m                    [0m            - Patch Attempt: empty content [1m([0mno diff headers, no context, no file             [2m                [0m
[2;36m                    [0m         references[1m)[0m.                                                                        [2m                [0m
[2;36m                    [0m            - Application Log:                                                               [2m                [0m
[2;36m                    [0m              ‚Ä¢ ‚ÄúThe patch did not apply, here are some possible reasons:‚Äù                   [2m                [0m
[2;36m                    [0m                ‚Äì Trying to patch a file that does not exist in the repository.              [2m                [0m
[2;36m                    [0m                ‚Äì Trying to patch fuzzer or harness related file.                            [2m                [0m
[2;36m                    [0m                ‚Äì Incorrect patch format.                                                    [2m                [0m
[2;36m                    [0m            - To reapply a patch, one would need at minimum a unified diff with correct file [2m                [0m
[2;36m                    [0m         paths matching the repository‚Äôs structure, and adhere to the project‚Äôs patch        [2m                [0m
[2;36m                    [0m         formatting guidelines [1m([0me.g., using `diff -u` or Git‚Äôs patch format[1m)[0m.                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. Areas for Further Investigation                                                  [2m                [0m
[2;36m                    [0m            - Fuzzer Timeout Configuration: inspect the libFuzzer invocation flags [1m([0me.g.,    [2m                [0m
[2;36m                    [0m         `-[33mtimeout[0m=`[1m)[0m and test harness timeout settings.                                     [2m                [0m
[2;36m                    [0m            - Target Code Paths: review code modules linked into the fuzzer executable for   [2m                [0m
[2;36m                    [0m         long-running loops or blocking operations.                                          [2m                [0m
[2;36m                    [0m            - Build System & File Layout: verify the repository‚Äôs directory structure to     [2m                [0m
[2;36m                    [0m         ensure patch targets exist and are correctly referenced.                            [2m                [0m
[2;36m                    [0m            - Patch Formatting Guidelines: confirm project conventions for submitting        [2m                [0m
[2;36m                    [0m         patches [1m([0mline endings, diff headers, context lines[1m)[0m.                                [2m                [0m
[2;36m                    [0m            - Harness vs. Production Code: catalog which files belong to the fuzzing harness [2m                [0m
[2;36m                    [0m         versus the core codebase to avoid mis-targeted patches.                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe patch did not apply, here are some possible reasons:[0m                            [2m                [0m
[2;36m                    [0m         [39m- Trying to patch a file that does not exist in the repository.[0m                     [2m                [0m
[2;36m                    [0m         [39m- Trying to patch fuzzer or harness related file. [0m[1;39m([0m[39mThese files are used to test the[0m [2m                [0m
[2;36m                    [0m         [39mvalidity of the patch.[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- Incorrect patch format. [0m[1;39m([0m[39mFocus on the patch formatting instructions.[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzingCLI.jav[0m[1;92ma:1[0m[39m-[0m[1;36m250[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing.cli;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.UUID;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.concurrent.ArrayBlockingQueue;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.concurrent.Callable;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ExecutionException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.concurrent.ExecutorCompletionService;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.concurrent.ExecutorService;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.concurrent.Executors;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.concurrent.Future;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.concurrent.atomic.AtomicInteger;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.io.FileUtils;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.fuzzing.Transformer;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.fuzzing.general.ByteDeleter;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.fuzzing.general.ByteFlipper;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.fuzzing.general.ByteInjector;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.fuzzing.general.GeneralTransformer;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.fuzzing.general.SpanSwapper;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.fuzzing.general.Truncator;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.pipes.FetchEmitTuple;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.pipes.PipesConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.pipes.PipesParser;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.pipes.PipesResult;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.pipes.emitter.EmitKey;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.tika.pipes.fetcher.FetchKey;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.apache.tika.pipes.fetcher.FetcherManager;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.tika.pipes.pipesiterator.PipesIterator;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:public class FuzzingCLI [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final Logger LOG = [0m[1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mFuzzingCLI.class[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final String TEMP_FETCHER_NAME = [0m[32m"temp"[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    private static final String TEMP_EMITTER_NAME = [0m[32m"temp"[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        FuzzingCLIConfig config = [0m[1;35mFuzzingCLIConfig.parse[0m[1;39m([0m[39margs[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        if [0m[1;39m([0m[1;35mconfig.getMaxTransformers[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"max transformers == 0!"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        FuzzingCLI fuzzingCLI = new [0m[1;35mFuzzingCLI[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;35mconfig.getProblemsDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;35mfuzzingCLI.execute[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private void [0m[1;35mexecute[0m[1;39m([0m[39mFuzzingCLIConfig config[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        ArrayBlockingQueue<FetchEmitTuple> q = new [0m[1;35mArrayBlockingQueue[0m[1;39m([0m[1;36m10000[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        PipesConfig pipesConfig = [0m[1;35mPipesConfig.load[0m[1;39m([0m[1;35mconfig.getTikaConfig[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        FetcherManager fetcherManager = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mFetcherManager.load[0m[1;39m([0m[1;35mconfig.getTikaConfig[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        int totalThreads = [0m[1;35mpipesConfig.getNumClients[0m[1;39m([0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        ExecutorService executorService = [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mExecutors.newFixedThreadPool[0m[1;39m([0m[39mtotalThreads[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        ExecutorCompletionService executorCompletionService =[0m                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                new [0m[1;35mExecutorCompletionService[0m[1;39m([0m[39mexecutorService[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        PipesIterator pipesIterator = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mPipesIterator.build[0m[1;39m([0m[1;35mconfig.getTikaConfig[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        FileAdder fileAdder = new [0m[1;35mFileAdder[0m[1;39m([0m[39mpipesIterator, q[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35mexecutorCompletionService.submit[0m[1;39m([0m[39mfileAdder[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        try [0m[1;39m([0m[39mPipesParser parser = new [0m[1;35mPipesParser[0m[1;39m([0m[39mpipesConfig[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mpipesConfig.getNumClients[0m[1;39m([0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                [0m[1;35mexecutorCompletionService.submit[0m[1;39m([0m[39mnew [0m[1;35mFuzzer[0m[1;39m([0m[39mq, config, parser, [0m  [2m                [0m
[2;36m                    [0m         [39mfetcherManager[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            int finished = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            while [0m[1;39m([0m[39mfinished < totalThreads[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                Future<Integer> future = null;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                try [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                    future = [0m[1;35mexecutorCompletionService.poll[0m[1;39m([0m[1;36m1[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mTimeUnit.SECONDS[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                    if [0m[1;39m([0m[39mfuture != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                        [0m[1;35mfuture.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                        finished++;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"Finished thread [0m[32m{[0m[32m}[0m[32m threads of [0m[32m{[0m[32m}[0m[32m"[0m[39m, finished, [0m     [2m                [0m
[2;36m                    [0m         [39mtotalThreads[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException | ExecutionException e[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                    [0m[1;35me.printStackTrace[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mexecutorService.shutdown[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mexecutorService.shutdownNow[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    private static class Fuzzer implements Callable<Integer> [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        static AtomicInteger COUNTER = new [0m[1;35mAtomicInteger[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        static AtomicInteger FUZZED = new [0m[1;35mAtomicInteger[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        static AtomicInteger SOURCE_FILES = new [0m[1;35mAtomicInteger[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        private final int threadId = [0m[1;35mCOUNTER.getAndIncrement[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        private final ArrayBlockingQueue<FetchEmitTuple> q;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        private final FuzzingCLIConfig config;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        private final PipesParser pipesParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        private final Transformer transformer;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        private final FetcherManager fetcherManager;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        public [0m[1;35mFuzzer[0m[1;39m([0m[39mArrayBlockingQueue<FetchEmitTuple> q, FuzzingCLIConfig [0m   [2m                [0m
[2;36m                    [0m         [39mconfig,[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                      PipesParser pipesParser, FetcherManager fetcherManager[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            this.q = q;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:            this.config = config;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            this.pipesParser = pipesParser;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[35m/[0m[35m/[0m[95mTODO[0m[39m - parameterize this[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            this.transformer =[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                    new [0m[1;35mGeneralTransformer[0m[1;39m([0m[1;35mconfig.getMaxTransformers[0m[1;39m([0m[1;39m)[0m[39m, new [0m    [2m                [0m
[2;36m                    [0m         [1;35mByteDeleter[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                            new [0m[1;35mByteFlipper[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mByteInjector[0m[1;39m([0m[1;39m)[0m[39m, new [0m         [2m                [0m
[2;36m                    [0m         [1;35mTruncator[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                            new [0m[1;35mSpanSwapper[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            this.fetcherManager = fetcherManager;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:        public Integer [0m[1;35mcall[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                FetchEmitTuple fetchEmitTuple = [0m[1;35mq.take[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                if [0m[1;39m([0m[1;35mfetchEmitTuple.equals[0m[1;39m([0m[39mPipesIterator.COMPLETED_SEMAPHORE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                    [0m[1;35mLOG.debug[0m[1;39m([0m[32m"Thread "[0m[39m + threadId + [0m[32m" stopping"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                    [0m[1;35mq.put[0m[1;39m([0m[39mPipesIterator.COMPLETED_SEMAPHORE[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                    return [0m[1;36m1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                int inputFiles = [0m[1;35mSOURCE_FILES.getAndIncrement[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                if [0m[1;39m([0m[39minputFiles % [0m[1;36m100[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"Processed [0m[32m{[0m[32m}[0m[32m source files"[0m[39m, inputFiles[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < config.perFileIterations; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                        [0m[1;35mfuzzIt[0m[1;39m([0m[39mfetchEmitTuple[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                        throw e;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"serious problem with"[0m[39m, e[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        private void [0m[1;35mfuzzIt[0m[1;39m([0m[39mFetchEmitTuple fetchEmitTuple[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throws IOException, InterruptedException, TikaException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            Path cwd = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[32m"tika-fuzz-"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                Path fuzzedPath = [0m[1;35mfuzz[0m[1;39m([0m[39mfetchEmitTuple, cwd[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                Path extract = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[39mcwd, [0m[32m"tika-extract-"[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [32m".json"[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                FetchEmitTuple fuzzedTuple = new [0m                               [2m                [0m
[2;36m                    [0m         [1;35mFetchEmitTuple[0m[1;39m([0m[1;35mfetchEmitTuple.getId[0m[1;39m([0m[1;39m)[0m[39m,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                        new [0m[1;35mFetchKey[0m[1;39m([0m[39mTEMP_FETCHER_NAME, [0m                        [2m                [0m
[2;36m                    [0m         [1;35mfuzzedPath.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m,[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:                        new [0m[1;35mEmitKey[0m[1;39m([0m[39mTEMP_EMITTER_NAME, [0m                         [2m                [0m
[2;36m                    [0m         [1;35mextract.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                int count = [0m[1;35mFUZZED.getAndIncrement[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:                if [0m[1;39m([0m[39mcount % [0m[1;36m100[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"processed [0m[32m{[0m[32m}[0m[32m fuzzed files"[0m[39m, count[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                boolean tryAgain = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                int tries = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:                while [0m[1;39m([0m[39mtryAgain && tries < [0m[1;35mconfig.getRetries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:                    tries++;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:                        PipesResult result = [0m[1;35mpipesParser.parse[0m[1;39m([0m[39mfuzzedTuple[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                        tryAgain = [0m[1;35mhandleResult[0m[1;39m([0m[1;35mresult.getStatus[0m[1;39m([0m[1;39m)[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                                [0m[1;35mfetchEmitTuple.getFetchKey[0m[1;39m([0m[1;39m)[0m[1;35m.getFetchKey[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mfuzzedPath, tries,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                                [0m[1;35mconfig.getRetries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                        throw e;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                        tryAgain = [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mhandleResult[0m[1;39m([0m[39mPipesResult.STATUS.UNSPECIFIED_CRASH,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                                [0m[1;35mfetchEmitTuple.getFetchKey[0m[1;39m([0m[1;39m)[0m[1;35m.getFetchKey[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mfuzzedPath, tries,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                                [0m[1;35mconfig.getRetries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                try [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:                    [0m[1;35mFileUtils.deleteDirectory[0m[1;39m([0m[1;35mcwd.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                    [0m[1;35me.printStackTrace[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                    [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Couldn't delete "[0m[39m + [0m[1;35mcwd.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        private Path [0m[1;35mfuzz[0m[1;39m([0m[39mFetchEmitTuple fetchEmitTuple, Path cwd[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                throws IOException, TikaException [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            Path target = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[39mcwd, [0m[32m"tika-fuzz-target-"[0m[39m,[0m        [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:                    [0m[32m"."[0m[39m + [0m                                                      [2m                [0m
[2;36m                    [0m         [1;35mFilenameUtils.getExtension[0m[1;39m([0m[1;35mfetchEmitTuple.getFetchKey[0m[1;39m([0m[1;39m)[0m[1;35m.getFetchKey[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mfetcherManager.getFetcher[0m[1;39m([0m                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                            [0m[1;35mfetchEmitTuple.getFetchKey[0m[1;39m([0m[1;39m)[0m[1;35m.getFetcherName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                    [0m[1;35m.fetch[0m[1;39m([0m[1;35mfetchEmitTuple.getFetchKey[0m[1;39m([0m[1;39m)[0m[1;35m.getFetchKey[0m[1;39m([0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [1;35mfetchEmitTuple.getMetadata[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                            [0m[1;35mfetchEmitTuple.getParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                try [0m[1;39m([0m[39mOutputStream os = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    [0m[1;35mtransformer.transform[0m[1;39m([0m[39mis, os[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            return target;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        private boolean [0m[1;35mhandleResult[0m[1;39m([0m[39mPipesResult.STATUS status, String [0m         [2m                [0m
[2;36m                    [0m         [39morigFetchKey,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                                     Path fuzzedPath, int tries, int [0m           [2m                [0m
[2;36m                    [0m         [39mmaxRetries[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                throws IOException [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:            switch [0m[1;39m([0m[39mstatus[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                case OOM:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                case TIMEOUT:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                case UNSPECIFIED_CRASH:[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                    if [0m[1;39m([0m[39mtries < maxRetries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                        [0m[1;35mLOG.info[0m[1;39m([0m[32m"trying again [0m[32m([0m[32m{[0m[32m}[0m[32m of [0m[32m{[0m[32m}[0m[32m)[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, tries, [0m         [2m                [0m
[2;36m                    [0m         [39mmaxRetries,[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                                [0m[1;35mstatus.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                        return true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                    Path problemFilePath = [0m[1;35mgetProblemFile[0m[1;39m([0m[39mstatus, [0m              [2m                [0m
[2;36m                    [0m         [39morigFetchKey[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"found a problem [0m[32m{[0m[32m}[0m[32m -> [0m[32m{[0m[32m}[0m[32m : [0m[32m{[0m[32m}[0m[32m"[0m[39m, origFetchKey, [0m    [2m                [0m
[2;36m                    [0m         [39mproblemFilePath,[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                            [0m[1;35mstatus.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mfuzzedPath, problemFilePath[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                    [0m[35m/[0m[35m/[0m[95mif[0m[39m there wasn't a problem[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        private Path [0m[1;35mgetProblemFile[0m[1;39m([0m[39mPipesResult.STATUS status, String [0m          [2m                [0m
[2;36m                    [0m         [39morigFetchKey[0m[1;39m)[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                throws IOException [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:            String name = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39morigFetchKey[0m[1;39m)[0m[39m + [0m[32m"-"[0m[39m + [0m          [2m                [0m
[2;36m                    [0m         [1;35mUUID.randomUUID[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:            Path problemFile =[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:61[0m[39m-[0m[1;36m84[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    static Options [0m[1;33mOPTIONS[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[35m/[0m[35m/[0m[95mBy[0m[39m the time this commandline is parsed, there should be both an [0m       [2m                [0m
[2;36m                    [0m         [39mextracts and an inputDir[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        Option extracts = new [0m[1;35mOption[0m[1;39m([0m[32m"extracts"[0m[39m, true, [0m[32m"directory for extract [0m   [2m                [0m
[2;36m                    [0m         [32mfiles"[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mextracts.setRequired[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;33mOPTIONS[0m[39m = new [0m[1;35mOptions[0m[1;39m([0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"i"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"inputFile"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"input directory [0m  [2m                [0m
[2;36m                    [0m         [32mfor seed files"[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                        [0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"o"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"outputFile"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"output file [0m     [2m                [0m
[2;36m                    [0m         [32mbase"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"m"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"timeoutMs"[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"timeout in ms -- max time allowed to parse a [0m             [2m                [0m
[2;36m                    [0m         [32mfile"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"n"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"thread id [0m[32m([0m[32mthread [0m                     [2m                [0m
[2;36m                    [0m         [32mnumber[0m[32m)[0m[32m"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                        [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"perFile"[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"number of iterations to run per seed [0m                     [2m                [0m
[2;36m                    [0m         [32mfile"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"t"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"maxTransformers"[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"maximum number of transformers to run per [0m                [2m                [0m
[2;36m                    [0m         [32miteration"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"r"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"retryId"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"which retry is [0m     [2m                [0m
[2;36m                    [0m         [32mthis"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                        [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:126[0m[39m-[0m[1;36m144[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        ExecutorService executor = [0m[1;35mExecutors.newFixedThreadPool[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        Future<Integer> future = [0m[1;35mexecutor.submit[0m[1;39m([0m[39mnew [0m[1;35mParseTask[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            int result = [0m[1;35mfuture.get[0m[1;39m([0m[39mtimeoutMs, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            if [0m[1;39m([0m[39mresult == [0m[1;36m1[0m[39m && [0m[1;35mFiles.exists[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"failed to delete target: "[0m[39m + target[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"timeout exception:"[0m[39m + target[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;35mfuture.cancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mwriteErrFile[0m[1;39m([0m[39mtarget, [0m[32m".timeout"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException | ExecutionException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem parsing "[0m[39m + target, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mexecutor.shutdownNow[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzingCLI.jav[0m[1;92ma:224[0m[39m-[0m[1;36m244[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        private boolean [0m[1;35mhandleResult[0m[1;39m([0m[39mPipesResult.STATUS status, String [0m         [2m                [0m
[2;36m                    [0m         [39morigFetchKey,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                                     Path fuzzedPath, int tries, int [0m           [2m                [0m
[2;36m                    [0m         [39mmaxRetries[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                throws IOException [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:            switch [0m[1;39m([0m[39mstatus[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                case OOM:[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                case TIMEOUT:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                case UNSPECIFIED_CRASH:[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                    if [0m[1;39m([0m[39mtries < maxRetries[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                        [0m[1;35mLOG.info[0m[1;39m([0m[32m"trying again [0m[32m([0m[32m{[0m[32m}[0m[32m of [0m[32m{[0m[32m}[0m[32m)[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, tries, [0m         [2m                [0m
[2;36m                    [0m         [39mmaxRetries,[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                                [0m[1;35mstatus.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                        return true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                    Path problemFilePath = [0m[1;35mgetProblemFile[0m[1;39m([0m[39mstatus, [0m              [2m                [0m
[2;36m                    [0m         [39morigFetchKey[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"found a problem [0m[32m{[0m[32m}[0m[32m -> [0m[32m{[0m[32m}[0m[32m : [0m[32m{[0m[32m}[0m[32m"[0m[39m, origFetchKey, [0m    [2m                [0m
[2;36m                    [0m         [39mproblemFilePath,[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                            [0m[1;35mstatus.name[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mfuzzedPath, problemFilePath[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                default:[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                    [0m[35m/[0m[35m/[0m[95mif[0m[39m there wasn't a problem[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Overview and Root Cause Analysis  [0m                                               [2m                [0m
[2;36m                    [0m         [39m   - The ‚ÄúERROR: libFuzzer: timeout‚Äù is coming from the Java fuzz-one harness [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`FuzzOne.java`[0m[1;39m)[0m[39m which implements its own per‚Äêfile timeout by spawning a [0m           [2m                [0m
[2;36m                    [0m         [39msingle‚Äêthreaded `ExecutorService` and calling `[0m[1;35mfuture.get[0m[1;39m([0m[39mtimeoutMs, [0m               [2m                [0m
[2;36m                    [0m         [39mTimeUnit.MILLISECONDS[0m[1;39m)[0m[39m`.  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - On timeout, the harness calls `[0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m`, abruptly killing the JVM and [0m  [2m                [0m
[2;36m                    [0m         [39mmaking libFuzzer believe nothing happened [0m[1;39m([0m[39mor that the target hung[0m[1;39m)[0m[39m, triggering its[0m [2m                [0m
[2;36m                    [0m         [39mglobal ‚Äútimeout‚Äù termination.  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - In addition, the `-m/--timeoutMs` option is currently marked `[0m[1;35mrequired[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m`,[0m [2m                [0m
[2;36m                    [0m         [39mso any missing or mis‚Äêspecified flag will cause a parse failure before even [0m        [2m                [0m
[2;36m                    [0m         [39mentering the fuzz loop [0m[1;39m([0m[39mthough the tool may not always surface that error[0m[1;39m)[0m[39m.  [0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Symptom & Desired Behavior  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - We want each individual parsing iteration that times out to be reported [0m[1;39m([0m[39mand [0m  [2m                [0m
[2;36m                    [0m         [39mthe input dumped[0m[1;39m)[0m[39m without killing the entire JVM.  [0m                                 [2m                [0m
[2;36m                    [0m         [39m   - We want the per‚Äêfile timeout to have a sensible default so that users invoking[0m [2m                [0m
[2;36m                    [0m         [39m`FuzzOne` via libFuzzer do not have to supply `-m` manually every time.  [0m           [2m                [0m
[2;36m                    [0m         [39m   - We want any true harness hang [0m[1;39m([0m[39mor infinite loop[0m[1;39m)[0m[39m to be caught by libFuzzer‚Äôs [0m  [2m                [0m
[2;36m                    [0m         [39mown `-[0m[33mtimeout[0m[39m=` flag, not by an internal `System.exit`.  [0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Patch Outline  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   A. Make `-m/--timeoutMs` optional and supply a default value.  [0m                  [2m                [0m
[2;36m                    [0m         [39m   B. Remove the `[0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m` calls from the `catch [0m[1;39m([0m[39mTimeoutException[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mand [0m   [2m                [0m
[2;36m                    [0m         [39msimilarly on other fatal catches[0m[1;39m)[0m[39m; instead, throw a runtime exception or return an [0m [2m                [0m
[2;36m                    [0m         [39merror code so that libFuzzer can take over.  [0m                                       [2m                [0m
[2;36m                    [0m         [39m   C. Ensure the `ExecutorService` is always shut down in `finally`.  [0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Detailed Steps  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m1[0m[39m. In `FuzzOne.java` [0m[1;39m([0m[39mpath:  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m      tika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.java[0m[1;39m)[0m[39m:  [0m       [2m                [0m
[2;36m                    [0m         [39m      - Change the static [0m[1;33mOPTIONS[0m[39m builder for `timeoutMs` to:  [0m                     [2m                [0m
[2;36m                    [0m         [39m        ‚Ä¢ `[0m[1;35m.required[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m` [0m[1;39m([0m[39minstead of `[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m, and  [0m                  [2m                [0m
[2;36m                    [0m         [39m        ‚Ä¢ Give it a default via `[0m[1;35m.defaultValue[0m[1;39m([0m[32m"10000"[0m[1;39m)[0m[39m` [0m[1;39m([0m[1;36m10[0m[39m seconds, for example[0m[1;39m)[0m[39m.[0m [2m                [0m
[2;36m                    [0m         [39m      - In the code that parses the command‚Äêline into `FuzzOneConfig`, after [0m       [2m                [0m
[2;36m                    [0m         [39mparsing call  [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         `[0m[1;35mconfig.setTimeoutMs[0m[1;39m([0m[1;35mparsedValueOrDefault[0m[1;39m([0m[39m‚ÄútimeoutMs‚Äù, 10000L[0m[1;39m)[0m[1;39m)[0m[39m;`  [0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m([0m[39mso that, if the flag was omitted, we use the [0m[1;36m10[0m[39m [0m[1;36m000[0m[39m ms default[0m[1;39m)[0m[39m.  [0m         [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m2[0m[39m. In the same file, locate the block:  [0m                                         [2m                [0m
[2;36m                    [0m         [39m         ExecutorService executor = ‚Ä¶  [0m                                             [2m                [0m
[2;36m                    [0m         [39m         Future<Integer> future = ‚Ä¶  [0m                                               [2m                [0m
[2;36m                    [0m         [39m         try [0m[1;39m{[0m[39m  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m             int result = [0m[1;35mfuture.get[0m[1;39m([0m[39mtimeoutMs, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;  [0m           [2m                [0m
[2;36m                    [0m         [39m             ‚Ä¶  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m                                           [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mLOG.warn[0m[1;39m([0m[39m‚Äútimeout exception:‚Äù + target[0m[1;39m)[0m[39m;  [0m                             [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mfuture.cancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mwriteErrFile[0m[1;39m([0m[39mtarget, ‚Äú.timeout‚Äù[0m[1;39m)[0m[39m;  [0m                                    [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m      - Replace the `[0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m` with `throw new [0m[1;35mRuntimeException[0m[1;39m([0m[32m"Parsing [0m     [2m                [0m
[2;36m                    [0m         [32mtimed out for "[0m[39m + target, e[0m[1;39m)[0m[39m;`  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m      - Likewise, in the `catch [0m[1;39m([0m[39mInterruptedException | ExecutionException e[0m[1;39m)[0m[39m` that[0m [2m                [0m
[2;36m                    [0m         [39mcurrently does `[0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m`, replace that exit with a similar runtime [0m          [2m                [0m
[2;36m                    [0m         [39mexception.  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m      - Retain the `[0m[1;35mfuture.cancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m` and `[0m[1;35mwriteErrFile[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` so that the input [0m [2m                [0m
[2;36m                    [0m         [39mis still dumped.  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m3[0m[39m. In both places, leave the `finally [0m[1;39m{[0m[39m [0m[1;35mexecutor.shutdownNow[0m[1;39m([0m[1;39m)[0m[39m; [0m[1;39m}[0m[39m` unchanged to [0m [2m                [0m
[2;36m                    [0m         [39mguarantee no thread‚Äêleaks.  [0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Why This Works  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - By making the timeout option optional with a default, we eliminate any [0m        [2m                [0m
[2;36m                    [0m         [39m‚Äúmissing required flag‚Äù parse errors.  [0m                                             [2m                [0m
[2;36m                    [0m         [39m   - By removing `[0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m`, we allow the Java process to throw a real [0m       [2m                [0m
[2;36m                    [0m         [39mexception on per‚Äêfile timeout. libFuzzer will see the non‚Äêzero exit [0m[1;39m([0m[39mor unhandled [0m  [2m                [0m
[2;36m                    [0m         [39mexception[0m[1;39m)[0m[39m as a crash and report the input, but it will not shut down the entire [0m   [2m                [0m
[2;36m                    [0m         [39mJVM in an uncontrolled way. It will then drive the next input.  [0m                    [2m                [0m
[2;36m                    [0m         [39m   - The harness will still record `.timeout` files in the ‚Äúproblems‚Äù directory, [0m   [2m                [0m
[2;36m                    [0m         [39mbut now in a controlled fashion that libFuzzer can integrate with.  [0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Preserving Existing Functionality  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   - We leave the `writeErrFile` calls intact, so timeouts are still captured.  [0m    [2m                [0m
[2;36m                    [0m         [39m   - We do not modify test code or any external libraries.  [0m                        [2m                [0m
[2;36m                    [0m         [39m   - We do not touch the multi‚Äêthreaded `FuzzingCLI` harness or any other fuzzing [0m  [2m                [0m
[2;36m                    [0m         [39minfrastructure‚Äîonly the single‚Äêfile CLI, which is part of the normal codebase.  [0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Potential Side Effects & Mitigation  [0m                                            [2m                [0m
[2;36m                    [0m         [39m   - The default timeout [0m[1;39m([0m[1;36m10[0m[39m [0m[1;36m000[0m[39m ms[0m[1;39m)[0m[39m may be too aggressive or conservative for some[0m [2m                [0m
[2;36m                    [0m         [39mfiles; we chose a round value that can be tuned later. If users need a different [0m   [2m                [0m
[2;36m                    [0m         [39mvalue, they can still pass `-m`.  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Throwing an unchecked exception will result in a Java stack trace. If that is [0m [2m                [0m
[2;36m                    [0m         [39mnoisy, we could wrap it in a client‚Äêfriendly error message‚Äîbut libFuzzer benefits [0m  [2m                [0m
[2;36m                    [0m         [39mfrom seeing a stack trace when diagnosing a crash.  [0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. Patch Application  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The target file path [0m                                                          [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`tika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.java`[0m[1;39m)[0m[39m is [0m         [2m                [0m
[2;36m                    [0m         [39mguaranteed to exist.  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - Use a standard `git diff -u` with correct context lines for unified diff [0m      [2m                [0m
[2;36m                    [0m         [39mformat.  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - No harness code outside this single CLI is altered‚Äîfuzzing logic in [0m           [2m                [0m
[2;36m                    [0m         [39m`FuzzingCLI.java` and any test files remain untouched.  [0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 22:10:17][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=165276;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=691400;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 22:12:51][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=345643;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=943165;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 22:15:16][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=662250;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=582390;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=834848;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=499041;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         The patch did not apply, here are some possible reasons:                            [2m                [0m
[2;36m                    [0m         - Trying to patch a file that does not exist in the repository.                     [2m                [0m
[2;36m                    [0m         - Trying to patch fuzzer or harness related file. [1m([0mThese files are used to test the [2m                [0m
[2;36m                    [0m         validity of the patch.[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         - Incorrect patch format. [1m([0mFocus on the patch formatting instructions.[1m)[0m             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m         The project‚Äôs libFuzzer-based tests are terminating with a timeout error. An empty  [2m                [0m
[2;36m                    [0m         or improperly formatted patch was submitted in an attempt to address the issue, but [2m                [0m
[2;36m                    [0m         it failed to apply. The patch application log suggests that the failure may be due  [2m                [0m
[2;36m                    [0m         to targeting a non-existent file, modifying a harness or fuzzer-specific file, or   [2m                [0m
[2;36m                    [0m         using an incorrect patch format.                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         Initial Issue                                                                       [2m                [0m
[2;36m                    [0m         - When running libFuzzer against the codebase, the fuzzer process halts with the    [2m                [0m
[2;36m                    [0m         message                                                                             [2m                [0m
[2;36m                    [0m           ‚ÄúERROR: libFuzzer: timeout.‚Äù                                                      [2m                [0m
[2;36m                    [0m         - This indicates that during a fuzzing session, no interesting behavior [1m([0mcrash or   [2m                [0m
[2;36m                    [0m         exit[1m)[0m was observed before the configured time limit, leading the harness to         [2m                [0m
[2;36m                    [0m         terminate.                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         Key Observations                                                                    [2m                [0m
[2;36m                    [0m         - The timeout originates from libFuzzer‚Äôs internal watchdog, not from an            [2m                [0m
[2;36m                    [0m         application crash or assertion failure.                                             [2m                [0m
[2;36m                    [0m         - No stack trace or file/line reference accompanies the timeout message, as         [2m                [0m
[2;36m                    [0m         timeouts do not trigger sanitizer reports.                                          [2m                [0m
[2;36m                    [0m         - The harness remains running without progress until the timeout threshold is       [2m                [0m
[2;36m                    [0m         reached.                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         Patch Attempt                                                                       [2m                [0m
[2;36m                    [0m         - The submitted `[1m<[0m[1;95mpatch_attempt[0m[39m>` block is empty‚Äîno diff headers or file [0m           [2m                [0m
[2;36m                    [0m         [39mmodifications are present.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m- As a result, applying the patch yields no changes to the repository.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPatch Application Log  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m- The patch application process reported failure with three possible reasons:  [0m     [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. The referenced [0m[1;35mfile[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m do not exist in the repository.  [0m                       [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. The patch targets a fuzzer or harness file, which may be excluded from [0m        [2m                [0m
[2;36m                    [0m         [39mpatching.  [0m                                                                         [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. The patch format does not conform to expected diff/patch syntax.  [0m             [2m                [0m
[2;36m                    [0m         [39m- No specific filenames, hunks, or line numbers are provided in the log, preventing[0m [2m                [0m
[2;36m                    [0m         [39mdirect reapplication.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAreas for Further Investigation  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Fuzzer Harness Code: review the entrypoint to confirm the correct invocation of [0m  [2m                [0m
[2;36m                    [0m         [39mthe library under test and any timeout-related flags.  [0m                             [2m                [0m
[2;36m                    [0m         [39m- Target Files Under Test: verify that the source files meant to be patched or [0m     [2m                [0m
[2;36m                    [0m         [39mupdated actually exist and are tracked in version control.  [0m                        [2m                [0m
[2;36m                    [0m         [39m- Build and Patch Infrastructure: inspect patch-application scripts or CI [0m          [2m                [0m
[2;36m                    [0m         [39mconfiguration to ensure they allow modifications to test harness files and use the [0m [2m                [0m
[2;36m                    [0m         [39mcorrect `git apply` or `patch` conventions.  [0m                                       [2m                [0m
[2;36m                    [0m         [39m- Timeout Configuration: examine the fuzzer‚Äôs command-line arguments or build-time [0m [2m                [0m
[2;36m                    [0m         [39mflags that define the timeout duration and behavior.  [0m                              [2m                [0m
[2;36m                    [0m         [39m- Repository Layout: confirm that the directory structure matches expectations for [0m [2m                [0m
[2;36m                    [0m         [39mpatch file paths.  [0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNo root-cause speculation or fixes are offered. This report focuses solely on [0m      [2m                [0m
[2;36m                    [0m         [39msummarizing the observable issue, the unsuccessful patch attempt, and the relevant [0m [2m                [0m
[2;36m                    [0m         [39mcode areas that warrant deeper review.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe patch did not apply, here are some possible reasons:[0m                            [2m                [0m
[2;36m                    [0m         [39m- Trying to patch a file that does not exist in the repository.[0m                     [2m                [0m
[2;36m                    [0m         [39m- Trying to patch fuzzer or harness related file. [0m[1;39m([0m[39mThese files are used to test the[0m [2m                [0m
[2;36m                    [0m         [39mvalidity of the patch.[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- Incorrect patch format. [0m[1;39m([0m[39mFocus on the patch formatting instructions.[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/Transformer.jav[0m[1;92ma:1[0m[39m-[0m[1;36m40[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:public interface Transformer [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:     * Returns the set of media types supported by this parser when used[0m         [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:     * with the given parse context.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     * @return immutable set of media types[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * @since Apache Tika [0m[1;36m1.24[0m[39m.[0m[1;36m1[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m         [2m                [0m
[2;36m                    [0m         [39mTikaException;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/AutoDetectTransformer.jav[0m[1;92ma:1[0m[39m-[0m[1;36m96[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.config.ServiceLoader;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.config.TikaConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.detect.Detector;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.fuzzing.general.GeneralTransformer;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.mime.MediaTypeRegistry;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class AutoDetectTransformer implements Transformer [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final ServiceLoader DEFAULT_LOADER =[0m                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:            new [0m[1;35mServiceLoader[0m[1;39m([0m[1;35mAutoDetectTransformer.class.getClassLoader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    TikaConfig config = [0m[1;35mTikaConfig.getDefaultConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    MediaTypeRegistry registry = [0m[1;35mconfig.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    Detector detector = [0m[1;35mTikaConfig.getDefaultConfig[0m[1;39m([0m[1;39m)[0m[1;35m.getDetector[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    Transformer fallback = new [0m[1;35mGeneralTransformer[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    Map<MediaType, Transformer> transformerMap = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public [0m[1;35mAutoDetectTransformer[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mthis[0m[1;39m([0m[1;35mDEFAULT_LOADER.loadServiceProviders[0m[1;39m([0m[39morg.apache.tika.fuzzing.Transformer.class[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public [0m[1;35mAutoDetectTransformer[0m[1;39m([0m[39mList<Transformer> transformers[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        for [0m[1;39m([0m[39mTransformer t : transformers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            for [0m[1;39m([0m[39mMediaType mediaType : [0m[1;35mt.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                [0m[1;35mtransformerMap.put[0m[1;39m([0m[39mmediaType, t[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        return [0m[1;35mtransformerMap.keySet[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[35m/[0m[35m/[0m[39m Automatically detect the MIME type of the document[0m                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            MediaType type = [0m[1;35mdetector.detect[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            Transformer transformer = [0m[1;35mgetTransformer[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;35mtransformer.transform[0m[1;39m([0m[39mtis, os[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private Transformer [0m[1;35mgetTransformer[0m[1;39m([0m[39mMediaType type[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39mtype == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            return fallback;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[35m/[0m[39m We always work on the normalised, canonical form[0m                      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        type = [0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        while [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try finding a parser for the type[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            Transformer transformer = [0m[1;35mtransformerMap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            if [0m[1;39m([0m[39mtransformer != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                return transformer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[35m/[0m[35m/[0m[39m Failing that, try for the parent of the type[0m                      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            type = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        return fallback;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:1[0m[39m-[0m[1;36m84[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing.cli;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.concurrent.Callable;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.concurrent.ExecutionException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ExecutorService;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.concurrent.Executors;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.concurrent.Future;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.commons.cli.CommandLine;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.commons.cli.CommandLineParser;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.cli.DefaultParser;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.cli.Option;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.cli.Options;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.cli.ParseException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.fuzzing.AutoDetectTransformer;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.fuzzing.Transformer;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.fuzzing.exceptions.CantFuzzException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.AutoDetectParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.utils.ExceptionUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * Forked process that runs against a single input file[0m                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:public class FuzzOne [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    private static final Logger LOG = [0m[1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mFuzzOne.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    static Options [0m[1;33mOPTIONS[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[35m/[0m[35m/[0m[95mBy[0m[39m the time this commandline is parsed, there should be both an [0m       [2m                [0m
[2;36m                    [0m         [39mextracts and an inputDir[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        Option extracts = new [0m[1;35mOption[0m[1;39m([0m[32m"extracts"[0m[39m, true, [0m[32m"directory for extract [0m   [2m                [0m
[2;36m                    [0m         [32mfiles"[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mextracts.setRequired[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;33mOPTIONS[0m[39m = new [0m[1;35mOptions[0m[1;39m([0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"i"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"inputFile"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"input directory [0m  [2m                [0m
[2;36m                    [0m         [32mfor seed files"[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                        [0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"o"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"outputFile"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"output file [0m     [2m                [0m
[2;36m                    [0m         [32mbase"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"m"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"timeoutMs"[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"timeout in ms -- max time allowed to parse a [0m             [2m                [0m
[2;36m                    [0m         [32mfile"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"n"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"thread id [0m[32m([0m[32mthread [0m                     [2m                [0m
[2;36m                    [0m         [32mnumber[0m[32m)[0m[32m"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                        [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"perFile"[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"number of iterations to run per seed [0m                     [2m                [0m
[2;36m                    [0m         [32mfile"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"t"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"maxTransformers"[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"maximum number of transformers to run per [0m                [2m                [0m
[2;36m                    [0m         [32miteration"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"r"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"retryId"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"which retry is [0m     [2m                [0m
[2;36m                    [0m         [32mthis"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                        [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:85[0m[39m-[0m[1;36m144[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    Parser parser = new [0m[1;35mAutoDetectParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        FuzzOneConfig config = [0m[1;35mFuzzOneConfig.parse[0m[1;39m([0m[39margs[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        FuzzOne fuzzOne = new [0m[1;35mFuzzOne[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;35mfuzzOne.execute[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    private void [0m[1;35mexecute[0m[1;39m([0m[39mFuzzOneConfig config[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        Path src = config.inputFile;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        Path targetDir = config.outputFileBase;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        AutoDetectTransformer transformer = new [0m[1;35mAutoDetectTransformer[0m[1;39m([0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < config.perFileIterations; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                String ext = [0m[32m"-"[0m[39m + config.threadNum + [0m[32m"-"[0m[39m + config.retryNum + [0m  [2m                [0m
[2;36m                    [0m         [32m"-"[0m[39m + i;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                [0m[1;35mfuzz[0m[1;39m([0m[39mext, src, targetDir, transformer, config.timeoutMs[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem transforming file"[0m[39m, e[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCantFuzzException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"can't fuzz this file "[0m[39m + src, e[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                [0m[1;35me.printStackTrace[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    private void [0m[1;35mfuzz[0m[1;39m([0m[39mString ext, Path src, Path targetFileBase, Transformer [0m   [2m                [0m
[2;36m                    [0m         [39mtransformer,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                      long timeoutMs[0m[1;39m)[0m[39m throws IOException, TikaException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        Path target =[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mtargetFileBase.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtargetFileBase.getFileName[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m + ext[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;35mtransformFile[0m[1;39m([0m[39mtransformer, src, target[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mThrowable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"failed to transform: "[0m[39m + [0m[1;35msrc.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            [0m[1;35mFiles.delete[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            throw t;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        ExecutorService executor = [0m[1;35mExecutors.newFixedThreadPool[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        Future<Integer> future = [0m[1;35mexecutor.submit[0m[1;39m([0m[39mnew [0m[1;35mParseTask[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            int result = [0m[1;35mfuture.get[0m[1;39m([0m[39mtimeoutMs, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            if [0m[1;39m([0m[39mresult == [0m[1;36m1[0m[39m && [0m[1;35mFiles.exists[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"failed to delete target: "[0m[39m + target[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"timeout exception:"[0m[39m + target[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;35mfuture.cancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mwriteErrFile[0m[1;39m([0m[39mtarget, [0m[32m".timeout"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException | ExecutionException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem parsing "[0m[39m + target, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mexecutor.shutdownNow[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/pom.xml:[0m[1;36m1[0m[39m-[0m[1;36m136[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:<?xml [0m[33mversion[0m[39m=[0m[32m"1[0m[32m.0"[0m[39m [0m[33mencoding[0m[39m=[0m[32m"UTF[0m[32m-8"[0m[39m?>[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:<!--[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:  Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:  or more contributor license agreements.  See the NOTICE file[0m                    [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:  distributed with this work for additional information[0m                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:  regarding copyright ownership.  The ASF licenses this file[0m                      [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:  to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                               [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:  [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:  with the License.  You may obtain a copy of the License at[0m                      [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:    [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:  Unless required by applicable law or agreed to in writing,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:  software distributed under the License is distributed on an[0m                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:  [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                         [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:  KIND, either express or implied.  See the License for the[0m                      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:  specific language governing permissions and limitations[0m                        [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  under the License.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:-->[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:<project [0m[33mxmlns[0m[39m=[0m[32m"http[0m[32m://maven.apache.org/POM/4.0.0"[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [39mxmlns:[0m[33mxsi[0m[39m=[0m[32m"http[0m[32m://www.w3.org/2001/XMLSchema-instance"[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [39mxsi:[0m[33mschemaLocation[0m[39m=[0m[32m"http[0m[32m://maven.apache.org/POM/4.0.0 [0m                              [2m                [0m
[2;36m                    [0m         [32mhttps://maven.apache.org/xsd/maven-4.0.0.xsd"[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  <parent>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:    <artifactId>tika-parent<[0m[35m/[0m[95martifactId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:    <version>[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT<[0m[35m/[0m[95mversion[0m[39m>[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:    <relativePath>..[0m[35m/tika-parent/[0m[95mpom.xml[0m[39m<[0m[35m/[0m[95mrelativePath[0m[39m>[0m                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:  <[0m[35m/[0m[95mparent[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  <artifactId>tika-fuzzing<[0m[35m/[0m[95martifactId[0m[39m>[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  <name>Apache Tika fuzzing<[0m[35m/[0m[95mname[0m[39m>[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:  <url>[0m[4;94mhttps://tika.apache.org/[0m[39m<[0m[35m/[0m[95murl[0m[39m>[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  <modelVersion>[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m<[0m[35m/[0m[95mmodelVersion[0m[39m>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:  <dependencies>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:      <groupId>$[0m[1;39m{[0m[39mproject.groupId[0m[1;39m}[0m[39m<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:      <artifactId>tika-core<[0m[35m/[0m[95martifactId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:      <scope>provided<[0m[35m/[0m[95mscope[0m[39m>[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:      <groupId>$[0m[1;39m{[0m[39mproject.groupId[0m[1;39m}[0m[39m<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:      <artifactId>tika-serialization<[0m[35m/[0m[95martifactId[0m[39m>[0m                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:      <groupId>$[0m[1;39m{[0m[39mproject.groupId[0m[1;39m}[0m[39m<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:      <artifactId>tika-emitter-fs<[0m[35m/[0m[95martifactId[0m[39m>[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:      <groupId>commons-cli<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:      <artifactId>commons-cli<[0m[35m/[0m[95martifactId[0m[39m>[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:      <artifactId>tika-parser-pkg-module<[0m[35m/[0m[95martifactId[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:      <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:      <artifactId>tika-parser-pdf-module<[0m[35m/[0m[95martifactId[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    <!-- logging -->[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:      <groupId>org.apache.logging.log4j<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:      <artifactId>log4j-slf4j2-impl<[0m[35m/[0m[95martifactId[0m[39m>[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:      <groupId>org.slf4j<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:      <artifactId>jcl-over-slf4j<[0m[35m/[0m[95martifactId[0m[39m>[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    <!-- test -->[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:      <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:      <artifactId>tika-parser-digest-commons<[0m[35m/[0m[95martifactId[0m[39m>[0m                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    <!-- bring in the mock parser -->[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:      <groupId>$[0m[1;39m{[0m[39mproject.groupId[0m[1;39m}[0m[39m<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:      <artifactId>tika-core<[0m[35m/[0m[95martifactId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:      <type>test-jar<[0m[35m/[0m[95mtype[0m[39m>[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:      <scope>test<[0m[35m/[0m[95mscope[0m[39m>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:  <[0m[35m/[0m[95mdependencies[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  <build>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    <plugins>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:      <plugin>[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        <groupId>org.apache.maven.plugins<[0m[35m/[0m[95mgroupId[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        <artifactId>maven-checkstyle-plugin<[0m[35m/[0m[95martifactId[0m[39m>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        <version>$[0m[1;39m{[0m[39mcheckstyle.plugin.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        <dependencies>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:          <dependency>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            <groupId>com.puppycrawl.tools<[0m[35m/[0m[95mgroupId[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            <artifactId>checkstyle<[0m[35m/[0m[95martifactId[0m[39m>[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            <version>$[0m[1;39m{[0m[39mpuppycrawl.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:          <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        <[0m[35m/[0m[95mdependencies[0m[39m>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        <executions>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:          <execution>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            <id>validate<[0m[35m/[0m[95mid[0m[39m>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            <phase>validate<[0m[35m/[0m[95mphase[0m[39m>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            <configuration>[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:              <configLocation>checkstyle.xml<[0m[35m/[0m[95mconfigLocation[0m[39m>[0m                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:              <inputEncoding>UTF-[0m[1;36m8[0m[39m<[0m[35m/[0m[95minputEncoding[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:              <consoleOutput>false<[0m[35m/[0m[95mconsoleOutput[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:              <includeTestSourceDirectory>true<[0m[35m/[0m[95mincludeTestSourceDirectory[0m[39m>[0m     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:              [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m<testSourceDirectories>$[0m[1;39m{[0m[39mproject.basedir[0m[1;39m}[0m[35m/src/test/[0m[95mjava[0m[39m<[0m[35m/[0m[95mtestSourceDirectories[0m[39m>[0m     [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:              <violationSeverity>error<[0m[35m/[0m[95mviolationSeverity[0m[39m>[0m                      [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:              <failOnViolation>true<[0m[35m/[0m[95mfailOnViolation[0m[39m>[0m                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            <[0m[35m/[0m[95mconfiguration[0m[39m>[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            <goals>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:              <goal>check<[0m[35m/[0m[95mgoal[0m[39m>[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:            <[0m[35m/[0m[95mgoals[0m[39m>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:          <[0m[35m/[0m[95mexecution[0m[39m>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        <[0m[35m/[0m[95mexecutions[0m[39m>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:      <[0m[35m/[0m[95mplugin[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:      <plugin>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        <groupId>org.apache.maven.plugins<[0m[35m/[0m[95mgroupId[0m[39m>[0m                             [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        <artifactId>maven-jar-plugin<[0m[35m/[0m[95martifactId[0m[39m>[0m                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        <configuration>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:          <archive>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            <manifestEntries>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:              [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m<Automatic-Module-Name>org.apache.tika.fuzzing<[0m[35m/[0m[95mAutomatic-Module-Name[0m[39m>[0m              [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            <[0m[35m/[0m[95mmanifestEntries[0m[39m>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:          <[0m[35m/[0m[95marchive[0m[39m>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        <[0m[35m/[0m[95mconfiguration[0m[39m>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:      <[0m[35m/[0m[95mplugin[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    <[0m[35m/[0m[95mplugins[0m[39m>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  <[0m[35m/[0m[95mbuild[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:<[0m[35m/[0m[95mproject[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root-Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer harness [0m[1;39m([0m[39mlibFuzzer/Jazzer[0m[1;39m)[0m[39m times out because one of two phases in [0m  [2m                [0m
[2;36m                    [0m         [39mour Java-side fuzz target blocks indefinitely:[0m                                      [2m                [0m
[2;36m                    [0m         [39m     a. The ‚Äútransform‚Äù phase [0m[1;39m([0m[39mAutoDetectTransformer ‚Üí specific Transformer [0m        [2m                [0m
[2;36m                    [0m         [39mimplementations[0m[1;39m)[0m[39m is executed synchronously in the main thread and has no internal [0m  [2m                [0m
[2;36m                    [0m         [39mtimeout or bail‚Äêout on pathological inputs.[0m                                         [2m                [0m
[2;36m                    [0m         [39m     b. The ‚Äúparse‚Äù phase is invoked via a one‚Äêthread ExecutorService with a [0m       [2m                [0m
[2;36m                    [0m         [39mtimeout, but only the parse step is bounded. A hung transform will never reach [0m     [2m                [0m
[2;36m                    [0m         [39mparse and thus tramples the fuzzer‚Äôs global watchdog.[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Additionally, spot‚Äêcheck the command‚Äêline parser [0m[1;39m([0m[39mFuzzOneConfig.parse[0m[1;39m)[0m[39m to [0m     [2m                [0m
[2;36m                    [0m         [39mconfirm that the per‚Äêfile timeoutMs parameter [0m[1;39m([0m[39m-m/--timeoutMs[0m[1;39m)[0m[39m is correctly read [0m   [2m                [0m
[2;36m                    [0m         [39minto the config. If this field remains zero or unset, then even the parse step will[0m [2m                [0m
[2;36m                    [0m         [39minstantly timeout, generating immediate [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m and confusing libFuzzer.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. High‚ÄêLevel Fix Steps [0m[1;39m([0m[39mno harness changes[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [39m   A. Enforce a transform‚Äêphase timeout entirely within library code [0m               [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mAutoDetectTransformer and/or core Transformer classes[0m[1;39m)[0m[39m:[0m                            [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m1[0m[39m. In [0m[1;35mAutoDetectTransformer.transform[0m[1;39m([0m[39mInputStream, OutputStream[0m[1;39m)[0m[39m:[0m             [2m                [0m
[2;36m                    [0m         [39m         ‚Äì Wrap the call to [0m[1;35mtransformer.transform[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m in a short‚Äêlived [0m            [2m                [0m
[2;36m                    [0m         [39mExecutorService [0m[1;39m([0m[39msingle‚Äêthreaded[0m[1;39m)[0m[39m.[0m                                                  [2m                [0m
[2;36m                    [0m         [39m         ‚Äì Submit a Callable that invokes [0m[1;35mtransformer.transform[0m[1;39m([0m[39mtis, os[0m[1;39m)[0m[39m.[0m           [2m                [0m
[2;36m                    [0m         [39m         ‚Äì Call [0m[1;35mFuture.get[0m[1;39m([0m[39mtimeoutNs, TimeUnit.NANOSECONDS[0m[1;39m)[0m[39m using the same [0m         [2m                [0m
[2;36m                    [0m         [39mtimeoutMs value [0m[1;39m([0m[39mconverted to ms[0m[1;39m)[0m[39m provided to the fuzz target.[0m                      [2m                [0m
[2;36m                    [0m         [39m         ‚Äì On TimeoutException:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             ‚Ä¢ Cancel the future, shut down the executor.[0m                           [2m                [0m
[2;36m                    [0m         [39m             ‚Ä¢ Throw a [0m[1;35mTikaException[0m[1;39m([0m[32m"Transform timed out"[0m[1;39m)[0m[39m so the harness sees an [0m [2m                [0m
[2;36m                    [0m         [39mexception and bails out of transform quickly.[0m                                       [2m                [0m
[2;36m                    [0m         [39m         ‚Äì Always shutdown the executor in finally block.[0m                           [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m2[0m[39m. Propagate the same timeoutMs into AutoDetectTransformer via a thread‚Äêlocal[0m [2m                [0m
[2;36m                    [0m         [39mor system‚Äêproperty, so that the library knows how long to wait. E.g., read a system[0m [2m                [0m
[2;36m                    [0m         [39mproperty ‚Äútika.fuzzing.timeoutMs‚Äù at transformer construction:[0m                      [2m                [0m
[2;36m                    [0m         [39m         ‚Äì If system‚Äêproperty absent or unparsable, fall back to a safe default [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39me.g., 500ms[0m[1;39m)[0m[39m.[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m3[0m[39m. Ensure that each concrete Transformer implementation [0m[1;39m([0m[39mGeneralTransformer, [0m [2m                [0m
[2;36m                    [0m         [39mPDFTransformer, etc.[0m[1;39m)[0m[39m honors [0m[1;35mThread.currentThread[0m[1;39m([0m[1;39m)[0m[1;35m.isInterrupted[0m[1;39m([0m[1;39m)[0m[39m where [0m          [2m                [0m
[2;36m                    [0m         [39mfeasible‚Äîespecially around loops or recursive parsing‚Äîso that [0m[1;35mcancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m actually[0m [2m                [0m
[2;36m                    [0m         [39mbreaks out of long‚Äêrunning code.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   B. Validate the command‚Äêline timeout parameter:[0m                                  [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m1[0m[39m. Inspect [0m[1;35mFuzzOneConfig.parse[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m to ensure it reads the ‚Äú-m‚Äù [0m[35m/[0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39m‚Äú--timeoutMs‚Äù option correctly:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m         ‚Äì The Option is declared as [0m[1;35m.longOpt[0m[1;39m([0m[32m"timeoutMs"[0m[1;39m)[0m[39m and short ‚Äú-m‚Äù. In [0m      [2m                [0m
[2;36m                    [0m         [1;35mparse[0m[1;39m([0m[1;39m)[0m[39m, call:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m               config.timeoutMs = [0m[1;35mLong.parseLong[0m[1;39m([0m[1;35mcmd.getOptionValue[0m[1;39m([0m[32m"timeoutMs"[0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m         ‚Äì Add a guard: if timeoutMs ‚â§ [0m[1;36m0[0m[39m, throw a ParseException or assign a [0m       [2m                [0m
[2;36m                    [0m         [39mminimum sensible value [0m[1;39m([0m[39me.g., 100ms[0m[1;39m)[0m[39m so that both transform and parse phases get at[0m [2m                [0m
[2;36m                    [0m         [39mleast a small timeslice.[0m                                                            [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m2[0m[39m. Add a unit test of FuzzOneConfig.parse to verify that ‚Äú-m [0m[1;36m1000[0m[39m‚Äù yields [0m    [2m                [0m
[2;36m                    [0m         [39mconfig.timeoutMs == [0m[1;36m1000[0m[39m, and that missing or malformed values are flagged early.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Preservation of Existing Logic[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - We do not alter any fuzzer harness code [0m[1;39m([0m[39me.g., FuzzOne, libFuzzer/Jazzer [0m      [2m                [0m
[2;36m                    [0m         [39mentrypoint[0m[1;39m)[0m[39m, so all existing tests and harness invocation remain unchanged.[0m         [2m                [0m
[2;36m                    [0m         [39m   - We preserve the public Transformer API, only adding an internal [0m               [2m                [0m
[2;36m                    [0m         [39mexecutor/time‚Äêlimit around the [0m[1;35mtransform[0m[1;39m([0m[1;39m)[0m[39m call; callers who already catch [0m         [2m                [0m
[2;36m                    [0m         [39mTikaException or IOException will naturally handle the new timeout exception.[0m       [2m                [0m
[2;36m                    [0m         [39m   - The parse‚Äêphase timeout logic is untouched, ensuring that behavior remains [0m    [2m                [0m
[2;36m                    [0m         [39midentical when transform completes normally.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification & Side‚ÄêEffects[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - By bounding the transform phase, we prevent pathological or maliciously [0m       [2m                [0m
[2;36m                    [0m         [39mcrafted inputs from hanging the Java code indefinitely, thus avoiding libFuzzer‚Äôs [0m  [2m                [0m
[2;36m                    [0m         [39mglobal timeout.[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - Using the same timeoutMs value [0m[1;39m([0m[39mconfigurable by ‚Äú-m‚Äù[0m[1;39m)[0m[39m maintains symmetry [0m      [2m                [0m
[2;36m                    [0m         [39mbetween transformation and parsing steps.[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Executor creation/shutdown per transform incurs minor overhead; if performance[0m [2m                [0m
[2;36m                    [0m         [39mis a concern, it can be optimized later [0m[1;39m([0m[39me.g., using a shared thread pool[0m[1;39m)[0m[39m.[0m         [2m                [0m
[2;36m                    [0m         [39m   - We introduce no new external dependencies and only modify library code under [0m  [2m                [0m
[2;36m                    [0m         [39msrc/main/java, so existing tests and CI remain green.[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Optional Verification[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - After implementing the timeout wrapper:[0m                                        [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ Run the fuzzer locally with a very low timeout [0m[1;39m([0m[39me.g., -m [0m[1;36m10[0m[1;39m)[0m[39m to confirm [0m     [2m                [0m
[2;36m                    [0m         [39mtransforms are aborted quickly and exit with the expected exception.[0m                [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ Ramp up timeout to the desired level [0m[1;39m([0m[39me.g., -m [0m[1;36m1000[0m[1;39m)[0m[39m and observe that now [0m   [2m                [0m
[2;36m                    [0m         [39mlibFuzzer no longer logs ‚ÄúERROR: libFuzzer: timeout‚Äù unless truly no coverage is [0m   [2m                [0m
[2;36m                    [0m         [39mgenerated.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Next Steps[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - Submit a proper patch against [0m                                                 [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/AutoDetectTransformer.java and [0m  [2m                [0m
[2;36m                    [0m         [39mensure FuzzOneConfig.parse is corrected in [0m                                         [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli.[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Coordinate with the build team to propagate the ‚Äútika.fuzzing.timeoutMs‚Äù [0m      [2m                [0m
[2;36m                    [0m         [39msystem‚Äêproperty into the fuzzing JVM [0m[1;39m([0m[39me.g., via -DjvmArgs[0m[1;39m)[0m[39m if needed.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 22:15:23][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=222783;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=883418;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 22:17:05][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=409361;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=966775;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 22:18:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=803325;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=417058;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 22:18:55][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=503152;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=574477;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         The patch did not apply, here are some possible reasons:                            [2m                [0m
[2;36m                    [0m         - Trying to patch a file that does not exist in the repository.                     [2m                [0m
[2;36m                    [0m         - Trying to patch fuzzer or harness related file. [1m([0mThese files are used to test the [2m                [0m
[2;36m                    [0m         validity of the patch.[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         - Incorrect patch format. [1m([0mFocus on the patch formatting instructions.[1m)[0m             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m         The codebase is exhibiting a libFuzzer timeout error when executing a fuzz target.  [2m                [0m
[2;36m                    [0m         No actual patch content was provided in the patch attempt. Upon trying to apply the [2m                [0m
[2;36m                    [0m         [1m([0mempty[1m)[0m patch, the operation failed. The reported failure reasons include the       [2m                [0m
[2;36m                    [0m         target file not existing, an attempt to patch a fuzzer/harness file, or an          [2m                [0m
[2;36m                    [0m         incorrect patch format.                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1[0m. Initial Issue                                                                    [2m                [0m
[2;36m                    [0m            - The fuzzing run terminated with the error message ‚ÄúERROR: libFuzzer: timeout.‚Äù [2m                [0m
[2;36m                    [0m            - This indicates that a fuzz target exceeded its maximum execution time and was  [2m                [0m
[2;36m                    [0m         forcibly stopped by libFuzzer‚Äôs timeout mechanism.                                  [2m                [0m
[2;36m                    [0m            - No further logs [1m([0mcrash stack traces or code coverage data[1m)[0m are available at    [2m                [0m
[2;36m                    [0m         this stage.                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. Important Observations                                                           [2m                [0m
[2;36m                    [0m            - The error originates from libFuzzer‚Äôs built-in timeout guard rather than from  [2m                [0m
[2;36m                    [0m         a functional crash or assertion.                                                    [2m                [0m
[2;36m                    [0m            - The harness code [1m([0mwhich invokes the target function under fuzzing[1m)[0m is in scope [2m                [0m
[2;36m                    [0m         but is not necessarily the root cause; it merely serves as the entry point for fuzz [2m                [0m
[2;36m                    [0m         inputs.                                                                             [2m                [0m
[2;36m                    [0m            - No modifications were recorded in the patch attempt, so there is no diff to    [2m                [0m
[2;36m                    [0m         review.                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. Patch Attempt and Application Log                                                [2m                [0m
[2;36m                    [0m            - The `[1m<[0m[1;95mpatch_attempt[0m[39m>` section is empty, indicating no actual changes were [0m     [2m                [0m
[2;36m                    [0m         [39mproposed.  [0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - When applying the patch, the patch utility reported failure and suggested:  [0m   [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ The specified file does not exist in the repository.  [0m                       [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ The patch may have targeted a fuzzer or harness file, which is typically [0m    [2m                [0m
[2;36m                    [0m         [39mexcluded from persistent code changes.  [0m                                            [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ The patch format may be incorrect according to the project‚Äôs patch [0m          [2m                [0m
[2;36m                    [0m         [39mformatting guidelines.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - Because no concrete diff is available, reapplying the patch is not possible [0m   [2m                [0m
[2;36m                    [0m         [39mwithout further detail.  [0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Areas for Further Investigation  [0m                                                [2m                [0m
[2;36m                    [0m         [39m   - Fuzzing Harness Files: Verify that the fuzzer entrypoint and any associated [0m   [2m                [0m
[2;36m                    [0m         [39mbuild scripts are correctly referenced and up to date.  [0m                            [2m                [0m
[2;36m                    [0m         [39m   - Target [0m[1;35mModule[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m: Identify which [0m[1;35mmodule[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m the fuzzer is exercising and review[0m [2m                [0m
[2;36m                    [0m         [39mtheir performance characteristics [0m[1;39m([0m[39me.g., potential infinite loops or heavy [0m         [2m                [0m
[2;36m                    [0m         [39mcomputations[0m[1;39m)[0m[39m.  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - Build and Fuzzing Configuration: Inspect timeout settings, sanitizer/optimizer[0m [2m                [0m
[2;36m                    [0m         [39mflags, and any custom wrappers around libFuzzer.  [0m                                  [2m                [0m
[2;36m                    [0m         [39m   - Repository File Structure: Confirm that the paths used in patch attempts match[0m [2m                [0m
[2;36m                    [0m         [39mthe actual directory layout and naming conventions.  [0m                               [2m                [0m
[2;36m                    [0m         [39m   - Patch Workflow Documentation: Review the patch formatting guidelines to ensure[0m [2m                [0m
[2;36m                    [0m         [39many future diffs adhere to the required structure.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe patch did not apply, here are some possible reasons:[0m                            [2m                [0m
[2;36m                    [0m         [39m- Trying to patch a file that does not exist in the repository.[0m                     [2m                [0m
[2;36m                    [0m         [39m- Trying to patch fuzzer or harness related file. [0m[1;39m([0m[39mThese files are used to test the[0m [2m                [0m
[2;36m                    [0m         [39mvalidity of the patch.[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- Incorrect patch format. [0m[1;39m([0m[39mFocus on the patch formatting instructions.[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:113[0m[39m-[0m[1;36m145[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    private void [0m[1;35mfuzz[0m[1;39m([0m[39mString ext, Path src, Path targetFileBase, Transformer [0m   [2m                [0m
[2;36m                    [0m         [39mtransformer,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                      long timeoutMs[0m[1;39m)[0m[39m throws IOException, TikaException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        Path target =[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mtargetFileBase.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtargetFileBase.getFileName[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m + ext[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;35mtransformFile[0m[1;39m([0m[39mtransformer, src, target[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mThrowable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"failed to transform: "[0m[39m + [0m[1;35msrc.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            [0m[1;35mFiles.delete[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            throw t;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        ExecutorService executor = [0m[1;35mExecutors.newFixedThreadPool[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        Future<Integer> future = [0m[1;35mexecutor.submit[0m[1;39m([0m[39mnew [0m[1;35mParseTask[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            int result = [0m[1;35mfuture.get[0m[1;39m([0m[39mtimeoutMs, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            if [0m[1;39m([0m[39mresult == [0m[1;36m1[0m[39m && [0m[1;35mFiles.exists[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"failed to delete target: "[0m[39m + target[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"timeout exception:"[0m[39m + target[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;35mfuture.cancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mwriteErrFile[0m[1;39m([0m[39mtarget, [0m[32m".timeout"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException | ExecutionException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem parsing "[0m[39m + target, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mexecutor.shutdownNow[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:168[0m[39m-[0m[1;36m174[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    private void [0m[1;35mtransformFile[0m[1;39m([0m[39mTransformer transformer, Path src, Path target[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            throws IOException, TikaException [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[39msrc[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                OutputStream os = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mtransformer.transform[0m[1;39m([0m[39mis, os[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:212[0m[39m-[0m[1;36m244[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        public Integer [0m[1;35mcall[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            boolean success = false;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"parsing "[0m[39m + target[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;35mparser.parse[0m[1;39m([0m[39mis, new [0m[1;35mDefaultHandler[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m, new [0m     [2m                [0m
[2;36m                    [0m         [1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                success = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                if [0m[1;39m([0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m != null && [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m instanceof [0m            [2m                [0m
[2;36m                    [0m         [39mRuntimeException[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                    [0m[35m/[0m[35m/[0m[95mhandleThrowable[0m[1;39m([0m[39mtarget, [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                    success = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                    success = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                success = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mThrowable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mhandleThrowable[0m[1;39m([0m[39mtarget, t[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                if [0m[1;39m([0m[39msuccess[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;35mFiles.delete[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"couldn't delete: "[0m[39m + [0m                         [2m                [0m
[2;36m                    [0m         [1;35mtarget.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"FOUND PROBLEM: "[0m[39m + target[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:            return success ? [0m[1;36m1[0m[39m : [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:147[0m[39m-[0m[1;36m154[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    private void [0m[1;35mwriteErrFile[0m[1;39m([0m[39mPath target, String ext[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            Path err = [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m + ext[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;35mFiles.write[0m[1;39m([0m[39merr, new byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"things aren't going right today."[0m[39m, e[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:185[0m[39m-[0m[1;36m197[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        static FuzzOneConfig [0m[1;35mparse[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws ParseException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            CommandLineParser parser = new [0m[1;35mDefaultParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            CommandLine commandLine = [0m[1;35mparser.parse[0m[1;39m([0m[1;33mOPTIONS[0m[39m, args[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            FuzzOneConfig config = new [0m[1;35mFuzzOneConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:            config.inputFile = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"i"[0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:            config.outputFileBase = [0m[1;35mPaths.get[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"o"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:            config.perFileIterations = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:            config.maxTransformers = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"t"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            config.threadNum = [0m                                                 [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"n"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            config.retryNum = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"r"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            config.timeoutMs = [0m                                                 [2m                [0m
[2;36m                    [0m         [1;35mInteger.parseInt[0m[1;39m([0m[1;35mcommandLine.getOptionValue[0m[1;39m([0m[32m"m"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            return config;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/AutoDetectTransformer.jav[0m[1;92ma:67[0m[39m-[0m[1;36m75[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[35m/[0m[35m/[0m[39m Automatically detect the MIME type of the document[0m                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            MediaType type = [0m[1;35mdetector.detect[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            Transformer transformer = [0m[1;35mgetTransformer[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;35mtransformer.transform[0m[1;39m([0m[39mtis, os[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/AutoDetectTransformer.jav[0m[1;92ma:77[0m[39m-[0m[1;36m96[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private Transformer [0m[1;35mgetTransformer[0m[1;39m([0m[39mMediaType type[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39mtype == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            return fallback;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[35m/[0m[39m We always work on the normalised, canonical form[0m                      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        type = [0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        while [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try finding a parser for the type[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            Transformer transformer = [0m[1;35mtransformerMap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            if [0m[1;39m([0m[39mtransformer != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                return transformer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[35m/[0m[35m/[0m[39m Failing that, try for the parent of the type[0m                      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            type = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        return fallback;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/pdf/PDFTransformer.jav[0m[1;92ma:45[0m[39m-[0m[1;36m51[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        try [0m[1;39m([0m[39mPDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[39mnew [0m                         [2m                [0m
[2;36m                    [0m         [1;35mRandomAccessReadBuffer[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[35m/[0m[35m/[0m[95msome[0m[39m docs have security which prevents mods and writing[0m            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[35m/[0m[35m/[0m[95mgiven[0m[39m our purposes here, we should remove security[0m                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;35mpdDocument.setAllSecurityToBeRemoved[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m([0m[39mEvilCOSWriter cosWriter = new [0m[1;35mEvilCOSWriter[0m[1;39m([0m[39mos, config[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:74[0m[39m-[0m[1;36m84[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"timeout in ms -- max time allowed to parse a [0m             [2m                [0m
[2;36m                    [0m         [32mfile"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"n"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"thread id [0m[32m([0m[32mthread [0m                     [2m                [0m
[2;36m                    [0m         [32mnumber[0m[32m)[0m[32m"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                        [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"perFile"[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"number of iterations to run per seed [0m                     [2m                [0m
[2;36m                    [0m         [32mfile"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"t"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"maxTransformers"[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"maximum number of transformers to run per [0m                [2m                [0m
[2;36m                    [0m         [32miteration"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"r"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"retryId"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"which retry is [0m     [2m                [0m
[2;36m                    [0m         [32mthis"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                        [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Problem Diagnosis  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The libFuzzer ‚Äútimeout‚Äù error is a by-product of our fuzz harness forcibly [0m    [2m                [0m
[2;36m                    [0m         [39mexiting [0m[1;39m([0m[39mvia [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m whenever a single input‚Äôs parse exceeds the per-input [0m [2m                [0m
[2;36m                    [0m         [39mtimeout. Under adversarial or malformed inputs‚Äîespecially PDFs‚Äîthe [0m                 [2m                [0m
[2;36m                    [0m         [39mPDDocument.loadPDF + EvilCOSWriter write path can take arbitrarily long [0m[1;39m([0m[39mor even [0m   [2m                [0m
[2;36m                    [0m         [39mblock[0m[1;39m)[0m[39m, triggering the harness‚Äô TimeoutException. That kills the JVM, which [0m        [2m                [0m
[2;36m                    [0m         [39mlibFuzzer reports as a timeout rather than a code crash.  [0m                          [2m                [0m
[2;36m                    [0m         [39m   - We must preserve the harness [0m[1;39m([0m[39mFuzzOne.java[0m[1;39m)[0m[39m unchanged, per project policy, but[0m [2m                [0m
[2;36m                    [0m         [39mreduce or eliminate pathological hangs inside the code under test [0m[1;39m([0m[39mthe Transformers[0m [2m                [0m
[2;36m                    [0m         [39mand parsers[0m[1;39m)[0m[39m so that no single input can tie up the harness thread past the [0m        [2m                [0m
[2;36m                    [0m         [39mtimeoutMs.  [0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Root Cause  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - PDFTransformer [0m[1;39m([0m[39mand, to a lesser extent, other Transformers[0m[1;39m)[0m[39m invoke [0m           [2m                [0m
[2;36m                    [0m         [39mheavy-weight, potentially unbounded operations [0m[1;39m([0m[39mloading a full PDDocument into [0m     [2m                [0m
[2;36m                    [0m         [39mmemory, rewriting with EvilCOSWriter[0m[1;39m)[0m[39m on arbitrarily corrupt or adversarial inputs.[0m [2m                [0m
[2;36m                    [0m         [39m   - These calls can exceed the harness‚Äô per-input timeout [0m[1;39m([0m[39mand even libFuzzer‚Äôs [0m   [2m                [0m
[2;36m                    [0m         [39moverall run timeout[0m[1;39m)[0m[39m, causing the harness to [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m.  [0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Critical Invariants to Preserve  [0m                                                [2m                [0m
[2;36m                    [0m         [39m   - All file types must still go through AutoDetectTransformer ‚Üí specific [0m         [2m                [0m
[2;36m                    [0m         [39mTransformer logic, so we do not disable parsing or remove functionality.  [0m          [2m                [0m
[2;36m                    [0m         [39m   - We must not alter FuzzOne.java, fuzz harness, or any test code.  [0m              [2m                [0m
[2;36m                    [0m         [39m   - Existing command-line options [0m[1;39m([0m[39mincluding timeoutMs, maxTransformers, etc.[0m[1;39m)[0m[39m and[0m [2m                [0m
[2;36m                    [0m         [39mtheir semantics must remain unchanged.  [0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Strategy Overview  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m   A. Introduce time-bounded wrappers inside heavy Transformer implementations [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mparticularly PDFTransformer[0m[1;39m)[0m[39m so that no single transform or write can block [0m       [2m                [0m
[2;36m                    [0m         [39mindefinitely.  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   B. If a transform step hits its internal timeout, promptly abort that transform,[0m [2m                [0m
[2;36m                    [0m         [39mthrow a controlled TikaException, and allow the harness to continue to parsing [0m[1;39m([0m[39mor [0m [2m                [0m
[2;36m                    [0m         [39mto skip that input[0m[1;39m)[0m[39m, rather than hanging.  [0m                                         [2m                [0m
[2;36m                    [0m         [39m   C. Tune the internal timeout to a fraction of the harness‚Äô overall timeoutMs [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mfor example, [0m[1;36m80[0m[39m%[0m[1;39m)[0m[39m, ensuring that transform+parse always completes within harness‚Äô [0m [2m                [0m
[2;36m                    [0m         [39mbudget.  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   D. Keep all changes local to the tika-fuzzing transformers and the main Tika [0m    [2m                [0m
[2;36m                    [0m         [39mcode [0m[1;39m([0m[39m‚Äúsrc/main/java/org/apache/tika/‚Ä¶‚Äù[0m[1;39m)[0m[39m, avoiding any modifications to harness or [0m [2m                [0m
[2;36m                    [0m         [39mtest files.  [0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Detailed Steps  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m1[0m[39m. In AutoDetectTransformer [0m[1;39m([0m[39mor in a new base class `TimeoutTransformer` that [0m   [2m                [0m
[2;36m                    [0m         [39mwraps any `Transformer`[0m[1;39m)[0m[39m:  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m      a. Introduce a new constructor argument or system-property‚Äìdriven parameter [0m  [2m                [0m
[2;36m                    [0m         [39m`transformTimeoutMs`. Default to [0m[1;39m([0m[39mtimeoutMs * [0m[1;36m0.8[0m[1;39m)[0m[39m if a property [0m                   [2m                [0m
[2;36m                    [0m         [39m`fuzz.transformTimeoutMs` exists; otherwise, use a conservative default [0m[1;39m([0m[39me.g., [0m[1;36m500[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mms[0m[1;39m)[0m[39m.  [0m                                                                              [2m                [0m
[2;36m                    [0m         [39m      b. Change `[0m[1;35mAutoDetectTransformer.transform[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` to delegate to a helper [0m     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mrunWithTimeout[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;35mactualTransformer.transform[0m[1;39m([0m[39mis, os[0m[1;39m)[0m[39m, transformTimeoutMs[0m[1;39m)[0m[39m`.  [0m  [2m                [0m
[2;36m                    [0m         [39m      c. `runWithTimeout` uses a single-threaded `ExecutorService` to submit the [0m   [2m                [0m
[2;36m                    [0m         [39mRunnable/Callable, calls `[0m[1;35mfuture.get[0m[1;39m([0m[39mtransformTimeoutMs, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m`, [0m  [2m                [0m
[2;36m                    [0m         [39mcatches `TimeoutException`, cancels the future, and then throws a new, controlled [0m  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mTikaException[0m[1;39m([0m[32m"Transformer timed out after X ms"[0m[1;39m)[0m[39m`.  [0m                              [2m                [0m
[2;36m                    [0m         [39m      d. By catching `TimeoutException` inside the Transformer, we ensure [0m          [2m                [0m
[2;36m                    [0m         [39m`transformFile` in the harness sees a `TikaException` [0m[1;39m([0m[39mnot an unbounded hanging [0m    [2m                [0m
[2;36m                    [0m         [39mtransform[0m[1;39m)[0m[39m, cleans up the temporary target, then continues to the parse step or [0m    [2m                [0m
[2;36m                    [0m         [39mrethrows.  [0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m2[0m[39m. Adapt PDFTransformer.java to respect this wrapper [0m[1;39m([0m[39mno direct changes to its [0m  [2m                [0m
[2;36m                    [0m         [39mload/write logic, only the wrapper around it[0m[1;39m)[0m[39m:  [0m                                    [2m                [0m
[2;36m                    [0m         [39m      a. Declare `public class PDFTransformer extends TimeoutTransformer` [0m[1;39m([0m[39mor have [0m [2m                [0m
[2;36m                    [0m         [39mPDFTransformer delegate to the TimeoutTransformer helper[0m[1;39m)[0m[39m.  [0m                        [2m                [0m
[2;36m                    [0m         [39m      b. Remove or minimize any calls that could bypass the timeout guard [0m[1;39m([0m[39me.g., [0m   [2m                [0m
[2;36m                    [0m         [39mavoid direct calls to `Loader.loadPDF` outside the `runWithTimeout` block[0m[1;39m)[0m[39m.  [0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m3[0m[39m. Configuration & Defaults  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m      a. Expose `transformTimeoutMs` as a system property [0m[1;39m([0m[39me.g., [0m                   [2m                [0m
[2;36m                    [0m         [39m`-Dfuzz.[0m[33mtransformTimeoutMs[0m[39m=[0m[1;36m2000[0m[39m`[0m[1;39m)[0m[39m, so end-users can align it with harness‚Äô [0m         [2m                [0m
[2;36m                    [0m         [39m`timeoutMs [0m[1;39m([0m[39m-m[0m[1;39m)[0m[39m`.  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m      b. In the absence of the property, default to a small constant [0m[1;39m([0m[39me.g., `[0m[1;36m1000[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39mms`[0m[1;39m)[0m[39m to avoid pathological hangs even if the harness timeout is large.  [0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;36m4[0m[39m. Testing & Verification  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m      a. Write unit tests for the new `TimeoutTransformer` utility, simulating a [0m   [2m                [0m
[2;36m                    [0m         [39mslow or stuck transform [0m[1;39m([0m[39me.g., a Transformer that sleeps 5s[0m[1;39m)[0m[39m and verifying we get a[0m [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mTikaException[0m[1;39m([0m[32m"Transformer timed out‚Ä¶"[0m[1;39m)[0m[39m` within ~1s.  [0m                             [2m                [0m
[2;36m                    [0m         [39m      b. Run the fuzz target with the new code on known ‚Äúhang‚Äù inputs [0m[1;39m([0m[39me.g., [0m       [2m                [0m
[2;36m                    [0m         [39mcrafted PDFs from previous sig-segv corpora[0m[1;39m)[0m[39m and confirm no per-input hangs occur, [0m [2m                [0m
[2;36m                    [0m         [39mand that libFuzzer no longer reports ‚ÄúERROR: libFuzzer: timeout.‚Äù  [0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Why This Works & preserves Invariants  [0m                                          [2m                [0m
[2;36m                    [0m         [39m   - By bounding the execution time of each transform step, we prevent a single [0m    [2m                [0m
[2;36m                    [0m         [39minput from monopolizing the harness thread beyond the configured window.  [0m          [2m                [0m
[2;36m                    [0m         [39m   - All existing Transform logic is untouched‚Äîonly wrapped in a timeout guard‚Äîso [0m  [2m                [0m
[2;36m                    [0m         [39mwe preserve full coverage of code paths and maintain existing functionality.  [0m      [2m                [0m
[2;36m                    [0m         [39m   - We avoid any direct changes to harness code, external libraries, or test [0m      [2m                [0m
[2;36m                    [0m         [39msuites, abiding by project policy.  [0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. Potential Side Effects & Mitigations  [0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Very heavy, yet valid inputs that legitimately require more than the default [0m  [2m                [0m
[2;36m                    [0m         [39m`transformTimeoutMs` may now throw spurious timeouts.  [0m                             [2m                [0m
[2;36m                    [0m         [39m     *Mitigation:* Users can tune `-Dfuzz.transformTimeoutMs` to match `-m` or [0m     [2m                [0m
[2;36m                    [0m         [39mtheir performance environment.  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - The additional `ExecutorService` overhead per transform adds minor GC/CPU [0m     [2m                [0m
[2;36m                    [0m         [39mcosts.  [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     *Mitigation:* Use a cached thread pool or reuse a single thread in a [0m          [2m                [0m
[2;36m                    [0m         [39m`ThreadLocal` to minimize churn.  [0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. References  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - Similar ‚Äútimeout wrapper‚Äù logic appears in Tika‚Äôs external parsers for [0m        [2m                [0m
[2;36m                    [0m         [39mlong-running XML transforms, where they guard `[0m[1;35mTransformer.transform[0m[1;39m([0m[1;39m)[0m[39m` calls in a [0m [2m                [0m
[2;36m                    [0m         [39mtimed executor.  [0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 22:19:02][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=91421;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=589205;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 22:21:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=471592;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=509572;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[12/29/25 22:23:23][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=968376;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=774779;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=284742;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=281388;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         The patch did not apply, here are some possible reasons:                            [2m                [0m
[2;36m                    [0m         - Trying to patch a file that does not exist in the repository.                     [2m                [0m
[2;36m                    [0m         - Trying to patch fuzzer or harness related file. [1m([0mThese files are used to test the [2m                [0m
[2;36m                    [0m         validity of the patch.[1m)[0m                                                             [2m                [0m
[2;36m                    [0m         - Incorrect patch format. [1m([0mFocus on the patch formatting instructions.[1m)[0m             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m         The project‚Äôs continuous fuzz testing run reported a libFuzzer timeout error. A     [2m                [0m
[2;36m                    [0m         patch was submitted but the `[1m<[0m[1;95mpatch_attempt[0m[39m>` section is empty, so no actual [0m       [2m                [0m
[2;36m                    [0m         [39mchanges were provided. When applying the [0m[1;39m([0m[39mempty or malformed[0m[1;39m)[0m[39m patch, the tooling [0m   [2m                [0m
[2;36m                    [0m         [39mproduced an error stating the patch did not apply. The diagnostic output cited [0m     [2m                [0m
[2;36m                    [0m         [39mthree possible root causes:  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m- The target file does not exist in the repository.  [0m                               [2m                [0m
[2;36m                    [0m         [39m- The target is a fuzzer or harness file [0m[1;39m([0m[39mwhich the system refuses to patch [0m        [2m                [0m
[2;36m                    [0m         [39mautomatically[0m[1;39m)[0m[39m.  [0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- The patch is in an incorrect format, not following the required diff conventions.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInitial issue  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- During an automated fuzzing session, libFuzzer terminated with a ‚Äútimeout‚Äù error.[0m [2m                [0m
[2;36m                    [0m         [39m- This indicates the fuzzer did not complete its run within the allotted time [0m      [2m                [0m
[2;36m                    [0m         [39mbudget.  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- The log snippet contains only the line `ERROR: libFuzzer: timeout`, with no [0m      [2m                [0m
[2;36m                    [0m         [39madditional stack trace or contextual messages.  [0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKey observations  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- The fuzzing harness merely invokes code under test and is unlikely to be the root[0m [2m                [0m
[2;36m                    [0m         [39mcause‚Äîits role is to provide input data and drive execution.  [0m                      [2m                [0m
[2;36m                    [0m         [39m- The timeout suggests either particularly expensive code paths under test or [0m      [2m                [0m
[2;36m                    [0m         [39mmisconfiguration of the fuzzing/runtime environment.  [0m                              [2m                [0m
[2;36m                    [0m         [39m- No further runtime or build logs were captured in the issue report.  [0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPatch attempt and application log  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m- The submitted patch body was empty [0m[1;39m([0m[39m`<patch_attempt>` contained no diff[0m[1;39m)[0m[39m.  [0m       [2m                [0m
[2;36m                    [0m         [39m- The patch application step reported failure with generic hints:  [0m                 [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. ‚ÄúTrying to patch a file that does not exist in the repository.‚Äù  [0m              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. ‚ÄúTrying to patch fuzzer or harness related file.‚Äù  [0m                            [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. ‚ÄúIncorrect patch format.‚Äù  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m- No unified diff header or hunk was present, so the patch tool could not match any[0m [2m                [0m
[2;36m                    [0m         [39mfile paths or content.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m- Because the patch file lacks a valid diff header [0m[1;39m([0m[39m`--- a/[0m[33m...[0m[39m` [0m[35m/[0m[39m `+++ b/[0m[33m...[0m[39m`[0m[1;39m)[0m[39m, the[0m [2m                [0m
[2;36m                    [0m         [39mformatter check also failed.  [0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAreas for further investigation  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Verify the exact file paths and names targeted by the intended patch. Ensure the [0m [2m                [0m
[2;36m                    [0m         [39mfiles exist in the repository at the correct relative paths.  [0m                      [2m                [0m
[2;36m                    [0m         [39m- Review the fuzzing harness code and its build rules to confirm it is not [0m         [2m                [0m
[2;36m                    [0m         [39minadvertently excluded from patching or modified by CI scripts.  [0m                   [2m                [0m
[2;36m                    [0m         [39m- Examine build and fuzzing configuration [0m[1;39m([0m[39mtimeout settings, resource limits[0m[1;39m)[0m[39m to [0m   [2m                [0m
[2;36m                    [0m         [39munderstand whether the timeout is caused by environmental constraints.  [0m            [2m                [0m
[2;36m                    [0m         [39m- Identify the modules or functions being exercised by the fuzzer; these are the [0m   [2m                [0m
[2;36m                    [0m         [39mlikely hotspots for performance or infinite‚Äêloop conditions leading to timeout.  [0m   [2m                [0m
[2;36m                    [0m         [39m- Check the patch formatting guidelines [0m[1;39m([0m[39munified diff syntax, correct line offsets,[0m [2m                [0m
[2;36m                    [0m         [39mcontext lines[0m[1;39m)[0m[39m to produce a syntactically valid diff for submission.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe patch did not apply, here are some possible reasons:[0m                            [2m                [0m
[2;36m                    [0m         [39m- Trying to patch a file that does not exist in the repository.[0m                     [2m                [0m
[2;36m                    [0m         [39m- Trying to patch fuzzer or harness related file. [0m[1;39m([0m[39mThese files are used to test the[0m [2m                [0m
[2;36m                    [0m         [39mvalidity of the patch.[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- Incorrect patch format. [0m[1;39m([0m[39mFocus on the patch formatting instructions.[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:1[0m[39m-[0m[1;36m20[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing.cli;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/pom.xml:[0m[1;36m1[0m[39m-[0m[1;36m136[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:<?xml [0m[33mversion[0m[39m=[0m[32m"1[0m[32m.0"[0m[39m [0m[33mencoding[0m[39m=[0m[32m"UTF[0m[32m-8"[0m[39m?>[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:<!--[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:  Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:  or more contributor license agreements.  See the NOTICE file[0m                    [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:  distributed with this work for additional information[0m                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:  regarding copyright ownership.  The ASF licenses this file[0m                      [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:  to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                               [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:  [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:  with the License.  You may obtain a copy of the License at[0m                      [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:    [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:  Unless required by applicable law or agreed to in writing,[0m                     [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:  software distributed under the License is distributed on an[0m                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:  [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                         [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:  KIND, either express or implied.  See the License for the[0m                      [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:  specific language governing permissions and limitations[0m                        [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  under the License.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:-->[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:<project [0m[33mxmlns[0m[39m=[0m[32m"http[0m[32m://maven.apache.org/POM/4.0.0"[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [39mxmlns:[0m[33mxsi[0m[39m=[0m[32m"http[0m[32m://www.w3.org/2001/XMLSchema-instance"[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [39mxsi:[0m[33mschemaLocation[0m[39m=[0m[32m"http[0m[32m://maven.apache.org/POM/4.0.0 [0m                              [2m                [0m
[2;36m                    [0m         [32mhttps://maven.apache.org/xsd/maven-4.0.0.xsd"[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  <parent>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:    <artifactId>tika-parent<[0m[35m/[0m[95martifactId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:    <version>[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT<[0m[35m/[0m[95mversion[0m[39m>[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:    <relativePath>..[0m[35m/tika-parent/[0m[95mpom.xml[0m[39m<[0m[35m/[0m[95mrelativePath[0m[39m>[0m                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:  <[0m[35m/[0m[95mparent[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  <artifactId>tika-fuzzing<[0m[35m/[0m[95martifactId[0m[39m>[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  <name>Apache Tika fuzzing<[0m[35m/[0m[95mname[0m[39m>[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:  <url>[0m[4;94mhttps://tika.apache.org/[0m[39m<[0m[35m/[0m[95murl[0m[39m>[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  <modelVersion>[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m<[0m[35m/[0m[95mmodelVersion[0m[39m>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:  <dependencies>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:      <groupId>$[0m[1;39m{[0m[39mproject.groupId[0m[1;39m}[0m[39m<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:      <artifactId>tika-core<[0m[35m/[0m[95martifactId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:      <scope>provided<[0m[35m/[0m[95mscope[0m[39m>[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:      <groupId>$[0m[1;39m{[0m[39mproject.groupId[0m[1;39m}[0m[39m<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:      <artifactId>tika-serialization<[0m[35m/[0m[95martifactId[0m[39m>[0m                                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:      <groupId>$[0m[1;39m{[0m[39mproject.groupId[0m[1;39m}[0m[39m<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:      <artifactId>tika-emitter-fs<[0m[35m/[0m[95martifactId[0m[39m>[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:      <groupId>commons-cli<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:      <artifactId>commons-cli<[0m[35m/[0m[95martifactId[0m[39m>[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:      <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:      <artifactId>tika-parser-pkg-module<[0m[35m/[0m[95martifactId[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:      <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:      <artifactId>tika-parser-pdf-module<[0m[35m/[0m[95martifactId[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    <!-- logging -->[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:      <groupId>org.apache.logging.log4j<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:      <artifactId>log4j-slf4j2-impl<[0m[35m/[0m[95martifactId[0m[39m>[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:      <groupId>org.slf4j<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:      <artifactId>jcl-over-slf4j<[0m[35m/[0m[95martifactId[0m[39m>[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    <!-- test -->[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:      <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:      <artifactId>tika-parser-digest-commons<[0m[35m/[0m[95martifactId[0m[39m>[0m                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    <!-- bring in the mock parser -->[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:      <groupId>$[0m[1;39m{[0m[39mproject.groupId[0m[1;39m}[0m[39m<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:      <artifactId>tika-core<[0m[35m/[0m[95martifactId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:      <version>$[0m[1;39m{[0m[39mproject.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:      <type>test-jar<[0m[35m/[0m[95mtype[0m[39m>[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:      <scope>test<[0m[35m/[0m[95mscope[0m[39m>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:  <[0m[35m/[0m[95mdependencies[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  <build>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    <plugins>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:      <plugin>[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        <groupId>org.apache.maven.plugins<[0m[35m/[0m[95mgroupId[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        <artifactId>maven-checkstyle-plugin<[0m[35m/[0m[95martifactId[0m[39m>[0m                         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        <version>$[0m[1;39m{[0m[39mcheckstyle.plugin.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        <dependencies>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:          <dependency>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            <groupId>com.puppycrawl.tools<[0m[35m/[0m[95mgroupId[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            <artifactId>checkstyle<[0m[35m/[0m[95martifactId[0m[39m>[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            <version>$[0m[1;39m{[0m[39mpuppycrawl.version[0m[1;39m}[0m[39m<[0m[35m/[0m[95mversion[0m[39m>[0m                            [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:          <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        <[0m[35m/[0m[95mdependencies[0m[39m>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        <executions>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:          <execution>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            <id>validate<[0m[35m/[0m[95mid[0m[39m>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            <phase>validate<[0m[35m/[0m[95mphase[0m[39m>[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            <configuration>[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:              <configLocation>checkstyle.xml<[0m[35m/[0m[95mconfigLocation[0m[39m>[0m                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:              <inputEncoding>UTF-[0m[1;36m8[0m[39m<[0m[35m/[0m[95minputEncoding[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:              <consoleOutput>false<[0m[35m/[0m[95mconsoleOutput[0m[39m>[0m                              [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:              <includeTestSourceDirectory>true<[0m[35m/[0m[95mincludeTestSourceDirectory[0m[39m>[0m     [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:              [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m<testSourceDirectories>$[0m[1;39m{[0m[39mproject.basedir[0m[1;39m}[0m[35m/src/test/[0m[95mjava[0m[39m<[0m[35m/[0m[95mtestSourceDirectories[0m[39m>[0m     [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:              <violationSeverity>error<[0m[35m/[0m[95mviolationSeverity[0m[39m>[0m                      [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:              <failOnViolation>true<[0m[35m/[0m[95mfailOnViolation[0m[39m>[0m                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            <[0m[35m/[0m[95mconfiguration[0m[39m>[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            <goals>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:              <goal>check<[0m[35m/[0m[95mgoal[0m[39m>[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:            <[0m[35m/[0m[95mgoals[0m[39m>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:          <[0m[35m/[0m[95mexecution[0m[39m>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        <[0m[35m/[0m[95mexecutions[0m[39m>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:      <[0m[35m/[0m[95mplugin[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:      <plugin>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        <groupId>org.apache.maven.plugins<[0m[35m/[0m[95mgroupId[0m[39m>[0m                             [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        <artifactId>maven-jar-plugin<[0m[35m/[0m[95martifactId[0m[39m>[0m                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        <configuration>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:          <archive>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            <manifestEntries>[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:              [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m<Automatic-Module-Name>org.apache.tika.fuzzing<[0m[35m/[0m[95mAutomatic-Module-Name[0m[39m>[0m              [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            <[0m[35m/[0m[95mmanifestEntries[0m[39m>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:          <[0m[35m/[0m[95marchive[0m[39m>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:        <[0m[35m/[0m[95mconfiguration[0m[39m>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:      <[0m[35m/[0m[95mplugin[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    <[0m[35m/[0m[95mplugins[0m[39m>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  <[0m[35m/[0m[95mbuild[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:<[0m[35m/[0m[95mproject[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzingCLI.jav[0m[1;92ma:1[0m[39m-[0m[1;36m200[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing.cli;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.UUID;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.concurrent.ArrayBlockingQueue;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.concurrent.Callable;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ExecutionException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.concurrent.ExecutorCompletionService;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.concurrent.ExecutorService;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.concurrent.Executors;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.concurrent.Future;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.concurrent.atomic.AtomicInteger;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.io.FileUtils;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.fuzzing.Transformer;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.fuzzing.general.ByteDeleter;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.fuzzing.general.ByteFlipper;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.fuzzing.general.ByteInjector;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.fuzzing.general.GeneralTransformer;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.fuzzing.general.SpanSwapper;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.fuzzing.general.Truncator;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.pipes.FetchEmitTuple;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.pipes.PipesConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.pipes.PipesParser;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.pipes.PipesResult;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.pipes.emitter.EmitKey;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.tika.pipes.fetcher.FetchKey;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.apache.tika.pipes.fetcher.FetcherManager;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.tika.pipes.pipesiterator.PipesIterator;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:public class FuzzingCLI [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final Logger LOG = [0m[1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mFuzzingCLI.class[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final String TEMP_FETCHER_NAME = [0m[32m"temp"[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    private static final String TEMP_EMITTER_NAME = [0m[32m"temp"[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        FuzzingCLIConfig config = [0m[1;35mFuzzingCLIConfig.parse[0m[1;39m([0m[39margs[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        if [0m[1;39m([0m[1;35mconfig.getMaxTransformers[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"max transformers == 0!"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        FuzzingCLI fuzzingCLI = new [0m[1;35mFuzzingCLI[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mFiles.createDirectories[0m[1;39m([0m[1;35mconfig.getProblemsDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;35mfuzzingCLI.execute[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private void [0m[1;35mexecute[0m[1;39m([0m[39mFuzzingCLIConfig config[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        ArrayBlockingQueue<FetchEmitTuple> q = new [0m[1;35mArrayBlockingQueue[0m[1;39m([0m[1;36m10000[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        PipesConfig pipesConfig = [0m[1;35mPipesConfig.load[0m[1;39m([0m[1;35mconfig.getTikaConfig[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        FetcherManager fetcherManager = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mFetcherManager.load[0m[1;39m([0m[1;35mconfig.getTikaConfig[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        int totalThreads = [0m[1;35mpipesConfig.getNumClients[0m[1;39m([0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        ExecutorService executorService = [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mExecutors.newFixedThreadPool[0m[1;39m([0m[39mtotalThreads[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        ExecutorCompletionService executorCompletionService =[0m                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                new [0m[1;35mExecutorCompletionService[0m[1;39m([0m[39mexecutorService[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        PipesIterator pipesIterator = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mPipesIterator.build[0m[1;39m([0m[1;35mconfig.getTikaConfig[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        FileAdder fileAdder = new [0m[1;35mFileAdder[0m[1;39m([0m[39mpipesIterator, q[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35mexecutorCompletionService.submit[0m[1;39m([0m[39mfileAdder[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        try [0m[1;39m([0m[39mPipesParser parser = new [0m[1;35mPipesParser[0m[1;39m([0m[39mpipesConfig[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mpipesConfig.getNumClients[0m[1;39m([0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:                [0m[1;35mexecutorCompletionService.submit[0m[1;39m([0m[39mnew [0m[1;35mFuzzer[0m[1;39m([0m[39mq, config, parser, [0m  [2m                [0m
[2;36m                    [0m         [39mfetcherManager[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            int finished = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            while [0m[1;39m([0m[39mfinished < totalThreads[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:                Future<Integer> future = null;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:                try [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                    future = [0m[1;35mexecutorCompletionService.poll[0m[1;39m([0m[1;36m1[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [39mTimeUnit.SECONDS[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                    if [0m[1;39m([0m[39mfuture != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                        [0m[1;35mfuture.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                        finished++;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"Finished thread [0m[32m{[0m[32m}[0m[32m threads of [0m[32m{[0m[32m}[0m[32m"[0m[39m, finished, [0m     [2m                [0m
[2;36m                    [0m         [39mtotalThreads[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException | ExecutionException e[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                    [0m[1;35me.printStackTrace[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mexecutorService.shutdown[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mexecutorService.shutdownNow[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    private static class Fuzzer implements Callable<Integer> [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        static AtomicInteger COUNTER = new [0m[1;35mAtomicInteger[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        static AtomicInteger FUZZED = new [0m[1;35mAtomicInteger[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:        static AtomicInteger SOURCE_FILES = new [0m[1;35mAtomicInteger[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        private final int threadId = [0m[1;35mCOUNTER.getAndIncrement[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        private final ArrayBlockingQueue<FetchEmitTuple> q;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        private final FuzzingCLIConfig config;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        private final PipesParser pipesParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        private final Transformer transformer;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        private final FetcherManager fetcherManager;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        public [0m[1;35mFuzzer[0m[1;39m([0m[39mArrayBlockingQueue<FetchEmitTuple> q, FuzzingCLIConfig [0m   [2m                [0m
[2;36m                    [0m         [39mconfig,[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                      PipesParser pipesParser, FetcherManager fetcherManager[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            this.q = q;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:            this.config = config;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            this.pipesParser = pipesParser;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[35m/[0m[35m/[0m[95mTODO[0m[39m - parameterize this[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            this.transformer =[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                    new [0m[1;35mGeneralTransformer[0m[1;39m([0m[1;35mconfig.getMaxTransformers[0m[1;39m([0m[1;39m)[0m[39m, new [0m    [2m                [0m
[2;36m                    [0m         [1;35mByteDeleter[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                            new [0m[1;35mByteFlipper[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mByteInjector[0m[1;39m([0m[1;39m)[0m[39m, new [0m         [2m                [0m
[2;36m                    [0m         [1;35mTruncator[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                            new [0m[1;35mSpanSwapper[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            this.fetcherManager = fetcherManager;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:        public Integer [0m[1;35mcall[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                FetchEmitTuple fetchEmitTuple = [0m[1;35mq.take[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                if [0m[1;39m([0m[1;35mfetchEmitTuple.equals[0m[1;39m([0m[39mPipesIterator.COMPLETED_SEMAPHORE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                    [0m[1;35mLOG.debug[0m[1;39m([0m[32m"Thread "[0m[39m + threadId + [0m[32m" stopping"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                    [0m[1;35mq.put[0m[1;39m([0m[39mPipesIterator.COMPLETED_SEMAPHORE[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                    return [0m[1;36m1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                int inputFiles = [0m[1;35mSOURCE_FILES.getAndIncrement[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                if [0m[1;39m([0m[39minputFiles % [0m[1;36m100[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"Processed [0m[32m{[0m[32m}[0m[32m source files"[0m[39m, inputFiles[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < config.perFileIterations; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                        [0m[1;35mfuzzIt[0m[1;39m([0m[39mfetchEmitTuple[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                        throw e;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"serious problem with"[0m[39m, e[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        private void [0m[1;35mfuzzIt[0m[1;39m([0m[39mFetchEmitTuple fetchEmitTuple[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                throws IOException, InterruptedException, TikaException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            Path cwd = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[32m"tika-fuzz-"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:                Path fuzzedPath = [0m[1;35mfuzz[0m[1;39m([0m[39mfetchEmitTuple, cwd[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                Path extract = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[39mcwd, [0m[32m"tika-extract-"[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [32m".json"[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                FetchEmitTuple fuzzedTuple = new [0m                               [2m                [0m
[2;36m                    [0m         [1;35mFetchEmitTuple[0m[1;39m([0m[1;35mfetchEmitTuple.getId[0m[1;39m([0m[1;39m)[0m[39m,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                        new [0m[1;35mFetchKey[0m[1;39m([0m[39mTEMP_FETCHER_NAME, [0m                        [2m                [0m
[2;36m                    [0m         [1;35mfuzzedPath.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m,[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:                        new [0m[1;35mEmitKey[0m[1;39m([0m[39mTEMP_EMITTER_NAME, [0m                         [2m                [0m
[2;36m                    [0m         [1;35mextract.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                int count = [0m[1;35mFUZZED.getAndIncrement[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:                if [0m[1;39m([0m[39mcount % [0m[1;36m100[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"processed [0m[32m{[0m[32m}[0m[32m fuzzed files"[0m[39m, count[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                boolean tryAgain = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                int tries = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:                while [0m[1;39m([0m[39mtryAgain && tries < [0m[1;35mconfig.getRetries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:                    tries++;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:                        PipesResult result = [0m[1;35mpipesParser.parse[0m[1;39m([0m[39mfuzzedTuple[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                        tryAgain = [0m[1;35mhandleResult[0m[1;39m([0m[1;35mresult.getStatus[0m[1;39m([0m[1;39m)[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                                [0m[1;35mfetchEmitTuple.getFetchKey[0m[1;39m([0m[1;39m)[0m[1;35m.getFetchKey[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mfuzzedPath, tries,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                                [0m[1;35mconfig.getRetries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                        throw e;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                        tryAgain = [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mhandleResult[0m[1;39m([0m[39mPipesResult.STATUS.UNSPECIFIED_CRASH,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                                [0m[1;35mfetchEmitTuple.getFetchKey[0m[1;39m([0m[1;39m)[0m[1;35m.getFetchKey[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mfuzzedPath, tries,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:                                [0m[1;35mconfig.getRetries[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                try [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/AutoDetectTransformer.jav[0m[1;92ma:1[0m[39m-[0m[1;36m96[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.config.ServiceLoader;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.config.TikaConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.detect.Detector;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.fuzzing.general.GeneralTransformer;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.mime.MediaTypeRegistry;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class AutoDetectTransformer implements Transformer [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final ServiceLoader DEFAULT_LOADER =[0m                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:            new [0m[1;35mServiceLoader[0m[1;39m([0m[1;35mAutoDetectTransformer.class.getClassLoader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    TikaConfig config = [0m[1;35mTikaConfig.getDefaultConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    MediaTypeRegistry registry = [0m[1;35mconfig.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    Detector detector = [0m[1;35mTikaConfig.getDefaultConfig[0m[1;39m([0m[1;39m)[0m[1;35m.getDetector[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    Transformer fallback = new [0m[1;35mGeneralTransformer[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    Map<MediaType, Transformer> transformerMap = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public [0m[1;35mAutoDetectTransformer[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mthis[0m[1;39m([0m[1;35mDEFAULT_LOADER.loadServiceProviders[0m[1;39m([0m[39morg.apache.tika.fuzzing.Transformer.class[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m)[0m[39m;[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    public [0m[1;35mAutoDetectTransformer[0m[1;39m([0m[39mList<Transformer> transformers[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        for [0m[1;39m([0m[39mTransformer t : transformers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            for [0m[1;39m([0m[39mMediaType mediaType : [0m[1;35mt.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                [0m[1;35mtransformerMap.put[0m[1;39m([0m[39mmediaType, t[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        return [0m[1;35mtransformerMap.keySet[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        try [0m[1;39m([0m[39mTikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            [0m[35m/[0m[35m/[0m[39m Automatically detect the MIME type of the document[0m                [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            Metadata metadata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            MediaType type = [0m[1;35mdetector.detect[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            Transformer transformer = [0m[1;35mgetTransformer[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            [0m[1;35mtransformer.transform[0m[1;39m([0m[39mtis, os[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private Transformer [0m[1;35mgetTransformer[0m[1;39m([0m[39mMediaType type[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39mtype == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            return fallback;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[35m/[0m[39m We always work on the normalised, canonical form[0m                      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        type = [0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        while [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try finding a parser for the type[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            Transformer transformer = [0m[1;35mtransformerMap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            if [0m[1;39m([0m[39mtransformer != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                return transformer;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[35m/[0m[35m/[0m[39m Failing that, try for the parent of the type[0m                      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            type = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        return fallback;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/pdf/PDFTransformer.jav[0m[1;92ma:1[0m[39m-[0m[1;36m62[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing.pdf;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.pdfbox.Loader;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.pdfbox.io.RandomAccessReadBuffer;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.pdfbox.pdmodel.encryption.InvalidPasswordException;[0m            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.fuzzing.Transformer;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.fuzzing.exceptions.CantFuzzException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:public class PDFTransformer implements Transformer [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final Set<MediaType> SUPPORTED_TYPES =[0m                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:            [0m[1;35mCollections.singleton[0m[1;39m([0m[1;35mMediaType.application[0m[1;39m([0m[32m"pdf"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    private PDFTransformerConfig config = new [0m[1;35mPDFTransformerConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return SUPPORTED_TYPES;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        try [0m[1;39m([0m[39mPDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[39mnew [0m                         [2m                [0m
[2;36m                    [0m         [1;35mRandomAccessReadBuffer[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[35m/[0m[35m/[0m[95msome[0m[39m docs have security which prevents mods and writing[0m            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[35m/[0m[35m/[0m[95mgiven[0m[39m our purposes here, we should remove security[0m                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;35mpdDocument.setAllSecurityToBeRemoved[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m([0m[39mEvilCOSWriter cosWriter = new [0m[1;35mEvilCOSWriter[0m[1;39m([0m[39mos, config[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mcosWriter.write[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInvalidPasswordException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            throw new [0m[1;35mCantFuzzException[0m[1;39m([0m[32m"encrypted doc"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    public void [0m[1;35msetConfig[0m[1;39m([0m[39mPDFTransformerConfig pdfTransformerConfig[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        this.config = pdfTransformerConfig;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:1[0m[39m-[0m[1;36m50[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.fuzzing.cli;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.concurrent.Callable;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.concurrent.ExecutionException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ExecutorService;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.concurrent.Executors;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.concurrent.Future;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.commons.cli.CommandLine;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.commons.cli.CommandLineParser;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.cli.DefaultParser;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.cli.Option;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.cli.Options;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.cli.ParseException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.fuzzing.AutoDetectTransformer;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.fuzzing.Transformer;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.fuzzing.exceptions.CantFuzzException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.AutoDetectParser;[0m                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.gitattributes:[0m[1;36m1[0m[39m-[0m[1;36m6[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:* [0m[33mtext[0m[39m=[0m[35mauto[0m[39m [0m[33meol[0m[39m=[0m[35mlf[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:tika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/resourc[0m [2m                [0m
[2;36m                    [0m         [39mes/test-documents/testEMLX.emlx [0m[33meol[0m[39m=[0m[35mlf[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:tika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/resourc[0m [2m                [0m
[2;36m                    [0m         [39mes/test-documents/testTXT.txt [0m[33meol[0m[39m=[0m[35mlf[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html[0m [2m                [0m
[2;36m                    [0m         [39m-module/src/test/resources/test-documents/testHTML.html [0m[33meol[0m[39m=[0m[35mlf[0m                      [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pkg-[0m [2m                [0m
[2;36m                    [0m         [39mmodule/src/test/resources/test-documents/testARofText.ar [0m[33meol[0m[39m=[0m[35mlf[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text[0m [2m                [0m
[2;36m                    [0m         [39m-module/src/test/resources/test-documents/testVCalendar.vcs [0m[33meol[0m[39m=[0m[35mlf[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mREADME.m[0m[1;92md:1[0m[39m-[0m[1;36m192[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:Welcome to Apache Tika  <[0m[4;94mhttps://tika.apache.org/[0m[39m>[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:=================================================[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m[1;39m[[0m[39m![0m[1;39m[[0m[39mlicense[0m[1;39m][0m[1;39m([0m[4;94mhttps://img.shields.io/github/license/apache/tika.svg?[0m[4;94mmaxAge[0m[4;94m=[0m[4;94m2592000[0m[4;94m)[0m [2m                [0m
[2;36m                    [0m         [1;39m][0m[1;39m([0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m[4;94m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:[0m[1;39m[[0m[39m![0m[1;39m[[0m[39mJenkins[0m[1;39m][0m[1;39m([0m[4;94mhttps://img.shields.io/jenkins/s/https/ci-builds.apache.org/job/Tika/[0m [2m                [0m
[2;36m                    [0m         [4;94mjob/tika-main-jdk17.svg?[0m[4;94mmaxAge[0m[4;94m=[0m[4;94m3600[0m[4;94m)[0m[1;39m][0m[1;39m([0m[4;94mhttps://ci-builds.apache.org/job/Tika/job/tik[0m [2m                [0m
[2;36m                    [0m         [4;94ma-main-jdk17/[0m[4;94m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m[1;39m[[0m[39m![0m[1;39m[[0m[39mJenkins [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mtests[0m[1;39m][0m[1;39m([0m[4;94mhttps://img.shields.io/jenkins/t/https/ci-builds.apache.org/job/Tika/job/tik[0m [2m                [0m
[2;36m                    [0m         [4;94ma-main-jdk17.svg?[0m[4;94mmaxAge[0m[4;94m=[0m[4;94m3600[0m[4;94m)[0m[1;39m][0m[1;39m([0m[4;94mhttps://ci-builds.apache.org/job/Tika/job/tika-main-[0m [2m                [0m
[2;36m                    [0m         [4;94mjdk17/lastBuild/testReport/[0m[4;94m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:[0m[1;39m[[0m[39m![0m[1;39m[[0m[39mMaven [0m                                                                         [2m                [0m
[2;36m                    [0m         [39mCentral[0m[1;39m][0m[1;39m([0m[4;94mhttps://img.shields.io/maven-central/v/org.apache.tika/tika.svg?[0m[4;94mmaxAge[0m[4;94m=[0m[4;94m864[0m [2m                [0m
[2;36m                    [0m         [4;94m00[0m[4;94m)[0m[1;39m][0m[1;39m([0m[4;94mhttp://search.maven.org/#search[0m[39m|ga|[0m[1;36m1[0m[39m|g%3A%22org.apache.tika%[0m[1;36m22[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m9:A[0m[39mpache [0m[1;35mTika[0m[1;39m([0m[39mTM[0m[1;39m)[0m[39m is a toolkit for detecting and extracting metadata and structured[0m [2m                [0m
[2;36m                    [0m         [39mtext content from various documents using existing parser libraries.[0m                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:Tika is a project of the [0m[1;39m[[0m[39mApache Software Foundation[0m[1;39m][0m[1;39m([0m[4;94mhttps://www.apache.org[0m[4;94m)[0m[4;94m.[0m   [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m13:A[0m[39mpache Tika, Tika, Apache, the Apache feather logo, and the Apache Tika project [0m [2m                [0m
[2;36m                    [0m         [39mlogo are trademarks of The Apache Software Foundation.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:Getting Started[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:===============[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:Pre-built binaries of Apache Tika standalone applications are available[0m          [2m                [0m
[2;36m                    [0m         [1;92m18:f[0m[39mrom [0m[4;94mhttps://tika.apache.org/download.html[0m[39m . Pre-built binaries of all the[0m       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:Tika jars can be fetched from Maven Central or your favourite Maven mirror.[0m      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:**Tika [0m[1;36m2.[0m[39mX and support for Java [0m[1;36m8[0m[39m is planned to reach End of Life [0m[1;39m([0m[39mEOL[0m[1;39m)[0m[39m in [0m      [2m                [0m
[2;36m                    [0m         [39mApril, [0m[1;36m2025[0m[39m. [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:See [0m[1;39m[[0m[39mTika Roadmap [0m[1;36m2.[0m[39mx, [0m[1;36m3.[0m[39mx and [0m                                                  [2m                [0m
[2;36m                    [0m         [39mbeyond[0m[1;39m][0m[1;39m([0m[4;94mhttps://cwiki.apache.org/confluence/display/TIKA/Tika+Roadmap+--+2.x%2C+3.x[0m [2m                [0m
[2;36m                    [0m         [4;94m+and+Beyond[0m[4;94m)[0m[4;94m.[0m[39m** [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:Tika is based on **Java [0m[1;36m17[0m[39m** and uses the [0m[1;39m[[0m[39mMaven [0m[1;36m3[0m[1;39m][0m[1;39m([0m[4;94mhttps://maven.apache.org[0m[4;94m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mbuild system. [0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:**N.B.** [0m[1;39m[[0m[39mDocker[0m[1;39m][0m[1;39m([0m[4;94mhttps://www.docker.com/products/personal[0m[4;94m)[0m[39m is used for tests in[0m [2m                [0m
[2;36m                    [0m         [39mtika-integration-tests.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;92m26:A[0m[39ms of Tika [0m[1;36m2.5[0m[39m.[0m[1;36m1[0m[39m, if Docker is not installed, those tests are skipped.  Docker [0m  [2m                [0m
[2;36m                    [0m         [39mis required for a successful[0m                                                        [2m                [0m
[2;36m                    [0m         [1;92m27:b[0m[39muild on earlier [0m[1;36m2.[0m[39mx versions.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:To build Tika from source, use the following command in the main directory:[0m      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    mvn clean install[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:The build consists of a number of components, including a standalone runnable [0m   [2m                [0m
[2;36m                    [0m         [39mjar that you can use to try out Tika features. You can run it like this:[0m            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    java -jar tika-app/target/tika-app-*.jar --help[0m                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:To build a specific project [0m[1;39m([0m[39mfor example, tika-server-standard[0m[1;39m)[0m[39m:[0m                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    mvn clean install -am -pl :tika-server-standard[0m                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:If the ossindex-maven-plugin is causing the build to fail because a dependency[0m   [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:has now been discovered to have a vulnerability:[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    mvn clean install -Dossindex.skip[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:Maven Dependencies[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:==================[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m52:A[0m[39mpache Tika provides *Bill of Material* [0m[1;39m([0m[39mBOM[0m[1;39m)[0m[39m artifact to align Tika module [0m     [2m                [0m
[2;36m                    [0m         [39mversions and simplify version management. [0m                                          [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:To avoid convergence errors in your own project, import this[0m                     [2m                [0m
[2;36m                    [0m         [1;92m54:b[0m[39mom or Tika's parent pom.xml in your dependency management section.[0m              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:If you use Apache Maven:[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:```xml[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:<project>[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:  <dependencyManagement>[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    <dependencies>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:      <dependency>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:       <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:       <artifactId>tika-bom<[0m[35m/[0m[95martifactId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:       <version>[0m[1;36m4.[0m[39mx.y<[0m[35m/[0m[95mversion[0m[39m>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:       <type>pom<[0m[35m/[0m[95mtype[0m[39m>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:       <scope>import<[0m[35m/[0m[95mscope[0m[39m>[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:      <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    <[0m[35m/[0m[95mdependencies[0m[39m>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:  <[0m[35m/[0m[95mdependencyManagement[0m[39m>[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:  <dependencies>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    <dependency>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:      <groupId>org.apache.tika<[0m[35m/[0m[95mgroupId[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:      <artifactId>tika-parsers-standard-package<[0m[35m/[0m[95martifactId[0m[39m>[0m                     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:      <!-- version not required since BOM included -->[0m                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    <[0m[35m/[0m[95mdependency[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:  <[0m[35m/[0m[95mdependencies[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:<[0m[35m/[0m[95mproject[0m[39m>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:```[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m82:F[0m[39mor Gradle:[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:```kotlin[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;92m85:de[0m[39mpendencies [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  [0m[1;35mimplementation[0m[1;39m([0m[1;35mplatform[0m[1;39m([0m[32m"org.apache.tika:tika-bom:4.x.y"[0m[1;39m)[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:  [0m[35m/[0m[35m/[0m[39m version not required since bom [0m[1;39m([0m[39mplatform in Gradle terms[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:  [0m[1;35mimplementation[0m[1;39m([0m[32m"org.apache.tika:tika-parsers-standard-package"[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:```[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:Migrating to [0m[1;36m4.[0m[39mx[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:================[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:TBD[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m97:C[0m[39montributing via Github[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:=======================[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:See the [0m[1;39m[[0m[39mpull request [0m                                                           [2m                [0m
[2;36m                    [0m         [39mtemplate[0m[1;39m][0m[1;39m([0m[4;94mhttps://github.com/apache/tika/blob/main/.github/pull_request_template.md[0m [2m                [0m
[2;36m                    [0m         [4;94m)[0m[4;94m.[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:**NOTE:** Please open pull requests against the `main` branch.  We locked [0m      [2m                [0m
[2;36m                    [0m         [39m`master` in September [0m[1;36m2020[0m[39m and no longer use it.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:## Thanks to all the people who have contributed[0m                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m[1;39m[[0m[39m![0m[1;39m[[0m[39mcontributors[0m[1;39m][0m[1;39m([0m[4;94mhttps://contributors-img.web.app/image?[0m[4;94mrepo[0m[4;94m=[0m[4;94mapache[0m[4;94m/tika[0m[4;94m)[0m[1;39m][0m[1;39m([0m[4;94mhttp[0m [2m                [0m
[2;36m                    [0m         [4;94ms://github.com/apache/tika/graphs/contributors[0m[4;94m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m107:B[0m[39muilding from a Specific Tag[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:============================[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:Let's assume that you want to build the [0m[1;36m3.0[0m[39m.[0m[1;36m1[0m[39m tag:[0m                              [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:```[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m111:0[0m[39m. Download and install hub.github.com[0m                                          [2m                [0m
[2;36m                    [0m         [1;92m112:1[0m[39m. git clone [0m[4;94mhttps://github.com/apache/tika.git[0m[39m [0m                                [2m                [0m
[2;36m                    [0m         [1;92m113:2[0m[39m. cd tika[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;92m114:3[0m[39m. git checkout [0m[1;36m3.0[0m[39m.[0m[1;36m1[0m                                                           [2m                [0m
[2;36m                    [0m         [1;92m115:4[0m[39m. mvn clean install[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:```[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:If a new vulnerability has been discovered between the date of the [0m             [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:tag and the date you are building the tag, you may need to build with:[0m          [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:```[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m122:4[0m[39m. mvn clean install -Dossindex.skip[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:```[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:If a local test is not working in your environment, please notify[0m               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m: the project at dev@tika.apache.org. As an immediate workaround, [0m               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m: you can turn off individual tests with e.g.: [0m                                  [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:```[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;92m130:4[0m[39m. mvn clean install -Dossindex.skip [0m                                           [2m                [0m
[2;36m                    [0m         [39m-[0m[33mDtest[0m[39m=\!UnpackerResourceTest#testPDFImages[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:```[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:License [0m[1;39m([0m[39msee also LICENSE.txt[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:==============================[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m136:C[0m[39mollective work: Copyright [0m[1;36m2011[0m[39m The Apache Software Foundation.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more contributor [0m [2m                [0m
[2;36m                    [0m         [39mlicense agreements.  See the NOTICE file distributed with this work for additional [0m [2m                [0m
[2;36m                    [0m         [39minformation regarding copyright ownership.  The ASF licenses this file to You under[0m [2m                [0m
[2;36m                    [0m         [39mthe Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except [0m  [2m                [0m
[2;36m                    [0m         [39min compliance with the License.  You may obtain a copy of the License at[0m            [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:<[0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m[39m>[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:Unless required by applicable law or agreed to in writing, software distributed[0m [2m                [0m
[2;36m                    [0m         [39munder the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR [0m        [2m                [0m
[2;36m                    [0m         [39mCONDITIONS OF ANY KIND, either express or implied.  See the License for the [0m        [2m                [0m
[2;36m                    [0m         [39mspecific language governing permissions and limitations under the License.[0m          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m144:A[0m[39mpache Tika includes a number of subcomponents with separate copyright notices [0m [2m                [0m
[2;36m                    [0m         [39mand license terms. Your use of these subcomponents is subject to the terms and [0m     [2m                [0m
[2;36m                    [0m         [39mconditions of the licenses listed in the LICENSE.txt file.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m146:E[0m[39mxport Control[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:==============[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:This distribution includes cryptographic software.  The country in which you [0m   [2m                [0m
[2;36m                    [0m         [39mcurrently reside may have restrictions on the import, possession, use, and/or [0m      [2m                [0m
[2;36m                    [0m         [39mre-export to another country, of encryption software.  BEFORE using any encryption [0m [2m                [0m
[2;36m                    [0m         [39msoftware, please  check your country's laws, regulations and policies concerning [0m   [2m                [0m
[2;36m                    [0m         [39mthe import, possession, or use, and re-export of encryption software, to  see if [0m   [2m                [0m
[2;36m                    [0m         [39mthis is permitted.  See <[0m[4;94mhttp://www.wassenaar.org/[0m[39m> for more information.[0m           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:The U.S. Government Department of Commerce, Bureau of Industry and Security [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mBIS[0m[1;39m)[0m[39m, has classified this software as Export Commodity Control Number [0m[1;39m([0m[39mECCN[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39m5D002.C.[0m[1;36m1[0m[39m, which includes information security software using or performing [0m        [2m                [0m
[2;36m                    [0m         [39mcryptographic functions with asymmetric algorithms.  The form and manner of this [0m   [2m                [0m
[2;36m                    [0m         [39mApache Software Foundation distribution makes it eligible for export under the [0m     [2m                [0m
[2;36m                    [0m         [39mLicense Exception ENC Technology Software Unrestricted [0m[1;39m([0m[39mTSU[0m[1;39m)[0m[39m exception [0m[1;39m([0m[39msee the BIS[0m [2m                [0m
[2;36m                    [0m         [39mExport Administration Regulations, Section [0m[1;36m740.13[0m[1;39m)[0m[39m for both object code and source [0m [2m                [0m
[2;36m                    [0m         [39mcode.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:The following provides more details on the included cryptographic software:[0m     [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m155:A[0m[39mpache Tika uses the Bouncy Castle generic encryption libraries for extracting [0m [2m                [0m
[2;36m                    [0m         [39mtext content and metadata from encrypted PDF files.  See [0m                           [2m                [0m
[2;36m                    [0m         [39m<[0m[4;94mhttp://www.bouncycastle.org/[0m[39m> for more details on Bouncy Castle.  [0m                 [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:Mailing Lists[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:=============[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m160:D[0m[39miscussion about Tika takes place on the following mailing lists:[0m               [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:* user@tika.apache.org    - About using Tika[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:* dev@tika.apache.org     - About developing Tika[0m                               [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:Notification on all code changes are sent to the following mailing list:[0m        [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:* commits@tika.apache.org[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:The mailing lists are open to anyone and publicly archived.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:You can subscribe the mailing lists by sending a message to [0m                    [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:[0m[1;39m[[0m[39mLIST[0m[1;39m][0m[39m-subscribe@tika.apache.org [0m[1;39m([0m[39mfor example, user-subscribe@[0m[33m...[0m[1;39m)[0m[39m.  [0m           [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:To unsubscribe, send a message to [0m[1;39m[[0m[39mLIST[0m[1;39m][0m[39m-unsubscribe@tika.apache.org.  [0m         [2m                [0m
[2;36m                    [0m         [1;92m174:F[0m[39mor more instructions, send a message to [0m[1;39m[[0m[39mLIST[0m[1;39m][0m[39m-help@tika.apache.org.[0m           [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:Issue Tracker[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:=============[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:If you encounter errors in Tika or want to suggest an improvement or a new [0m     [2m                [0m
[2;36m                    [0m         [39mfeature,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m: please visit the [0m[1;39m[[0m[39mTika issue [0m                                                  [2m                [0m
[2;36m                    [0m         [39mtracker[0m[1;39m][0m[1;39m([0m[4;94mhttps://issues.apache.org/jira/browse/TIKA[0m[4;94m)[0m[4;94m.[0m[39m [0m                              [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m: There you can also find the latest information on known issues and [0m            [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m: recent bug fixes and enhancements.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;92m184:B[0m[39muild Issues[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:============[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:*TODO*[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:* Need to install jce[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:* If you find any other issues while building, please email the [0m                [2m                [0m
[2;36m                    [0m         [39mdev@tika.apache.org[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:  list.[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:50[0m[39m-[0m[1;36m110[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.AutoDetectParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.utils.ExceptionUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * Forked process that runs against a single input file[0m                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:public class FuzzOne [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    private static final Logger LOG = [0m[1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mFuzzOne.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    static Options [0m[1;33mOPTIONS[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    static [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[35m/[0m[35m/[0m[95mBy[0m[39m the time this commandline is parsed, there should be both an [0m       [2m                [0m
[2;36m                    [0m         [39mextracts and an inputDir[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        Option extracts = new [0m[1;35mOption[0m[1;39m([0m[32m"extracts"[0m[39m, true, [0m[32m"directory for extract [0m   [2m                [0m
[2;36m                    [0m         [32mfiles"[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mextracts.setRequired[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;33mOPTIONS[0m[39m = new [0m[1;35mOptions[0m[1;39m([0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"i"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"inputFile"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"input directory [0m  [2m                [0m
[2;36m                    [0m         [32mfor seed files"[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                        [0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m         [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"o"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"outputFile"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"output file [0m     [2m                [0m
[2;36m                    [0m         [32mbase"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                        [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"m"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"timeoutMs"[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"timeout in ms -- max time allowed to parse a [0m             [2m                [0m
[2;36m                    [0m         [32mfile"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"n"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"thread id [0m[32m([0m[32mthread [0m                     [2m                [0m
[2;36m                    [0m         [32mnumber[0m[32m)[0m[32m"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                        [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"p"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"perFile"[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"number of iterations to run per seed [0m                     [2m                [0m
[2;36m                    [0m         [32mfile"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:                [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m[1;35mOption.builder[0m[1;39m([0m[32m"t"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"maxTransformers"[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                [0m[1;35m.desc[0m[1;39m([0m[32m"maximum number of transformers to run per [0m                [2m                [0m
[2;36m                    [0m         [32miteration"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.addOption[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;35mOption.builder[0m[1;39m([0m[32m"r"[0m[1;39m)[0m[1;35m.longOpt[0m[1;39m([0m[32m"retryId"[0m[1;39m)[0m[1;35m.desc[0m[1;39m([0m[32m"which retry is [0m     [2m                [0m
[2;36m                    [0m         [32mthis"[0m[1;39m)[0m[1;35m.hasArg[0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                        [0m[1;35m.required[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    Parser parser = new [0m[1;35mAutoDetectParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public static void [0m[1;35mmain[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m args[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        FuzzOneConfig config = [0m[1;35mFuzzOneConfig.parse[0m[1;39m([0m[39margs[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        FuzzOne fuzzOne = new [0m[1;35mFuzzOne[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;35mfuzzOne.execute[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    private void [0m[1;35mexecute[0m[1;39m([0m[39mFuzzOneConfig config[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        Path src = config.inputFile;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        Path targetDir = config.outputFileBase;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        AutoDetectTransformer transformer = new [0m[1;35mAutoDetectTransformer[0m[1;39m([0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < config.perFileIterations; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:                String ext = [0m[32m"-"[0m[39m + config.threadNum + [0m[32m"-"[0m[39m + config.retryNum + [0m  [2m                [0m
[2;36m                    [0m         [32m"-"[0m[39m + i;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                [0m[1;35mfuzz[0m[1;39m([0m[39mext, src, targetDir, transformer, config.timeoutMs[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem transforming file"[0m[39m, e[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCantFuzzException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"can't fuzz this file "[0m[39m + src, e[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                return;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                [0m[1;35me.printStackTrace[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:212[0m[39m-[0m[1;36m244[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        public Integer [0m[1;35mcall[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            boolean success = false;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"parsing "[0m[39m + target[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;35mparser.parse[0m[1;39m([0m[39mis, new [0m[1;35mDefaultHandler[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m, new [0m     [2m                [0m
[2;36m                    [0m         [1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                success = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                if [0m[1;39m([0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m != null && [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m instanceof [0m            [2m                [0m
[2;36m                    [0m         [39mRuntimeException[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                    [0m[35m/[0m[35m/[0m[95mhandleThrowable[0m[1;39m([0m[39mtarget, [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                    success = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                    success = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                success = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mThrowable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mhandleThrowable[0m[1;39m([0m[39mtarget, t[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                if [0m[1;39m([0m[39msuccess[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;35mFiles.delete[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"couldn't delete: "[0m[39m + [0m                         [2m                [0m
[2;36m                    [0m         [1;35mtarget.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"FOUND PROBLEM: "[0m[39m + target[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:            return success ? [0m[1;36m1[0m[39m : [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:126[0m[39m-[0m[1;36m144[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        ExecutorService executor = [0m[1;35mExecutors.newFixedThreadPool[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        Future<Integer> future = [0m[1;35mexecutor.submit[0m[1;39m([0m[39mnew [0m[1;35mParseTask[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            int result = [0m[1;35mfuture.get[0m[1;39m([0m[39mtimeoutMs, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            if [0m[1;39m([0m[39mresult == [0m[1;36m1[0m[39m && [0m[1;35mFiles.exists[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"failed to delete target: "[0m[39m + target[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"timeout exception:"[0m[39m + target[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;35mfuture.cancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mwriteErrFile[0m[1;39m([0m[39mtarget, [0m[32m".timeout"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException | ExecutionException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem parsing "[0m[39m + target, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mexecutor.shutdownNow[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:212[0m[39m-[0m[1;36m244[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        public Integer [0m[1;35mcall[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            boolean success = false;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"parsing "[0m[39m + target[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;35mparser.parse[0m[1;39m([0m[39mis, new [0m[1;35mDefaultHandler[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m, new [0m     [2m                [0m
[2;36m                    [0m         [1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                success = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                if [0m[1;39m([0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m != null && [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[39m instanceof [0m            [2m                [0m
[2;36m                    [0m         [39mRuntimeException[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                    [0m[35m/[0m[35m/[0m[95mhandleThrowable[0m[1;39m([0m[39mtarget, [0m[1;35me.getCause[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                    success = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                    success = true;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException | IOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                success = true;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mThrowable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mhandleThrowable[0m[1;39m([0m[39mtarget, t[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                if [0m[1;39m([0m[39msuccess[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;35mFiles.delete[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"couldn't delete: "[0m[39m + [0m                         [2m                [0m
[2;36m                    [0m         [1;35mtarget.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                    [0m[1;35mLOG.info[0m[1;39m([0m[32m"FOUND PROBLEM: "[0m[39m + target[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:            return success ? [0m[1;36m1[0m[39m : [0m[1;36m0[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/pdf/PDFTransformer.jav[0m[1;92ma:45[0m[39m-[0m[1;36m57[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        try [0m[1;39m([0m[39mPDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[39mnew [0m                         [2m                [0m
[2;36m                    [0m         [1;35mRandomAccessReadBuffer[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[35m/[0m[35m/[0m[95msome[0m[39m docs have security which prevents mods and writing[0m            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[35m/[0m[35m/[0m[95mgiven[0m[39m our purposes here, we should remove security[0m                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;35mpdDocument.setAllSecurityToBeRemoved[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m([0m[39mEvilCOSWriter cosWriter = new [0m[1;35mEvilCOSWriter[0m[1;39m([0m[39mos, config[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mcosWriter.write[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInvalidPasswordException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            throw new [0m[1;35mCantFuzzException[0m[1;39m([0m[32m"encrypted doc"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:168[0m[39m-[0m[1;36m176[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    private void [0m[1;35mtransformFile[0m[1;39m([0m[39mTransformer transformer, Path src, Path target[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            throws IOException, TikaException [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:        try [0m[1;39m([0m[39mInputStream is = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[39msrc[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                OutputStream os = [0m[1;35mFiles.newOutputStream[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mtransformer.transform[0m[1;39m([0m[39mis, os[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:    private static class FuzzOneConfig [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:120[0m[39m-[0m[1;36m160[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;35mtransformFile[0m[1;39m([0m[39mtransformer, src, target[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mThrowable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"failed to transform: "[0m[39m + [0m[1;35msrc.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            [0m[1;35mFiles.delete[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            throw t;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        ExecutorService executor = [0m[1;35mExecutors.newFixedThreadPool[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        Future<Integer> future = [0m[1;35mexecutor.submit[0m[1;39m([0m[39mnew [0m[1;35mParseTask[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            int result = [0m[1;35mfuture.get[0m[1;39m([0m[39mtimeoutMs, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            if [0m[1;39m([0m[39mresult == [0m[1;36m1[0m[39m && [0m[1;35mFiles.exists[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"failed to delete target: "[0m[39m + target[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"timeout exception:"[0m[39m + target[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;35mfuture.cancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mwriteErrFile[0m[1;39m([0m[39mtarget, [0m[32m".timeout"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException | ExecutionException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem parsing "[0m[39m + target, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            [0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mexecutor.shutdownNow[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:    private void [0m[1;35mwriteErrFile[0m[1;39m([0m[39mPath target, String ext[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            Path err = [0m                                                         [2m                [0m
[2;36m                    [0m         [1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m + ext[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:            [0m[1;35mFiles.write[0m[1;39m([0m[39merr, new byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"things aren't going right today."[0m[39m, e[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    private void [0m[1;35mhandleThrowable[0m[1;39m([0m[39mPath target, Throwable t[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            Path errMsg =[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                    [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m".stacktrace"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing/src/main/java/org/apache/tika/fuzzing/pdf/PDFTransformer.jav[0m[1;92ma:44[0m[39m-[0m[1;36m60[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    public void [0m[1;35mtransform[0m[1;39m([0m[39mInputStream is, OutputStream os[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        try [0m[1;39m([0m[39mPDDocument pdDocument = [0m[1;35mLoader.loadPDF[0m[1;39m([0m[39mnew [0m                         [2m                [0m
[2;36m                    [0m         [1;35mRandomAccessReadBuffer[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            [0m[35m/[0m[35m/[0m[95msome[0m[39m docs have security which prevents mods and writing[0m            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:            [0m[35m/[0m[35m/[0m[95mgiven[0m[39m our purposes here, we should remove security[0m                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;35mpdDocument.setAllSecurityToBeRemoved[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            try [0m[1;39m([0m[39mEvilCOSWriter cosWriter = new [0m[1;35mEvilCOSWriter[0m[1;39m([0m[39mos, config[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                [0m[1;35mcosWriter.write[0m[1;39m([0m[39mpdDocument[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInvalidPasswordException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            throw new [0m[1;35mCantFuzzException[0m[1;39m([0m[32m"encrypted doc"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    public void [0m[1;35msetConfig[0m[1;39m([0m[39mPDFTransformerConfig pdfTransformerConfig[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        this.config = pdfTransformerConfig;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Correct the patch formatting and target paths  [0m                                  [2m                [0m
[2;36m                    [0m         [39m   - Ensure the submitted patch is a valid unified diff with headers of the form:  [0m [2m                [0m
[2;36m                    [0m         [39m     --- a/tika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.java  [0m    [2m                [0m
[2;36m                    [0m         [39m     +++ b/tika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.java  [0m    [2m                [0m
[2;36m                    [0m         [39m   - Remove any stray dashes in the path [0m[1;39m([0m[39m‚Äútika-fuzzing/cli‚Äù ‚Üí ‚Äútika/fuzzing/cli‚Äù[0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [39mso the patch tool can locate the files.  [0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Include at least three lines of context on each side of every hunk to satisfy [0m [2m                [0m
[2;36m                    [0m         [39munified diff conventions and enable automatic application.[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Bound the PDF‚Äêtransformation phase by mirroring the existing parse‚Äêtimeout logic[0m [2m                [0m
[2;36m                    [0m         [39m   - In FuzzOne.java‚Äôs `[0m[1;35mfuzz[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mjust before submitting the parse task[0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mwrap the call to `[0m[1;35mtransformFile[0m[1;39m([0m[39mtransformer, src, target[0m[1;39m)[0m[39m` in a single‚Äêthreaded [0m    [2m                [0m
[2;36m                    [0m         [39mExecutorService, exactly as is done for `ParseTask`.  [0m                              [2m                [0m
[2;36m                    [0m         [39m   - Use `[0m[1;35mfuture.get[0m[1;39m([0m[39mtimeoutMs, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m` on that transform‚Äêfuture.  [0m [2m                [0m
[2;36m                    [0m         [39m   - On timeout:  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ call `[0m[1;35mfuture.cancel[0m[1;39m([0m[39mtrue[0m[1;39m)[0m[39m`  [0m                                                 [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ write a ‚Äú.timeout‚Äù marker file [0m[1;39m([0m[39mthe same way the parse timeout branch does[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ call `[0m[1;35mSystem.exit[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m` to abort this run [0m[1;39m([0m[39mso libFuzzer sees it as a timeout[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m   - Shut down the executor with `[0m[1;35mshutdownNow[0m[1;39m([0m[1;39m)[0m[39m` in a finally block.  [0m              [2m                [0m
[2;36m                    [0m         [39m   - This change guarantees that any expensive transformer [0m[1;39m([0m[39me.g., heavy PDF parsing[0m [2m                [0m
[2;36m                    [0m         [39mvia PDFBox + EvilCOSWriter[0m[1;39m)[0m[39m will be preempted after the same `timeoutMs` budget [0m    [2m                [0m
[2;36m                    [0m         [39mallotted for parsing.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Introduce a fail‚Äêfast check for overly large PDFs in PDFTransformer  [0m            [2m                [0m
[2;36m                    [0m         [39m   - In `[0m[1;35mPDFTransformer.transform[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`, before invoking `[0m[1;35mLoader.loadPDF[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`, [0m    [2m                [0m
[2;36m                    [0m         [39mcheck the available bytes in the input stream [0m[1;39m([0m[39me.g., via [0m                           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mis[0m[1;39m)[0m[1;35m.getOpenContainer[0m[1;39m([0m[1;39m)[0m[1;35m.getLength[0m[1;39m([0m[1;39m)[0m[39m` if available, or by [0m       [2m                [0m
[2;36m                    [0m         [39mwrapping in a `BoundedInputStream` with a configurable max size[0m[1;39m)[0m[39m.  [0m                 [2m                [0m
[2;36m                    [0m         [39m   - If the file exceeds a reasonable size threshold [0m[1;39m([0m[39mconfigurable via a new [0m       [2m                [0m
[2;36m                    [0m         [39mPDFTransformerConfig parameter[0m[1;39m)[0m[39m, immediately throw `[0m[1;35mCantFuzzException[0m[1;39m([0m[32m"file too [0m    [2m                [0m
[2;36m                    [0m         [32mlarge"[0m[1;39m)[0m[39m`.  [0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - This avoids attempting to load/rewriting multi‚Äêmegabyte or pathological PDFs [0m  [2m                [0m
[2;36m                    [0m         [39mthat invariably cause timeouts.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. [0m[1;39m([0m[39mOptionally[0m[1;39m)[0m[39m Make transformer I/O interrupt‚Äêaware  [0m                              [2m                [0m
[2;36m                    [0m         [39m   - Supply a lightweight `InterruptibleInputStream` wrapper that checks [0m           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mThread.interrupted[0m[1;39m([0m[1;39m)[0m[39m` on each read, throwing `InterruptedIOException` if set.  [0m    [2m                [0m
[2;36m                    [0m         [39m   - Feed this wrapper into PDFBox‚Äôs `RandomAccessReadBuffer`, so a cancelled [0m      [2m                [0m
[2;36m                    [0m         [39mtransform thread will promptly unwind rather than lingering in deep parsing loops. [0m [2m                [0m
[2;36m                    [0m         [39m   - This is a low‚Äêrisk change, since it only affects fuzzer‚Äêdriven code paths.[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Generate and submit the patch  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Use `git diff -u` against the initial codebase, verify that the hunks apply, [0m  [2m                [0m
[2;36m                    [0m         [39mand ensure all modified lines are correctly contextualized.  [0m                       [2m                [0m
[2;36m                    [0m         [39m   - Target only the two files in the tika-fuzzing module:  [0m                        [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ tika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.java  [0m        [2m                [0m
[2;36m                    [0m         [39m     ‚Ä¢ tika-fuzzing/src/main/java/org/apache/tika/fuzzing/pdf/PDFTransformer.java  [0m [2m                [0m
[2;36m                    [0m         [39m   - Confirm that maven build and existing non‚Äêfuzzing tests are unaffected.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWhy this strategy is optimal  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m- It addresses the root cause‚Äîexpensive transformations blocking the fuzz‚Äêharness [0m  [2m                [0m
[2;36m                    [0m         [39mbeyond its timeout‚Äîby enforcing the same deadline on both transform and parse.  [0m    [2m                [0m
[2;36m                    [0m         [39m- It preserves existing parse‚Äêtimeout logic, leveraging its proven pattern rather [0m  [2m                [0m
[2;36m                    [0m         [39mthan inventing new concurrency primitives.  [0m                                        [2m                [0m
[2;36m                    [0m         [39m- It leaves non‚Äêfuzzer builds and tests untouched: all changes reside in the [0m       [2m                [0m
[2;36m                    [0m         [39mtika-fuzzing module.  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m- It uses a simple size‚Äêcheck in PDFTransformer to short‚Äêcircuit pathological [0m      [2m                [0m
[2;36m                    [0m         [39minputs, further reducing the chance of a harness timeout.  [0m                         [2m                [0m
[2;36m                    [0m         [39m- Proper patch formatting and correct file paths ensure the diff will apply cleanly[0m [2m                [0m
[2;36m                    [0m         [39mon the initial codebase without CI tool complaints.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPotential side‚Äêeffects and mitigations  [0m                                            [2m                [0m
[2;36m                    [0m         [39m- Transform timeouts now may terminate some inputs early; however, those inputs are[0m [2m                [0m
[2;36m                    [0m         [39malready problematic [0m[1;39m([0m[39mthey exceed the allotted budget[0m[1;39m)[0m[39m.  [0m                            [2m                [0m
[2;36m                    [0m         [39m- Introducing an interruptible input stream could expose rare edge‚Äêcases if PDFBox [0m [2m                [0m
[2;36m                    [0m         [39minternals read from the underlying buffer before checking interrupts; mitigated by [0m [2m                [0m
[2;36m                    [0m         [39monly enabling this in the fuzzer module.  [0m                                          [2m                [0m
[2;36m                    [0m         [39m- Adding a maximum‚Äêsize threshold for PDF skipping should be accompanied by a [0m      [2m                [0m
[2;36m                    [0m         [39mdefault conservative value [0m[1;39m([0m[39me.g., [0m[1;36m1[0m[39m MiB[0m[1;39m)[0m[39m and be configurable in [0m                    [2m                [0m
[2;36m                    [0m         [39mPDFTransformerConfig, so that legitimate documents are not inadvertently excluded.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mCode ranges to patch  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m<code_range>tika-fuzzing/src/main/java/org/apache/tika/fuzzing/cli/FuzzOne.jav[0m[1;92ma:120[0m [2m                [0m
[2;36m                    [0m         [39m-[0m[1;36m160[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m<code_range>tika-fuzzing/src/main/java/org/apache/tika/fuzzing/pdf/PDFTransformer.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:44[0m[39m-[0m[1;36m60[0m[39m<[0m[35m/[0m[95mcode_range[0m[39m>[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/29/25 22:23:28][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=588215;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=947235;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m6[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=564253;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=528537;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpra77tcqk[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_o4_mini/tika_tk-delta-06_vuln_10/[0m[95magent-output-1[0m [2m               [0m
[2;36m                    [0m         [95m767047008.687598[0m                                                                     [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-no-delta/tika_tk-delta-06_vuln_10.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[12/29/25 22:23:29][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mtika[0m           ]8;id=8933;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=868857;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=220618;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=703449;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=290020;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=847729;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
