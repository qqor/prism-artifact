--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -117,6 +117,15 @@
         } else {
             dofs = ofs + 8;
         }
+        /* Prevent reading past the supplied buffer */
+        if (dofs > buf_size || dsize > buf_size - dofs) {
+            exif_log (md->log,
+                      EXIF_LOG_CODE_CORRUPT_DATA,
+                      "ExifMnoteApple",
+                      "Tag data overflow detected (offset %u, size %u, buf_size %u)",
+                      dofs, dsize, buf_size);
+            continue;
+        }
 	if (dofs > buf_size) {
 		exif_log (md->log, EXIF_LOG_CODE_CORRUPT_DATA,
                                   "ExifMnoteApplet", "Tag size overflow detected (%u vs size %u)", dofs, buf_size);
