--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -1105,7 +1105,8 @@
 	hdr_len = tvb_get_letohs(tvb, offset + NB_LENGTH);
 	command = tvb_get_uint8( tvb, offset + NB_COMMAND);
 					/* limit command so no table overflows */
-	command = MIN(command, array_length(dissect_netb));
+	if (command >= array_length(dissect_netb))
+		command = array_length(dissect_netb) - 1;
 
 		/* print command name */
 	command_name = val_to_str_ext(command, &cmd_vals_ext, "Unknown (0x%02x)");
