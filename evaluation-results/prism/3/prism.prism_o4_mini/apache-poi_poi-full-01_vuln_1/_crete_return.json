{
  "project_name": "apache-poi",
  "vulnerability_identifier": "apache-poi_poi-full-01_vuln_1",
  "source_directory": "/tasks_new/apache-poi_poi-full-01/official-afc-poi",
  "llm_usage": {
    "total_cost": 0.19354280000000001,
    "prompt_tokens": 115796,
    "completion_tokens": 15038
  },
  "variant": "sound",
  "diff": "--- a/poi/src/main/java/org/apache/poi/util/StringUtil.java\n+++ b/poi/src/main/java/org/apache/poi/util/StringUtil.java\n@@ -90,6 +90,9 @@\n         if ((len < 0) || (((string.length - offset) / 2) < len)) {\n             throw new IllegalArgumentException(\"Illegal length \" + len);\n         }\n+        if (len > MAX_RECORD_LENGTH) {\n+            throw new IllegalArgumentException(\"Requested Unicode string length \" + len + \" exceeds max record length \" + MAX_RECORD_LENGTH);\n+        }\n \n         return new String(string, offset, len * 2, UTF16LE);\n     }\n@@ -108,7 +111,11 @@\n         if (string.length == 0) {\n             return \"\";\n         }\n-        return getFromUnicodeLE(string, 0, string.length / 2);\n+        int len = string.length / 2;\n+        if (len > MAX_RECORD_LENGTH) {\n+            throw new IllegalArgumentException(\"Requested Unicode string length \" + len + \" exceeds max record length \" + MAX_RECORD_LENGTH);\n+        }\n+        return getFromUnicodeLE(string, 0, len);\n     }\n \n     /**\n",
  "stdout": "",
  "stderr": ""
}