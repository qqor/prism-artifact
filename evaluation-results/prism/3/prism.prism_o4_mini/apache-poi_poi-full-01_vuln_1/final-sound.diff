--- a/poi/src/main/java/org/apache/poi/util/StringUtil.java
+++ b/poi/src/main/java/org/apache/poi/util/StringUtil.java
@@ -90,6 +90,9 @@
         if ((len < 0) || (((string.length - offset) / 2) < len)) {
             throw new IllegalArgumentException("Illegal length " + len);
         }
+        if (len > MAX_RECORD_LENGTH) {
+            throw new IllegalArgumentException("Requested Unicode string length " + len + " exceeds max record length " + MAX_RECORD_LENGTH);
+        }
 
         return new String(string, offset, len * 2, UTF16LE);
     }
@@ -108,7 +111,11 @@
         if (string.length == 0) {
             return "";
         }
-        return getFromUnicodeLE(string, 0, string.length / 2);
+        int len = string.length / 2;
+        if (len > MAX_RECORD_LENGTH) {
+            throw new IllegalArgumentException("Requested Unicode string length " + len + " exceeds max record length " + MAX_RECORD_LENGTH);
+        }
+        return getFromUnicodeLE(string, 0, len);
     }
 
     /**
