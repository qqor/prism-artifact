--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
@@ -1093,11 +1093,16 @@
             MediaType contentType = detector.detect(tis, metadata);
 
             String name = metadata.get(TikaCoreProperties.RESOURCE_NAME_KEY);
-            File outputFile = null;
+            File outputFile;
             if (name == null) {
                 name = "file" + count++;
             }
-            outputFile = getOutputFile(name, metadata, contentType);
+            try {
+                outputFile = getOutputFile(name, metadata, contentType);
+            } catch (IOException e) {
+                LOG.warn("Skipping embedded file {} due to invalid file path: {}", name, e.getMessage());
+                return;
+            }
 
 
             File parent = outputFile.getParentFile();
@@ -1125,7 +1130,7 @@
             }
         }
 
-        private File getOutputFile(String name, Metadata metadata, MediaType contentType) {
+        private File getOutputFile(String name, Metadata metadata, MediaType contentType) throws IOException {
             String ext = getExtension(contentType);
             if (name.indexOf('.') == -1 && contentType != null) {
                 name += ext;
@@ -1135,8 +1140,8 @@
             if (relID != null && !name.startsWith(relID)) {
                 name = relID + "_" + name;
             }
-            //defensively do this so that we don't get an exception
-            //from FilenameUtils.normalize
+            // defensively do this so that we don't get an exception
+            // from FilenameUtils.normalize
             name = name.replaceAll("\u0000", " ");
             String normalizedName = FilenameUtils.normalize(name);
 
@@ -1147,7 +1152,7 @@
             if (normalizedName == null) {
                 normalizedName = "file" + count++ + ext;
             }
-            //strip off initial C:/ or ~/ or /
+            // strip off initial C:/ or ~/ or /
             int prefixLength = FilenameUtils.getPrefixLength(normalizedName);
             if (prefixLength > -1) {
                 normalizedName = normalizedName.substring(prefixLength);
@@ -1157,15 +1162,20 @@
             } catch (IllegalArgumentException e) {
                 LOG.warn("couldn't url decode name {}", normalizedName);
             }
-            File outputFile = new File(extractDir, normalizedName);
-            //if file already exists, prepend uuid
-            if (outputFile.exists()) {
-                String fileName = FilenameUtils.getName(normalizedName);
-                outputFile = new File(extractDir, UUID
-                        .randomUUID()
-                        .toString() + "-" + fileName);
-            }
-            return outputFile;
+            // resolve and normalize against extraction directory to prevent traversal
+            java.nio.file.Path root = extractDir.toPath();
+            java.nio.file.Path target = root.resolve(normalizedName).normalize();
+            if (!target.startsWith(root)) {
+                throw new IOException("Invalid embedded file name, potential path traversal: " + normalizedName);
+            }
+            // if file already exists, prepend uuid
+            if (java.nio.file.Files.exists(target)) {
+                String baseName = FilenameUtils.getName(normalizedName);
+                String unique = UUID.randomUUID().toString() + "-" + baseName;
+                java.nio.file.Path alt = root.resolve(unique).normalize();
+                target = alt;
+            }
+            return target.toFile();
         }
 
         private String getExtension(MediaType contentType) {
