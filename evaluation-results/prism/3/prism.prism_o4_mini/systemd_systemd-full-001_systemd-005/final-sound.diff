--- a/src/basic/alloc-util.h
+++ b/src/basic/alloc-util.h
@@ -103,7 +103,10 @@
 }
 
 static inline void freep(void *p) {
-        free(*(void**) p);
+        /* Free the pointed-to pointer, then null it to avoid dangling references. */
+        void **pp = (void**) p;
+        free(*pp);
+        *pp = NULL;
 }
 
 #define _cleanup_free_ _cleanup_(freep)
