[10/27/25 20:05:05] INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmpw54y99cl                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_3/agent-output-1761595505.2835183                                                                        
                             - Detection toml file: /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_3.toml                                                                                 
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                                                                                                 
                                                                                                                                                                                                                 
                    INFO     [logging_performance](pdfbox Building Cached for CLEAN environment) Started...                                                                                 context_managers.py:9
[10/27/25 20:06:20] INFO     [logging_performance](pdfbox Building Cached for CLEAN environment) Took 74.98 seconds; exception=False                                                       context_managers.py:23
                    INFO     [logging_performance](pdfbox Running tests for Cached for CLEAN environment) Started...                                                                        context_managers.py:9
                    INFO     [logging_performance](pdfbox Running tests for Cached for CLEAN environment) Took 0.00 seconds; exception=False                                               context_managers.py:23
                    INFO     Setting timeouts                                                                                                                                                       default.py:85
                               - build: 600 (original: 74)                                                                                                                                                       
                               - run tests: 600 (original: 0)                                                                                                                                                    
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:06:21] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False                                                                                context_managers.py:23
[10/27/25 20:06:22] INFO     Successfully created Cached for CLEAN environment                                                                                                                    oss_fuzz.py:256
                    INFO     Current environments: ['CLEAN -> Cached']                                                                                                                            oss_fuzz.py:265
                    INFO     Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 0, patch status: PatchStatus.INITIALIZED)                                                                                                                                 
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:06:23] INFO     [logging_performance](pdfbox Setting owner) Took 0.97 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:06:24] INFO     [logging_performance](pdfbox Setting owner) Took 0.84 seconds; exception=False                                                                                context_managers.py:23
[10/27/25 20:06:55] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:06:56] INFO     [logging_performance](pdfbox Setting owner) Took 0.86 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Running a pov) Started...                                                                                                         context_managers.py:9
[10/27/25 20:07:27] INFO     [logging_performance](pdfbox Running a pov) Took 30.36 seconds; exception=True                                                                                context_managers.py:23
                    WARNING  Crash analysis results is empty. This should not happen.                                                                                                              __init__.py:41
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:07:28] INFO     [logging_performance](pdfbox Setting owner) Took 0.97 seconds; exception=False                                                                                context_managers.py:23
[10/27/25 20:07:59] INFO     Found jstack output at /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/jstack.txt                                                                      __init__.py:43
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                                                                                              
                             ===Evaluator Diff===                                                                                                                                                                
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-27 20:07:57                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f636c50c910, length=14, elements={                                                                                                                         
                             0x000055f4d1c3db70, 0x000055f4d1d48bf0, 0x000055f4d1d4a000, 0x000055f4d1d53090,                                                                                                     
                             0x000055f4d1d54410, 0x000055f4d1d557f0, 0x000055f4d1d571f0, 0x000055f4d1d586f0,                                                                                                     
                             0x000055f4d1d59b30, 0x000055f4d1d96990, 0x000055f4d1d99b00, 0x000055f4d1f173f0,                                                                                                     
                             0x00007f639c000e70, 0x000055f4d24aff50                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26751.20ms elapsed=28.73s tid=0x000055f4d1c3db70 nid=0x13 runnable  [0x00007ffcc4765000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                                                       
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                                                  
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                                                    
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.90ms elapsed=28.68s tid=0x000055f4d1d48bf0 nid=0x16 waiting on condition  [0x00007f63b39c3000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.50ms elapsed=28.68s tid=0x000055f4d1d4a000 nid=0x17 in Object.wait()  [0x00007f63b38e2000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.25ms elapsed=28.68s tid=0x000055f4d1d53090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=5.00ms elapsed=28.68s tid=0x000055f4d1d54410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.68s tid=0x000055f4d1d557f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1926.67ms elapsed=28.68s tid=0x000055f4d1d571f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=891.42ms elapsed=28.68s tid=0x000055f4d1d586f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=65.15ms elapsed=28.68s tid=0x000055f4d1d59b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.14ms elapsed=28.66s tid=0x000055f4d1d96990 nid=0x20 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.06ms elapsed=28.66s tid=0x000055f4d1d99b00 nid=0x23 in Object.wait()  [0x00007f63b241f000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.51ms elapsed=28.54s tid=0x000055f4d1f173f0 nid=0x27 waiting on condition  [0x00007f63b20d5000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x00000000894128c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.89ms elapsed=28.42s tid=0x00007f639c000e70 nid=0x3d waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.19ms elapsed=25.51s tid=0x000055f4d24aff50 nid=0x292 in Object.wait()  [0x00007f63b1daf000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.46ms elapsed=28.69s tid=0x000055f4d1d44400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=42.85ms elapsed=28.71s tid=0x000055f4d1c54da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=49.59ms elapsed=27.62s tid=0x00007f63ac0015b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=52.77ms elapsed=27.62s tid=0x00007f63ac001fb0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=42.53ms elapsed=27.62s tid=0x00007f63ac0029b0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=53.91ms elapsed=27.62s tid=0x00007f63ac0033b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=47.44ms elapsed=27.62s tid=0x00007f63ac003db0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=45.69ms elapsed=27.62s tid=0x00007f63ac0047b0 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=39.76ms elapsed=27.62s tid=0x00007f63ac0051b0 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=52.25ms elapsed=27.62s tid=0x00007f63ac005bb0 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=44.54ms elapsed=27.62s tid=0x00007f63ac0065b0 nid=0x67 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=51.24ms elapsed=27.62s tid=0x00007f63ac006fb0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=42.18ms elapsed=27.62s tid=0x00007f63ac0079b0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=53.96ms elapsed=27.62s tid=0x00007f63ac0083b0 nid=0x6a runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.84ms elapsed=28.66s tid=0x000055f4d1d98320 nid=0x21 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-27 20:07:57                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f636c50c910, length=14, elements={                                                                                                                         
                             0x000055f4d1c3db70, 0x000055f4d1d48bf0, 0x000055f4d1d4a000, 0x000055f4d1d53090,                                                                                                     
                             0x000055f4d1d54410, 0x000055f4d1d557f0, 0x000055f4d1d571f0, 0x000055f4d1d586f0,                                                                                                     
                             0x000055f4d1d59b30, 0x000055f4d1d96990, 0x000055f4d1d99b00, 0x000055f4d1f173f0,                                                                                                     
                             0x00007f639c000e70, 0x000055f4d24aff50                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26751.20ms elapsed=28.73s tid=0x000055f4d1c3db70 nid=0x13 runnable  [0x00007ffcc4765000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                                                       
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                                                  
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                                                    
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.90ms elapsed=28.68s tid=0x000055f4d1d48bf0 nid=0x16 waiting on condition  [0x00007f63b39c3000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.50ms elapsed=28.68s tid=0x000055f4d1d4a000 nid=0x17 in Object.wait()  [0x00007f63b38e2000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.25ms elapsed=28.68s tid=0x000055f4d1d53090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=5.00ms elapsed=28.68s tid=0x000055f4d1d54410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.68s tid=0x000055f4d1d557f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1926.67ms elapsed=28.68s tid=0x000055f4d1d571f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=891.42ms elapsed=28.68s tid=0x000055f4d1d586f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=65.15ms elapsed=28.68s tid=0x000055f4d1d59b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.14ms elapsed=28.66s tid=0x000055f4d1d96990 nid=0x20 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.06ms elapsed=28.66s tid=0x000055f4d1d99b00 nid=0x23 in Object.wait()  [0x00007f63b241f000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.51ms elapsed=28.54s tid=0x000055f4d1f173f0 nid=0x27 waiting on condition  [0x00007f63b20d5000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x00000000894128c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.89ms elapsed=28.42s tid=0x00007f639c000e70 nid=0x3d waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.19ms elapsed=25.51s tid=0x000055f4d24aff50 nid=0x292 in Object.wait()  [0x00007f63b1daf000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.46ms elapsed=28.69s tid=0x000055f4d1d44400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=42.85ms elapsed=28.71s tid=0x000055f4d1c54da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=49.59ms elapsed=27.62s tid=0x00007f63ac0015b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=52.77ms elapsed=27.62s tid=0x00007f63ac001fb0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=42.53ms elapsed=27.62s tid=0x00007f63ac0029b0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=53.91ms elapsed=27.62s tid=0x00007f63ac0033b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=47.44ms elapsed=27.62s tid=0x00007f63ac003db0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=45.69ms elapsed=27.62s tid=0x00007f63ac0047b0 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=39.76ms elapsed=27.62s tid=0x00007f63ac0051b0 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=52.25ms elapsed=27.62s tid=0x00007f63ac005bb0 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=44.54ms elapsed=27.62s tid=0x00007f63ac0065b0 nid=0x67 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=51.24ms elapsed=27.62s tid=0x00007f63ac006fb0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=42.18ms elapsed=27.62s tid=0x00007f63ac0079b0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=53.96ms elapsed=27.62s tid=0x00007f63ac0083b0 nid=0x6a runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.84ms elapsed=28.66s tid=0x000055f4d1d98320 nid=0x21 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                                                                                                                                                                                                                 
                             ===Analysis Report===                                                                                                                                                               
                                                                                                                                                                                                                 
                             ===Evaluation End===                                                                                                                                                                
[10/27/25 20:08:14] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/27/25 20:10:01] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
[10/27/25 20:13:40] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                                                                                                  
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:13:41] INFO     [logging_performance](pdfbox Setting owner) Took 0.84 seconds; exception=False                                                                                context_managers.py:23
[10/27/25 20:13:42] INFO     [logging_performance](pdfbox Patching) Started...                                                                                                              context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmphxd4szyc                                                                                                                                 default.py:173
[10/27/25 20:14:10] ERROR    Failed to build the challenge                                                                                                                                         __init__.py:53
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_3/agent-output-1761595505.2835183/build_failed_stdout.txt: /src /src/project-parent/pdfbox                    functions.py:17
                             /src/project-parent/pdfbox                                                                                                                                                          
                             ---------------------------------------------------------------                                                                                                                     
                             vm.mmap_rnd_bits = 28                                                                                                                                                               
                             ---------------------------------------------------------------                                                                                                                     
                             CC=clang                                                                                                                                                                            
                             CXX=clang++                                                                                                                                                                         
                             CFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                   
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -fno-sanitize=leak                                       
                             CXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                                 
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension                  
                             -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -stdlib=libc++ -fno-sanitize=leak                        
                             RUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers                                                                                                    
                             ---------------------------------------------------------------                                                                                                                     
                             + __REAL_MAVEN_REPO=/root/.m2/repository                                                                                                                                            
                             + __SHARED_MAVEN_REPO=/work/mavencache                                                                                                                                              
                             + '[' '!' -L /root/.m2/repository ']'                                                                                                                                               
                             + unset __REAL_MAVEN_REPO                                                                                                                                                           
                             + unset __SHARED_MAVEN_REPO                                                                                                                                                         
                             + PROJECT=pdfbox                                                                                                                                                                    
                             + PROJECT_GROUP_ID=org.apache.pdfbox                                                                                                                                                
                             + PROJECT_ARTIFACT_ID=pdfbox                                                                                                                                                        
                             + XMPBOX_ARTIFACT_ID=xmpbox                                                                                                                                                         
                             + MAIN_REPOSITORY=https://github.com/apache/pdfbox/                                                                                                                                 
                             + MAVEN_ARGS='-Djavac.src.version=11 -Djavac.target.version=11 -DskipTests'                                                                                                         
                             + cd /src/project-parent                                                                                                                                                            
                             + [[ -v LOCAL_DEV ]]                                                                                                                                                                
                             + mv /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict /out                                                                                                              
                             + set_project_version_in_fuzz_targets_dependency                                                                                                                                    
                             ++ cd pdfbox                                                                                                                                                                        
                             ++ /src/maven/apache-maven-3.9.9/bin/mvn org.apache.maven.plugins:maven-help-plugin:3.2.0:evaluate -Dexpression=project.version -q -DforceStdout                                    
                             + PROJECT_VERSION=4.0.0-SNAPSHOT                                                                                                                                                    
                             + cd fuzz-targets                                                                                                                                                                   
                             + /src/maven/apache-maven-3.9.9/bin/mvn versions:use-dep-version -Dexcludes=com.code-intelligence:jazzer -DdepVersion=4.0.0-SNAPSHOT -DforceVersion=true                            
                             [INFO] Scanning for projects...                                                                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] ----------------------< com.fuzzer:fuzz-targets >-----------------------                                                                                                     
                             [INFO] Building fuzz 0.0.1-SNAPSHOT                                                                                                                                                 
                             [INFO]   from pom.xml                                                                                                                                                               
                             [INFO] --------------------------------[ jar ]---------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- versions:2.19.1:use-dep-version (default-cli) @ fuzz-targets ---                                                                                                         
                             [INFO] Updated org.apache.pdfbox:pdfbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                                                                                                
                             [INFO] Updated org.apache.pdfbox:xmpbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD SUCCESS                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  0.751 s                                                                                                                                                         
                             [INFO] Finished at: 2025-10-27T20:13:48Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             + cd pdfbox                                                                                                                                                                         
                             + /src/maven/apache-maven-3.9.9/bin/mvn install -Djavac.src.version=11 -Djavac.target.version=11 -DskipTests -Dmaven.repo.local=/out/m2                                             
                             [INFO] Scanning for projects...                                                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Build Order:                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent                                               [pom]                                                                                                     
                             [INFO] Apache PDFBox io                                                [bundle]                                                                                                     
                             [INFO] Apache FontBox                                                  [bundle]                                                                                                     
                             [INFO] Apache XmpBox                                                   [bundle]                                                                                                     
                             [INFO] Apache PDFBox                                                   [bundle]                                                                                                     
                             [INFO] Apache PDFBox Debugger                                             [jar]                                                                                                     
                             [INFO] Apache PDFBox tools                                                [jar]                                                                                                     
                             [INFO] Apache PDFBox application                                          [jar]                                                                                                     
                             [INFO] Apache PDFBox Debugger application                                 [jar]                                                                                                     
                             [INFO] Apache PDFBox examples                                             [jar]                                                                                                     
                             [INFO] pdfbox-reactor                                                     [pom]                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] ------------------< org.apache.pdfbox:pdfbox-parent >-------------------                                                                                                     
                             [INFO] Building Apache PDFBox parent 4.0.0-SNAPSHOT                      [1/11]                                                                                                     
                             [INFO]   from parent/pom.xml                                                                                                                                                        
                             [INFO] --------------------------------[ pom ]---------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-parent ---                                                                                                                     
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-parent ---                                                                                                       
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-parent ---                                                                                                        
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-parent ---                                                                                                                       
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-parent ---                                                                                                                
                                                                                                                                                                                                                 
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-parent ---                                                                                            
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-parent ---                                                                                                                        
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-parent ---                                                                                                            
                                                                                                                                                                                                                 
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-parent ---                                                                                                              
                             [INFO] Installing /src/project-parent/pdfbox/parent/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-parent/4.0.0-SNAPSHOT/pdfbox-parent-4.0.0-SNAPSHOT.pom                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --------------------< org.apache.pdfbox:pdfbox-io >---------------------                                                                                                     
                             [INFO] Building Apache PDFBox io 4.0.0-SNAPSHOT                          [2/11]                                                                                                     
                             [INFO]   from io/pom.xml                                                                                                                                                            
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-io ---                                                                                                                         
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-io ---                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-io ---                                                                                                            
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                                                                                                    
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-io ---                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-io ---                                                                                                                    
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-io ---                                                                                                
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox-io ---                                                                                                            
                             [INFO] skip non existing resourceDirectory /src/project-parent/pdfbox/io/src/main/resources                                                                                         
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox-io ---                                                                                                                
                                                                                                                                                                                                                 
                             [INFO] Recompiling the module because of changed source code.                                                                                                                       
                             [INFO] Compiling 18 source files with javac [debug deprecation release 11] to target/classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ pdfbox-io ---                                                                                                    
                             [INFO] Copying 2 resources from src/test/resources to target/test-classes                                                                                                           
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes                                                                                        
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ pdfbox-io ---                                                                                                        
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 10 source files with javac [debug deprecation release 11] to target/test-classes                                                                                   
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[45,29] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[50,24] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[57,24] populateBuffer(java.io.InputStream,byte[]) in                                   
                             org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- surefire:3.5.2:test (default-test) @ pdfbox-io ---                                                                                                                       
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             [INFO] Tests are skipped.                                                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-io ---                                                                                                                            
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ pdfbox-io ---                                                                                                                     
                             [INFO] Building bundle: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                           
                             [INFO] Writing manifest: /src/project-parent/pdfbox/io/target/classes/META-INF/MANIFEST.MF                                                                                          
                             [INFO]                                                                                                                                                                              
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-io ---                                                                                                                
                             [INFO] Building jar: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                                                                                      
                             [INFO]                                                                                                                                                                              
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-io ---                                                                                                                  
                             [INFO] Installing /src/project-parent/pdfbox/io/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.pom                                          
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar to                                                                                              
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                                     
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar to                                                                                      
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- bundle:5.1.9:install (default-install) @ pdfbox-io ---                                                                                                                   
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO] Installing org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                                                                           
                             [INFO] Writing OBR metadata                                                                                                                                                         
                             [INFO]                                                                                                                                                                              
                             [INFO] ---------------------< org.apache.pdfbox:fontbox >----------------------                                                                                                     
                             [INFO] Building Apache FontBox 4.0.0-SNAPSHOT                            [3/11]                                                                                                     
                             [INFO]   from fontbox/pom.xml                                                                                                                                                       
                             [INFO] -------------------------------[ bundle ]-------------------------------                                                                                                     
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (default) @ fontbox ---                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ fontbox ---                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ fontbox ---                                                                                                              
                             [INFO]                                                                                                                                                                              
                             [INFO] --- checkstyle:3.6.0:check (check) @ fontbox ---                                                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ fontbox ---                                                                                                                      
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                                                                                               
                             [INFO]                                                                                                                                                                              
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ fontbox ---                                                                                                  
                             [INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7                                                                                           
                             [INFO] Copying 3 resources from 1 bundle.                                                                                                                                           
                             [INFO] Copying appended resource: META-INF/LICENSE                                                                                                                                  
                             [INFO] Copying appended resource: META-INF/NOTICE                                                                                                                                   
                             [INFO]                                                                                                                                                                              
                             [INFO] --- resources:3.3.1:resources (default-resources) @ fontbox ---                                                                                                              
                             [INFO] Copying 93 resources from src/main/resources to target/classes                                                                                                               
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                                                                                             
                             [INFO]                                                                                                                                                                              
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ fontbox ---                                                                                                                  
                             [INFO] Recompiling the module because of changed dependency.                                                                                                                        
                             [INFO] Compiling 141 source files with javac [debug deprecation release 11] to target/classes                                                                                       
                             [INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Some input files use unchecked or unsafe operations.                                   
                             [INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Recompile with -Xlint:unchecked for details.                                           
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[114,36] cannot find symbol                                                      
                               symbol:   variable MAX_DICT_ENTRIES                                                                                                                                               
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[229,73] cannot find symbol                                                      
                               symbol:   variable MAX_ENCODING_TOKENS                                                                                                                                            
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[238,34] cannot find symbol                                                      
                               symbol:   variable MAX_DUP_ENTRIES                                                                                                                                                
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[528,52] cannot find symbol                                                      
                               symbol:   variable MAX_PROCVOID_TOKENS                                                                                                                                            
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [INFO] 4 errors                                                                                                                                                                     
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  8.167 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.087 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... FAILURE [  1.940 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox ...................................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  21.302 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-27T20:14:10Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project fontbox: Compilation failure: Compilation                 
                             failure:                                                                                                                                                                            
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[114,36] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_DICT_ENTRIES                                                                                                                                       
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[229,73] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_ENCODING_TOKENS                                                                                                                                    
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[238,34] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_DUP_ENTRIES                                                                                                                                        
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[528,52] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_PROCVOID_TOKENS                                                                                                                                    
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors and possible solutions, please read the following articles:                                                                           
                             [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] After correcting the problems, you can resume the build with the command                                                                                                    
                             [ERROR]   mvn <args> -rf :fontbox                                                                                                                                                   
                             subprocess command returned a non-zero exit status: 1                                                                                                                               
                                                                                                                                                                                                                 
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_3/agent-output-1761595505.2835183/build_failed_stderr.txt: INFO:__main__:Running: docker build -t             functions.py:17
                             aixcc-afc/pdfbox:latest --file /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox/Dockerfile                                                                             
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox.                                                                                                                      
                             #0 building with "default" instance using docker driver                                                                                                                             
                                                                                                                                                                                                                 
                             #1 [internal] load build definition from Dockerfile                                                                                                                                 
                             #1 transferring dockerfile: 2.07kB done                                                                                                                                             
                             #1 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                        
                             #2 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #3 [internal] load .dockerignore                                                                                                                                                    
                             #3 transferring context: 2B done                                                                                                                                                    
                             #3 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #4 [ 1/13] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                                                                                                        
                             #4 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #5 [internal] load build context                                                                                                                                                    
                             #5 transferring context: 1.23kB done                                                                                                                                                
                             #5 DONE 0.0s                                                                                                                                                                        
                                                                                                                                                                                                                 
                             #6 [12/13] COPY build.sh /src/                                                                                                                                                      
                             #6 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #7 [10/13] COPY pkgs/pdfbox.tar.gz /src/pdfbox.tar.gz                                                                                                                               
                             #7 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #8 [ 8/13] COPY project-parent /src/project-parent/                                                                                                                                 
                             #8 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #9 [ 9/13] RUN rm -rf /src/project-parent/pdfbox                                                                                                                                    
                             #9 CACHED                                                                                                                                                                           
                                                                                                                                                                                                                 
                             #10 [ 4/13] COPY pkgs/maven.zip /src/maven.zip                                                                                                                                      
                             #10 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #11 [ 3/13] RUN mkdir /usr/my-bin && mv /usr/bin/tesseract /usr/my-bin/tesseract                                                                                                    
                             #11 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #12 [ 6/13] COPY pkgs/pdf.dict.gz /src/pdf.dict.gz                                                                                                                                  
                             #12 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #13 [11/13] RUN tar -zxf /src/pdfbox.tar.gz -C /src/project-parent && rm /src/pdfbox.tar.gz                                                                                         
                             #13 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #14 [ 5/13] RUN unzip /src/maven.zip -d /src/maven && rm /src/maven.zip                                                                                                             
                             #14 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #15 [ 2/13] RUN set -eux     && apt-get update     && apt-get install --yes --no-install-recommends         tesseract-ocr=4.1.1-2build2                                             
                             tesseract-ocr-eng=1:4.00~git30-7274cfa-1     && apt-get clean     && rm -rf /var/lib/apt/lists/*                                                                                    
                             #15 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #16 [ 7/13] RUN gunzip /src/pdf.dict.gz &&     mv /src/pdf.dict /src/PDFStreamParserFuzzer.dict &&     cp /src/PDFStreamParserFuzzer.dict                                           
                             /src/PDFWriteReadFuzzer.dict                                                                                                                                                        
                             #16 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #17 [13/13] WORKDIR /src/project-parent/pdfbox                                                                                                                                      
                             #17 CACHED                                                                                                                                                                          
                                                                                                                                                                                                                 
                             #18 exporting to image                                                                                                                                                              
                             #18 exporting layers done                                                                                                                                                           
                             #18 writing image sha256:f9dca0f812072ea8dbb9e8825c0bee11c8a4821e0a1ff9033f91feb13eea7783 done                                                                                      
                             #18 naming to docker.io/aixcc-afc/pdfbox:latest                                                                                                                                     
                             #18 naming to docker.io/aixcc-afc/pdfbox:latest done                                                                                                                                
                             #18 DONE 0.0s                                                                                                                                                                       
                             INFO:__main__:Keeping existing build artifacts as-is (if any).                                                                                                                      
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64                 
                             -e PROJECT_NAME=pdfbox -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v                                        
                             /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox:/local-source-mount:ro -v /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/:/out -v                              
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/work/pdfbox:/work -t aixcc-afc/pdfbox:latest /bin/bash -c 'pushd $SRC && rm -rf /src/project-parent/pdfbox && cp                
                             -r /local-source-mount /src/project-parent/pdfbox && popd && compile'.                                                                                                              
                             ERROR:__main__:Building fuzzers failed.                                                                                                                                             
                                                                                                                                                                                                                 
                    INFO     [logging_performance](pdfbox Patching) Took 28.86 seconds; exception=False                                                                                    context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:14:11] INFO     [logging_performance](pdfbox Setting owner) Took 0.80 seconds; exception=False                                                                                context_managers.py:23
[10/27/25 20:14:12] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:14:13] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False                                                                                context_managers.py:23
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.UNCOMPILABLE                                                                                                                                                            
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                                                                                               
                             +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                                                                                               
                             @@ -49,8 +49,12 @@                                                                                                                                                                  
                                  private Type1Font font;                                                                                                                                                        
                                                                                                                                                                                                                 
                                  /**                                                                                                                                                                            
                             -     * Parses a Type 1 font and returns a Type1Font class which represents it.                                                                                                     
                             -     *                                                                                                                                                                             
                             +public class Type1Parser                                                                                                                                                           
                             +{                                                                                                                                                                                  
                             +    private static final int MAX_DICT_ENTRIES = 10_000;                                                                                                                            
                             +    private static final int MAX_ENCODING_TOKENS = 10_000;                                                                                                                         
                             +    private static final int MAX_DUP_ENTRIES = 1_000;                                                                                                                              
                             +    private static final int MAX_PROCVOID_TOKENS = 100_000;                                                                                                                        
                                   * @param segment1 Segment 1: ASCII                                                                                                                                            
                                   * @param segment2 Segment 2: Binary                                                                                                                                           
                                   * @throws IOException                                                                                                                                                         
                             @@ -107,6 +111,9 @@                                                                                                                                                                 
                                                                                                                                                                                                                 
                                      // font dict                                                                                                                                                               
                                      int length = read(Token.INTEGER).intValue();                                                                                                                               
                             +        if (length < 0 || length > MAX_DICT_ENTRIES) {                                                                                                                             
                             +            throw new IOException("Invalid dictionary length: " + length);                                                                                                         
                             +        }                                                                                                                                                                          
                                      read(Token.NAME, "dict");                                                                                                                                                  
                                      // found in some TeX fonts                                                                                                                                                 
                                      readMaybe(Token.NAME, "dup");                                                                                                                                              
                             @@ -214,18 +221,23 @@                                                                                                                                                               
                                          // 0 1 255 {1 index exch /.notdef put } for                                                                                                                            
                                          // we have to check "readonly" and "def" too                                                                                                                           
                                          // as some fonts don't provide any dup-values, see PDFBOX-2134                                                                                                         
                             +            int encodingTokenCount = 0;                                                                                                                                            
                                          while (!(lexer.peekKind(Token.NAME)                                                                                                                                    
                             -                    && (lexer.peekToken().getText().equals("dup")                                                                                                                  
                             -                            || lexer.peekToken().getText().equals("readonly")                                                                                                      
                             -                            || lexer.peekToken().getText().equals("def"))))                                                                                                        
                             -            {                                                                                                                                                                      
                             +                    && ("dup".equals(lexer.peekToken().getText())                                                                                                                  
                             +                        || "readonly".equals(lexer.peekToken().getText())                                                                                                          
                             +                        || "def".equals(lexer.peekToken().getText())))) {                                                                                                          
                             +                if (lexer.peekToken() == null || ++encodingTokenCount > MAX_ENCODING_TOKENS) {                                                                                     
                             +                    throw new IOException("Malformed encoding: too many tokens");                                                                                                  
                             +                }                                                                                                                                                                  
                                              lexer.nextToken();                                                                                                                                                 
                                          }                                                                                                                                                                      
                                                                                                                                                                                                                 
                                          Map<Integer, String> codeToName = new HashMap<>();                                                                                                                     
                             -            while (lexer.peekKind(Token.NAME) &&                                                                                                                                   
                             -                    lexer.peekToken().getText().equals("dup"))                                                                                                                     
                             -            {                                                                                                                                                                      
                             +            int dupCount = 0;                                                                                                                                                      
                             +            while (lexer.peekKind(Token.NAME) && "dup".equals(lexer.peekToken().getText())) {                                                                                      
                             +                if (++dupCount > MAX_DUP_ENTRIES) {                                                                                                                                
                             +                    throw new IOException("Too many dup entries: " + dupCount);                                                                                                    
                             +                }                                                                                                                                                                  
                                              read(Token.NAME, "dup");                                                                                                                                           
                                              int code = read(Token.INTEGER).intValue();                                                                                                                         
                                              String name = read(Token.LITERAL).getText();                                                                                                                       
                             @@ -510,14 +522,13 @@                                                                                                                                                               
                                  private void readProcVoid() throws IOException                                                                                                                                 
                                  {                                                                                                                                                                              
                                      int openProc = 1;                                                                                                                                                          
                             -        while (true)                                                                                                                                                               
                             -        {                                                                                                                                                                          
                             -            if (lexer.peekToken() == null)                                                                                                                                         
                             -            {                                                                                                                                                                      
                             -                throw new IOException("Malformed procedure: missing token");                                                                                                       
                             -            }                                                                                                                                                                      
                             -            if (lexer.peekKind(Token.START_PROC))                                                                                                                                  
                             -            {                                                                                                                                                                      
                             +        int procTokenCount = 0;                                                                                                                                                    
                             +        while (true) {                                                                                                                                                             
                             +            Token next = lexer.peekToken();                                                                                                                                        
                             +            if (next == null || ++procTokenCount > MAX_PROCVOID_TOKENS) {                                                                                                          
                             +                throw new IOException("Malformed or too long procedure");                                                                                                          
                             +            }                                                                                                                                                                      
                             +            if (lexer.peekKind(Token.START_PROC)) {                                                                                                                                
                                              openProc++;                                                                                                                                                        
                                          }                                                                                                                                                                      
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[114,36] cannot find symbol                                                      
                               symbol:   variable MAX_DICT_ENTRIES                                                                                                                                               
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[229,73] cannot find symbol                                                      
                               symbol:   variable MAX_ENCODING_TOKENS                                                                                                                                            
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[238,34] cannot find symbol                                                      
                               symbol:   variable MAX_DUP_ENTRIES                                                                                                                                                
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[528,52] cannot find symbol                                                      
                               symbol:   variable MAX_PROCVOID_TOKENS                                                                                                                                            
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [INFO] 4 errors                                                                                                                                                                     
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  8.167 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.087 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... FAILURE [  1.940 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox ...................................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  21.302 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-27T20:14:10Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project fontbox: Compilation failure: Compilation                 
                             failure:                                                                                                                                                                            
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[114,36] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_DICT_ENTRIES                                                                                                                                       
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[229,73] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_ENCODING_TOKENS                                                                                                                                    
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[238,34] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_DUP_ENTRIES                                                                                                                                        
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[528,52] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_PROCVOID_TOKENS                                                                                                                                    
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors                                                                                                                                       
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-27 20:07:57                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f636c50c910, length=14, elements={                                                                                                                         
                             0x000055f4d1c3db70, 0x000055f4d1d48bf0, 0x000055f4d1d4a000, 0x000055f4d1d53090,                                                                                                     
                             0x000055f4d1d54410, 0x000055f4d1d557f0, 0x000055f4d1d571f0, 0x000055f4d1d586f0,                                                                                                     
                             0x000055f4d1d59b30, 0x000055f4d1d96990, 0x000055f4d1d99b00, 0x000055f4d1f173f0,                                                                                                     
                             0x00007f639c000e70, 0x000055f4d24aff50                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26751.20ms elapsed=28.73s tid=0x000055f4d1c3db70 nid=0x13 runnable  [0x00007ffcc4765000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                                                       
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                                                  
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                                                    
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.90ms elapsed=28.68s tid=0x000055f4d1d48bf0 nid=0x16 waiting on condition  [0x00007f63b39c3000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.50ms elapsed=28.68s tid=0x000055f4d1d4a000 nid=0x17 in Object.wait()  [0x00007f63b38e2000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.25ms elapsed=28.68s tid=0x000055f4d1d53090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=5.00ms elapsed=28.68s tid=0x000055f4d1d54410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.68s tid=0x000055f4d1d557f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1926.67ms elapsed=28.68s tid=0x000055f4d1d571f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=891.42ms elapsed=28.68s tid=0x000055f4d1d586f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=65.15ms elapsed=28.68s tid=0x000055f4d1d59b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.14ms elapsed=28.66s tid=0x000055f4d1d96990 nid=0x20 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.06ms elapsed=28.66s tid=0x000055f4d1d99b00 nid=0x23 in Object.wait()  [0x00007f63b241f000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.51ms elapsed=28.54s tid=0x000055f4d1f173f0 nid=0x27 waiting on condition  [0x00007f63b20d5000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x00000000894128c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.89ms elapsed=28.42s tid=0x00007f639c000e70 nid=0x3d waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.19ms elapsed=25.51s tid=0x000055f4d24aff50 nid=0x292 in Object.wait()  [0x00007f63b1daf000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.46ms elapsed=28.69s tid=0x000055f4d1d44400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=42.85ms elapsed=28.71s tid=0x000055f4d1c54da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=49.59ms elapsed=27.62s tid=0x00007f63ac0015b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=52.77ms elapsed=27.62s tid=0x00007f63ac001fb0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=42.53ms elapsed=27.62s tid=0x00007f63ac0029b0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=53.91ms elapsed=27.62s tid=0x00007f63ac0033b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=47.44ms elapsed=27.62s tid=0x00007f63ac003db0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=45.69ms elapsed=27.62s tid=0x00007f63ac0047b0 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=39.76ms elapsed=27.62s tid=0x00007f63ac0051b0 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=52.25ms elapsed=27.62s tid=0x00007f63ac005bb0 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=44.54ms elapsed=27.62s tid=0x00007f63ac0065b0 nid=0x67 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=51.24ms elapsed=27.62s tid=0x00007f63ac006fb0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=42.18ms elapsed=27.62s tid=0x00007f63ac0079b0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=53.96ms elapsed=27.62s tid=0x00007f63ac0083b0 nid=0x6a runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.84ms elapsed=28.66s tid=0x000055f4d1d98320 nid=0x21 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                                                                                                                                                                                                                 
                             A libFuzzer fuzzing run against the `PDFExtractTextFuzzer` harness timed out after approximately 28.7 seconds. The main thread remains in a RUNNABLE state,                         
                             repeatedly invoking native callbacks (`TraceDataFlowNativeCallbacks.traceConstCmpInt`) and methods within the Apache FontBox and PDFBox libraries while parsing a                   
                             Type 1 font. No crash or explicit error beyond the timeout is reported.                                                                                                             
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             - Issue                                                                                                                                                                             
                               The fuzzer execution did not complete within the allotted time and was terminated by libFuzzer with a timeout error. The attached thread dump shows the main                    
                             fuzzing thread continuously executing code in the font parsing pipeline rather than returning or hanging in a blocked state.                                                        
                                                                                                                                                                                                                 
                             - Vulnerability Type                                                                                                                                                                
                               The issue is classified as a timeout/hang during fuzzing, which may indicate a performance bottleneck or potential denial-of-service scenario when processing                     
                             certain malformed or specially crafted inputs. No memory safety error or exception is reported.                                                                                     
                                                                                                                                                                                                                 
                             - Important Observations                                                                                                                                                            
                                The main thread is RUNNABLE and consuming CPU time (over 26 seconds of CPU).                                                                                                    
                                Execution repeatedly enters `com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt` (native) immediately before                                    
                             `Type1Lexer.readToken`.                                                                                                                                                             
                                The call stack progresses through:                                                                                                                                              
                                  `org.apache.fontbox.type1.Type1Lexer.readToken`                                                                                                                               
                                  `org.apache.fontbox.type1.Type1Parser.parseASCII` and related methods                                                                                                         
                                  `org.apache.pdfbox.pdmodel.font.Type1Font.createWithPFB`                                                                                                                      
                                  `org.apache.pdfbox.pdmodel.font.PDType1Font.<init>`                                                                                                                           
                                  `org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont`                                                                                                                     
                                  Text processing in `PDFTextStripper` via `PDFStreamEngine`.                                                                                                                   
                                No thread is blocked on I/O or locks; the loop appears to be in tight parsing logic rather than waiting.                                                                        
                                                                                                                                                                                                                 
                             - Code Areas to Investigate                                                                                                                                                         
                               To understand the full context of this timeout, review the following components:                                                                                                  
                               1. Harness entry point: `com.example.PDFExtractTextFuzzer.fuzzerTestOneInput`                                                                                                     
                               2. FontBox Type 1 lexer and parser:                                                                                                                                               
                                  - `Type1Lexer.readToken`                                                                                                                                                       
                                  - `Type1Parser.parseASCII`, `Type1Parser.readEncoding`                                                                                                                         
                                  - `Type1Font.createWithPFB`                                                                                                                                                    
                               3. PDFBox font factories and resource handling:                                                                                                                                   
                                  - `PDType1Font` constructor                                                                                                                                                    
                                  - `PDFontFactory.createFont`                                                                                                                                                   
                                  - `PDResources.getFont` and related content stream operators (`SetFontAndSize`)                                                                                                
                               4. The interaction between Jazzers native callbacks (`traceConstCmpInt`) and the parsing loop.                                                                                   
                               5. Any loops or recursive logic in the ASCII Type 1 parsing code that could lead to prolonged or non-terminating execution.                                                       
                                                                                                                                                                                                                 
                             Reviewing these modules will provide a holistic view of why certain inputs can drive the parser into long-running or non-terminating behavior, leading to the                       
                             observed fuzzer timeout.                                                                                                                                                            
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-27 20:07:57                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f636c50c910, length=14, elements={                                                                                                                         
                             0x000055f4d1c3db70, 0x000055f4d1d48bf0, 0x000055f4d1d4a000, 0x000055f4d1d53090,                                                                                                     
                             0x000055f4d1d54410, 0x000055f4d1d557f0, 0x000055f4d1d571f0, 0x000055f4d1d586f0,                                                                                                     
                             0x000055f4d1d59b30, 0x000055f4d1d96990, 0x000055f4d1d99b00, 0x000055f4d1f173f0,                                                                                                     
                             0x00007f639c000e70, 0x000055f4d24aff50                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26751.20ms elapsed=28.73s tid=0x000055f4d1c3db70 nid=0x13 runnable  [0x00007ffcc4765000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                                                       
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                                                  
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                                                    
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.90ms elapsed=28.68s tid=0x000055f4d1d48bf0 nid=0x16 waiting on condition  [0x00007f63b39c3000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.50ms elapsed=28.68s tid=0x000055f4d1d4a000 nid=0x17 in Object.wait()  [0x00007f63b38e2000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.25ms elapsed=28.68s tid=0x000055f4d1d53090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=5.00ms elapsed=28.68s tid=0x000055f4d1d54410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.68s tid=0x000055f4d1d557f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1926.67ms elapsed=28.68s tid=0x000055f4d1d571f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=891.42ms elapsed=28.68s tid=0x000055f4d1d586f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=65.15ms elapsed=28.68s tid=0x000055f4d1d59b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.14ms elapsed=28.66s tid=0x000055f4d1d96990 nid=0x20 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.06ms elapsed=28.66s tid=0x000055f4d1d99b00 nid=0x23 in Object.wait()  [0x00007f63b241f000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.51ms elapsed=28.54s tid=0x000055f4d1f173f0 nid=0x27 waiting on condition  [0x00007f63b20d5000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x00000000894128c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.89ms elapsed=28.42s tid=0x00007f639c000e70 nid=0x3d waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.19ms elapsed=25.51s tid=0x000055f4d24aff50 nid=0x292 in Object.wait()  [0x00007f63b1daf000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.46ms elapsed=28.69s tid=0x000055f4d1d44400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=42.85ms elapsed=28.71s tid=0x000055f4d1c54da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=49.59ms elapsed=27.62s tid=0x00007f63ac0015b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=52.77ms elapsed=27.62s tid=0x00007f63ac001fb0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=42.53ms elapsed=27.62s tid=0x00007f63ac0029b0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=53.91ms elapsed=27.62s tid=0x00007f63ac0033b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=47.44ms elapsed=27.62s tid=0x00007f63ac003db0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=45.69ms elapsed=27.62s tid=0x00007f63ac0047b0 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=39.76ms elapsed=27.62s tid=0x00007f63ac0051b0 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=52.25ms elapsed=27.62s tid=0x00007f63ac005bb0 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=44.54ms elapsed=27.62s tid=0x00007f63ac0065b0 nid=0x67 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=51.24ms elapsed=27.62s tid=0x00007f63ac006fb0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=42.18ms elapsed=27.62s tid=0x00007f63ac0079b0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=53.96ms elapsed=27.62s tid=0x00007f63ac0083b0 nid=0x6a runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.84ms elapsed=28.66s tid=0x000055f4d1d98320 nid=0x21 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             </issue>                                                                                                                                                                            
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:75-95                                                                                                                
                             ```                                                                                                                                                                                 
                             75:        aheadToken = readToken(curToken);                                                                                                                                        
                             76:        return curToken;                                                                                                                                                         
                             77:    }                                                                                                                                                                            
                             78:                                                                                                                                                                                 
                             79:    /**                                                                                                                                                                          
                             80:     * Returns the next token without consuming it.                                                                                                                              
                             81:     * @return The next token                                                                                                                                                    
                             82:     */                                                                                                                                                                          
                             83:    public Token peekToken()                                                                                                                                                     
                             84:    {                                                                                                                                                                            
                             85:        return aheadToken;                                                                                                                                                       
                             86:    }                                                                                                                                                                            
                             87:                                                                                                                                                                                 
                             88:    /**                                                                                                                                                                          
                             89:     * Checks if the kind of the next token equals the given one without consuming it.                                                                                           
                             90:     *                                                                                                                                                                           
                             91:     * @return true if the kind of the next token equals the given one                                                                                                           
                             92:     */                                                                                                                                                                          
                             93:    public boolean peekKind(Token.Kind kind)                                                                                                                                     
                             94:    {                                                                                                                                                                            
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                                                                                               
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:75-115                                                                                                               
                             ```                                                                                                                                                                                 
                             75:        aheadToken = readToken(curToken);                                                                                                                                        
                             76:        return curToken;                                                                                                                                                         
                             77:    }                                                                                                                                                                            
                             78:                                                                                                                                                                                 
                             79:    /**                                                                                                                                                                          
                             80:     * Returns the next token without consuming it.                                                                                                                              
                             81:     * @return The next token                                                                                                                                                    
                             82:     */                                                                                                                                                                          
                             83:    public Token peekToken()                                                                                                                                                     
                             84:    {                                                                                                                                                                            
                             85:        return aheadToken;                                                                                                                                                       
                             86:    }                                                                                                                                                                            
                             87:                                                                                                                                                                                 
                             88:    /**                                                                                                                                                                          
                             89:     * Checks if the kind of the next token equals the given one without consuming it.                                                                                           
                             90:     *                                                                                                                                                                           
                             91:     * @return true if the kind of the next token equals the given one                                                                                                           
                             92:     */                                                                                                                                                                          
                             93:    public boolean peekKind(Token.Kind kind)                                                                                                                                     
                             94:    {                                                                                                                                                                            
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                                                                                               
                             96:    }                                                                                                                                                                            
                             97:                                                                                                                                                                                 
                             98:    /**                                                                                                                                                                          
                             99:     * Reads an ASCII char from the buffer.                                                                                                                                      
                             100:     */                                                                                                                                                                         
                             101:    private char getChar() throws IOException                                                                                                                                   
                             102:    {                                                                                                                                                                           
                             103:        try                                                                                                                                                                     
                             104:        {                                                                                                                                                                       
                             105:            return (char) buffer.get();                                                                                                                                         
                             106:        }                                                                                                                                                                       
                             107:        catch (BufferUnderflowException exception)                                                                                                                              
                             108:        {                                                                                                                                                                       
                             109:            throw new IOException("Premature end of buffer reached");                                                                                                           
                             110:        }                                                                                                                                                                       
                             111:    }                                                                                                                                                                           
                             112:                                                                                                                                                                                
                             113:    /**                                                                                                                                                                         
                             114:     * Reads a single token.                                                                                                                                                    
                             115:     * @param prevToken the previous token                                                                                                                                      
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:79-155                                                                                                              
                             ```                                                                                                                                                                                 
                             79:    private void parseASCII(byte[] bytes) throws IOException                                                                                                                     
                             80:    {                                                                                                                                                                            
                             81:        if (bytes.length == 0)                                                                                                                                                   
                             82:        {                                                                                                                                                                        
                             83:            throw new IOException("ASCII segment of type 1 font is empty");                                                                                                      
                             84:        }                                                                                                                                                                        
                             85:                                                                                                                                                                                 
                             86:        // %!FontType1-1.0                                                                                                                                                       
                             87:        // %!PS-AdobeFont-1.0                                                                                                                                                    
                             88:        if (bytes.length < 2 || (bytes[0] != '%' && bytes[1] != '!'))                                                                                                            
                             89:        {                                                                                                                                                                        
                             90:            throw new IOException("Invalid start of ASCII segment of type 1 font");                                                                                              
                             91:        }                                                                                                                                                                        
                             92:                                                                                                                                                                                 
                             93:        lexer = new Type1Lexer(bytes);                                                                                                                                           
                             94:                                                                                                                                                                                 
                             95:        // (corrupt?) synthetic font                                                                                                                                             
                             96:        if ("FontDirectory".equals(lexer.peekToken().getText()))                                                                                                                 
                             97:        {                                                                                                                                                                        
                             98:            read(Token.NAME, "FontDirectory");                                                                                                                                   
                             99:            read(Token.LITERAL); // font name                                                                                                                                    
                             100:            read(Token.NAME, "known");                                                                                                                                          
                             101:            read(Token.START_PROC);                                                                                                                                             
                             102:            readProcVoid();                                                                                                                                                     
                             103:            read(Token.START_PROC);                                                                                                                                             
                             104:            readProcVoid();                                                                                                                                                     
                             105:            read(Token.NAME, "ifelse");                                                                                                                                         
                             106:        }                                                                                                                                                                       
                             107:                                                                                                                                                                                
                             108:        // font dict                                                                                                                                                            
                             109:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             110:        read(Token.NAME, "dict");                                                                                                                                               
                             111:        // found in some TeX fonts                                                                                                                                              
                             112:        readMaybe(Token.NAME, "dup");                                                                                                                                           
                             113:        // if present, the "currentdict" is not required                                                                                                                        
                             114:        read(Token.NAME, "begin");                                                                                                                                              
                             115:                                                                                                                                                                                
                             116:        for (int i = 0; i < length; i++)                                                                                                                                        
                             117:        {                                                                                                                                                                       
                             118:            // premature end                                                                                                                                                    
                             119:            Token token = lexer.peekToken();                                                                                                                                    
                             120:            if (token == null)                                                                                                                                                  
                             121:            {                                                                                                                                                                   
                             122:                break;                                                                                                                                                          
                             123:            }                                                                                                                                                                   
                             124:            if (token.getKind() == Token.NAME &&                                                                                                                                
                             125:                ("currentdict".equals(token.getText()) || "end".equals(token.getText())))                                                                                       
                             126:            {                                                                                                                                                                   
                             127:                break;                                                                                                                                                          
                             128:            }                                                                                                                                                                   
                             129:                                                                                                                                                                                
                             130:            // key/value                                                                                                                                                        
                             131:            String key = read(Token.LITERAL).getText();                                                                                                                         
                             132:            switch (key)                                                                                                                                                        
                             133:            {                                                                                                                                                                   
                             134:                case "FontInfo":                                                                                                                                                
                             135:                case "Fontinfo":                                                                                                                                                
                             136:                    readFontInfo(readSimpleDict());                                                                                                                             
                             137:                    break;                                                                                                                                                      
                             138:                case "Metrics":                                                                                                                                                 
                             139:                    readSimpleDict();                                                                                                                                           
                             140:                    break;                                                                                                                                                      
                             141:                case "Encoding":                                                                                                                                                
                             142:                    readEncoding();                                                                                                                                             
                             143:                    break;                                                                                                                                                      
                             144:                default:                                                                                                                                                        
                             145:                    readSimpleValue(key);                                                                                                                                       
                             146:                    break;                                                                                                                                                      
                             147:            }                                                                                                                                                                   
                             148:        }                                                                                                                                                                       
                             149:                                                                                                                                                                                
                             150:        readMaybe(Token.NAME, "currentdict");                                                                                                                                   
                             151:        read(Token.NAME, "end");                                                                                                                                                
                             152:                                                                                                                                                                                
                             153:        read(Token.NAME, "currentfile");                                                                                                                                        
                             154:        read(Token.NAME, "eexec");                                                                                                                                              
                             155:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:192-239                                                                                                             
                             ```                                                                                                                                                                                 
                             192:    private void readEncoding() throws IOException                                                                                                                              
                             193:    {                                                                                                                                                                           
                             194:        if (lexer.peekKind(Token.NAME))                                                                                                                                         
                             195:        {                                                                                                                                                                       
                             196:            String name = lexer.nextToken().getText();                                                                                                                          
                             197:                                                                                                                                                                                
                             198:            if (name.equals("StandardEncoding"))                                                                                                                                
                             199:            {                                                                                                                                                                   
                             200:                font.encoding = StandardEncoding.INSTANCE;                                                                                                                      
                             201:            }                                                                                                                                                                   
                             202:            else                                                                                                                                                                
                             203:            {                                                                                                                                                                   
                             204:                throw new IOException("Unknown encoding: " + name);                                                                                                             
                             205:            }                                                                                                                                                                   
                             206:            readMaybe(Token.NAME, "readonly");                                                                                                                                  
                             207:            read(Token.NAME, "def");                                                                                                                                            
                             208:        }                                                                                                                                                                       
                             209:        else                                                                                                                                                                    
                             210:        {                                                                                                                                                                       
                             211:            read(Token.INTEGER).intValue();                                                                                                                                     
                             212:            readMaybe(Token.NAME, "array");                                                                                                                                     
                             213:                                                                                                                                                                                
                             214:            // 0 1 255 {1 index exch /.notdef put } for                                                                                                                         
                             215:            // we have to check "readonly" and "def" too                                                                                                                        
                             216:            // as some fonts don't provide any dup-values, see PDFBOX-2134                                                                                                      
                             217:            while (!(lexer.peekKind(Token.NAME)                                                                                                                                 
                             218:                    && (lexer.peekToken().getText().equals("dup")                                                                                                               
                             219:                            || lexer.peekToken().getText().equals("readonly")                                                                                                   
                             220:                            || lexer.peekToken().getText().equals("def"))))                                                                                                     
                             221:            {                                                                                                                                                                   
                             222:                lexer.nextToken();                                                                                                                                              
                             223:            }                                                                                                                                                                   
                             224:                                                                                                                                                                                
                             225:            Map<Integer, String> codeToName = new HashMap<>();                                                                                                                  
                             226:            while (lexer.peekKind(Token.NAME) &&                                                                                                                                
                             227:                    lexer.peekToken().getText().equals("dup"))                                                                                                                  
                             228:            {                                                                                                                                                                   
                             229:                read(Token.NAME, "dup");                                                                                                                                        
                             230:                int code = read(Token.INTEGER).intValue();                                                                                                                      
                             231:                String name = read(Token.LITERAL).getText();                                                                                                                    
                             232:                read(Token.NAME, "put");                                                                                                                                        
                             233:                codeToName.put(code, name);                                                                                                                                     
                             234:            }                                                                                                                                                                   
                             235:            font.encoding = new BuiltInEncoding(codeToName);                                                                                                                    
                             236:            readMaybe(Token.NAME, "readonly");                                                                                                                                  
                             237:            read(Token.NAME, "def");                                                                                                                                            
                             238:        }                                                                                                                                                                       
                             239:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:510-536                                                                                                             
                             ```                                                                                                                                                                                 
                             510:    private void readProcVoid() throws IOException                                                                                                                              
                             511:    {                                                                                                                                                                           
                             512:        int openProc = 1;                                                                                                                                                       
                             513:        while (true)                                                                                                                                                            
                             514:        {                                                                                                                                                                       
                             515:            if (lexer.peekToken() == null)                                                                                                                                      
                             516:            {                                                                                                                                                                   
                             517:                throw new IOException("Malformed procedure: missing token");                                                                                                    
                             518:            }                                                                                                                                                                   
                             519:            if (lexer.peekKind(Token.START_PROC))                                                                                                                               
                             520:            {                                                                                                                                                                   
                             521:                openProc++;                                                                                                                                                     
                             522:            }                                                                                                                                                                   
                             523:                                                                                                                                                                                
                             524:            Token token = lexer.nextToken();                                                                                                                                    
                             525:                                                                                                                                                                                
                             526:            if (token.getKind() == Token.END_PROC)                                                                                                                              
                             527:            {                                                                                                                                                                   
                             528:                openProc--;                                                                                                                                                     
                             529:                if (openProc == 0)                                                                                                                                              
                             530:                {                                                                                                                                                               
                             531:                    break;                                                                                                                                                      
                             532:                }                                                                                                                                                               
                             533:            }                                                                                                                                                                   
                             534:        }                                                                                                                                                                       
                             535:        readMaybe(Token.NAME, "executeonly");                                                                                                                                   
                             536:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:108-116                                                                                                             
                             ```                                                                                                                                                                                 
                             108:        // font dict                                                                                                                                                            
                             109:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             110:        read(Token.NAME, "dict");                                                                                                                                               
                             111:        // found in some TeX fonts                                                                                                                                              
                             112:        readMaybe(Token.NAME, "dup");                                                                                                                                           
                             113:        // if present, the "currentdict" is not required                                                                                                                        
                             114:        read(Token.NAME, "begin");                                                                                                                                              
                             115:                                                                                                                                                                                
                             116:        for (int i = 0; i < length; i++)                                                                                                                                        
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:192-200                                                                                                             
                             ```                                                                                                                                                                                 
                             192:    private void readEncoding() throws IOException                                                                                                                              
                             193:    {                                                                                                                                                                           
                             194:        if (lexer.peekKind(Token.NAME))                                                                                                                                         
                             195:        {                                                                                                                                                                       
                             196:            String name = lexer.nextToken().getText();                                                                                                                          
                             197:                                                                                                                                                                                
                             198:            if (name.equals("StandardEncoding"))                                                                                                                                
                             199:            {                                                                                                                                                                   
                             200:                font.encoding = StandardEncoding.INSTANCE;                                                                                                                      
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:217-224                                                                                                             
                             ```                                                                                                                                                                                 
                             217:            while (!(lexer.peekKind(Token.NAME)                                                                                                                                 
                             218:                    && (lexer.peekToken().getText().equals("dup")                                                                                                               
                             219:                            || lexer.peekToken().getText().equals("readonly")                                                                                                   
                             220:                            || lexer.peekToken().getText().equals("def"))))                                                                                                     
                             221:            {                                                                                                                                                                   
                             222:                lexer.nextToken();                                                                                                                                              
                             223:            }                                                                                                                                                                   
                             224:                                                                                                                                                                                
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:510-518                                                                                                             
                             ```                                                                                                                                                                                 
                             510:    private void readProcVoid() throws IOException                                                                                                                              
                             511:    {                                                                                                                                                                           
                             512:        int openProc = 1;                                                                                                                                                       
                             513:        while (true)                                                                                                                                                            
                             514:        {                                                                                                                                                                       
                             515:            if (lexer.peekToken() == null)                                                                                                                                      
                             516:            {                                                                                                                                                                   
                             517:                throw new IOException("Malformed procedure: missing token");                                                                                                    
                             518:            }                                                                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Introduce configurable sanity bounds in Type1Parser to prevent unbounded loops when parsing malicious or malformed Type 1 fonts. Define the following static                     
                             constants at the top of `Type1Parser` (just after class declaration):                                                                                                               
                                - MAX_DICT_ENTRIES (e.g., 10_000)                                                                                                                                                
                                - MAX_ENCODING_TOKENS (e.g., 10_000)                                                                                                                                             
                                - MAX_DUP_ENTRIES (e.g., 1_000)                                                                                                                                                  
                                - MAX_PROCVOID_TOKENS (e.g., 100_000)                                                                                                                                            
                                                                                                                                                                                                                 
                             2. Patch parseASCII to validate the length integer before entering the main dictionary loop:                                                                                      
                                - After reading `int length = read(Token.INTEGER).intValue();`, add:                                                                                                             
                                  ```                                                                                                                                                                            
                                  if (length < 0 || length > MAX_DICT_ENTRIES) {                                                                                                                                 
                                      throw new IOException("Invalid dictionary length: " + length);                                                                                                             
                                  }                                                                                                                                                                              
                                  ```                                                                                                                                                                            
                                This ensures that a huge or negative length does not drive an excessively long or infinite loop.                                                                                 
                                                                                                                                                                                                                 
                             3. Harden readEncoding with early-exit and token-count checks:                                                                                                                      
                                a. For the first loop that scans to the next `dup`/`readonly`/`def` token:                                                                                                       
                                   - Initialize `int encodingTokenCount = 0;` before the loop.                                                                                                                   
                                   - Change the loop to:                                                                                                                                                         
                                     ```                                                                                                                                                                         
                                     while (!(lexer.peekKind(Token.NAME)                                                                                                                                         
                                             && ("dup".equals(lexer.peekToken().getText())                                                                                                                       
                                                 || "readonly".equals(lexer.peekToken().getText())                                                                                                               
                                                 || "def".equals(lexer.peekToken().getText()))) ) {                                                                                                              
                                         if (lexer.peekToken() == null || ++encodingTokenCount > MAX_ENCODING_TOKENS) {                                                                                          
                                             throw new IOException("Malformed encoding: too many tokens");                                                                                                       
                                         }                                                                                                                                                                       
                                         lexer.nextToken();                                                                                                                                                      
                                     }                                                                                                                                                                           
                                     ```                                                                                                                                                                         
                                b. For the second loop that processes `dup` entries:                                                                                                                             
                                   - Initialize `int dupCount = 0;` before the loop.                                                                                                                             
                                   - Change the loop to:                                                                                                                                                         
                                     ```                                                                                                                                                                         
                                     while (lexer.peekKind(Token.NAME) && "dup".equals(lexer.peekToken().getText())) {                                                                                           
                                         if (++dupCount > MAX_DUP_ENTRIES) {                                                                                                                                     
                                             throw new IOException("Too many dup entries: " + dupCount);                                                                                                         
                                         }                                                                                                                                                                       
                                         read(Token.NAME, "dup");                                                                                                                                                
                                         int code = read(Token.INTEGER).intValue();                                                                                                                              
                                         String name = read(Token.LITERAL).getText();                                                                                                                            
                                         read(Token.NAME, "put");                                                                                                                                                
                                         codeToName.put(code, name);                                                                                                                                             
                                     }                                                                                                                                                                           
                                     ```                                                                                                                                                                         
                                This prevents infinite scanning on malformed encoding definitions and limits the number of duplicate entries parsed.                                                             
                                                                                                                                                                                                                 
                             4. Enhance readProcVoid to abort on excessively long or unterminated procedures:                                                                                                    
                                - Before the `while (true)` loop, initialize `int procTokenCount = 0;`.                                                                                                          
                                - Inside the loop, at the top:                                                                                                                                                   
                                  ```                                                                                                                                                                            
                                  Token next = lexer.peekToken();                                                                                                                                                
                                  if (next == null || ++procTokenCount > MAX_PROCVOID_TOKENS) {                                                                                                                  
                                      throw new IOException("Malformed or too long procedure");                                                                                                                  
                                  }                                                                                                                                                                              
                                  ```                                                                                                                                                                            
                                This guarantees that missing or unbalanced procedure delimiters (`{` and `}`) cannot spin the parser indefinitely.                                                               
                                                                                                                                                                                                                 
                             5. Preserve original logic and error semantics:                                                                                                                                     
                                - All new checks throw `IOException`, consistent with existing malformed-font errors.                                                                                            
                                - Real-world fonts with typical dictionary sizes, encoding definitions, and procedures will not approach these bounds and thus remain unaffected.                                
                                - The constants can be tuned based on observed legitimate font characteristics or exposed via system properties if future flexibility is required.                               
                                                                                                                                                                                                                 
                             6. Testing and validation:                                                                                                                                                          
                                - Add unit tests with synthetic Type 1 font data that exercise:                                                                                                                  
                                   A very large length value (exceeds MAX_DICT_ENTRIES).                                                                                                                        
                                   Encoding data with no `dup`/`def`/`readonly` tokens.                                                                                                                         
                                   An encoding section with an excessive number of `dup` entries.                                                                                                               
                                   An unterminated procedure missing matching `}`.                                                                                                                              
                                - Confirm that each of these malformed inputs fails fast with an `IOException`.                                                                                                  
                                - Verify that well-formed Type 1 fonts from the existing test suite continue to parse successfully and that no existing tests break.                                             
                                                                                                                                                                                                                 
                             Justification:                                                                                                                                                                      
                             - The root cause of the fuzzer timeout is unbounded loops in Type1Parser when encountering large or malformed integer fields and encoding/procedure constructs. By                  
                             bounding these loops, we ensure prompt failure rather than prolonged CPU consumption.                                                                                               
                             - This approach maintains all original parsing capabilities for valid fonts, only rejecting edge cases that risk denial-of-service.                                                 
                             - Similar loop bounds exist in other parts of the codebase (e.g., CFFParser), so introducing these limits is consistent with existing practices.                                    
                             - No changes are made to harness code, utilities, or external dependenciesonly the parser logic is hardened.                                                                       
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Evaluation End===                                                                                                                                                                
[10/27/25 20:14:28] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                                                                                                  __init__.py:160
                             (n evals: 2, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
[10/27/25 20:15:43] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                                                                                                     __init__.py:160
                             (n evals: 2, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
[10/27/25 20:17:27] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                                                                                                    __init__.py:160
                             (n evals: 2, patch status: PatchStatus.UNCOMPILABLE)                                                                                                                                
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:17:28] INFO     [logging_performance](pdfbox Setting owner) Took 0.89 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Patching) Started...                                                                                                              context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpfxrntei0                                                                                                                                 default.py:173
[10/27/25 20:18:26] INFO     [logging_performance](pdfbox Patching) Took 57.43 seconds; exception=False                                                                                    context_managers.py:23
                    INFO     [logging_performance](pdfbox Checking build) Started...                                                                                                        context_managers.py:9
[10/27/25 20:18:40] INFO     [logging_performance](pdfbox Checking build) Took 14.43 seconds; exception=False                                                                              context_managers.py:23
                    INFO     [logging_performance](pdfbox Running PoV) Started...                                                                                                           context_managers.py:9
[10/27/25 20:18:46] INFO     [logging_performance](pdfbox Running PoV) Took 6.06 seconds; exception=False                                                                                  context_managers.py:23
                    INFO     [logging_performance](pdfbox Testing) Started...                                                                                                               context_managers.py:9
                    INFO     [logging_performance](pdfbox Testing) Took 0.00 seconds; exception=False                                                                                      context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:18:47] INFO     [logging_performance](pdfbox Setting owner) Took 0.81 seconds; exception=False                                                                                context_managers.py:23
[10/27/25 20:18:48] INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:18:49] INFO     [logging_performance](pdfbox Setting owner) Took 0.83 seconds; exception=False                                                                                context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                                                                                                         context_managers.py:9
[10/27/25 20:18:50] INFO     [logging_performance](pdfbox Setting owner) Took 0.94 seconds; exception=False                                                                                context_managers.py:23
                    INFO     ===Evaluator Result===                                                                                                                                              evaluator.py:204
                             PatchStatus.SOUND                                                                                                                                                                   
                             ===Evaluator Diff===                                                                                                                                                                
                             --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                                                                                               
                             +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                                                                                               
                             @@ -44,6 +44,11 @@                                                                                                                                                                  
                                  private static final int EEXEC_KEY = 55665;                                                                                                                                    
                                  private static final int CHARSTRING_KEY = 4330;                                                                                                                                
                                                                                                                                                                                                                 
                             +    // limits to prevent unbounded loops in Type 1 parsing                                                                                                                         
                             +    private static final int MAX_DICT_ENTRIES    = 10_000;                                                                                                                         
                             +    private static final int MAX_ENCODING_TOKENS = 10_000;                                                                                                                         
                             +    private static final int MAX_DUP_ENTRIES     = 1_000;                                                                                                                          
                             +    private static final int MAX_PROCVOID_TOKENS = 100_000;                                                                                                                        
                                  // state                                                                                                                                                                       
                                  private Type1Lexer lexer;                                                                                                                                                      
                                  private Type1Font font;                                                                                                                                                        
                             @@ -107,6 +112,9 @@                                                                                                                                                                 
                                                                                                                                                                                                                 
                                      // font dict                                                                                                                                                               
                                      int length = read(Token.INTEGER).intValue();                                                                                                                               
                             +        if (length < 0 || length > MAX_DICT_ENTRIES) {                                                                                                                             
                             +            throw new IOException("Invalid dictionary length: " + length);                                                                                                         
                             +        }                                                                                                                                                                          
                                      read(Token.NAME, "dict");                                                                                                                                                  
                                      // found in some TeX fonts                                                                                                                                                 
                                      readMaybe(Token.NAME, "dup");                                                                                                                                              
                             @@ -214,18 +222,23 @@                                                                                                                                                               
                                          // 0 1 255 {1 index exch /.notdef put } for                                                                                                                            
                                          // we have to check "readonly" and "def" too                                                                                                                           
                                          // as some fonts don't provide any dup-values, see PDFBOX-2134                                                                                                         
                             +            int encodingTokenCount = 0;                                                                                                                                            
                                          while (!(lexer.peekKind(Token.NAME)                                                                                                                                    
                             -                    && (lexer.peekToken().getText().equals("dup")                                                                                                                  
                             -                            || lexer.peekToken().getText().equals("readonly")                                                                                                      
                             -                            || lexer.peekToken().getText().equals("def"))))                                                                                                        
                             -            {                                                                                                                                                                      
                             +                    && ("dup".equals(lexer.peekToken().getText())                                                                                                                  
                             +                        || "readonly".equals(lexer.peekToken().getText())                                                                                                          
                             +                        || "def".equals(lexer.peekToken().getText())))) {                                                                                                          
                             +                if (lexer.peekToken() == null || ++encodingTokenCount > MAX_ENCODING_TOKENS) {                                                                                     
                             +                    throw new IOException("Malformed encoding: too many tokens");                                                                                                  
                             +                }                                                                                                                                                                  
                                              lexer.nextToken();                                                                                                                                                 
                                          }                                                                                                                                                                      
                                                                                                                                                                                                                 
                                          Map<Integer, String> codeToName = new HashMap<>();                                                                                                                     
                             -            while (lexer.peekKind(Token.NAME) &&                                                                                                                                   
                             -                    lexer.peekToken().getText().equals("dup"))                                                                                                                     
                             -            {                                                                                                                                                                      
                             +            int dupCount = 0;                                                                                                                                                      
                             +            while (lexer.peekKind(Token.NAME) && "dup".equals(lexer.peekToken().getText())) {                                                                                      
                             +                if (++dupCount > MAX_DUP_ENTRIES) {                                                                                                                                
                             +                    throw new IOException("Too many dup entries: " + dupCount);                                                                                                    
                             +                }                                                                                                                                                                  
                                              read(Token.NAME, "dup");                                                                                                                                           
                                              int code = read(Token.INTEGER).intValue();                                                                                                                         
                                              String name = read(Token.LITERAL).getText();                                                                                                                       
                             @@ -510,14 +523,13 @@                                                                                                                                                               
                                  private void readProcVoid() throws IOException                                                                                                                                 
                                  {                                                                                                                                                                              
                                      int openProc = 1;                                                                                                                                                          
                             -        while (true)                                                                                                                                                               
                             -        {                                                                                                                                                                          
                             -            if (lexer.peekToken() == null)                                                                                                                                         
                             -            {                                                                                                                                                                      
                             -                throw new IOException("Malformed procedure: missing token");                                                                                                       
                             -            }                                                                                                                                                                      
                             -            if (lexer.peekKind(Token.START_PROC))                                                                                                                                  
                             -            {                                                                                                                                                                      
                             +        int procTokenCount = 0;                                                                                                                                                    
                             +        while (true) {                                                                                                                                                             
                             +            Token next = lexer.peekToken();                                                                                                                                        
                             +            if (next == null || ++procTokenCount > MAX_PROCVOID_TOKENS) {                                                                                                          
                             +                throw new IOException("Malformed or too long procedure");                                                                                                          
                             +            }                                                                                                                                                                      
                             +            if (lexer.peekKind(Token.START_PROC)) {                                                                                                                                
                                              openProc++;                                                                                                                                                        
                                          }                                                                                                                                                                      
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Patch Result===                                                                                                                                                                  
                                                                                                                                                                                                                 
                             ===Issue===                                                                                                                                                                         
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-27 20:07:57                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f636c50c910, length=14, elements={                                                                                                                         
                             0x000055f4d1c3db70, 0x000055f4d1d48bf0, 0x000055f4d1d4a000, 0x000055f4d1d53090,                                                                                                     
                             0x000055f4d1d54410, 0x000055f4d1d557f0, 0x000055f4d1d571f0, 0x000055f4d1d586f0,                                                                                                     
                             0x000055f4d1d59b30, 0x000055f4d1d96990, 0x000055f4d1d99b00, 0x000055f4d1f173f0,                                                                                                     
                             0x00007f639c000e70, 0x000055f4d24aff50                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26751.20ms elapsed=28.73s tid=0x000055f4d1c3db70 nid=0x13 runnable  [0x00007ffcc4765000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                                                       
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                                                  
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                                                    
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.90ms elapsed=28.68s tid=0x000055f4d1d48bf0 nid=0x16 waiting on condition  [0x00007f63b39c3000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.50ms elapsed=28.68s tid=0x000055f4d1d4a000 nid=0x17 in Object.wait()  [0x00007f63b38e2000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.25ms elapsed=28.68s tid=0x000055f4d1d53090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=5.00ms elapsed=28.68s tid=0x000055f4d1d54410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.68s tid=0x000055f4d1d557f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1926.67ms elapsed=28.68s tid=0x000055f4d1d571f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=891.42ms elapsed=28.68s tid=0x000055f4d1d586f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=65.15ms elapsed=28.68s tid=0x000055f4d1d59b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.14ms elapsed=28.66s tid=0x000055f4d1d96990 nid=0x20 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.06ms elapsed=28.66s tid=0x000055f4d1d99b00 nid=0x23 in Object.wait()  [0x00007f63b241f000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.51ms elapsed=28.54s tid=0x000055f4d1f173f0 nid=0x27 waiting on condition  [0x00007f63b20d5000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x00000000894128c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.89ms elapsed=28.42s tid=0x00007f639c000e70 nid=0x3d waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.19ms elapsed=25.51s tid=0x000055f4d24aff50 nid=0x292 in Object.wait()  [0x00007f63b1daf000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.46ms elapsed=28.69s tid=0x000055f4d1d44400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=42.85ms elapsed=28.71s tid=0x000055f4d1c54da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=49.59ms elapsed=27.62s tid=0x00007f63ac0015b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=52.77ms elapsed=27.62s tid=0x00007f63ac001fb0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=42.53ms elapsed=27.62s tid=0x00007f63ac0029b0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=53.91ms elapsed=27.62s tid=0x00007f63ac0033b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=47.44ms elapsed=27.62s tid=0x00007f63ac003db0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=45.69ms elapsed=27.62s tid=0x00007f63ac0047b0 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=39.76ms elapsed=27.62s tid=0x00007f63ac0051b0 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=52.25ms elapsed=27.62s tid=0x00007f63ac005bb0 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=44.54ms elapsed=27.62s tid=0x00007f63ac0065b0 nid=0x67 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=51.24ms elapsed=27.62s tid=0x00007f63ac006fb0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=42.18ms elapsed=27.62s tid=0x00007f63ac0079b0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=53.96ms elapsed=27.62s tid=0x00007f63ac0083b0 nid=0x6a runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.84ms elapsed=28.66s tid=0x000055f4d1d98320 nid=0x21 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ===Evaluation Report===                                                                                                                                                             
                             # Evaluation Report                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Summary                                                                                                                                                                          
                             A libFuzzer run against PDF text extraction hung and timed out while parsing a Type 1 font. The stack trace shows the fuzzer stuck in                                               
                             `Type1Parser.readToken`/`Type1Parser.readEncoding`, spinning on input that never satisfies loop exit conditions. To prevent unbounded loops, a patch was attempted                  
                             that adds constants (`MAX_DICT_ENTRIES`, `MAX_ENCODING_TOKENS`, `MAX_DUP_ENTRIES`, `MAX_PROCVOID_TOKENS`) and checks counts in several loops. After applying the                    
                             patch, the `fontbox` module fails to compile with cannot find symbol errors for the newly introduced constants, indicating they were not declared in the correct                  
                             scope or file.                                                                                                                                                                      
                                                                                                                                                                                                                 
                             ## Description                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Initial Issue                                                                                                                                                                    
                                - The fuzz target (`PDFExtractTextFuzzer`) invokes PDFBoxs text stripper on a synthetic PDF containing a Type 1 font.                                                           
                                - The fuzzer run ends with `ERROR: libFuzzer: timeout` after ~28 s.                                                                                                              
                                - The Java thread dump shows the main thread in a busy loop inside `Type1Parser` methods (`readToken`, `readEncoding`, etc.), indicating unbounded token                       
                             consumption or missing loop exits when parsing malformed or adversarial input.                                                                                                      
                                - No exceptions are thrown; the parser never completes, causing the overall harness to stall.                                                                                    
                                                                                                                                                                                                                 
                             2. Important Observations                                                                                                                                                           
                                - Hanging occurs deep in the FontBox Type 1 parsing code, not in the fuzz harness.                                                                                               
                                - Several loops in `Type1Parser` (`readEncoding` token accumulation, dup entry loop, `readProcVoid`) have no guard against excessively long or endless                         
                             sequences.                                                                                                                                                                          
                                - The fuzzers instrumentation callback (`traceConstCmpInt`) appears because of coverage tracking but is not the root cause.                                                     
                                                                                                                                                                                                                 
                             3. Patch Attempt                                                                                                                                                                    
                                - Introduce four new `static final` limits in `Type1Parser`:                                                                                                                     
                                   MAX_DICT_ENTRIES = 10_000                                                                                                                                                    
                                   MAX_ENCODING_TOKENS = 10_000                                                                                                                                                 
                                   MAX_DUP_ENTRIES = 1_000                                                                                                                                                      
                                   MAX_PROCVOID_TOKENS = 100_000                                                                                                                                                
                                - In the dictionary parsing section, throw if `length < 0 || length > MAX_DICT_ENTRIES`.                                                                                         
                                - In the encoding token loop, count tokens and throw if count exceeds `MAX_ENCODING_TOKENS`.                                                                                     
                                - In the dup loop, count entries and throw after `MAX_DUP_ENTRIES`.                                                                                                            
                                - In `readProcVoid`, count tokens and throw if count exceeds `MAX_PROCVOID_TOKENS` or if EOF is reached.                                                                         
                                                                                                                                                                                                                 
                             4. Patch Result / Compilation Log                                                                                                                                                   
                                - Compilation fails in `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java` with four cannot find symbol errors for each `MAX_*` constant.                        
                                - The errors refer to usages at lines corresponding to the new checks.                                                                                                           
                                - This indicates that the constants were not in scopeeither the declarations were misplaced (e.g., inside a Javadoc or method) or the class was redefined                       
                             incorrectly.                                                                                                                                                                        
                                                                                                                                                                                                                 
                             5. Areas for Further Investigation                                                                                                                                                  
                                - Verify the placement of the `static final` declarations: they must reside directly inside the `Type1Parser` class body, not inside a Javadoc, method, or                       
                             nested block.                                                                                                                                                                       
                                - Check that the files `package` and `import` statements were not disrupted by the patch.                                                                                       
                                - Review the diff hunk around line 49 of `Type1Parser.java` to ensure only one `public class Type1Parser` declaration exists and that the constants are declared                 
                             outside any methods.                                                                                                                                                                
                                - Examine adjacent code in the repository to confirm no merge conflicts or formatting issues moved or deleted the constant definitions.                                          
                                - Audit other loops in `Type1Parser` for similar unbounded behaviour (e.g., whitespace skipping, token lookahead) to create a consistent strategy for                            
                             loop-termination and error reporting.                                                                                                                                               
                                                                                                                                                                                                                 
                             ## Initial Issue Log                                                                                                                                                                
                             Here is the initial issue log of the codebase:                                                                                                                                      
                             <issue>                                                                                                                                                                             
                             ERROR: libFuzzer: timeout                                                                                                                                                           
                             2025-10-27 20:07:57                                                                                                                                                                 
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                                                                                                        
                                                                                                                                                                                                                 
                             Threads class SMR info:                                                                                                                                                             
                             _java_thread_list=0x00007f636c50c910, length=14, elements={                                                                                                                         
                             0x000055f4d1c3db70, 0x000055f4d1d48bf0, 0x000055f4d1d4a000, 0x000055f4d1d53090,                                                                                                     
                             0x000055f4d1d54410, 0x000055f4d1d557f0, 0x000055f4d1d571f0, 0x000055f4d1d586f0,                                                                                                     
                             0x000055f4d1d59b30, 0x000055f4d1d96990, 0x000055f4d1d99b00, 0x000055f4d1f173f0,                                                                                                     
                             0x00007f639c000e70, 0x000055f4d24aff50                                                                                                                                              
                             }                                                                                                                                                                                   
                                                                                                                                                                                                                 
                             "main" #1 prio=5 os_prio=0 cpu=26751.20ms elapsed=28.73s tid=0x000055f4d1c3db70 nid=0x13 runnable  [0x00007ffcc4765000]                                                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Native Method)                                                                        
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                                                                                                       
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                                                                                                        
                                     at org.apache.fontbox.type1.Type1Parser.readEncoding(Type1Parser.java:222)                                                                                                  
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:142)                                                                                                    
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                                                                                                          
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                                                                                                      
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                                                                                                  
                                     at org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                                                                                          
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                                                                                                      
                                     at org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.java:72)                                                                             
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:924)                                                                                
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine.java:557)                                                                         
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515)                                                                                  
                                     at org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                                                                                    
                                     at org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:153)                                                                                 
                                     at org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                                                                                             
                                     at org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                                                                                            
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                                                                                               
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                                                                                                 
                                     at com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                                                                                        
                                     at java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/LambdaForm$DMH)                                                                     
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$MH)                                                                                 
                                     at java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaForm$MH)                                                                              
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                                                                                   
                                     at com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native Method)                                                                               
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:551)                                                                           
                                     at com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.java:441)                                                                           
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                                                                                                        
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                                                                                               
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                                                                                                 
                                                                                                                                                                                                                 
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.90ms elapsed=28.68s tid=0x000055f4d1d48bf0 nid=0x16 waiting on condition  [0x00007f63b39c3000]                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native Method)                                                                                      
                                     at java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                                                                                    
                                     at java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                                                                                        
                                                                                                                                                                                                                 
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.50ms elapsed=28.68s tid=0x000055f4d1d4a000 nid=0x17 in Object.wait()  [0x00007f63b38e2000]                                             
                                java.lang.Thread.State: WAITING (on object monitor)                                                                                                                              
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                                                                                            
                                     at java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                                                                                         
                                                                                                                                                                                                                 
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.25ms elapsed=28.68s tid=0x000055f4d1d53090 nid=0x18 waiting on condition  [0x0000000000000000]                                 
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=5.00ms elapsed=28.68s tid=0x000055f4d1d54410 nid=0x19 runnable  [0x0000000000000000]                                                
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.57ms elapsed=28.68s tid=0x000055f4d1d557f0 nid=0x1a runnable  [0x0000000000000000]                                      
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1926.67ms elapsed=28.68s tid=0x000055f4d1d571f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=891.42ms elapsed=28.68s tid=0x000055f4d1d586f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                No compile task                                                                                                                                                                  
                                                                                                                                                                                                                 
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=65.15ms elapsed=28.68s tid=0x000055f4d1d59b30 nid=0x1d runnable  [0x0000000000000000]                                              
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.14ms elapsed=28.66s tid=0x000055f4d1d96990 nid=0x20 runnable  [0x0000000000000000]                                          
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=1.06ms elapsed=28.66s tid=0x000055f4d1d99b00 nid=0x23 in Object.wait()  [0x00007f63b241f000]                                       
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x000000008941c178> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.51ms elapsed=28.54s tid=0x000055f4d1f173f0 nid=0x27 waiting on condition  [0x00007f63b20d5000]                                  
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                                                                                                  
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                                                                                                            
                                     - parking to wait for  <0x00000000894128c0> (a java.util.concurrent.SynchronousQueue$TransferStack)                                                                         
                                     at java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252)                                                                                  
                                     at java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/SynchronousQueue.java:401)                                                                 
                                     at java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                                                                                   
                                     at java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.java:1061)                                                                           
                                     at java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.java:1122)                                                                         
                                     at java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor.java:635)                                                                         
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                                                                                                                                                                                                 
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.89ms elapsed=28.42s tid=0x00007f639c000e70 nid=0x3d waiting on condition  [0x0000000000000000]                                  
                                java.lang.Thread.State: RUNNABLE                                                                                                                                                 
                                                                                                                                                                                                                 
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.19ms elapsed=25.51s tid=0x000055f4d24aff50 nid=0x292 in Object.wait()  [0x00007f63b1daf000]                                          
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                                                                                                        
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                                                                                                    
                                     - waiting on <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                     
                                     at java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                                                                                            
                                     - locked <0x00000000f6010280> (a java.lang.ref.ReferenceQueue$Lock)                                                                                                         
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                                                                                                  
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                                                                                                   
                                     at jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                                                                                         
                                                                                                                                                                                                                 
                             "VM Thread" os_prio=0 cpu=55.46ms elapsed=28.69s tid=0x000055f4d1d44400 nid=0x15 runnable                                                                                           
                                                                                                                                                                                                                 
                             "GC Thread#0" os_prio=0 cpu=42.85ms elapsed=28.71s tid=0x000055f4d1c54da0 nid=0x14 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#1" os_prio=0 cpu=49.59ms elapsed=27.62s tid=0x00007f63ac0015b0 nid=0x5f runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#2" os_prio=0 cpu=52.77ms elapsed=27.62s tid=0x00007f63ac001fb0 nid=0x60 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#3" os_prio=0 cpu=42.53ms elapsed=27.62s tid=0x00007f63ac0029b0 nid=0x61 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#4" os_prio=0 cpu=53.91ms elapsed=27.62s tid=0x00007f63ac0033b0 nid=0x62 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#5" os_prio=0 cpu=47.44ms elapsed=27.62s tid=0x00007f63ac003db0 nid=0x63 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#6" os_prio=0 cpu=45.69ms elapsed=27.62s tid=0x00007f63ac0047b0 nid=0x64 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#7" os_prio=0 cpu=39.76ms elapsed=27.62s tid=0x00007f63ac0051b0 nid=0x65 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#8" os_prio=0 cpu=52.25ms elapsed=27.62s tid=0x00007f63ac005bb0 nid=0x66 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#9" os_prio=0 cpu=44.54ms elapsed=27.62s tid=0x00007f63ac0065b0 nid=0x67 runnable                                                                                         
                                                                                                                                                                                                                 
                             "GC Thread#10" os_prio=0 cpu=51.24ms elapsed=27.62s tid=0x00007f63ac006fb0 nid=0x68 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#11" os_prio=0 cpu=42.18ms elapsed=27.62s tid=0x00007f63ac0079b0 nid=0x69 runnable                                                                                        
                                                                                                                                                                                                                 
                             "GC Thread#12" os_prio=0 cpu=53.96ms elapsed=27.62s tid=0x00007f63ac0083b0 nid=0x6a runnable                                                                                        
                                                                                                                                                                                                                 
                             "VM Periodic Task Thread" os_prio=0 cpu=9.84ms elapsed=28.66s tid=0x000055f4d1d98320 nid=0x21 waiting on condition                                                                  
                                                                                                                                                                                                                 
                             JNI global refs: 20, weak refs: 0                                                                                                                                                   
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
                             </issue>                                                                                                                                                                            
                                                                                                                                                                                                                 
                             ## Additional Issue Log                                                                                                                                                             
                             Here is the additional issue log after the last patch attempt:                                                                                                                      
                             <additional_issue>                                                                                                                                                                  
                             [ERROR] COMPILATION ERROR :                                                                                                                                                         
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[114,36] cannot find symbol                                                      
                               symbol:   variable MAX_DICT_ENTRIES                                                                                                                                               
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[229,73] cannot find symbol                                                      
                               symbol:   variable MAX_ENCODING_TOKENS                                                                                                                                            
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[238,34] cannot find symbol                                                      
                               symbol:   variable MAX_DUP_ENTRIES                                                                                                                                                
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[528,52] cannot find symbol                                                      
                               symbol:   variable MAX_PROCVOID_TOKENS                                                                                                                                            
                               location: class org.apache.fontbox.type1.Type1Parser                                                                                                                              
                             [INFO] 4 errors                                                                                                                                                                     
                             [INFO] -------------------------------------------------------------                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                                                                                                           
                             [INFO]                                                                                                                                                                              
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  8.167 s]                                                                                                     
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.087 s]                                                                                                     
                             [INFO] Apache FontBox ..................................... FAILURE [  1.940 s]                                                                                                     
                             [INFO] Apache XmpBox ...................................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox ...................................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox application .......................... SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                                                                                                 
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                                                                                                 
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                                                                                                 
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] BUILD FAILURE                                                                                                                                                                
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [INFO] Total time:  21.302 s                                                                                                                                                        
                             [INFO] Finished at: 2025-10-27T20:14:10Z                                                                                                                                            
                             [INFO] ------------------------------------------------------------------------                                                                                                     
                             [ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project fontbox: Compilation failure: Compilation                 
                             failure:                                                                                                                                                                            
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[114,36] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_DICT_ENTRIES                                                                                                                                       
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[229,73] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_ENCODING_TOKENS                                                                                                                                    
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[238,34] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_DUP_ENTRIES                                                                                                                                        
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:[528,52] cannot find symbol                                                      
                             [ERROR]   symbol:   variable MAX_PROCVOID_TOKENS                                                                                                                                    
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Parser                                                                                                                      
                             [ERROR] -> [Help 1]                                                                                                                                                                 
                             [ERROR]                                                                                                                                                                             
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                                                                                                 
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                                                                                              
                             [ERROR]                                                                                                                                                                             
                             [ERROR] For more information about the errors                                                                                                                                       
                             </additional_issue>                                                                                                                                                                 
                                                                                                                                                                                                                 
                             ## Notes                                                                                                                                                                            
                             - All patch attempts are applied to the initial codebase. Reapply the the previous patches if needed.                                                                               
                             - If multiple different issues are present, all the issues must be resolved in a single patch attempt.                                                                              
                             - Try different approaches to resolve the issues.                                                                                                                                   
                             ===Analysis Report===                                                                                                                                                               
                             # Analysis Report                                                                                                                                                                   
                                                                                                                                                                                                                 
                             ## Relevant Code Snippets                                                                                                                                                           
                             <code_snippets>                                                                                                                                                                     
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:1-80                                                                                                                
                             ```                                                                                                                                                                                 
                             1:/*                                                                                                                                                                                
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                                                             
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                                                          
                             4: * this work for additional information regarding copyright ownership.                                                                                                            
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                                                        
                             6: * (the "License"); you may not use this file except in compliance with                                                                                                           
                             7: * the License.  You may obtain a copy of the License at                                                                                                                          
                             8: *                                                                                                                                                                                
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                
                             10: *                                                                                                                                                                               
                             11: * Unless required by applicable law or agreed to in writing, software                                                                                                           
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                                                                                             
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                                                                      
                             14: * See the License for the specific language governing permissions and                                                                                                           
                             15: * limitations under the License.                                                                                                                                                
                             16: */                                                                                                                                                                              
                             17:                                                                                                                                                                                 
                             18:package org.apache.fontbox.type1;                                                                                                                                                
                             19:                                                                                                                                                                                 
                             20:import org.apache.fontbox.encoding.BuiltInEncoding;                                                                                                                              
                             21:import org.apache.fontbox.encoding.StandardEncoding;                                                                                                                             
                             22:                                                                                                                                                                                 
                             23:import java.io.IOException;                                                                                                                                                      
                             24:import java.util.ArrayList;                                                                                                                                                      
                             25:import java.util.HashMap;                                                                                                                                                        
                             26:import java.util.List;                                                                                                                                                           
                             27:import java.util.Map;                                                                                                                                                            
                             28:                                                                                                                                                                                 
                             29:/**                                                                                                                                                                              
                             30: * Parses an Adobe Type 1 (.pfb) font. It is used exclusively by Type1Font.                                                                                                      
                             31: *                                                                                                                                                                               
                             32: * The Type 1 font format is a free-text format which is somewhat difficult                                                                                                      
                             33: * to parse. This is made worse by the fact that many Type 1 font files do                                                                                                       
                             34: * not conform to the specification, especially those embedded in PDFs. This                                                                                                     
                             35: * parser therefore tries to be as forgiving as possible.                                                                                                                        
                             36: *                                                                                                                                                                               
                             37: * @see "Adobe Type 1 Font Format, Adobe Systems (1999)"                                                                                                                         
                             38: *                                                                                                                                                                               
                             39: * @author John Hewson                                                                                                                                                           
                             40: */                                                                                                                                                                              
                             41:final class Type1Parser                                                                                                                                                          
                             42:{                                                                                                                                                                                
                             43:    // constants for encryption                                                                                                                                                  
                             44:    private static final int EEXEC_KEY = 55665;                                                                                                                                  
                             45:    private static final int CHARSTRING_KEY = 4330;                                                                                                                              
                             46:                                                                                                                                                                                 
                             47:    // state                                                                                                                                                                     
                             48:    private Type1Lexer lexer;                                                                                                                                                    
                             49:    private Type1Font font;                                                                                                                                                      
                             50:                                                                                                                                                                                 
                             51:    /**                                                                                                                                                                          
                             52:     * Parses a Type 1 font and returns a Type1Font class which represents it.                                                                                                   
                             53:     *                                                                                                                                                                           
                             54:     * @param segment1 Segment 1: ASCII                                                                                                                                          
                             55:     * @param segment2 Segment 2: Binary                                                                                                                                         
                             56:     * @throws IOException                                                                                                                                                       
                             57:     */                                                                                                                                                                          
                             58:    public Type1Font parse(byte[] segment1, byte[] segment2) throws IOException                                                                                                  
                             59:    {                                                                                                                                                                            
                             60:        font = new Type1Font(segment1, segment2);                                                                                                                                
                             61:        try                                                                                                                                                                      
                             62:        {                                                                                                                                                                        
                             63:            parseASCII(segment1);                                                                                                                                                
                             64:        }                                                                                                                                                                        
                             65:        catch (NumberFormatException ex)                                                                                                                                         
                             66:        {                                                                                                                                                                        
                             67:            throw new IOException(ex);                                                                                                                                           
                             68:        }                                                                                                                                                                        
                             69:        if (segment2.length > 0)                                                                                                                                                 
                             70:        {                                                                                                                                                                        
                             71:            parseBinary(segment2);                                                                                                                                               
                             72:        }                                                                                                                                                                        
                             73:        return font;                                                                                                                                                             
                             74:    }                                                                                                                                                                            
                             75:                                                                                                                                                                                 
                             76:    /**                                                                                                                                                                          
                             77:     * Parses the ASCII portion of a Type 1 font.                                                                                                                                
                             78:     */                                                                                                                                                                          
                             79:    private void parseASCII(byte[] bytes) throws IOException                                                                                                                     
                             80:    {                                                                                                                                                                            
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:1-200                                                                                                               
                             ```                                                                                                                                                                                 
                             1:/*                                                                                                                                                                                
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                                                                                             
                             3: * contributor license agreements.  See the NOTICE file distributed with                                                                                                          
                             4: * this work for additional information regarding copyright ownership.                                                                                                            
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                                                                                                        
                             6: * (the "License"); you may not use this file except in compliance with                                                                                                           
                             7: * the License.  You may obtain a copy of the License at                                                                                                                          
                             8: *                                                                                                                                                                                
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                                                                                                
                             10: *                                                                                                                                                                               
                             11: * Unless required by applicable law or agreed to in writing, software                                                                                                           
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                                                                                             
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                                                                                                      
                             14: * See the License for the specific language governing permissions and                                                                                                           
                             15: * limitations under the License.                                                                                                                                                
                             16: */                                                                                                                                                                              
                             17:                                                                                                                                                                                 
                             18:package org.apache.fontbox.type1;                                                                                                                                                
                             19:                                                                                                                                                                                 
                             20:import org.apache.fontbox.encoding.BuiltInEncoding;                                                                                                                              
                             21:import org.apache.fontbox.encoding.StandardEncoding;                                                                                                                             
                             22:                                                                                                                                                                                 
                             23:import java.io.IOException;                                                                                                                                                      
                             24:import java.util.ArrayList;                                                                                                                                                      
                             25:import java.util.HashMap;                                                                                                                                                        
                             26:import java.util.List;                                                                                                                                                           
                             27:import java.util.Map;                                                                                                                                                            
                             28:                                                                                                                                                                                 
                             29:/**                                                                                                                                                                              
                             30: * Parses an Adobe Type 1 (.pfb) font. It is used exclusively by Type1Font.                                                                                                      
                             31: *                                                                                                                                                                               
                             32: * The Type 1 font format is a free-text format which is somewhat difficult                                                                                                      
                             33: * to parse. This is made worse by the fact that many Type 1 font files do                                                                                                       
                             34: * not conform to the specification, especially those embedded in PDFs. This                                                                                                     
                             35: * parser therefore tries to be as forgiving as possible.                                                                                                                        
                             36: *                                                                                                                                                                               
                             37: * @see "Adobe Type 1 Font Format, Adobe Systems (1999)"                                                                                                                         
                             38: *                                                                                                                                                                               
                             39: * @author John Hewson                                                                                                                                                           
                             40: */                                                                                                                                                                              
                             41:final class Type1Parser                                                                                                                                                          
                             42:{                                                                                                                                                                                
                             43:    // constants for encryption                                                                                                                                                  
                             44:    private static final int EEXEC_KEY = 55665;                                                                                                                                  
                             45:    private static final int CHARSTRING_KEY = 4330;                                                                                                                              
                             46:                                                                                                                                                                                 
                             47:    // state                                                                                                                                                                     
                             48:    private Type1Lexer lexer;                                                                                                                                                    
                             49:    private Type1Font font;                                                                                                                                                      
                             50:                                                                                                                                                                                 
                             51:    /**                                                                                                                                                                          
                             52:     * Parses a Type 1 font and returns a Type1Font class which represents it.                                                                                                   
                             53:     *                                                                                                                                                                           
                             54:     * @param segment1 Segment 1: ASCII                                                                                                                                          
                             55:     * @param segment2 Segment 2: Binary                                                                                                                                         
                             56:     * @throws IOException                                                                                                                                                       
                             57:     */                                                                                                                                                                          
                             58:    public Type1Font parse(byte[] segment1, byte[] segment2) throws IOException                                                                                                  
                             59:    {                                                                                                                                                                            
                             60:        font = new Type1Font(segment1, segment2);                                                                                                                                
                             61:        try                                                                                                                                                                      
                             62:        {                                                                                                                                                                        
                             63:            parseASCII(segment1);                                                                                                                                                
                             64:        }                                                                                                                                                                        
                             65:        catch (NumberFormatException ex)                                                                                                                                         
                             66:        {                                                                                                                                                                        
                             67:            throw new IOException(ex);                                                                                                                                           
                             68:        }                                                                                                                                                                        
                             69:        if (segment2.length > 0)                                                                                                                                                 
                             70:        {                                                                                                                                                                        
                             71:            parseBinary(segment2);                                                                                                                                               
                             72:        }                                                                                                                                                                        
                             73:        return font;                                                                                                                                                             
                             74:    }                                                                                                                                                                            
                             75:                                                                                                                                                                                 
                             76:    /**                                                                                                                                                                          
                             77:     * Parses the ASCII portion of a Type 1 font.                                                                                                                                
                             78:     */                                                                                                                                                                          
                             79:    private void parseASCII(byte[] bytes) throws IOException                                                                                                                     
                             80:    {                                                                                                                                                                            
                             81:        if (bytes.length == 0)                                                                                                                                                   
                             82:        {                                                                                                                                                                        
                             83:            throw new IOException("ASCII segment of type 1 font is empty");                                                                                                      
                             84:        }                                                                                                                                                                        
                             85:                                                                                                                                                                                 
                             86:        // %!FontType1-1.0                                                                                                                                                       
                             87:        // %!PS-AdobeFont-1.0                                                                                                                                                    
                             88:        if (bytes.length < 2 || (bytes[0] != '%' && bytes[1] != '!'))                                                                                                            
                             89:        {                                                                                                                                                                        
                             90:            throw new IOException("Invalid start of ASCII segment of type 1 font");                                                                                              
                             91:        }                                                                                                                                                                        
                             92:                                                                                                                                                                                 
                             93:        lexer = new Type1Lexer(bytes);                                                                                                                                           
                             94:                                                                                                                                                                                 
                             95:        // (corrupt?) synthetic font                                                                                                                                             
                             96:        if ("FontDirectory".equals(lexer.peekToken().getText()))                                                                                                                 
                             97:        {                                                                                                                                                                        
                             98:            read(Token.NAME, "FontDirectory");                                                                                                                                   
                             99:            read(Token.LITERAL); // font name                                                                                                                                    
                             100:            read(Token.NAME, "known");                                                                                                                                          
                             101:            read(Token.START_PROC);                                                                                                                                             
                             102:            readProcVoid();                                                                                                                                                     
                             103:            read(Token.START_PROC);                                                                                                                                             
                             104:            readProcVoid();                                                                                                                                                     
                             105:            read(Token.NAME, "ifelse");                                                                                                                                         
                             106:        }                                                                                                                                                                       
                             107:                                                                                                                                                                                
                             108:        // font dict                                                                                                                                                            
                             109:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             110:        read(Token.NAME, "dict");                                                                                                                                               
                             111:        // found in some TeX fonts                                                                                                                                              
                             112:        readMaybe(Token.NAME, "dup");                                                                                                                                           
                             113:        // if present, the "currentdict" is not required                                                                                                                        
                             114:        read(Token.NAME, "begin");                                                                                                                                              
                             115:                                                                                                                                                                                
                             116:        for (int i = 0; i < length; i++)                                                                                                                                        
                             117:        {                                                                                                                                                                       
                             118:            // premature end                                                                                                                                                    
                             119:            Token token = lexer.peekToken();                                                                                                                                    
                             120:            if (token == null)                                                                                                                                                  
                             121:            {                                                                                                                                                                   
                             122:                break;                                                                                                                                                          
                             123:            }                                                                                                                                                                   
                             124:            if (token.getKind() == Token.NAME &&                                                                                                                                
                             125:                ("currentdict".equals(token.getText()) || "end".equals(token.getText())))                                                                                       
                             126:            {                                                                                                                                                                   
                             127:                break;                                                                                                                                                          
                             128:            }                                                                                                                                                                   
                             129:                                                                                                                                                                                
                             130:            // key/value                                                                                                                                                        
                             131:            String key = read(Token.LITERAL).getText();                                                                                                                         
                             132:            switch (key)                                                                                                                                                        
                             133:            {                                                                                                                                                                   
                             134:                case "FontInfo":                                                                                                                                                
                             135:                case "Fontinfo":                                                                                                                                                
                             136:                    readFontInfo(readSimpleDict());                                                                                                                             
                             137:                    break;                                                                                                                                                      
                             138:                case "Metrics":                                                                                                                                                 
                             139:                    readSimpleDict();                                                                                                                                           
                             140:                    break;                                                                                                                                                      
                             141:                case "Encoding":                                                                                                                                                
                             142:                    readEncoding();                                                                                                                                             
                             143:                    break;                                                                                                                                                      
                             144:                default:                                                                                                                                                        
                             145:                    readSimpleValue(key);                                                                                                                                       
                             146:                    break;                                                                                                                                                      
                             147:            }                                                                                                                                                                   
                             148:        }                                                                                                                                                                       
                             149:                                                                                                                                                                                
                             150:        readMaybe(Token.NAME, "currentdict");                                                                                                                                   
                             151:        read(Token.NAME, "end");                                                                                                                                                
                             152:                                                                                                                                                                                
                             153:        read(Token.NAME, "currentfile");                                                                                                                                        
                             154:        read(Token.NAME, "eexec");                                                                                                                                              
                             155:    }                                                                                                                                                                           
                             156:                                                                                                                                                                                
                             157:    private void readSimpleValue(String key) throws IOException                                                                                                                 
                             158:    {                                                                                                                                                                           
                             159:        List<Token> value = readDictValue();                                                                                                                                    
                             160:                                                                                                                                                                                
                             161:        switch (key)                                                                                                                                                            
                             162:        {                                                                                                                                                                       
                             163:            case "FontName":                                                                                                                                                    
                             164:                font.fontName = value.get(0).getText();                                                                                                                         
                             165:                break;                                                                                                                                                          
                             166:            case "PaintType":                                                                                                                                                   
                             167:                font.paintType = value.get(0).intValue();                                                                                                                       
                             168:                break;                                                                                                                                                          
                             169:            case "FontType":                                                                                                                                                    
                             170:                font.fontType = value.get(0).intValue();                                                                                                                        
                             171:                break;                                                                                                                                                          
                             172:            case "FontMatrix":                                                                                                                                                  
                             173:                font.fontMatrix = arrayToNumbers(value);                                                                                                                        
                             174:                break;                                                                                                                                                          
                             175:            case "FontBBox":                                                                                                                                                    
                             176:                font.fontBBox = arrayToNumbers(value);                                                                                                                          
                             177:                break;                                                                                                                                                          
                             178:            case "UniqueID":                                                                                                                                                    
                             179:                font.uniqueID = value.get(0).intValue();                                                                                                                        
                             180:                break;                                                                                                                                                          
                             181:            case "StrokeWidth":                                                                                                                                                 
                             182:                font.strokeWidth = value.get(0).floatValue();                                                                                                                   
                             183:                break;                                                                                                                                                          
                             184:            case "FID":                                                                                                                                                         
                             185:                font.fontID = value.get(0).getText();                                                                                                                           
                             186:                break;                                                                                                                                                          
                             187:            default:                                                                                                                                                            
                             188:                break;                                                                                                                                                          
                             189:        }                                                                                                                                                                       
                             190:    }                                                                                                                                                                           
                             191:                                                                                                                                                                                
                             192:    private void readEncoding() throws IOException                                                                                                                              
                             193:    {                                                                                                                                                                           
                             194:        if (lexer.peekKind(Token.NAME))                                                                                                                                         
                             195:        {                                                                                                                                                                       
                             196:            String name = lexer.nextToken().getText();                                                                                                                          
                             197:                                                                                                                                                                                
                             198:            if (name.equals("StandardEncoding"))                                                                                                                                
                             199:            {                                                                                                                                                                   
                             200:                font.encoding = StandardEncoding.INSTANCE;                                                                                                                      
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:190-250                                                                                                             
                             ```                                                                                                                                                                                 
                             190:    }                                                                                                                                                                           
                             191:                                                                                                                                                                                
                             192:    private void readEncoding() throws IOException                                                                                                                              
                             193:    {                                                                                                                                                                           
                             194:        if (lexer.peekKind(Token.NAME))                                                                                                                                         
                             195:        {                                                                                                                                                                       
                             196:            String name = lexer.nextToken().getText();                                                                                                                          
                             197:                                                                                                                                                                                
                             198:            if (name.equals("StandardEncoding"))                                                                                                                                
                             199:            {                                                                                                                                                                   
                             200:                font.encoding = StandardEncoding.INSTANCE;                                                                                                                      
                             201:            }                                                                                                                                                                   
                             202:            else                                                                                                                                                                
                             203:            {                                                                                                                                                                   
                             204:                throw new IOException("Unknown encoding: " + name);                                                                                                             
                             205:            }                                                                                                                                                                   
                             206:            readMaybe(Token.NAME, "readonly");                                                                                                                                  
                             207:            read(Token.NAME, "def");                                                                                                                                            
                             208:        }                                                                                                                                                                       
                             209:        else                                                                                                                                                                    
                             210:        {                                                                                                                                                                       
                             211:            read(Token.INTEGER).intValue();                                                                                                                                     
                             212:            readMaybe(Token.NAME, "array");                                                                                                                                     
                             213:                                                                                                                                                                                
                             214:            // 0 1 255 {1 index exch /.notdef put } for                                                                                                                         
                             215:            // we have to check "readonly" and "def" too                                                                                                                        
                             216:            // as some fonts don't provide any dup-values, see PDFBOX-2134                                                                                                      
                             217:            while (!(lexer.peekKind(Token.NAME)                                                                                                                                 
                             218:                    && (lexer.peekToken().getText().equals("dup")                                                                                                               
                             219:                            || lexer.peekToken().getText().equals("readonly")                                                                                                   
                             220:                            || lexer.peekToken().getText().equals("def"))))                                                                                                     
                             221:            {                                                                                                                                                                   
                             222:                lexer.nextToken();                                                                                                                                              
                             223:            }                                                                                                                                                                   
                             224:                                                                                                                                                                                
                             225:            Map<Integer, String> codeToName = new HashMap<>();                                                                                                                  
                             226:            while (lexer.peekKind(Token.NAME) &&                                                                                                                                
                             227:                    lexer.peekToken().getText().equals("dup"))                                                                                                                  
                             228:            {                                                                                                                                                                   
                             229:                read(Token.NAME, "dup");                                                                                                                                        
                             230:                int code = read(Token.INTEGER).intValue();                                                                                                                      
                             231:                String name = read(Token.LITERAL).getText();                                                                                                                    
                             232:                read(Token.NAME, "put");                                                                                                                                        
                             233:                codeToName.put(code, name);                                                                                                                                     
                             234:            }                                                                                                                                                                   
                             235:            font.encoding = new BuiltInEncoding(codeToName);                                                                                                                    
                             236:            readMaybe(Token.NAME, "readonly");                                                                                                                                  
                             237:            read(Token.NAME, "def");                                                                                                                                            
                             238:        }                                                                                                                                                                       
                             239:    }                                                                                                                                                                           
                             240:                                                                                                                                                                                
                             241:    /**                                                                                                                                                                         
                             242:     * Extracts values from an array as numbers.                                                                                                                                
                             243:     */                                                                                                                                                                         
                             244:    private List<Number> arrayToNumbers(List<Token> value) throws IOException                                                                                                   
                             245:    {                                                                                                                                                                           
                             246:        List<Number> numbers = new ArrayList<>();                                                                                                                               
                             247:        for (int i = 1, size = value.size() - 1; i < size; i++)                                                                                                                 
                             248:        {                                                                                                                                                                       
                             249:            Token token = value.get(i);                                                                                                                                         
                             250:            if (token.getKind() == Token.REAL)                                                                                                                                  
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:508-550                                                                                                             
                             ```                                                                                                                                                                                 
                             508:     * Reads a procedure but without returning anything.                                                                                                                        
                             509:     */                                                                                                                                                                         
                             510:    private void readProcVoid() throws IOException                                                                                                                              
                             511:    {                                                                                                                                                                           
                             512:        int openProc = 1;                                                                                                                                                       
                             513:        while (true)                                                                                                                                                            
                             514:        {                                                                                                                                                                       
                             515:            if (lexer.peekToken() == null)                                                                                                                                      
                             516:            {                                                                                                                                                                   
                             517:                throw new IOException("Malformed procedure: missing token");                                                                                                    
                             518:            }                                                                                                                                                                   
                             519:            if (lexer.peekKind(Token.START_PROC))                                                                                                                               
                             520:            {                                                                                                                                                                   
                             521:                openProc++;                                                                                                                                                     
                             522:            }                                                                                                                                                                   
                             523:                                                                                                                                                                                
                             524:            Token token = lexer.nextToken();                                                                                                                                    
                             525:                                                                                                                                                                                
                             526:            if (token.getKind() == Token.END_PROC)                                                                                                                              
                             527:            {                                                                                                                                                                   
                             528:                openProc--;                                                                                                                                                     
                             529:                if (openProc == 0)                                                                                                                                              
                             530:                {                                                                                                                                                               
                             531:                    break;                                                                                                                                                      
                             532:                }                                                                                                                                                               
                             533:            }                                                                                                                                                                   
                             534:        }                                                                                                                                                                       
                             535:        readMaybe(Token.NAME, "executeonly");                                                                                                                                   
                             536:    }                                                                                                                                                                           
                             537:                                                                                                                                                                                
                             538:    /**                                                                                                                                                                         
                             539:     * Parses the binary portion of a Type 1 font.                                                                                                                              
                             540:     */                                                                                                                                                                         
                             541:    private void parseBinary(byte[] bytes) throws IOException                                                                                                                   
                             542:    {                                                                                                                                                                           
                             543:        byte[] decrypted;                                                                                                                                                       
                             544:        // Sometimes, fonts use the hex format, so this needs to be converted before decryption                                                                                 
                             545:        if (isBinary(bytes))                                                                                                                                                    
                             546:        {                                                                                                                                                                       
                             547:            decrypted = decrypt(bytes, EEXEC_KEY, 4);                                                                                                                           
                             548:        }                                                                                                                                                                       
                             549:        else                                                                                                                                                                    
                             550:        {                                                                                                                                                                       
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:43-46                                                                                                               
                             ```                                                                                                                                                                                 
                             43:    // constants for encryption                                                                                                                                                  
                             44:    private static final int EEXEC_KEY = 55665;                                                                                                                                  
                             45:    private static final int CHARSTRING_KEY = 4330;                                                                                                                              
                             46:                                                                                                                                                                                 
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:108-116                                                                                                             
                             ```                                                                                                                                                                                 
                             108:        // font dict                                                                                                                                                            
                             109:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             110:        read(Token.NAME, "dict");                                                                                                                                               
                             111:        // found in some TeX fonts                                                                                                                                              
                             112:        readMaybe(Token.NAME, "dup");                                                                                                                                           
                             113:        // if present, the "currentdict" is not required                                                                                                                        
                             114:        read(Token.NAME, "begin");                                                                                                                                              
                             115:                                                                                                                                                                                
                             116:        for (int i = 0; i < length; i++)                                                                                                                                        
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:217-224                                                                                                             
                             ```                                                                                                                                                                                 
                             217:            while (!(lexer.peekKind(Token.NAME)                                                                                                                                 
                             218:                    && (lexer.peekToken().getText().equals("dup")                                                                                                               
                             219:                            || lexer.peekToken().getText().equals("readonly")                                                                                                   
                             220:                            || lexer.peekToken().getText().equals("def"))))                                                                                                     
                             221:            {                                                                                                                                                                   
                             222:                lexer.nextToken();                                                                                                                                              
                             223:            }                                                                                                                                                                   
                             224:                                                                                                                                                                                
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:226-234                                                                                                             
                             ```                                                                                                                                                                                 
                             226:            while (lexer.peekKind(Token.NAME) &&                                                                                                                                
                             227:                    lexer.peekToken().getText().equals("dup"))                                                                                                                  
                             228:            {                                                                                                                                                                   
                             229:                read(Token.NAME, "dup");                                                                                                                                        
                             230:                int code = read(Token.INTEGER).intValue();                                                                                                                      
                             231:                String name = read(Token.LITERAL).getText();                                                                                                                    
                             232:                read(Token.NAME, "put");                                                                                                                                        
                             233:                codeToName.put(code, name);                                                                                                                                     
                             234:            }                                                                                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:510-536                                                                                                             
                             ```                                                                                                                                                                                 
                             510:    private void readProcVoid() throws IOException                                                                                                                              
                             511:    {                                                                                                                                                                           
                             512:        int openProc = 1;                                                                                                                                                       
                             513:        while (true)                                                                                                                                                            
                             514:        {                                                                                                                                                                       
                             515:            if (lexer.peekToken() == null)                                                                                                                                      
                             516:            {                                                                                                                                                                   
                             517:                throw new IOException("Malformed procedure: missing token");                                                                                                    
                             518:            }                                                                                                                                                                   
                             519:            if (lexer.peekKind(Token.START_PROC))                                                                                                                               
                             520:            {                                                                                                                                                                   
                             521:                openProc++;                                                                                                                                                     
                             522:            }                                                                                                                                                                   
                             523:                                                                                                                                                                                
                             524:            Token token = lexer.nextToken();                                                                                                                                    
                             525:                                                                                                                                                                                
                             526:            if (token.getKind() == Token.END_PROC)                                                                                                                              
                             527:            {                                                                                                                                                                   
                             528:                openProc--;                                                                                                                                                     
                             529:                if (openProc == 0)                                                                                                                                              
                             530:                {                                                                                                                                                               
                             531:                    break;                                                                                                                                                      
                             532:                }                                                                                                                                                               
                             533:            }                                                                                                                                                                   
                             534:        }                                                                                                                                                                       
                             535:        readMaybe(Token.NAME, "executeonly");                                                                                                                                   
                             536:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:43-52                                                                                                               
                             ```                                                                                                                                                                                 
                             43:    // constants for encryption                                                                                                                                                  
                             44:    private static final int EEXEC_KEY = 55665;                                                                                                                                  
                             45:    private static final int CHARSTRING_KEY = 4330;                                                                                                                              
                             46:                                                                                                                                                                                 
                             47:    // state                                                                                                                                                                     
                             48:    private Type1Lexer lexer;                                                                                                                                                    
                             49:    private Type1Font font;                                                                                                                                                      
                             50:                                                                                                                                                                                 
                             51:    /**                                                                                                                                                                          
                             52:     * Parses a Type 1 font and returns a Type1Font class which represents it.                                                                                                   
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:108-116                                                                                                             
                             ```                                                                                                                                                                                 
                             108:        // font dict                                                                                                                                                            
                             109:        int length = read(Token.INTEGER).intValue();                                                                                                                            
                             110:        read(Token.NAME, "dict");                                                                                                                                               
                             111:        // found in some TeX fonts                                                                                                                                              
                             112:        readMaybe(Token.NAME, "dup");                                                                                                                                           
                             113:        // if present, the "currentdict" is not required                                                                                                                        
                             114:        read(Token.NAME, "begin");                                                                                                                                              
                             115:                                                                                                                                                                                
                             116:        for (int i = 0; i < length; i++)                                                                                                                                        
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:190-239                                                                                                             
                             ```                                                                                                                                                                                 
                             190:    }                                                                                                                                                                           
                             191:                                                                                                                                                                                
                             192:    private void readEncoding() throws IOException                                                                                                                              
                             193:    {                                                                                                                                                                           
                             194:        if (lexer.peekKind(Token.NAME))                                                                                                                                         
                             195:        {                                                                                                                                                                       
                             196:            String name = lexer.nextToken().getText();                                                                                                                          
                             197:                                                                                                                                                                                
                             198:            if (name.equals("StandardEncoding"))                                                                                                                                
                             199:            {                                                                                                                                                                   
                             200:                font.encoding = StandardEncoding.INSTANCE;                                                                                                                      
                             201:            }                                                                                                                                                                   
                             202:            else                                                                                                                                                                
                             203:            {                                                                                                                                                                   
                             204:                throw new IOException("Unknown encoding: " + name);                                                                                                             
                             205:            }                                                                                                                                                                   
                             206:            readMaybe(Token.NAME, "readonly");                                                                                                                                  
                             207:            read(Token.NAME, "def");                                                                                                                                            
                             208:        }                                                                                                                                                                       
                             209:        else                                                                                                                                                                    
                             210:        {                                                                                                                                                                       
                             211:            read(Token.INTEGER).intValue();                                                                                                                                     
                             212:            readMaybe(Token.NAME, "array");                                                                                                                                     
                             213:                                                                                                                                                                                
                             214:            // 0 1 255 {1 index exch /.notdef put } for                                                                                                                         
                             215:            // we have to check "readonly" and "def" too                                                                                                                        
                             216:            // as some fonts don't provide any dup-values, see PDFBOX-2134                                                                                                      
                             217:            while (!(lexer.peekKind(Token.NAME)                                                                                                                                 
                             218:                    && (lexer.peekToken().getText().equals("dup")                                                                                                               
                             219:                            || lexer.peekToken().getText().equals("readonly")                                                                                                   
                             220:                            || lexer.peekToken().getText().equals("def"))))                                                                                                     
                             221:            {                                                                                                                                                                   
                             222:                lexer.nextToken();                                                                                                                                              
                             223:            }                                                                                                                                                                   
                             224:                                                                                                                                                                                
                             225:            Map<Integer, String> codeToName = new HashMap<>();                                                                                                                  
                             226:            while (lexer.peekKind(Token.NAME) &&                                                                                                                                
                             227:                    lexer.peekToken().getText().equals("dup"))                                                                                                                  
                             228:            {                                                                                                                                                                   
                             229:                read(Token.NAME, "dup");                                                                                                                                        
                             230:                int code = read(Token.INTEGER).intValue();                                                                                                                      
                             231:                String name = read(Token.LITERAL).getText();                                                                                                                    
                             232:                read(Token.NAME, "put");                                                                                                                                        
                             233:                codeToName.put(code, name);                                                                                                                                     
                             234:            }                                                                                                                                                                   
                             235:            font.encoding = new BuiltInEncoding(codeToName);                                                                                                                    
                             236:            readMaybe(Token.NAME, "readonly");                                                                                                                                  
                             237:            read(Token.NAME, "def");                                                                                                                                            
                             238:        }                                                                                                                                                                       
                             239:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             <code>                                                                                                                                                                              
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:508-536                                                                                                             
                             ```                                                                                                                                                                                 
                             508:     * Reads a procedure but without returning anything.                                                                                                                        
                             509:     */                                                                                                                                                                         
                             510:    private void readProcVoid() throws IOException                                                                                                                              
                             511:    {                                                                                                                                                                           
                             512:        int openProc = 1;                                                                                                                                                       
                             513:        while (true)                                                                                                                                                            
                             514:        {                                                                                                                                                                       
                             515:            if (lexer.peekToken() == null)                                                                                                                                      
                             516:            {                                                                                                                                                                   
                             517:                throw new IOException("Malformed procedure: missing token");                                                                                                    
                             518:            }                                                                                                                                                                   
                             519:            if (lexer.peekKind(Token.START_PROC))                                                                                                                               
                             520:            {                                                                                                                                                                   
                             521:                openProc++;                                                                                                                                                     
                             522:            }                                                                                                                                                                   
                             523:                                                                                                                                                                                
                             524:            Token token = lexer.nextToken();                                                                                                                                    
                             525:                                                                                                                                                                                
                             526:            if (token.getKind() == Token.END_PROC)                                                                                                                              
                             527:            {                                                                                                                                                                   
                             528:                openProc--;                                                                                                                                                     
                             529:                if (openProc == 0)                                                                                                                                              
                             530:                {                                                                                                                                                               
                             531:                    break;                                                                                                                                                      
                             532:                }                                                                                                                                                               
                             533:            }                                                                                                                                                                   
                             534:        }                                                                                                                                                                       
                             535:        readMaybe(Token.NAME, "executeonly");                                                                                                                                   
                             536:    }                                                                                                                                                                           
                             ```                                                                                                                                                                                 
                             </code>                                                                                                                                                                             
                             </code_snippets>                                                                                                                                                                    
                                                                                                                                                                                                                 
                             ## Fix Strategy                                                                                                                                                                     
                             <fix_strategy>                                                                                                                                                                      
                                                                                                                                                                                                                 
                             1. Correct the placement and scope of the new constants                                                                                                                             
                                - Remove the unintended second class declaration (`public class Type1Parser {  }`) introduced by the last patch. Ensure there's only one top-level `final class                 
                             Type1Parser` in the file.                                                                                                                                                           
                                - Immediately after the existing static fields for encryption keys (lines around 4445), insert the four new constants at class scope, for example:                              
                                  ```java                                                                                                                                                                        
                                  // constants for encryption                                                                                                                                                    
                                  private static final int EEXEC_KEY = 55665;                                                                                                                                    
                                  private static final int CHARSTRING_KEY = 4330;                                                                                                                                
                                                                                                                                                                                                                 
                                  // limits to prevent unbounded loops in Type 1 parsing                                                                                                                         
                                  private static final int MAX_DICT_ENTRIES    = 10_000;                                                                                                                         
                                  private static final int MAX_ENCODING_TOKENS = 10_000;                                                                                                                         
                                  private static final int MAX_DUP_ENTRIES     = 1_000;                                                                                                                          
                                  private static final int MAX_PROCVOID_TOKENS = 100_000;                                                                                                                        
                                  ```                                                                                                                                                                            
                                - This guarantees visibility in all parser methods and resolves the cannot find symbol compilation errors.                                                                     
                                                                                                                                                                                                                 
                             2. Guard the dictionaryparsing loop in `parseASCII(...)`                                                                                                                           
                                - Locate the lines:                                                                                                                                                              
                                  ```java                                                                                                                                                                        
                                  int length = read(Token.INTEGER).intValue();                                                                                                                                   
                                  read(Token.NAME, "dict");                                                                                                                                                      
                                  ```                                                                                                                                                                            
                                - Immediately after reading `length`, validate it:                                                                                                                               
                                  ```java                                                                                                                                                                        
                                  if (length < 0 || length > MAX_DICT_ENTRIES) {                                                                                                                                 
                                      throw new IOException("Invalid dictionary length: " + length);                                                                                                             
                                  }                                                                                                                                                                              
                                  ```                                                                                                                                                                            
                                - This prevents a malicious or corrupted font from specifying a huge `length` that would stall or OOM the loop.                                                                  
                                                                                                                                                                                                                 
                             3. Cap token consumption in `readEncoding()`                                                                                                                                        
                                - At the start of the `else` branch (arraybased encoding) in `readEncoding()`, declare two counters:                                                                            
                                  ```java                                                                                                                                                                        
                                  int encodingTokenCount = 0;                                                                                                                                                    
                                  int dupCount = 0;                                                                                                                                                              
                                  ```                                                                                                                                                                            
                                - In the first loop that skips tokens until a control word (`dup`, `readonly`, or `def`), increment `encodingTokenCount` on each `lexer.nextToken()` and throw                   
                             if it exceeds `MAX_ENCODING_TOKENS`:                                                                                                                                                
                                  ```java                                                                                                                                                                        
                                  while (!(lexer.peekKind(Token.NAME) && isControlWord(lexer.peekToken().getText()))) {                                                                                          
                                      if (++encodingTokenCount > MAX_ENCODING_TOKENS) {                                                                                                                          
                                          throw new IOException("Malformed encoding: too many tokens");                                                                                                          
                                      }                                                                                                                                                                          
                                      lexer.nextToken();                                                                                                                                                         
                                  }                                                                                                                                                                              
                                  ```                                                                                                                                                                            
                                - In the subsequent `dup`entry loop, increment `dupCount` each iteration and throw if it exceeds `MAX_DUP_ENTRIES`:                                                             
                                  ```java                                                                                                                                                                        
                                  while (lexer.peekKind(Token.NAME) && "dup".equals(lexer.peekToken().getText())) {                                                                                              
                                      if (++dupCount > MAX_DUP_ENTRIES) {                                                                                                                                        
                                          throw new IOException("Too many dup entries: " + dupCount);                                                                                                            
                                      }                                                                                                                                                                          
                                      // existing read(Token.NAME, "dup"); ...                                                                                                                                   
                                  }                                                                                                                                                                              
                                  ```                                                                                                                                                                            
                                - This bounds both the total scanned tokens and the number of `dup` operations.                                                                                                  
                                                                                                                                                                                                                 
                             4. Bound procedure parsing in `readProcVoid()`                                                                                                                                      
                                - At the top of `readProcVoid()`, introduce:                                                                                                                                     
                                  ```java                                                                                                                                                                        
                                  int procVoidTokenCount = 0;                                                                                                                                                    
                                  ```                                                                                                                                                                            
                                - In the `while (true)` loop, increment this counter immediately after checking `peekToken()` and before calling `nextToken()`. If it exceeds                                    
                             `MAX_PROCVOID_TOKENS`, throw:                                                                                                                                                       
                                  ```java                                                                                                                                                                        
                                  if (++procVoidTokenCount > MAX_PROCVOID_TOKENS) {                                                                                                                              
                                      throw new IOException("Malformed or too long procedure");                                                                                                                  
                                  }                                                                                                                                                                              
                                  Token token = lexer.nextToken();                                                                                                                                               
                                  ```                                                                                                                                                                            
                                - This ensures a deeply nested or neverterminating procedure body cant hang the parser.                                                                                        
                                                                                                                                                                                                                 
                             5. Verify formatting, imports, and brace matching                                                                                                                                   
                                - Ensure no additional braces or nested class declarations remain from the faulty patch. The file should compile with exactly one `final class Type1Parser {                    
                             }`.                                                                                                                                                                                 
                                - Confirm the `package` and `import` sections at the top remain unchanged and that the new constants are positioned before any methods.                                          
                                                                                                                                                                                                                 
                             6. Regression testing and sideeffect mitigation                                                                                                                                    
                                - Run existing PDFBox unit tests, especially those covering Type 1 fonts, to verify no normal font parsing is broken. The chosen limits (10 000 tokens, 1 000                    
                             `dup` entries, etc.) are sufficiently high to accommodate typical Type 1 fonts.                                                                                                     
                                - If customers report valid fonts exceeding these thresholds, allow configuration via system properties or a future enhancement, but do not lower the hardcoded                 
                             limits below these sanity checks.                                                                                                                                                   
                                                                                                                                                                                                                 
                             Justification:                                                                                                                                                                      
                             - Placing the static finals alongside the existing keys fixes the cannot find symbol errors by ensuring classlevel visibility.                                                   
                             - Each loop in `Type1Parser` that can spin unboundedly is now guarded by a simple counter against a generous threshold, stopping pathological input while                           
                             preserving the parsers forgiving behavior for legitimate fonts.                                                                                                                    
                             - This approach retains all existing parsing logic, only adding early exits to prevent hangs. It doesnt touch the fuzz harness or external dependencies, thus                      
                             keeping tests and fuzz targets intact.                                                                                                                                              
                             - Similar limit checks are standard in parsers to bound resource usage and avoid denialofservice conditions.                                                                      
                                                                                                                                                                                                                 
                             </fix_strategy>                                                                                                                                                                     
                             ===Tests Result===                                                                                                                                                                  
                             No tests found                                                                                                                                                                      
                             ===Evaluation End===                                                                                                                                                                
[10/27/25 20:18:51] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                                                                                                      __init__.py:160
                             (n evals: 3, patch status: PatchStatus.SOUND)                                                                                                                                       
                    INFO     Building environment                                                                                                                                                 __init__.py:132
                             - Cache directory: /tmp/tmpw54y99cl                                                                                                                                                 
                             - Max timeout: 1800                                                                                                                                                                 
                             - Output directory: reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_3/agent-output-1761596331.157923                                                                         
                             - Detection toml file: /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_3.toml                                                                                 
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                                                                                                 
                                                                                                                                                                                                                 
