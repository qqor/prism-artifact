--- a/poi/src/main/java/org/apache/poi/ss/usermodel/DataFormatter.java
+++ b/poi/src/main/java/org/apache/poi/ss/usermodel/DataFormatter.java
@@ -127,13 +127,15 @@
     private static final Pattern amPmPattern = Pattern.compile("(([AP])[M/P]*)", Pattern.CASE_INSENSITIVE);
 
     /** Pattern to find formats with condition ranges e.g. [>=100] */
-    private static final Pattern rangeConditionalPattern = Pattern.compile(".*\\[\\s*(>|>=|<|<=|=)\\s*[0-9]*\\.*[0-9].*");
+    private static final Pattern rangeConditionalPattern =
+        Pattern.compile("(?>.*\\[\\s*(?:>=|>|<=|<|=)\\s*[0-9]*\\.?[0-9].*)");
 
     /**
      * A regex to find locale patterns like [$$-1009] and [$?-452].
      * Note that we don't currently process these into locales
      */
-    private static final Pattern localePatternGroup = Pattern.compile("(\\[\\$[^-\\]]*-[0-9A-Z]+])");
+    private static final Pattern localePatternGroup =
+        Pattern.compile("(?>\\[\\$[^-\\]]*-[0-9A-Z]+])");
 
     /**
      * A regex to match the colour formatting's rules.
