{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-delta-01_vuln_001",
  "source_directory": "/home/qqor/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.1249061,
    "prompt_tokens": 45851,
    "completion_tokens": 16925
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/crypto/certificate.c\n+++ b/libfreerdp/crypto/certificate.c\n@@ -1534,16 +1534,16 @@\n \tWINPR_ASSERT(bio);\n \tWINPR_ASSERT(ppem);\n \n-\tconst uint16_t blocksize = 2048;\n-\tuint16_t offset = 0;\n-\tuint16_t length = blocksize;\n+\tconst size_t blocksize = 2048;\n+\tsize_t offset = 0;\n+\tsize_t length = blocksize;\n \tchar* pem = NULL;\n \n \t*ppem = NULL;\n \tif (plength)\n \t\t*plength = 0;\n \n-\twhile (status != 0)\n+\twhile (offset < length)\n \t{\n \t\tchar* tmp = realloc(pem, length + 1);\n \t\tif (!tmp)\n@@ -1564,13 +1564,15 @@\n \t\t\tbreak;\n \n \t\toffset += (size_t)status;\n-\t\tlength += blocksize;\n-\n-\t}\n+\t\tif (offset == length)\n+\t\t\tlength += blocksize;\n+\t}\n+\n \tpem[offset] = '\\0';\n \t*ppem = pem;\n \tif (plength)\n \t\t*plength = offset;\n+\trc = TRUE;\n \trc = TRUE;\n fail:\n \tif (!rc)\n",
  "stdout": "",
  "stderr": ""
}