--- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
+++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
@@ -97,11 +97,15 @@
         Path tmpDir = Files.createTempDirectory(cwd, "tika-shell-detect-");
         Path tmpFile = tmpDir.resolve(fileName);
         Files.copy(tis.getPath(), tmpFile, StandardCopyOption.REPLACE_EXISTING);
-        ProcessBuilder pb = new ProcessBuilder(fileName);
+        ProcessBuilder pb = new ProcessBuilder("sh", "-n", fileName);
         pb.directory(tmpDir.toFile());
+        FileProcessResult result = null;
         try {
-            FileProcessResult result = ProcessUtils.execute(pb, 20000, 100000, 100000);
-            if (result.getExitValue() == 0) {
+            try {
+                result = ProcessUtils.execute(pb, 20000, 100000, 100000);
+            } catch (IOException e) {
+            }
+            if (result != null && result.getExitValue() == 0) {
                 metadata.set(SHELL_NO_ARGS, true);
             }
         } finally {
