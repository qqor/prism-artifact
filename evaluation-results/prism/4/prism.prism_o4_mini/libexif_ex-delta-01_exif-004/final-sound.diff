--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -117,9 +117,10 @@
         } else {
             dofs = ofs + 8;
         }
-	if (dofs > buf_size) {
+	/* Prevent reading past the end of the buffer */
+	if (dofs + dsize > buf_size) {
 		exif_log (md->log, EXIF_LOG_CODE_CORRUPT_DATA,
-                                  "ExifMnoteApplet", "Tag size overflow detected (%u vs size %u)", dofs, buf_size);
+                          "ExifMnoteDataApple", "Tag size overflow detected (%u vs %u)", dofs + dsize, buf_size);
 		continue;
 	}
         ofs += 12;
