[2;36m[12/31/25 03:34:33][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=803222;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=146277;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpzgvg79l0[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/mongoose_mg-delta-02_mongoose_2/[0m[95magent-o[0m [2m               [0m
[2;36m                    [0m         [95mutput-1767152073.8315592[0m                                                             [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/mongoose_mg-delta-02_mongoose_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-mongoose[0m         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Building Cached for CLEAN environment[1m)[0m          ]8;id=840890;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=428199;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[12/31/25 03:34:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Building Cached for CLEAN environment[1m)[0m Took    ]8;id=933448;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=511738;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m8.48[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                 [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running tests for Cached for CLEAN environment[1m)[0m ]8;id=797623;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=62234;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running tests for Cached for CLEAN             ]8;id=436482;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=490603;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=187063;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=809705;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m8[0m[1m)[0m                                                           [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=739151;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=716552;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:34:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.90[0m seconds;              ]8;id=584250;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=604916;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=956898;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=977977;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=313571;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=269076;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=813396;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=661877;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=111790;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=541026;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:34:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.01[0m seconds;              ]8;id=710570;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=444649;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=473657;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=386771;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:34:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.92[0m seconds;              ]8;id=7741;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=431501;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/31/25 03:34:48][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=488001;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=913317;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         fuzz -[33mruns[0m=[1;36m100[0m.                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/31/25 03:35:01][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=309337;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=170758;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:37:12][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=264025;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=828;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:37:30][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=775321;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=673202;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=413201;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=395206;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:37:31][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.01[0m seconds;              ]8;id=384141;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=541459;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/31/25 03:37:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=321854;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=674997;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp3r14czdw[0m                                                 ]8;id=373947;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=313383;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/31/25 03:37:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m7.28[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=867471;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=503828;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=526046;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=127365;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:37:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.53[0m seconds;             ]8;id=799564;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=895847;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=457378;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=348679;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:37:46][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=769807;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=712919;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m856586979[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83203708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55cc83204aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83204aa8[0m[39m,[0m[1;36m0x55cc83218448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55cc83189c02[0m[39m bp [0m[1;36m0x7ffc693aeac0[0m[39m sp [0m[1;36m0x7ffc693aeab8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc83189c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc83171d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc831868b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc82fd57ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc830fe11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc8318679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpt_zvx9dm[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=451514;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=866794;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m856586979[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83203708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55cc83204aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83204aa8[0m[39m,[0m[1;36m0x55cc83218448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55cc83189c02[0m[39m bp [0m[1;36m0x7ffc693aeac0[0m[39m sp [0m[1;36m0x7ffc693aeab8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc83189c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc83171d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc831868b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc82fd57ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc830fe11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc8318679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpt_zvx9dm[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m856586979[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83203708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55cc83204aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83204aa8[0m[39m,[0m[1;36m0x55cc83218448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55cc83189c02[0m[39m bp [0m[1;36m0x7ffc693aeac0[0m[39m sp [0m[1;36m0x7ffc693aeab8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc83189c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc83171d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc831868b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc82fd57ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc830fe11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc8318679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpt_zvx9dm[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.61[0m seconds;                ]8;id=645306;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=631559;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=963201;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=790166;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:37:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.91[0m seconds;              ]8;id=33314;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=526332;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=363630;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=590244;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:37:48][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.98[0m seconds;              ]8;id=930378;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=212272;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=416405;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=119799;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-380[0m,[1;36m6[0m +[1;36m380[0m,[1;36m8[0m @@                                                                 [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_icmp[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m         +  size_t min_hdr = [1;35msizeof[0m[1m([0mstruct eth[1m)[0m + [1;35msizeof[0m[1m([0mstruct ip[1m)[0m + [1;35msizeof[0m[1m([0mstruct icmp[1m)[0m;   [2m                [0m
[2;36m                    [0m         +  if [1m([0mpkt->raw.len [1m<[0m[39m min_hdr[0m[1;39m)[0m[39m return;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [39m     size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m856586979[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83203708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55cc83204aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83204aa8[0m[39m,[0m[1;36m0x55cc83218448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55cc83189c02[0m[39m bp [0m[1;36m0x7ffc693aeac0[0m[39m sp [0m[1;36m0x7ffc693aeab8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc83189c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc83171d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc831868b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc82fd57ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc830fe11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc8318679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpt_zvx9dm[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA fuzzing run of the Mongoose codebase triggered an AddressSanitizer crash [0m         [2m                [0m
[2;36m                    [0m         [39mindicating a heap-buffer-overflow in the function `rx_icmp` [0m[1;39m([0m[39mnet_builtin.[0m[1;92mc:385[0m[1;39m)[0m[39m. [0m   [2m                [0m
[2;36m                    [0m         [39mThe out-of-bounds read occurs immediately after a [0m[1;36m34[0m[39m-byte heap allocation. The [0m     [2m                [0m
[2;36m                    [0m         [39mcrash was observed while executing the fuzzer harness [0m[1;39m([0m[39m`LLVMFuzzerTestOneInput`[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mwhich drives network packet parsing via `mg_tcpip_rx` and ultimately calls [0m         [2m                [0m
[2;36m                    [0m         [39m`rx_icmp`.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Issue  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  During fuzz testing, a one-byte read is performed past the end of a [0m              [2m                [0m
[2;36m                    [0m         [39mheap-allocated buffer when processing ICMP packets. AddressSanitizer reports:  [0m     [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m  ERROR: AddressSanitizer: heap-buffer-overflow … [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mnet_builtin.[0m[1;92mc:385:18[0m                                                                [2m                [0m
[2;36m                    [0m         [39m  READ of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m … [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region[0m                   [2m                [0m
[2;36m                    [0m         [39m  ```  [0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Vulnerability type  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m  Heap-buffer-overflow [0m[1;39m([0m[39mout-of-bounds read[0m[1;39m)[0m[39m in ICMP packet handling.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Key observations  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m  • The buffer in question is allocated in `LLVMFuzzerTestOneInput` [0m[1;39m([0m[39mfuzz.[0m[1;92mc:95[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mwith a size of [0m[1;36m34[0m[39m bytes.  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m  • `mg_tcpip_rx` [0m[1;39m([0m[39mnet_builtin.[0m[1;92mc:897[0m[1;39m)[0m[39m dispatches the packet to `rx_icmp`.  [0m         [2m                [0m
[2;36m                    [0m         [39m  • In `rx_icmp`, an access at offset [0m[1;36m34[0m[39m [0m[1;39m([0m[39mone past the allocated length[0m[1;39m)[0m[39m triggers [0m  [2m                [0m
[2;36m                    [0m         [39mthe overflow.  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m  • The fuzzer is using libFuzzer in “interactive” mode with a single input tested [0m [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m times.  [0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Areas for investigation  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. **rx_icmp [0m[1;39m([0m[39mnet_builtin.c around line [0m[1;36m385[0m[1;39m)[0m[39m** – review bounds checks before [0m     [2m                [0m
[2;36m                    [0m         [39mreading packet data.  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. **mg_tcpip_rx [0m[1;39m([0m[39mnet_builtin.c around line [0m[1;36m897[0m[1;39m)[0m[39m** – ensure packet length is [0m     [2m                [0m
[2;36m                    [0m         [39mvalidated before dispatch.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. **pkt structure and length field** – verify that the packet object carries [0m    [2m                [0m
[2;36m                    [0m         [39mcorrect size metadata.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m4[0m[39m. **Fuzz harness setup [0m[1;39m([0m[39mtest/fuzz.c[0m[1;39m)[0m[39m** – examine how input data is mapped into [0m  [2m                [0m
[2;36m                    [0m         [39mthe packet buffer and whether length is set appropriately.  [0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA holistic review should cover the packet‐parsing logic in `net_builtin.c`, the [0m    [2m                [0m
[2;36m                    [0m         [39mdefinition and initialization of the `pkt` object, and the fuzzer harness that [0m     [2m                [0m
[2;36m                    [0m         [39mconstructs the test inputs.[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:127[0m[39m-[0m[1;36m136[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:#pragma [0m[1;35mpack[0m[1;39m([0m[39mpop[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m153[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:839[0m[39m-[0m[1;36m843[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1208[0m[39m-[0m[1;36m1208[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:#endif  [0m[35m/[0m[35m/[0m[39m MG_ENABLE_TCPIP[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The crash in rx_icmp stems from reading `pkt->icmp->type` before verifying [0m    [2m                [0m
[2;36m                    [0m         [39mthat the ICMP header [0m[1;39m([0m[39mand therefore the entire IPv4+ICMP header area[0m[1;39m)[0m[39m lies within [0m  [2m                [0m
[2;36m                    [0m         [39mthe received raw buffer. The existing IPv4 path in rx_ip only checks `pkt->pay.len`[0m [2m                [0m
[2;36m                    [0m         [39magainst the ICMP header size, but `pkt->pay.len` is computed relative to the start [0m [2m                [0m
[2;36m                    [0m         [39mof the ICMP payload [0m[1;39m([0m[39mafter IP[0m[1;39m)[0m[39m and does not account for the Ethernet header. As a [0m  [2m                [0m
[2;36m                    [0m         [39mresult, for a raw buffer exactly equal to Ethernet [0m[1;39m([0m[1;36m14[0m[1;39m)[0m[39m + IP [0m[1;39m([0m[1;36m20[0m[1;39m)[0m[39m = [0m[1;36m34[0m[39m bytes, [0m      [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.len` becomes [0m[1;36m0[0m[39m, so rx_ip’s check passes, mkpay resets pay.len, and [0m       [2m                [0m
[2;36m                    [0m         [39mrx_icmp is invoked with `pkt->icmp` pointing one byte past the buffer. Accessing [0m   [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp->type` then overruns the heap.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Preservation of Protocol Logic[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - We must preserve the existing flow for well-formed ICMPv4 packets: parsing [0m    [2m                [0m
[2;36m                    [0m         [39mEthernet→IPv4→ICMP, computing payload length, responding only to echo requests [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`type == [0m[1;36m8[0m[39m`[0m[1;39m)[0m[39m, copying payload back in the reply, recalculating checksums, and [0m     [2m                [0m
[2;36m                    [0m         [39memitting a frame.[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - The IPv6 branch already includes a safeguard [0m[1;39m([0m[39m`if [0m[1;39m([0m[39mpkt->pay.len < [0m             [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m[1;39m)[0m[39m before touching the ICMPv6 header. We should adopt an[0m [2m                [0m
[2;36m                    [0m         [39manalogous, but correct, check for IPv4.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Proposed Patch Steps[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   A. In rx_icmp [0m[1;39m([0m[39mnet_builtin.c around line [0m[1;36m382[0m[1;39m)[0m[39m, insert an explicit length check [0m  [2m                [0m
[2;36m                    [0m         [39mat the top of the function. Use the same `hlen` that is later used for [0m             [2m                [0m
[2;36m                    [0m         [39mtransmission, which equals:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m      and ensure that the total received packet length [0m[1;39m([0m[39m`pkt->raw.len`[0m[1;39m)[0m[39m is at least[0m [2m                [0m
[2;36m                    [0m         [39m`hlen`. If not, return immediately without touching `pkt->icmp`.[0m                    [2m                [0m
[2;36m                    [0m         [39m   B. Remove or leave intact the existing IPv4 header-length check in rx_ip; the [0m   [2m                [0m
[2;36m                    [0m         [39mnew guard in rx_icmp will cover all entry paths [0m[1;39m([0m[39mrx_ip and any other dispatchers[0m[1;39m)[0m[39m.[0m  [2m                [0m
[2;36m                    [0m         [39m   C. No changes to the fuzzer harness, tests, or external dependencies.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   Pseudocode patch in rx_icmp:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     static void [0m[1;35mrx_icmp[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m       size_t min_hdr = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct [0m     [2m                [0m
[2;36m                    [0m         [39micmp[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mpkt->raw.len < min_hdr[0m[1;39m)[0m[39m return;    [0m[35m/[0m[35m/[0m[39m <=== New guard[0m                     [2m                [0m
[2;36m                    [0m         [39m       [0m[35m/[0m[35m/[0m[39m existing code follows:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [39m         [0m[33m...[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m       [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Justification[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - This one-line guard prevents the dereference of `pkt->icmp` when the buffer is[0m [2m                [0m
[2;36m                    [0m         [39mtoo small, eliminating the heap-buffer-overflow.[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - It mirrors the IPv6 handling pattern [0m[1;39m([0m[39mchecking header size before header [0m      [2m                [0m
[2;36m                    [0m         [39maccess[0m[1;39m)[0m[39m but applies at the correct byte offset for IPv4.[0m                            [2m                [0m
[2;36m                    [0m         [39m   - By checking `pkt->raw.len` directly, we ensure that the entire [0m                [2m                [0m
[2;36m                    [0m         [39mEthernet+IP+ICMP header region resides within the allocated buffer.[0m                 [2m                [0m
[2;36m                    [0m         [39m   - The rest of the ICMP echo-reply logic remains unchanged, preserving protocol [0m  [2m                [0m
[2;36m                    [0m         [39mbehavior and existing tests.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Potential Side Effects and Mitigation[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Packets that are truncated or malformed [0m[1;39m([0m[39msmaller than a full ICMPv4 header[0m[1;39m)[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mwill now be silently dropped rather than processed or rejected later. This is [0m      [2m                [0m
[2;36m                    [0m         [39macceptable, as they are invalid and were previously causing memory unsafety.[0m        [2m                [0m
[2;36m                    [0m         [39m   - No performance impact for well-formed packets, since the check is a simple [0m    [2m                [0m
[2;36m                    [0m         [39minteger compare.[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - No changes to packet transmission logic—only safety checks are added at packet[0m [2m                [0m
[2;36m                    [0m         [39mreception.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. References to Similar Patterns[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - IPv6 path in rx_ip6 [0m[1;39m([0m[39mlines [0m[1;36m839[0m[39m–[0m[1;36m843[0m[1;39m)[0m[39m performs `if [0m[1;39m([0m[39mpkt->pay.len < [0m              [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;` before proceeding. Our patch introduces a similar [0m     [2m                [0m
[2;36m                    [0m         [39mpattern at the IPv4 RX handler, but with the proper offset accounting for both [0m     [2m                [0m
[2;36m                    [0m         [39mEthernet and IPv4 headers.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFile: src/net_builtin.c[0m                                                             [2m                [0m
[2;36m                    [0m         [39mCode Range: around lines [0m[1;36m382[0m[39m–[0m[1;36m386[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/31/25 03:37:55][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=405388;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=108437;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:41:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=605046;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=95153;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:43:51][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=965530;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=150046;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=809169;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=456673;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:43:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.08[0m seconds;              ]8;id=451979;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=643619;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/31/25 03:43:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=695237;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=863353;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpxer3_hkd[0m                                                 ]8;id=12529;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=471893;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/31/25 03:44:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m7.27[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=541143;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=890923;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=587543;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=479446;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:44:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.45[0m seconds;             ]8;id=551771;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=261014;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=40257;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=773197;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:44:07][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=351316;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=778058;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1237654652[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259c708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55b6e259daa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259daa8[0m[39m,[0m[1;36m0x55b6e25b1448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55b6e2522c02[0m[39m bp [0m[1;36m0x7fff31fca760[0m[39m sp [0m[1;36m0x7fff31fca758[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e2522c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e250ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e251f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55b6e236e7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e249711f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e251f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp380a1431[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=837531;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=263713;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1237654652[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259c708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55b6e259daa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259daa8[0m[39m,[0m[1;36m0x55b6e25b1448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55b6e2522c02[0m[39m bp [0m[1;36m0x7fff31fca760[0m[39m sp [0m[1;36m0x7fff31fca758[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e2522c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e250ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e251f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55b6e236e7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e249711f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e251f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp380a1431[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1237654652[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259c708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55b6e259daa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259daa8[0m[39m,[0m[1;36m0x55b6e25b1448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55b6e2522c02[0m[39m bp [0m[1;36m0x7fff31fca760[0m[39m sp [0m[1;36m0x7fff31fca758[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e2522c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e250ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e251f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55b6e236e7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e249711f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e251f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp380a1431[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.52[0m seconds;                ]8;id=729657;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=342418;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=905194;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=951433;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:44:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.02[0m seconds;              ]8;id=500210;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=988600;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=510447;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=673673;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:44:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.97[0m seconds;              ]8;id=630896;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=909808;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=589951;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=460255;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-380[0m,[1;36m7[0m +[1;36m380[0m,[1;36m12[0m @@                                                                [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_icmp[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m         -  [35m/[0m[35m/[0m [1;35mMG_DEBUG[0m[1m([0m[1m([0m[32m"ICMP %d"[0m, [1m([0mint[1m)[0m len[1m)[0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         +  if [1m([0mpkt->ip == NULL[1m)[0m return;                                                     [2m                [0m
[2;36m                    [0m         +  size_t ihl = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                           [2m                [0m
[2;36m                    [0m         +  size_t eth_hdr = [1;35msizeof[0m[1m([0m*pkt->eth[1m)[0m;                                              [2m                [0m
[2;36m                    [0m         +  size_t min_len = eth_hdr + ihl + [1;35msizeof[0m[1m([0m*pkt->icmp[1m)[0m;                             [2m                [0m
[2;36m                    [0m         +  if [1m([0mihl [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m || pkt->raw.len < min_len[0m[1;39m)[0m[39m return;[0m                    [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [39m     size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m     size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-799[0m[39m,[0m[1;36m9[0m[39m +[0m[1;36m804[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m     struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+    size_t ihl = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mihl < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m || pkt->raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m + ihl + [0m        [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ihl[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1237654652[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259c708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55b6e259daa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259daa8[0m[39m,[0m[1;36m0x55b6e25b1448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55b6e2522c02[0m[39m bp [0m[1;36m0x7fff31fca760[0m[39m sp [0m[1;36m0x7fff31fca758[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e2522c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e250ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e251f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55b6e236e7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e249711f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e251f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp380a1431[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mAn AddressSanitizer heap-buffer-overflow was repeatedly triggered in the function [0m  [2m                [0m
[2;36m                    [0m         [39m`rx_icmp` when running the fuzz target. The issue report shows a one-byte read past[0m [2m                [0m
[2;36m                    [0m         [39mthe end of an allocated buffer in `rx_icmp`. A patch was attempted that adds a [0m     [2m                [0m
[2;36m                    [0m         [39mminimum-header-length check [0m[1;39m([0m[39m`pkt->raw.len < [0m[1;35msizeof[0m[1;39m([0m[39meth[0m[1;39m)[0m[39m+[0m[1;35msizeof[0m[1;39m([0m[39mip[0m[1;39m)[0m[39m+[0m[1;35msizeof[0m[1;39m([0m[39micmp[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mto early-exit if the packet is too short. After applying this patch, the same [0m      [2m                [0m
[2;36m                    [0m         [39moverflow is still reported at the same source location, indicating the guard did [0m   [2m                [0m
[2;36m                    [0m         [39mnot prevent the out-of-bounds access.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Initial Issue  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - During fuzzing, a heap-buffer-overflow is detected in `[0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct [0m         [2m                [0m
[2;36m                    [0m         [39mmg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m` at net_builtin.[0m[1;92mc:385[0m[39m.  [0m                         [2m                [0m
[2;36m                    [0m         [39m   - The overflow occurs on a [0m[1;36m1[0m[39m-byte read at offset just past a [0m[1;36m34[0m[39m-byte region [0m     [2m                [0m
[2;36m                    [0m         [39mallocated by `malloc` in `LLVMFuzzerTestOneInput`.  [0m                                [2m                [0m
[2;36m                    [0m         [39m   - Stack trace highlights the call chain:  [0m                                       [2m                [0m
[2;36m                    [0m         [39m     rx_icmp → mg_tcpip_rx → LLVMFuzzerTestOneInput → fuzzer loop → main.  [0m         [2m                [0m
[2;36m                    [0m         [39m   - ASan shadow-memory indicates the read address is exactly one byte beyond the [0m  [2m                [0m
[2;36m                    [0m         [39mallocated packet buffer.  [0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Important Observations  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - The offending read is based on fields in `pkt->icmp` or `pkt->raw.buf` without[0m [2m                [0m
[2;36m                    [0m         [39msufficient bounds checking.  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - The packet length [0m[1;39m([0m[39m`pkt->raw.len`[0m[1;39m)[0m[39m was used elsewhere but not validated before[0m [2m                [0m
[2;36m                    [0m         [39maccessing the ICMP header bytes.  [0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - The overflow consistently reproduces on both pre-patch and post-patch fuzz [0m    [2m                [0m
[2;36m                    [0m         [39mruns.  [0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Patch Attempt  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - In `src/net_builtin.c`, immediately at function entry of `rx_icmp`, the [0m       [2m                [0m
[2;36m                    [0m         [39mfollowing lines were added:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m       size_t min_hdr = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct [0m     [2m                [0m
[2;36m                    [0m         [39micmp[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m       if [0m[1;39m([0m[39mpkt->raw.len < min_hdr[0m[1;39m)[0m[39m return;[0m                                          [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - The goal was to bail out on packets shorter than the combined Ethernet, IP, [0m   [2m                [0m
[2;36m                    [0m         [39mand ICMP header lengths.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Result After Patch  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - Fuzzer logs post-patch show an identical heap-buffer-overflow at [0m              [2m                [0m
[2;36m                    [0m         [39mnet_builtin.[0m[1;92mc:385[0m[39m in `rx_icmp`.  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - The call stack, shadow bytes layout, and scoping of the corruption remain [0m     [2m                [0m
[2;36m                    [0m         [39munchanged.  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - The early-return guard did not catch the fuzzed packet size or did not apply [0m  [2m                [0m
[2;36m                    [0m         [39min the code path leading to the overflow.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Areas for Further Investigation  [0m                                                [2m                [0m
[2;36m                    [0m         [39m   - The definition and population of `pkt->raw.len` and `pkt->raw.buf` in the [0m     [2m                [0m
[2;36m                    [0m         [39mpacket receive path.  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - How `pkt->icmp` is set and whether additional checks on `pkt->icmp->type`, [0m    [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp->code`, or other header fields assume more available data than [0m          [2m                [0m
[2;36m                    [0m         [39mallocated.  [0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - Any other code paths in `mg_tcpip_rx` that lead to accessing payload bytes [0m    [2m                [0m
[2;36m                    [0m         [39mafter the ICMP header.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - The layout and size of the `struct pkt` and how fragmentation or variant [0m      [2m                [0m
[2;36m                    [0m         [39mpacket sizes are handled.  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - Interaction between the fuzzer’s input processing in `LLVMFuzzerTestOneInput` [0m [2m                [0m
[2;36m                    [0m         [39mand the packet parser routines.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m856586979[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83203708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55cc83204aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc83204aa8[0m[39m,[0m[1;36m0x55cc83218448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55cc83189c02[0m[39m bp [0m[1;36m0x7ffc693aeac0[0m[39m sp [0m[1;36m0x7ffc693aeab8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc83189c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc83171d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc831868b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc82fd57ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc830fe11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc8318679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc82ff2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc82fdd5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc82fe305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc8300e302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fa222b43082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpt_zvx9dm[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mmongoose.[0m[1;92mc:4000[0m[39m-[0m[1;36m4147[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m4000[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4001[0m[39m:struct mg_connection *[0m[1;35mmg_wrapfd[0m[1;39m([0m[39mstruct mg_mgr *mgr, int fd,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m4002[0m[39m:                                mg_event_handler_t fn, void *fn_data[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m4003[0m[39m:  struct mg_connection *c = [0m[1;35mmg_alloc_conn[0m[1;39m([0m[39mmgr[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m4004[0m[39m:  if [0m[1;39m([0m[39mc != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m4005[0m[39m:    c->fd = [0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m fd;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m4006[0m[39m:    c->fn = fn;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m4007[0m[39m:    c->fn_data = fn_data;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m4008[0m[39m:    [0m[1;35mMG_EPOLL_ADD[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m4009[0m[39m:    [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_OPEN, NULL[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m4010[0m[39m:    [0m[1;35mLIST_ADD_[0m[1;33mHEAD[0m[1;39m([0m[39mstruct mg_connection, &mgr->conns, c[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m4011[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4012[0m[39m:  return c;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m4013[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4014[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4015[0m[39m:struct mg_timer *[0m[1;35mmg_timer_add[0m[1;39m([0m[39mstruct mg_mgr *mgr, uint64_t milliseconds,[0m       [2m                [0m
[2;36m                    [0m         [1;36m4016[0m[39m:                              unsigned flags, void [0m[1;39m([0m[39m*fn[0m[1;39m)[0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m, void *arg[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m4017[0m[39m:  struct mg_timer *t = [0m[1;39m([0m[39mstruct mg_timer *[0m[1;39m)[0m[39m [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*t[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m4018[0m[39m:  if [0m[1;39m([0m[39mt != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m4019[0m[39m:    [0m[1;35mmg_timer_init[0m[1;39m([0m[39m&mgr->timers, t, milliseconds, flags, fn, arg[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m4020[0m[39m:    t->id = mgr->timerid++;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4021[0m[39m:  [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4022[0m[39m:  return t;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m4023[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4024[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4025[0m[39m:long [0m[1;35mmg_io_recv[0m[1;39m([0m[39mstruct mg_connection *c, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m4026[0m[39m:  if [0m[1;39m([0m[39mc->rtls.len == [0m[1;36m0[0m[1;39m)[0m[39m return MG_IO_WAIT;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m4027[0m[39m:  if [0m[1;39m([0m[39mlen > c->rtls.len[0m[1;39m)[0m[39m len = c->rtls.len;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m4028[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39mbuf, c->rtls.buf, len[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m4029[0m[39m:  [0m[1;35mmg_iobuf_del[0m[1;39m([0m[39m&c->rtls, [0m[1;36m0[0m[39m, len[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m4030[0m[39m:  return [0m[1;39m([0m[39mlong[0m[1;39m)[0m[39m len;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m4031[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4032[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4033[0m[39m:void [0m[1;35mmg_mgr_free[0m[1;39m([0m[39mstruct mg_mgr *mgr[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m4034[0m[39m:  struct mg_connection *c;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m4035[0m[39m:  struct mg_timer *tmp, *t = mgr->timers;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m4036[0m[39m:  while [0m[1;39m([0m[39mt != NULL[0m[1;39m)[0m[39m tmp = t->next, [0m[1;35mfree[0m[1;39m([0m[39mt[0m[1;39m)[0m[39m, t = tmp;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m4037[0m[39m:  mgr->timers = NULL;  [0m[35m/[0m[35m/[0m[39m Important. Next call to poll won't touch timers[0m      [2m                [0m
[2;36m                    [0m         [1;36m4038[0m[39m:  for [0m[1;39m([0m[39mc = mgr->conns; c != NULL; c = c->next[0m[1;39m)[0m[39m c->is_closing = [0m[1;36m1[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m4039[0m[39m:  [0m[1;35mmg_mgr_poll[0m[1;39m([0m[39mmgr, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m4040[0m[39m:#if MG_ENABLE_FREERTOS_TCP[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m4041[0m[39m:  [0m[1;35mFreeRTOS_DeleteSocketSet[0m[1;39m([0m[39mmgr->ss[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m4042[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m4043[0m[39m:  [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"All connections closed"[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m4044[0m[39m:#if MG_ENABLE_EPOLL[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4045[0m[39m:  if [0m[1;39m([0m[39mmgr->epoll_fd >= [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;35mclose[0m[1;39m([0m[39mmgr->epoll_fd[0m[1;39m)[0m[39m, mgr->epoll_fd = [0m[1;36m-1[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m4046[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m4047[0m[39m:  [0m[1;35mmg_tls_ctx_free[0m[1;39m([0m[39mmgr[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m4048[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4049[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4050[0m[39m:void [0m[1;35mmg_mgr_init[0m[1;39m([0m[39mstruct mg_mgr *mgr[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m4051[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39mmgr, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*mgr[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m4052[0m[39m:#if MG_ENABLE_EPOLL[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m4053[0m[39m:  if [0m[1;39m([0m[1;39m([0m[39mmgr->epoll_fd = [0m[1;35mepoll_create1[0m[1;39m([0m[39mEPOLL_CLOEXEC[0m[1;39m)[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m4054[0m[39m:    [0m[1;35mMG_ERROR[0m[1;39m([0m[1;39m([0m[32m"epoll_create1 errno %d"[0m[39m, errno[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m4055[0m[39m:#else[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m4056[0m[39m:  mgr->epoll_fd = [0m[1;36m-1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4057[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m4058[0m[39m:#if MG_ARCH == MG_ARCH_WIN32 && MG_ENABLE_WINSOCK[0m                              [2m                [0m
[2;36m                    [0m         [1;36m4059[0m[39m:  [0m[35m/[0m[35m/[0m[39m clang-format off[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4060[0m[39m:  [0m[1;39m{[0m[39m WSADATA data; [0m[1;35mWSAStartup[0m[1;39m([0m[1;35mMAKEWORD[0m[1;39m([0m[1;36m2[0m[39m, [0m[1;36m2[0m[1;39m)[0m[39m, &data[0m[1;39m)[0m[39m; [0m[1;39m}[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4061[0m[39m:  [0m[35m/[0m[35m/[0m[39m clang-format on[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m4062[0m[39m:#elif MG_ENABLE_FREERTOS_TCP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m4063[0m[39m:  mgr->ss = [0m[1;35mFreeRTOS_CreateSocketSet[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m4064[0m[39m:#elif [0m[1;35mdefined[0m[1;39m([0m[39m__unix[0m[1;39m)[0m[39m || [0m[1;35mdefined[0m[1;39m([0m[39m__unix__[0m[1;39m)[0m[39m || [0m[1;35mdefined[0m[1;39m([0m[39m__APPLE__[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m4065[0m[39m:  [0m[35m/[0m[35m/[0m[39m Ignore SIGPIPE signal, so if client cancels the request, it[0m               [2m                [0m
[2;36m                    [0m         [1;36m4066[0m[39m:  [0m[35m/[0m[35m/[0m[39m won't kill the whole process.[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m4067[0m[39m:  [0m[1;35msignal[0m[1;39m([0m[39mSIGPIPE, SIG_IGN[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4068[0m[39m:#elif MG_ENABLE_TCPIP_DRIVER_INIT && [0m[1;35mdefined[0m[1;39m([0m[39mMG_TCPIP_DRIVER_INIT[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m4069[0m[39m:  [0m[1;35mMG_TCPIP_DRIVER_INIT[0m[1;39m([0m[39mmgr[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m4070[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m4071[0m[39m:  mgr->pipe = MG_INVALID_SOCKET;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m4072[0m[39m:  mgr->dnstimeout = [0m[1;36m3000[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m4073[0m[39m:  mgr->dns4.url = [0m[32m"udp://8.8.8.8:53"[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m4074[0m[39m:  mgr->dns6.url = [0m[32m"udp://[0m[32m[[0m[32m2001:4860:4860::8888[0m[32m][0m[32m:53"[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m4075[0m[39m:  [0m[1;35mmg_tls_ctx_init[0m[1;39m([0m[39mmgr[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m4076[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4077[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4078[0m[39m:#ifdef MG_ENABLE_LINES[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m4079[0m[39m:#line [0m[1;36m1[0m[39m [0m[32m"src/net_builtin.c"[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4080[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m4081[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4082[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4083[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                [2m                [0m
[2;36m                    [0m         [1;36m4084[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m4085[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m4086[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4087[0m[39m:#ifndef MIP_TCP_KEEPALIVE_MS[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m4088[0m[39m:#define MIP_TCP_KEEPALIVE_MS [0m[1;36m45000[0m[39m  [0m[35m/[0m[35m/[0m[39m TCP keep-alive period, ms[0m               [2m                [0m
[2;36m                    [0m         [1;36m4089[0m[39m:#endif[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m4090[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4091[0m[39m:#define MIP_TCP_ACK_MS [0m[1;36m150[0m[39m    [0m[35m/[0m[35m/[0m[39m Timeout for ACKing[0m                            [2m                [0m
[2;36m                    [0m         [1;36m4092[0m[39m:#define MIP_ARP_RESP_MS [0m[1;36m100[0m[39m   [0m[35m/[0m[35m/[0m[39m Timeout for ARP response[0m                      [2m                [0m
[2;36m                    [0m         [1;36m4093[0m[39m:#define MIP_TCP_SYN_MS [0m[1;36m15000[0m[39m  [0m[35m/[0m[35m/[0m[39m Timeout for connection establishment[0m          [2m                [0m
[2;36m                    [0m         [1;36m4094[0m[39m:#define MIP_TCP_FIN_MS [0m[1;36m1000[0m[39m   [0m[35m/[0m[35m/[0m[39m Timeout for closing connection[0m                [2m                [0m
[2;36m                    [0m         [1;36m4095[0m[39m:#define MIP_TCP_WIN [0m[1;36m6000[0m[39m      [0m[35m/[0m[35m/[0m[39m TCP window size[0m                               [2m                [0m
[2;36m                    [0m         [1;36m4096[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4097[0m[39m:struct connstate [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m4098[0m[39m:  uint32_t seq, ack;           [0m[35m/[0m[35m/[0m[39m TCP seq/ack counters[0m                         [2m                [0m
[2;36m                    [0m         [1;36m4099[0m[39m:  uint64_t timer;              [0m[35m/[0m[35m/[0m[39m TCP keep-alive [0m[35m/[0m[39m ACK timer[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4100[0m[39m:  uint32_t acked;              [0m[35m/[0m[35m/[0m[39m Last ACK-ed number[0m                           [2m                [0m
[2;36m                    [0m         [1;36m4101[0m[39m:  size_t unacked;              [0m[35m/[0m[35m/[0m[39m Not acked bytes[0m                              [2m                [0m
[2;36m                    [0m         [1;36m4102[0m[39m:  uint8_t mac[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;              [0m[35m/[0m[35m/[0m[39m Peer MAC address[0m                             [2m                [0m
[2;36m                    [0m         [1;36m4103[0m[39m:  uint8_t ttype;               [0m[35m/[0m[35m/[0m[39m Timer type. [0m[1;36m0[0m[39m: ack, [0m[1;36m1[0m[39m: keep-alive[0m            [2m                [0m
[2;36m                    [0m         [1;36m4104[0m[39m:#define MIP_TTYPE_KEEPALIVE [0m[1;36m0[0m[39m  [0m[35m/[0m[35m/[0m[39m Connection is idle for long, send keepalive[0m  [2m                [0m
[2;36m                    [0m         [1;36m4105[0m[39m:#define MIP_TTYPE_ACK [0m[1;36m1[0m[39m        [0m[35m/[0m[35m/[0m[39m Peer sent us data, we have to ack it soon[0m    [2m                [0m
[2;36m                    [0m         [1;36m4106[0m[39m:#define MIP_TTYPE_ARP [0m[1;36m2[0m[39m        [0m[35m/[0m[35m/[0m[39m ARP resolve sent, waiting for response[0m       [2m                [0m
[2;36m                    [0m         [1;36m4107[0m[39m:#define MIP_TTYPE_SYN [0m[1;36m3[0m[39m        [0m[35m/[0m[35m/[0m[39m SYN sent, waiting for response[0m               [2m                [0m
[2;36m                    [0m         [1;36m4108[0m[39m:#define MIP_TTYPE_FIN [0m[1;36m4[0m[39m  [0m[35m/[0m[35m/[0m[39m FIN sent, waiting until terminating the connection[0m [2m                [0m
[2;36m                    [0m         [1;36m4109[0m[39m:  uint8_t tmiss;         [0m[35m/[0m[35m/[0m[39m Number of keep-alive misses[0m                        [2m                [0m
[2;36m                    [0m         [1;36m4110[0m[39m:  struct mg_iobuf raw;   [0m[35m/[0m[35m/[0m[39m For TLS only. Incoming raw data[0m                    [2m                [0m
[2;36m                    [0m         [1;36m4111[0m[39m:  bool fin_rcvd;         [0m[35m/[0m[35m/[0m[39m We have received FIN from the peer[0m                 [2m                [0m
[2;36m                    [0m         [1;36m4112[0m[39m:  bool twclosure;        [0m[35m/[0m[35m/[0m[39m [0m[1;36m3[0m[39m-way closure done[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m4113[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4114[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4115[0m[39m:#pragma [0m[1;35mpack[0m[1;39m([0m[39mpush, [0m[1;36m1[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m4116[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4117[0m[39m:struct lcp [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m4118[0m[39m:  uint8_t addr, ctrl, proto[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m, code, id, len[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m4119[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4120[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4121[0m[39m:struct eth [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m4122[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m4123[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m4124[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m4125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4126[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4127[0m[39m:struct ip [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m4128[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m4129[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4130[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4131[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4132[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m4133[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m4134[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m4135[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m4136[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m4137[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m4138[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m4139[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m4140[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4141[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4142[0m[39m:struct ip6 [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m4143[0m[39m:  uint8_t ver;      [0m[35m/[0m[35m/[0m[39m Version[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m4144[0m[39m:  uint8_t opts[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Options[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m4145[0m[39m:  uint16_t len;     [0m[35m/[0m[35m/[0m[39m Length[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m4146[0m[39m:  uint8_t proto;    [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m4147[0m[39m:  uint8_t ttl;      [0m[35m/[0m[35m/[0m[39m Time to live[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m388[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m864[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The heap-buffer-overflow is caused by dereferencing `pkt->icmp->type` in [0m      [2m                [0m
[2;36m                    [0m         [39m`rx_icmp` without ensuring the ICMP header actually lies within the allocated [0m      [2m                [0m
[2;36m                    [0m         [39m`pkt->raw.buf`. Fuzzed packets with IPv4 options [0m[1;39m([0m[39mi.e. `[0m[1;39m([0m[39mip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[39m`[0m[1;39m)[0m[39m make [0m [2m                [0m
[2;36m                    [0m         [39mthe IP header longer than [0m[1;36m20[0m[39m bytes, so the existing code’s fixed cast `pkt->icmp = [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` points past the end of the buffer, and the later [0m     [2m                [0m
[2;36m                    [0m         [39m`pkt->pay` pointer from `mkpay` uses a different offset, compounding the mismatch.[0m  [2m                [0m
[2;36m                    [0m         [39m   - The earlier patch in `rx_icmp` checked `pkt->raw.len < [0m                        [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39meth[0m[1;39m)[0m[39m+[0m[1;35msizeof[0m[1;39m([0m[39mip[0m[1;39m)[0m[39m+[0m[1;35msizeof[0m[1;39m([0m[39micmp[0m[1;39m)[0m[39m`, but this guard is reached **after** the [0m      [2m                [0m
[2;36m                    [0m         [39mdereference of `pkt->icmp->type` and still assumes a fixed [0m[1;36m20[0m[39m-byte IP header. Hence[0m [2m                [0m
[2;36m                    [0m         [39mit neither prevents OOB access nor handles variable-length IPv4 headers.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Patch Plan[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   A. In the IPv4 packet parsing function `rx_ip` [0m[1;39m([0m[39msrc/net_builtin.c lines [0m         [2m                [0m
[2;36m                    [0m         [39m~[0m[1;36m794[0m[39m–[0m[1;36m805[0m[1;39m)[0m[39m, perform these steps **before** assigning `pkt->icmp` and calling [0m        [2m                [0m
[2;36m                    [0m         [39m`rx_icmp`:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m1[0m[39m. Extract the actual IPv4 header length in bytes from the IHL field:  [0m       [2m                [0m
[2;36m                    [0m         [39m         `size_t ihl = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;`[0m                                   [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m2[0m[39m. Validate `ihl` is at least the minimum IPv4 header size [0m[1;39m([0m[39m`[0m[1;35msizeof[0m[1;39m([0m[39mstruct [0m   [2m                [0m
[2;36m                    [0m         [39mip[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m and not absurdly large:  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m         `if [0m[1;39m([0m[39mihl < [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m || ihl > pkt->raw.len - [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mreturn;`[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m3[0m[39m. Compute the total offset from the buffer start to the end of the ICMP [0m     [2m                [0m
[2;36m                    [0m         [39mheader:  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m         `size_t icmp_offset = [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ihl + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.icmp[0m[1;39m)[0m[39m;`[0m         [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m4[0m[39m. Check that the packet buffer contains at least `icmp_offset` bytes:  [0m      [2m                [0m
[2;36m                    [0m         [39m         `if [0m[1;39m([0m[39mpkt->raw.len < icmp_offset[0m[1;39m)[0m[39m return;`[0m                                  [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m5[0m[39m. Set `pkt->icmp` to the correct start of the ICMP header:  [0m                 [2m                [0m
[2;36m                    [0m         [39m         `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ihl[0m[1;39m)[0m[39m;`[0m                      [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m6[0m[39m. Call `mkpay` with the pointer immediately after the ICMP header to set [0m    [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.buf` and `pkt->pay.len`:  [0m                                                [2m                [0m
[2;36m                    [0m         [39m         `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m;`[0m                      [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m7[0m[39m. Finally, invoke `[0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;`[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m   B. [0m[1;39m([0m[39mOptional safety[0m[1;39m)[0m[39m At the entry of `rx_icmp`, insert a guard that uses the [0m    [2m                [0m
[2;36m                    [0m         [39m**same** IPv4 header length logic to ensure any stray calls with malformed or [0m      [2m                [0m
[2;36m                    [0m         [39mtruncated packets are still checked before dereferencing:[0m                           [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m1[0m[39m. Recompute `ihl` and required minimal packet size:  [0m                        [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         size_t ihl = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m         size_t min_len = [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ihl + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.icmp[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39mpkt->raw.len < min_len[0m[1;39m)[0m[39m return;[0m                                        [2m                [0m
[2;36m                    [0m         [39m         ```[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m2[0m[39m. This must appear **before** the `pkt->icmp->type` access.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Preservation of Functionality[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Legitimate ICMP Echo Requests [0m[1;39m([0m[39mtype [0m[1;36m8[0m[1;39m)[0m[39m on standard [0m[1;36m20[0m[39m-byte IPv4 headers will [0m  [2m                [0m
[2;36m                    [0m         [39mstill be processed unchanged, since `ihl == [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m` passes the new [0m      [2m                [0m
[2;36m                    [0m         [39mchecks and `pkt->icmp` remains at `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m`.[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - IPv4 packets with options [0m[1;39m([0m[39mlonger headers[0m[1;39m)[0m[39m will have `pkt->icmp` correctly [0m    [2m                [0m
[2;36m                    [0m         [39mlocated, so `pkt->icmp->type` reads valid memory or the packet is dropped if [0m       [2m                [0m
[2;36m                    [0m         [39mtruncated. There is no change to the reply construction in `rx_icmp`, preserving [0m   [2m                [0m
[2;36m                    [0m         [39mecho-reply logic.[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - Downstream code [0m[1;39m([0m[39m`tx_ip`, `ether_output`[0m[1;39m)[0m[39m remains untouched, so no other [0m      [2m                [0m
[2;36m                    [0m         [39mprotocols or TCP/UDP paths are affected.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Side-Effect Mitigation[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Malformed or truncated ICMP packets [0m[1;39m([0m[39mincluding those with bogus header [0m        [2m                [0m
[2;36m                    [0m         [39mlengths[0m[1;39m)[0m[39m will be silently dropped early in `rx_ip`, which is acceptable and [0m        [2m                [0m
[2;36m                    [0m         [39mconsistent with existing behavior for other invalid packets.[0m                        [2m                [0m
[2;36m                    [0m         [39m   - No broad exception catching is introduced; we maintain explicit length checks [0m [2m                [0m
[2;36m                    [0m         [39monly.[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m   - Fuzz harness, tests, and external modules remain unchanged.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Similar Patterns in Codebase[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - The IPv6 path already uses computed payload offsets instead of fixed casts; [0m   [2m                [0m
[2;36m                    [0m         [39mthis patch aligns the IPv4/ICMP handling to the same robust pattern.[0m                [2m                [0m
[2;36m                    [0m         [39m   - Other protocol parsers [0m[1;39m([0m[39me.g. UDP/TCP[0m[1;39m)[0m[39m in `rx_ip` use length checks based on [0m   [2m                [0m
[2;36m                    [0m         [39mheader fields; we apply the same rigor here.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Implementation Steps[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - Edit `src/net_builtin.c`, function `rx_ip` at the ICMP branch:[0m                 [2m                [0m
[2;36m                    [0m         [39m     - Replace the current fixed cast and `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m` with the new [0m [2m                [0m
[2;36m                    [0m         [39mlogic outlined in step 2A.[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - Optionally, edit `src/net_builtin.c`, function `rx_icmp` to add the minimal [0m   [2m                [0m
[2;36m                    [0m         [39mearly-return guard before accessing `pkt->icmp->type`.[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Compile and re-run the fuzz target to confirm the heap-buffer-overflow is [0m     [2m                [0m
[2;36m                    [0m         [39mresolved and existing tests pass.[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. No External or Harness Code Modification[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - All changes are confined to `src/net_builtin.c`.[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Fuzzing harness and other test code are unaffected, fulfilling the requirement[0m [2m                [0m
[2;36m                    [0m         [39mto preserve existing tests and harness logic.[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/31/25 03:44:20][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=88045;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=108308;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:46:37][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=51388;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=348949;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:48:07][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=324077;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=300707;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=369335;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=37674;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:48:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.04[0m seconds;              ]8;id=109575;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=865290;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=458567;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=207489;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpradcsjeh[0m                                                 ]8;id=794151;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=685097;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/31/25 03:48:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m7.35[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=134673;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=254263;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=807280;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=717873;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:48:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.39[0m seconds;             ]8;id=8250;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=676002;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=500486;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=386551;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:48:22][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=887117;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=920966;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1493118286[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b3708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x556b4e6b4aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b4aa8[0m[39m,[0m[1;36m0x556b4e6c8448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x556b4e639c02[0m[39m bp [0m[1;36m0x7ffc7eaeff20[0m[39m sp [0m[1;36m0x7ffc7eaeff18[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e639c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e621d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e6368b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x556b4e4857ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e5ae11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e63679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiurg_oy_[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=340222;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=570663;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1493118286[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b3708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x556b4e6b4aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b4aa8[0m[39m,[0m[1;36m0x556b4e6c8448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x556b4e639c02[0m[39m bp [0m[1;36m0x7ffc7eaeff20[0m[39m sp [0m[1;36m0x7ffc7eaeff18[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e639c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e621d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e6368b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x556b4e4857ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e5ae11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e63679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiurg_oy_[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1493118286[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b3708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x556b4e6b4aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b4aa8[0m[39m,[0m[1;36m0x556b4e6c8448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x556b4e639c02[0m[39m bp [0m[1;36m0x7ffc7eaeff20[0m[39m sp [0m[1;36m0x7ffc7eaeff18[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e639c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e621d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e6368b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x556b4e4857ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e5ae11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e63679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiurg_oy_[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.44[0m seconds;                ]8;id=477202;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=620444;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=269104;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=806691;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:48:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.97[0m seconds;              ]8;id=570155;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=727211;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/31/25 03:48:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=186387;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=266969;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:48:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.01[0m seconds;              ]8;id=567287;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=714386;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=273549;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=791765;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-380[0m,[1;36m7[0m +[1;36m380[0m,[1;36m12[0m @@                                                                [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_icmp[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m         -  [35m/[0m[35m/[0m [1;35mMG_DEBUG[0m[1m([0m[1m([0m[32m"ICMP %d"[0m, [1m([0mint[1m)[0m len[1m)[0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         +  if [1m([0mpkt->ip == NULL[1m)[0m return;                                                     [2m                [0m
[2;36m                    [0m         +  size_t ihl = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                           [2m                [0m
[2;36m                    [0m         +  size_t eth_hdr = [1;35msizeof[0m[1m([0m*pkt->eth[1m)[0m;                                              [2m                [0m
[2;36m                    [0m         +  size_t min_len = eth_hdr + ihl + [1;35msizeof[0m[1m([0m*pkt->icmp[1m)[0m;                             [2m                [0m
[2;36m                    [0m         +  if [1m([0mihl [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m || pkt->raw.len < min_len[0m[1;39m)[0m[39m return;[0m                    [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [39m     size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m     size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-799[0m[39m,[0m[1;36m9[0m[39m +[0m[1;36m804[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m     struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+    size_t ihl = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mihl < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m || pkt->raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m + ihl + [0m        [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->ip + ihl[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1493118286[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b3708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x556b4e6b4aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b4aa8[0m[39m,[0m[1;36m0x556b4e6c8448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x556b4e639c02[0m[39m bp [0m[1;36m0x7ffc7eaeff20[0m[39m sp [0m[1;36m0x7ffc7eaeff18[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e639c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e621d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e6368b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x556b4e4857ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e5ae11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e63679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiurg_oy_[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mA libFuzzer run with AddressSanitizer identified a heap-buffer-overflow in [0m         [2m                [0m
[2;36m                    [0m         [39m`rx_icmp` [0m[1;39m([0m[39min `src/net_builtin.[0m[1;92mc:385[0m[39m`[0m[1;39m)[0m[39m when processing malformed packets. An [0m       [2m                [0m
[2;36m                    [0m         [39mattempted patch added null checks and bounds checks on the IP header length [0m[1;39m([0m[39m`ihl`[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mand the overall packet raw length before accessing the ICMP header. After applying [0m [2m                [0m
[2;36m                    [0m         [39mthese checks both in `rx_icmp` and in `mg_tcpip_rx` [0m[1;39m([0m[39mreplacing pointer arithmetic [0m  [2m                [0m
[2;36m                    [0m         [39mwith `char*` offsets and early returns[0m[1;39m)[0m[39m, the same overflow was still reproducible [0m  [2m                [0m
[2;36m                    [0m         [39mat the same source location.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInitial Issue  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- A one‐byte read beyond the end of a heap‐allocated buffer was detected in the [0m    [2m                [0m
[2;36m                    [0m         [39mfunction `[0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m`.  [0m                                           [2m                [0m
[2;36m                    [0m         [39m- The crash report shows an AddressSanitizer error at line [0m[1;36m385[0m[39m in [0m                  [2m                [0m
[2;36m                    [0m         [39m`src/net_builtin.c`, triggered when reading `pkt->icmp->type`.  [0m                    [2m                [0m
[2;36m                    [0m         [39m- The failing allocation is [0m[1;36m34[0m[39m bytes long, and the overflow attempt reads one byte [0m [2m                [0m
[2;36m                    [0m         [39mjust past the allocated region.  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Stack trace highlights calls: `rx_icmp` → `mg_tcpip_rx` → [0m                        [2m                [0m
[2;36m                    [0m         [39m`LLVMFuzzerTestOneInput` → libFuzzer runtime.[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mImportant Observations  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m- `pkt->ip` was non‐NULL and `pkt->icmp` was computed as `[0m[1;39m([0m[39mstruct icmp*[0m[1;39m)[0m[1;39m([0m[39mpkt->ip + [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[1;39m)[0m[39m`, without verifying that the data buffer actually contains a full ICMP header.  [0m [2m                [0m
[2;36m                    [0m         [39m- `pkt->raw.len` [0m[1;39m([0m[39mthe total available data[0m[1;39m)[0m[39m was insufficiently checked prior to [0m    [2m                [0m
[2;36m                    [0m         [39mdereferencing the ICMP fields.  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m- The ADDRESSSANITIZER shadow memory indicates the byte read was exactly at the [0m    [2m                [0m
[2;36m                    [0m         [39mbuffer boundary.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPatch Attempt  [0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- In `rx_icmp`, added:  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m  • `if [0m[1;39m([0m[39mpkt->ip == NULL[0m[1;39m)[0m[39m return;`  [0m                                                [2m                [0m
[2;36m                    [0m         [39m  • Compute `ihl = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m`.  [0m                                     [2m                [0m
[2;36m                    [0m         [39m  • Compute `eth_hdr = [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m` and `min_len = eth_hdr + ihl + [0m           [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m`.  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m  • Early return if `ihl < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` or `pkt->raw.len < min_len`.  [0m         [2m                [0m
[2;36m                    [0m         [39m- In `mg_tcpip_rx`, for `ip->proto == [0m[1;36m1[0m[39m` case, replaced:  [0m                          [2m                [0m
[2;36m                    [0m         [39m    pkt->icmp = [0m[1;39m([0m[39micmp*[0m[1;39m)[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;  [0m                                             [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m  with:  [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m    compute the same `ihl` and `min_len` guard;  [0m                                   [2m                [0m
[2;36m                    [0m         [39m    set `pkt->icmp = [0m[1;39m([0m[39mstruct icmp*[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mchar*[0m[1;39m)[0m[39mpkt->ip + ihl[0m[1;39m)[0m[39m;`  [0m                       [2m                [0m
[2;36m                    [0m         [39m    call `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, [0m[1;39m([0m[39mchar*[0m[1;39m)[0m[39mpkt->icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m;`.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPost-Patch Log  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- The fuzzer was rerun with the same input and parameters [0m[1;39m([0m[39m`-[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m`[0m[1;39m)[0m[39m.  [0m          [2m                [0m
[2;36m                    [0m         [39m- AddressSanitizer reported the same one‐byte heap-buffer-overflow in `rx_icmp` at [0m [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m385[0m[39m.  [0m                                                                         [2m                [0m
[2;36m                    [0m         [39m- The heap region, stack trace, and overflow offset remain identical.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAreas for Further Investigation  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m- The logic around packet length fields [0m[1;39m([0m[39m`pkt->raw.len`, `pkt->pay.len`[0m[1;39m)[0m[39m and how [0m   [2m                [0m
[2;36m                    [0m         [39mthey are initialized in `mg_tcpip_rx`.  [0m                                            [2m                [0m
[2;36m                    [0m         [39m- The offset computation for the ICMP header: ensure that IP header length and [0m     [2m                [0m
[2;36m                    [0m         [39mEthernet header size align with packet buffer layout.  [0m                             [2m                [0m
[2;36m                    [0m         [39m- Interaction between `mkpay` [0m[1;39m([0m[39mwhich adjusts packet payload pointers[0m[1;39m)[0m[39m and the [0m      [2m                [0m
[2;36m                    [0m         [39mbounds of the allocated buffer.  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Any other code paths leading to `rx_icmp` where `pkt->raw.len` or `pkt->ip` might[0m [2m                [0m
[2;36m                    [0m         [39mbe inconsistent with actual buffer size.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1237654652[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259c708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55b6e259daa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55b6e259daa8[0m[39m,[0m[1;36m0x55b6e25b1448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55b6e2522c02[0m[39m bp [0m[1;36m0x7fff31fca760[0m[39m sp [0m[1;36m0x7fff31fca758[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e2522c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e250ad1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e251f8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55b6e236e7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55b6e249711f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55b6e251f79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55b6e238b350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55b6e23765c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55b6e237c05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55b6e23a7302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fe27511a082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp380a1431[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:124[0m[39m-[0m[1;36m160[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:  uint8_t options[0m[1;39m[[0m[1;36m32[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:#pragma [0m[1;35mpack[0m[1;39m([0m[39mpop[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:  if [0m[1;39m([0m[39mifp->fn != NULL[0m[1;39m)[0m[39m ifp->[0m[1;35mfn[0m[1;39m([0m[39mifp, ev, ev_data[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:static void [0m[1;35msend_syn[0m[1;39m([0m[39mstruct mg_connection *c[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:static uint32_t [0m[1;35mcsumup[0m[1;39m([0m[39muint32_t sum, const void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:  size_t i;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:  const uint8_t *p = [0m[1;39m([0m[39mconst uint8_t *[0m[1;39m)[0m[39m buf;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:  for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < len; i++[0m[1;39m)[0m[39m sum += i & [0m[1;36m1[0m[39m ? p[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m : [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m p[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:  return sum;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:147[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:static void [0m[1;35msend_syn[0m[1;39m([0m[39mstruct mg_connection *c[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m930[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"Unknown eth type %x"[0m[39m, [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt.eth->type[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    if [0m[1;39m([0m[39mmg_log_level >= MG_LL_VERBOSE[0m[1;39m)[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len >= [0m[1;36m32[0m[39m ? [0m[1;36m32[0m[39m : len[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m902[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m903[0m[39m:static void [0m[1;35mmg_tcpip_poll[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, uint64_t now[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m904[0m[39m:  struct mg_connection *c;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m905[0m[39m:  bool expired_1000ms = [0m[1;35mmg_timer_expired[0m[1;39m([0m[39m&ifp->timer_1000ms, [0m[1;36m1000[0m[39m, now[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m906[0m[39m:  ifp->now = now;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:  if [0m[1;39m([0m[39mexpired_1000ms[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:#if MG_ENABLE_TCPIP_PRINT_DEBUG_STATS[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:    const char *names[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[32m"down"[0m[39m, [0m[32m"up"[0m[39m, [0m[32m"req"[0m[39m, [0m[32m"ip"[0m[39m, [0m[32m"ready"[0m[1;39m}[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m911[0m[39m:    [0m[1;35mMG_INFO[0m[1;39m([0m[1;39m([0m[32m"Status: %s, IP: %M, rx:%u, tx:%u, dr:%u, er:%u"[0m[39m,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m912[0m[39m:             names[0m[1;39m[[0m[39mifp->state[0m[1;39m][0m[39m, mg_print_ip4, &ifp->ip, ifp->nrecv, ifp->nsent,[0m [2m                [0m
[2;36m                    [0m         [1;36m913[0m[39m:             ifp->ndrop, ifp->nerr[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m914[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m915[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m916[0m[39m:  [0m[35m/[0m[35m/[0m[39m Handle gw ARP request timeout, order is important[0m                          [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:  if [0m[1;39m([0m[39mexpired_1000ms && ifp->state == MG_TCPIP_STATE_IP[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:    ifp->state = MG_TCPIP_STATE_READY;  [0m[35m/[0m[35m/[0m[39m keep best-effort MAC[0m                 [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[1;35monstatechange[0m[1;39m([0m[39mifp[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:  [0m[35m/[0m[35m/[0m[39m Handle physical interface up/down status[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:  if [0m[1;39m([0m[39mexpired_1000ms && ifp->driver->up[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:    bool up = ifp->driver->[0m[1;35mup[0m[1;39m([0m[39mifp[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    bool current = ifp->state != MG_TCPIP_STATE_DOWN;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    if [0m[1;39m([0m[39m!up && ifp->enable_dhcp_client[0m[1;39m)[0m[39m ifp->ip = [0m[1;36m0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:    if [0m[1;39m([0m[39mup != current[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m link state has changed[0m                             [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:      ifp->state = up == false ? MG_TCPIP_STATE_DOWN[0m                            [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:                   : ifp->enable_dhcp_client || ifp->ip == [0m[1;36m0[0m                    [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:                       ? MG_TCPIP_STATE_UP[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m930[0m[39m:                       : MG_TCPIP_STATE_IP;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo eliminate the one‐byte heap‐buffer‐overflow in rx_icmp without touching the [0m     [2m                [0m
[2;36m                    [0m         [39mharness or utility layers, we must ensure that every dereference of the ICMP header[0m [2m                [0m
[2;36m                    [0m         [39mis preceded by a precise bounds check against the real buffer length. There are two[0m [2m                [0m
[2;36m                    [0m         [39mplaces to harden: [0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m in the IPv4 dispatch [0m[1;39m([0m[39m`rx_ip`[0m[1;39m)[0m[39m, before we even point at an [0m   [2m                [0m
[2;36m                    [0m         [39mICMP header; and [0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m inside `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`, before we read `pkt->icmp->type`. Both [0m    [2m                [0m
[2;36m                    [0m         [39mroles are needed because `rx_ip` decides to call `rx_icmp`, and `rx_icmp` itself [0m   [2m                [0m
[2;36m                    [0m         [39massumed its caller already filtered out short buffers. [0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m.  **Patch `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mIPv4 “proto == [0m[1;36m1[0m[39m” branch[0m[1;39m)[0m[39m**  [0m                                [2m                [0m
[2;36m                    [0m         [39m    - Replace the naive `pkt->ip + [0m[1;36m1[0m[39m` cast and old `pkt->pay.len` test with:  [0m      [2m                [0m
[2;36m                    [0m         [39m      a. Compute the actual IP‐header length in bytes:  [0m                            [2m                [0m
[2;36m                    [0m         [39m         `size_t ihl = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;`  [0m                                 [2m                [0m
[2;36m                    [0m         [39m      b. Reject anything smaller than a minimum IPv4 header [0m[1;39m([0m[39m`ihl < [0m[1;35msizeof[0m[1;39m([0m[39mstruct [0m  [2m                [0m
[2;36m                    [0m         [39mip[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m or smaller than the Ethernet header + IP header + ICMP header:  [0m              [2m                [0m
[2;36m                    [0m         [39m         `if [0m[1;39m([0m[39mpkt->raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m + ihl + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m [2m                [0m
[2;36m                    [0m         [39m      c. Point `pkt->icmp` at `[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ihl[0m[1;39m)[0m[39m`, and call `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, [0m[1;39m([0m[39mchar[0m [2m                [0m
[2;36m                    [0m         [39m*[0m[1;39m)[0m[39mpkt->icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m`.  [0m                                               [2m                [0m
[2;36m                    [0m         [39m      d. Then call `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m`.  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m    - This ensures we never advance into unowned memory or produce an oversized [0m    [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.len`.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m.  **Patch `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` entry**  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m    - Before any read of `pkt->icmp->type`, re‐compute and re‐check the same [0m       [2m                [0m
[2;36m                    [0m         [39mminimum‐length requirement:  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m      a. Verify `pkt->ip` is non‐NULL.  [0m                                            [2m                [0m
[2;36m                    [0m         [39m      b. Compute `ihl` and then test `pkt->raw.len >= [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m + ihl + [0m    [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m`.  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m      c. If the test fails, return immediately—no dereference.  [0m                    [2m                [0m
[2;36m                    [0m         [39m    - After these guards, it is safe to read `pkt->icmp->type`, because we have [0m    [2m                [0m
[2;36m                    [0m         [39mguaranteed the entire ICMP header is in‐bounds.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m.  **Rationale**  [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m    - All reads of ICMP fields [0m[1;39m([0m[39mboth in `rx_ip` and in `rx_icmp`[0m[1;39m)[0m[39m are gated by the [0m [2m                [0m
[2;36m                    [0m         [39msame precise length check, eliminating any window where a [0m[1;36m34[0m[39m‐byte packet could [0m     [2m                [0m
[2;36m                    [0m         [39mtrigger a read at offset [0m[1;36m34[0m[39m.  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m    - We use pointer arithmetic on `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->ip + ihl` instead of `[0m[1;39m([0m[39mpkt->ip + [0m  [2m                [0m
[2;36m                    [0m         [1;36m1[0m[1;39m)[0m[39m` so that IPv4 options [0m[1;39m([0m[39mvariable‐length headers[0m[1;39m)[0m[39m are correctly handled.  [0m         [2m                [0m
[2;36m                    [0m         [39m    - We do **not** alter any harness, fuzzer flags, or utility functions [0m[1;39m([0m[39m`mkpay`,[0m [2m                [0m
[2;36m                    [0m         [39m`csumup`, etc.[0m[1;39m)[0m[39m. Existing TCP, UDP, IPv6, ARP paths remain untouched.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m.  **Potential Side Effects & Mitigation**  [0m                                       [2m                [0m
[2;36m                    [0m         [39m    - Malformed or truncated ICMP packets will now be quietly dropped earlier, [0m     [2m                [0m
[2;36m                    [0m         [39minstead of overrunning memory. This is acceptable: malformed frames should not be [0m  [2m                [0m
[2;36m                    [0m         [39mprocessed, and valid ICMP traffic [0m[1;39m([0m[39mwith at least [0m[1;36m8[0m[39m bytes beyond the IP header[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mcontinues to function normally.  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m    - Since we preserve the call‐into `mkpay` for valid packets, downstream logic [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mchecksums, echo replies[0m[1;39m)[0m[39m remains unchanged.  [0m                                      [2m                [0m
[2;36m                    [0m         [39m    - We maintain the existing `MG_TCPIP_EV_ICMP` behavior and do not disable or [0m   [2m                [0m
[2;36m                    [0m         [39mremove features—only add early returns for safety.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m.  **Reference in Codebase**  [0m                                                     [2m                [0m
[2;36m                    [0m         [39m    - The ARP and IPv6 paths already perform `raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[39m + [0m             [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*ip6[0m[1;39m)[0m[39m` before dispatch; this draws a direct parallel for our IPv4/ICMP case.[0m [2m                [0m
[2;36m                    [0m         [39m    - Similar “min‐header” guards exist for UDP and TCP in `rx_ip` for other [0m       [2m                [0m
[2;36m                    [0m         [39mprotocols; we are simply extending the same pattern to ICMP.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll tests and the existing fuzzer harness will continue to run, but any malformed [0m  [2m                [0m
[2;36m                    [0m         [39mor undersized ICMP frame can no longer cause a one‐byte overflow. [0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/31/25 03:48:33][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=250846;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=274966;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:51:26][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=746927;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=401949;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:52:53][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=210049;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=675960;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=487168;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=355391;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:52:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.00[0m seconds;              ]8;id=107940;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=652520;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=890124;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=582754;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpk9ir9yud[0m                                                 ]8;id=190019;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=720355;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[12/31/25 03:53:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m7.21[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=918792;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=966510;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=279865;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=216499;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:53:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.41[0m seconds;             ]8;id=127985;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=127777;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=615981;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=416499;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:53:08][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=358374;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=143335;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1779220820[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65170708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55cc65171aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65171aa8[0m[39m,[0m[1;36m0x55cc65185448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55cc650f6c02[0m[39m bp [0m[1;36m0x7fff8cf12200[0m[39m sp [0m[1;36m0x7fff8cf121f8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc650f6c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650ded1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc650f38b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc64f427ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc6506b11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650f379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgr1k1w9v[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=927932;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=737861;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1779220820[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65170708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55cc65171aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65171aa8[0m[39m,[0m[1;36m0x55cc65185448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55cc650f6c02[0m[39m bp [0m[1;36m0x7fff8cf12200[0m[39m sp [0m[1;36m0x7fff8cf121f8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc650f6c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650ded1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc650f38b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc64f427ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc6506b11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650f379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgr1k1w9v[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1779220820[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65170708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55cc65171aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65171aa8[0m[39m,[0m[1;36m0x55cc65185448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55cc650f6c02[0m[39m bp [0m[1;36m0x7fff8cf12200[0m[39m sp [0m[1;36m0x7fff8cf121f8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc650f6c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650ded1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc650f38b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc64f427ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc6506b11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650f379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgr1k1w9v[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.53[0m seconds;                ]8;id=662061;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=581968;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=988745;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=238850;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:53:09][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.93[0m seconds;              ]8;id=581435;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=457662;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[12/31/25 03:53:10][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=1574;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=52677;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:53:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.00[0m seconds;              ]8;id=710767;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=833345;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=777972;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=143811;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-380[0m,[1;36m17[0m +[1;36m380[0m,[1;36m28[0m @@                                                               [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_icmp[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m         -  [35m/[0m[35m/[0m [1;35mMG_DEBUG[0m[1m([0m[1m([0m[32m"ICMP %d"[0m, [1m([0mint[1m)[0m len[1m)[0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -  if [1m([0mpkt->icmp->type == [1;36m8[0m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[1m)[0m [1m{[0m        [2m                [0m
[2;36m                    [0m         -    size_t hlen = [1;35msizeof[0m[1m([0mstruct eth[1m)[0m + [1;35msizeof[0m[1m([0mstruct ip[1m)[0m + [1;35msizeof[0m[1m([0mstruct icmp[1m)[0m;    [2m                [0m
[2;36m                    [0m         -    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;                        [2m                [0m
[2;36m                    [0m         +  [35m/[0m* Validate IP presence and header length *[35m/[0m                                     [2m                [0m
[2;36m                    [0m         +  if [1m([0mpkt->ip == NULL[1m)[0m return;                                                     [2m                [0m
[2;36m                    [0m         +  size_t ihl = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                           [2m                [0m
[2;36m                    [0m         +  if [1m([0mihl [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[39m* Check that ICMP header is fully present in raw buffer *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [39m+  size_t eth_hdr = [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+  size_t icmp_offset = eth_hdr + ihl;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+  if [0m[1;39m([0m[39mpkt->raw.len < icmp_offset + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                     [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[39m* Set pkt->icmp pointer to actual ICMP header *[0m[35m/[0m                                [2m                [0m
[2;36m                    [0m         [39m+  pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->eth + icmp_offset[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[39m* Only handle echo request directed to us *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [39m+  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [39m+    size_t hlen = icmp_offset + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    size_t space = ifp->tx.len - hlen;[0m                                             [2m                [0m
[2;36m                    [0m         [39m+    size_t plen = pkt->raw.len > hlen ? pkt->raw.len - hlen : [0m[1;36m0[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m            [2m                [0m
[2;36m                    [0m         [39m-                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m-    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                        [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m                [2m                [0m
[2;36m                    [0m         [39m-    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m+    struct ip *rip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m           [2m                [0m
[2;36m                    [0m         [39m+                           [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m+    struct icmp *ricmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mrip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmemset[0m[1;39m([0m[39mricmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*ricmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[39m* Set csum to [0m[1;36m0[0m[39m *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmemcpy[0m[1;39m([0m[39mricmp + [0m[1;36m1[0m[39m, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m, plen[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m+    ricmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39mricmp, [0m[1;35msizeof[0m[1;39m([0m[39m*ricmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m [0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-799[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m810[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m+      [0m[35m/[0m[39m* Compute IP header length and validate ICMP header presence *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [39m+      size_t ihl = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[39mihl < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m || pkt->raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m + ihl + [0m      [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+      pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->ip + ihl[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+      [0m[35m/[0m[39m* Set payload to data after ICMP header *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [39m+      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+      [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-886[0m[39m,[0m[1;36m12[0m[39m +[0m[1;36m900[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [39m       pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m  [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m     [2m                [0m
[2;36m                    [0m         [39m+      [0m[35m/[0m[39m* Compute actual IP header length and validate *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [39m+      size_t ihl = [0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[39mihl < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[39m || pkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ihl[0m[1;39m)[0m[39m return;[0m   [2m                [0m
[2;36m                    [0m         [39m+      [0m[35m/[0m[39m* Set payload to IP data after header *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [39m+      [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt.ip + ihl[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1779220820[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65170708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55cc65171aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65171aa8[0m[39m,[0m[1;36m0x55cc65185448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55cc650f6c02[0m[39m bp [0m[1;36m0x7fff8cf12200[0m[39m sp [0m[1;36m0x7fff8cf121f8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc650f6c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650ded1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc650f38b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc64f427ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc6506b11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650f379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgr1k1w9v[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAn AddressSanitizer heap-buffer-overflow was triggered in the function `rx_icmp` [0m   [2m                [0m
[2;36m                    [0m         [39mwithin `src/net_builtin.c` when fuzzing the Mongoose TCP/IP implementation. The [0m    [2m                [0m
[2;36m                    [0m         [39mfailing read occurs just past the end of a small heap allocation [0m[1;39m([0m[1;36m34[0m[39m bytes[0m[1;39m)[0m[39m. A [0m     [2m                [0m
[2;36m                    [0m         [39mpatch was applied to guard against invalid or truncated packet data by checking for[0m [2m                [0m
[2;36m                    [0m         [39ma non-null IP header pointer, computing and validating the IP header length [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`ihl`[0m[1;39m)[0m[39m, and ensuring the total packet length is sufficient before accessing the [0m   [2m                [0m
[2;36m                    [0m         [39mICMP header. After applying the patch, the fuzzer still reports the same [0m           [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow in `rx_icmp` at the same location, indicating the bounds [0m      [2m                [0m
[2;36m                    [0m         [39mchecks did not fully prevent the out-of-bounds access.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Initial Issue  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer runs the harness in `fuzz.c`, which allocates a `pkt` structure on [0m [2m                [0m
[2;36m                    [0m         [39mthe heap and fills in IP and ICMP header pointers based on the input buffer.  [0m      [2m                [0m
[2;36m                    [0m         [39m   - In `[0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m`, an unguarded access to[0m [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp->type` is made.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - AddressSanitizer reports a [0m[1;36m1[0m[39m-byte read at an address immediately past a [0m       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m-byte region allocated by `malloc` in `LLVMFuzzerTestOneInput`.  [0m                 [2m                [0m
[2;36m                    [0m         [39m   - Stack traces show the overflow occurs on line [0m[1;36m385[0m[39m of `net_builtin.c`, in the [0m  [2m                [0m
[2;36m                    [0m         [39mcode path handling ICMP packets [0m[1;39m([0m[39mtype [0m[1;36m8[0m[1;39m)[0m[39m.  [0m                                         [2m                [0m
[2;36m                    [0m         [39m   - The shadow memory dump confirms the read is just beyond the heap allocation [0m   [2m                [0m
[2;36m                    [0m         [39mboundary.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Key Observations from the Initial Log  [0m                                          [2m                [0m
[2;36m                    [0m         [39m   - The allocation size for the test input is [0m[1;36m34[0m[39m bytes, and the code assumes the [0m  [2m                [0m
[2;36m                    [0m         [39mpresence of a full IP + ICMP header in that buffer.  [0m                               [2m                [0m
[2;36m                    [0m         [39m   - `pkt->ip` may be set but the full header might not fit in the allocated [0m       [2m                [0m
[2;36m                    [0m         [39mbuffer, leading to a read off the end.  [0m                                            [2m                [0m
[2;36m                    [0m         [39m   - No checks were in place in `rx_icmp` to verify that the buffer actually [0m       [2m                [0m
[2;36m                    [0m         [39mcontains both the IP header and the ICMP header before dereferencing them.  [0m        [2m                [0m
[2;36m                    [0m         [39m   - The crash is reproducible and consistent across fuzzing runs.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Patch Attempt  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - In `rx_icmp`, before accessing `pkt->icmp`, the patch adds:  [0m                  [2m                [0m
[2;36m                    [0m         [39m     • A null check for `pkt->ip`.  [0m                                                [2m                [0m
[2;36m                    [0m         [39m     • Calculation of the IP header length [0m[1;39m([0m[39m`ihl = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m`[0m[1;39m)[0m[39m.  [0m    [2m                [0m
[2;36m                    [0m         [39m     • Computation of a minimal required packet length [0m[1;39m([0m[39m`eth_hdr + ihl + [0m           [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m.  [0m                                                             [2m                [0m
[2;36m                    [0m         [39m     • An early return if `ihl` is smaller than the size of an IP header or if the [0m [2m                [0m
[2;36m                    [0m         [39mraw packet length `pkt->raw.len` is less than that minimum.  [0m                       [2m                [0m
[2;36m                    [0m         [39m   - In the IP-proto-[0m[1;36m1[0m[39m [0m[1;39m([0m[39mICMP[0m[1;39m)[0m[39m handling branch of `mg_tcpip_rx` [0m[1;39m([0m[39maround line [0m[1;36m799[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39msimilar checks were added:  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m     • Validate that the IP header length is at least `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m`.  [0m         [2m                [0m
[2;36m                    [0m         [39m     • Ensure `pkt->raw.len` covers Ethernet header + IP header + ICMP header.  [0m    [2m                [0m
[2;36m                    [0m         [39m     • Adjust `pkt->icmp` to point at the correct offset based on `ihl`.  [0m          [2m                [0m
[2;36m                    [0m         [39m     • Pass the correctly offset ICMP payload pointer to `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m`.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Result After Applying the Patch  [0m                                                [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer output shows that the same heap-buffer-overflow in `rx_icmp` is [0m    [2m                [0m
[2;36m                    [0m         [39mstill triggered at line [0m[1;36m385[0m[39m.  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - The stack trace and shadow-byte dump match the initial failure, indicating [0m    [2m                [0m
[2;36m                    [0m         [39mthat the added guards did not prevent this particular out-of-bounds read.  [0m         [2m                [0m
[2;36m                    [0m         [39m   - The allocation is again [0m[1;36m34[0m[39m bytes, and at least one code path still leads to [0m   [2m                [0m
[2;36m                    [0m         [39mdereferencing beyond that boundary.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Areas for Further Investigation  [0m                                                [2m                [0m
[2;36m                    [0m         [39m   - The logic in `rx_icmp` around how `pkt->pay.len` and `pkt->raw.len` are [0m       [2m                [0m
[2;36m                    [0m         [39mcomputed and used—ensuring they accurately reflect the buffer limits.  [0m             [2m                [0m
[2;36m                    [0m         [39m   - The construction and initialization of `pkt->raw.len`, `pkt->ip`, [0m             [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.len`, and related fields in the fuzzer harness [0m[1;39m([0m[39m`fuzz.c`[0m[1;39m)[0m[39m and in [0m         [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx`.  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - Any other code paths leading into `rx_icmp` that may bypass the new length [0m    [2m                [0m
[2;36m                    [0m         [39mchecks [0m[1;39m([0m[39me.g., fragmented packet handling or alternate protocol branches[0m[1;39m)[0m[39m.  [0m         [2m                [0m
[2;36m                    [0m         [39m   - Validation of Ethernet header length assumptions—for example, if VLAN tags or [0m [2m                [0m
[2;36m                    [0m         [39mother optional headers are present but not accounted for.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1493118286[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b3708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x556b4e6b4aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x556b4e6b4aa8[0m[39m,[0m[1;36m0x556b4e6c8448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x556b4e639c02[0m[39m bp [0m[1;36m0x7ffc7eaeff20[0m[39m sp [0m[1;36m0x7ffc7eaeff18[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e639c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e621d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e6368b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x556b4e4857ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x556b4e5ae11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x556b4e63679d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x556b4e4a2350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x556b4e48d5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x556b4e49305f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x556b4e4be302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc6e2180082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiurg_oy_[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:1[0m[39m-[0m[1;36m120[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#define MG_ENABLE_SOCKET [0m[1;36m0[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#define MG_ENABLE_LOG [0m[1;36m0[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#define MG_ENABLE_LINES [0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_ENABLE_TCPIP [0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define MG_IO_SIZE [0m[1;39m([0m[1;36m32[0m[39m * [0m[1;36m1024[0m[39m * [0m[1;36m1024[0m[1;39m)[0m[39m  [0m[35m/[0m[35m/[0m[39m Big IO size for fast resizes[0m            [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"mongoose.c"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"driver_mock.c"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#ifdef __cplusplus[0m                                                               [2m                [0m
[2;36m                    [0m         [1;92m12:e[0m[39mxtern [0m[32m"C"[0m[39m int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *, size_t[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#else[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *, size_t[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#endif[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:static void [0m[1;35mfn[0m[1;39m([0m[39mstruct mg_connection *c, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  struct mg_http_serve_opts opts = [0m[1;39m{[0m[39m.root_dir = [0m[32m"."[0m[1;39m}[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  if [0m[1;39m([0m[39mev == MG_EV_HTTP_MSG[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:    [0m[1;35mmg_http_serve_dir[0m[1;39m([0m[39mc, [0m[1;39m([0m[39mstruct mg_http_message *[0m[1;39m)[0m[39m ev_data, &opts[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *data, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:  [0m[1;35mmg_log_set[0m[1;39m([0m[39mMG_LL_INFO[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:  struct mg_dns_message dm;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  [0m[1;35mmg_dns_parse[0m[1;39m([0m[39mdata, size, &dm[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  [0m[1;35mmg_dns_parse[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[39m, &dm[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:  struct mg_http_message hm;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  if [0m[1;39m([0m[1;35mmg_http_parse[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m data, size, &hm[0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, hm.method.buf, hm.method.len[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, hm.uri.buf, hm.uri.len[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, hm.uri.buf, hm.uri.len[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    for [0m[1;39m([0m[39msize_t i = [0m[1;36m0[0m[39m; i < [0m[1;35msizeof[0m[1;39m([0m[39mhm.headers[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39mhm.headers[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:      struct mg_str *k = &hm.headers[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.name, *v = &hm.headers[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m.value;[0m         [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:      [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, k->buf, k->len[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:      [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, v->buf, v->len[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  [0m[1;35mmg_http_parse[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[39m, &hm[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  struct mg_str body = [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m data, size[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:  char tmp[0m[1;39m[[0m[1;36m256[0m[1;39m][0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:  [0m[1;35mmg_http_get_var[0m[1;39m([0m[39m&body, [0m[32m"key"[0m[39m, tmp, [0m[1;35msizeof[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:  [0m[1;35mmg_http_get_var[0m[1;39m([0m[39m&body, [0m[32m"key"[0m[39m, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  [0m[1;35mmg_url_decode[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, size, tmp, [0m[1;35msizeof[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  [0m[1;35mmg_url_decode[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, size, tmp, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  [0m[1;35mmg_url_decode[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[39m, tmp, [0m[1;36m1[0m[39m, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  struct mg_mqtt_message mm;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:  if [0m[1;39m([0m[1;35mmg_mqtt_parse[0m[1;39m([0m[39mdata, size, [0m[1;36m0[0m[39m, &mm[0m[1;39m)[0m[39m == MQTT_OK[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, mm.topic.buf, mm.topic.len[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, mm.data.buf, mm.data.len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, mm.dgram.buf, mm.dgram.len[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  [0m[1;35mmg_mqtt_parse[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[39m, [0m[1;36m0[0m[39m, &mm[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  if [0m[1;39m([0m[1;35mmg_mqtt_parse[0m[1;39m([0m[39mdata, size, [0m[1;36m5[0m[39m, &mm[0m[1;39m)[0m[39m == MQTT_OK[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, mm.topic.buf, mm.topic.len[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, mm.data.buf, mm.data.len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, mm.dgram.buf, mm.dgram.len[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  [0m[1;35mmg_mqtt_parse[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[39m, [0m[1;36m5[0m[39m, &mm[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  [0m[1;35mmg_sntp_parse[0m[1;39m([0m[39mdata, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  [0m[1;35mmg_sntp_parse[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  char buf[0m[1;39m[[0m[39msize * [0m[1;36m4[0m[39m [0m[35m/[0m[39m [0m[1;36m3[0m[39m + [0m[1;36m5[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m At least [0m[1;36m4[0m[39m chars and nul termination[0m           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:  [0m[1;35mmg_base64_decode[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, size, buf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:  [0m[1;35mmg_base64_decode[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[39m, buf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:  [0m[1;35mmg_base64_encode[0m[1;39m([0m[39mdata, size, buf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  [0m[1;35mmg_base64_encode[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[39m, buf, [0m[1;35msizeof[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  [0m[1;35mmg_match[0m[1;39m([0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, size[0m[1;39m)[0m[39m, [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, size[0m[1;39m)[0m[39m, NULL[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:  struct mg_str entry, s = [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, size[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:  while [0m[1;39m([0m[1;35mmg_span[0m[1;39m([0m[39ms, &entry, &s, [0m[32m','[0m[1;39m)[0m[1;39m)[0m[39m entry.len = [0m[1;36m0[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:  int n;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:  [0m[1;35mmg_json_get[0m[1;39m([0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, size[0m[1;39m)[0m[39m, [0m[32m"$"[0m[39m, &n[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:  [0m[1;35mmg_json_get[0m[1;39m([0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, size[0m[1;39m)[0m[39m, [0m[32m"$.a.b"[0m[39m, &n[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:  [0m[1;35mmg_json_get[0m[1;39m([0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m data, size[0m[1;39m)[0m[39m, [0m[32m"$[0m[32m[[0m[32m0[0m[32m][0m[32m"[0m[39m, &n[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  if [0m[1;39m([0m[39msize > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    struct mg_tcpip_if mif = [0m[1;39m{[0m[39m.ip = [0m[1;36m0x01020304[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                              .mask = [0m[1;36m255[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                              .gw = [0m[1;36m0x01010101[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                              .driver = &mg_tcpip_driver_mock[0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    struct mg_mgr mgr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;35mmg_mgr_init[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;35mmg_tcpip_init[0m[1;39m([0m[39m&mgr, &mif[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make a copy of the random data, in order to modify it[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[35m/[0m[35m/[0m[39m Test HTTP serving[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    const char *url = [0m[32m"http://localhost:12345"[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    struct mg_connection *c = [0m[1;35mmg_http_connect[0m[1;39m([0m[39m&mgr, url, fn, NULL[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;35mmg_iobuf_add[0m[1;39m([0m[39m&c->recv, [0m[1;36m0[0m[39m, data, size[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    c->[0m[1;35mpfn[0m[1;39m([0m[39mc, MG_EV_READ, NULL[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m manually invoke protocol event handler[0m      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[1;35mmg_mgr_free[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;35mfree[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:    [0m[1;35mmg_tcpip_free[0m[1;39m([0m[39m&mif[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  return [0m[1;36m0[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m894[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mmongoose.h:[0m[1;36m627[0m[39m-[0m[1;36m650[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m627[0m[39m:   [0m[1;39m([0m[39merrcode[0m[1;39m)[0m[39m == -pdFREERTOS_ERRNO_EINPROGRESS || \[0m                              [2m                [0m
[2;36m                    [0m         [1;36m628[0m[39m:   [0m[1;39m([0m[39merrcode[0m[1;39m)[0m[39m == -pdFREERTOS_ERRNO_EAGAIN[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m629[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m630[0m[39m:#define [0m[1;35mMG_SOCK_RESET[0m[1;39m([0m[39merrcode[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39merrcode[0m[1;39m)[0m[39m == -pdFREERTOS_ERRNO_ENOTCONN[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m631[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m632[0m[39m:[0m[35m/[0m[35m/[0m[39m actually only if optional timeout is enabled[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m633[0m[39m:#define [0m[1;35mMG_SOCK_INTR[0m[1;39m([0m[39mfd[0m[1;39m)[0m[39m [0m[1;39m([0m[39mfd == NULL[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m634[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:#define sockaddr_in freertos_sockaddr[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:#define sockaddr freertos_sockaddr[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:#if ipFR_TCP_VERSION_MAJOR >= [0m[1;36m4[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:#define sin_addr sin_address.ulIP_IPv4[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:#define [0m[1;35maccept[0m[1;39m([0m[39ma, b, c[0m[1;39m)[0m[39m [0m[1;35mFreeRTOS_accept[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:#define [0m[1;35mconnect[0m[1;39m([0m[39ma, b, c[0m[1;39m)[0m[39m [0m[1;35mFreeRTOS_connect[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:#define [0m[1;35mbind[0m[1;39m([0m[39ma, b, c[0m[1;39m)[0m[39m [0m[1;35mFreeRTOS_bind[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:#define [0m[1;35mlisten[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;35mFreeRTOS_listen[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:#define [0m[1;35msocket[0m[1;39m([0m[39ma, b, c[0m[1;39m)[0m[39m [0m[1;35mFreeRTOS_socket[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mc[0m[1;39m)[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:#define [0m[1;35msend[0m[1;39m([0m[39ma, b, c, d[0m[1;39m)[0m[39m [0m[1;35mFreeRTOS_send[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m, [0m[1;39m([0m[39md[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:#define [0m[1;35mrecv[0m[1;39m([0m[39ma, b, c, d[0m[1;39m)[0m[39m [0m[1;35mFreeRTOS_recv[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m, [0m[1;39m([0m[39md[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:#define [0m[1;35msetsockopt[0m[1;39m([0m[39ma, b, c, d, e[0m[1;39m)[0m[39m [0m[1;35mFreeRTOS_setsockopt[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m, [0m[1;39m([0m[39md[0m[1;39m)[0m[39m, [0m[1;39m([0m[39me[0m[1;39m)[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:#define [0m[1;35msendto[0m[1;39m([0m[39ma, b, c, d, e, f[0m[1;39m)[0m[39m [0m[1;35mFreeRTOS_sendto[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m, [0m[1;39m([0m[39md[0m[1;39m)[0m[39m, [0m[1;39m([0m[39me[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mf[0m[1;39m)[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:#define [0m[1;35mrecvfrom[0m[1;39m([0m[39ma, b, c, d, e, f[0m[1;39m)[0m[39m \[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:  [0m[1;35mFreeRTOS_recvfrom[0m[1;39m([0m[1;39m([0m[39ma[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mb[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m, [0m[1;39m([0m[39md[0m[1;39m)[0m[39m, [0m[1;39m([0m[39me[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mf[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:147[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:static void [0m[1;35msend_syn[0m[1;39m([0m[39mstruct mg_connection *c[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mmongoose.h:[0m[1;36m100[0m[39m-[0m[1;36m140[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#include <stdarg.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#include <stdbool.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#include <stdint.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#include <stdio.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:#include <time.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:#include <fx_api.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:#include <tx_api.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:#include <nx_api.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:#include <nx_bsd.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:#include <nx_port.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:#include <tx_port.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:#define PATH_MAX FX_MAXIMUM_PATH[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:#define MG_DIRSEP '\\'[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:#define socklen_t int[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:#define [0m[1;35mclosesocket[0m[1;39m([0m[39mx[0m[1;39m)[0m[39m [0m[1;35msoc_close[0m[1;39m([0m[39mx[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:#undef FOPEN_MAX[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:#if MG_ARCH == MG_ARCH_ESP32[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:#include <ctype.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:#include <dirent.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:#include <errno.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:#include <fcntl.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:#include <limits.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:#include <netdb.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:#include <stdarg.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:#include <stddef.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:#include <stdio.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:#include <stdlib.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:#include <string.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:#include <sys/stat.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:#include <sys/types.h>[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mmongoose.h:[0m[1;36m200[0m[39m-[0m[1;36m240[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:#include <task.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:#define [0m[1;35mcalloc[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;35mmg_calloc[0m[1;39m([0m[39ma, b[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:#define [0m[1;35mfree[0m[1;39m([0m[39ma[0m[1;39m)[0m[39m [0m[1;35mvPortFree[0m[1;39m([0m[39ma[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:#define [0m[1;35mmalloc[0m[1;39m([0m[39ma[0m[1;39m)[0m[39m [0m[1;35mpvPortMalloc[0m[1;39m([0m[39ma[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:#define [0m[1;35mstrdup[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;35mmg_strdup[0m[1;39m([0m[1;35mmg_str[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m.buf[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m[35m/[0m[35m/[0m[39m Re-route calloc/free to the FreeRTOS's functions, don't use stdlib[0m           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:static inline void *[0m[1;35mmg_calloc[0m[1;39m([0m[39msize_t cnt, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:  void *p = [0m[1;35mpvPortMalloc[0m[1;39m([0m[39mcnt * size[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:  if [0m[1;39m([0m[39mp != NULL[0m[1;39m)[0m[39m [0m[1;35mmemset[0m[1;39m([0m[39mp, [0m[1;36m0[0m[39m, size * cnt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:  return p;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:#define [0m[1;35mmkdir[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;35mmg_mkdir[0m[1;39m([0m[39ma, b[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:static inline int [0m[1;35mmg_mkdir[0m[1;39m([0m[39mconst char *path, mode_t mode[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m path, [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m mode;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:  return [0m[1;36m-1[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:#endif  [0m[35m/[0m[35m/[0m[39m MG_ARCH == MG_ARCH_FREERTOS[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:#if MG_ARCH == MG_ARCH_NEWLIB[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:#define _POSIX_TIMERS[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:#include <ctype.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:#include <errno.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:#include <stdarg.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:#include <stdbool.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:#include <stdio.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:#include <stdlib.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:#include <string.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:#include <sys/stat.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:#include <sys/time.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:#include <sys/types.h>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:#include <time.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:#include <unistd.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:#define MG_PATH_MAX [0m[1;36m100[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:#define MG_ENABLE_SOCKET [0m[1;36m0[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:380[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mmongoose.h:[0m[1;36m550[0m[39m-[0m[1;36m570[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m550[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m551[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m552[0m[39m:#ifndef MG_IO_SIZE[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:#define MG_IO_SIZE [0m[1;36m16384[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:#if MG_ARCH == MG_ARCH_ZEPHYR[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:#include <zephyr/kernel.h>[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:#include <ctype.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:#include <errno.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:#include <zephyr/net/socket.h>[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:#include <zephyr/posix/fcntl.h>[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:#include <zephyr/posix/sys/select.h>[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:#include <stdarg.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:#include <stdbool.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m570[0m[39m:#include <stdint.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mmongoose.h:[0m[1;36m200[0m[39m-[0m[1;36m240[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:#include <task.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:#define [0m[1;35mcalloc[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;35mmg_calloc[0m[1;39m([0m[39ma, b[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:#define [0m[1;35mfree[0m[1;39m([0m[39ma[0m[1;39m)[0m[39m [0m[1;35mvPortFree[0m[1;39m([0m[39ma[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:#define [0m[1;35mmalloc[0m[1;39m([0m[39ma[0m[1;39m)[0m[39m [0m[1;35mpvPortMalloc[0m[1;39m([0m[39ma[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:#define [0m[1;35mstrdup[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;35mmg_strdup[0m[1;39m([0m[1;35mmg_str[0m[1;39m([0m[39ms[0m[1;39m)[0m[1;39m)[0m[39m.buf[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:[0m[35m/[0m[35m/[0m[39m Re-route calloc/free to the FreeRTOS's functions, don't use stdlib[0m           [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:static inline void *[0m[1;35mmg_calloc[0m[1;39m([0m[39msize_t cnt, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:  void *p = [0m[1;35mpvPortMalloc[0m[1;39m([0m[39mcnt * size[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:  if [0m[1;39m([0m[39mp != NULL[0m[1;39m)[0m[39m [0m[1;35mmemset[0m[1;39m([0m[39mp, [0m[1;36m0[0m[39m, size * cnt[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:  return p;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:#define [0m[1;35mmkdir[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;35mmg_mkdir[0m[1;39m([0m[39ma, b[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:static inline int [0m[1;35mmg_mkdir[0m[1;39m([0m[39mconst char *path, mode_t mode[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:  [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m path, [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m mode;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:  return [0m[1;36m-1[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:#endif  [0m[35m/[0m[35m/[0m[39m MG_ARCH == MG_ARCH_FREERTOS[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:#if MG_ARCH == MG_ARCH_NEWLIB[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:#define _POSIX_TIMERS[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:#include <ctype.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:#include <errno.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:#include <stdarg.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:#include <stdbool.h>[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:#include <stdio.h>[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:#include <stdlib.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:#include <string.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:#include <sys/stat.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:#include <sys/time.h>[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:#include <sys/types.h>[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:#include <time.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:#include <unistd.h>[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:#define MG_PATH_MAX [0m[1;36m100[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:#define MG_ENABLE_SOCKET [0m[1;36m0[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m200[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#ifndef MIP_TCP_KEEPALIVE_MS[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#define MIP_TCP_KEEPALIVE_MS [0m[1;36m45000[0m[39m  [0m[35m/[0m[35m/[0m[39m TCP keep-alive period, ms[0m                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#endif[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#define MIP_TCP_ACK_MS [0m[1;36m150[0m[39m    [0m[35m/[0m[35m/[0m[39m Timeout for ACKing[0m                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#define MIP_ARP_RESP_MS [0m[1;36m100[0m[39m   [0m[35m/[0m[35m/[0m[39m Timeout for ARP response[0m                        [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#define MIP_TCP_SYN_MS [0m[1;36m15000[0m[39m  [0m[35m/[0m[35m/[0m[39m Timeout for connection establishment[0m            [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#define MIP_TCP_FIN_MS [0m[1;36m1000[0m[39m   [0m[35m/[0m[35m/[0m[39m Timeout for closing connection[0m                  [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#define MIP_TCP_WIN [0m[1;36m6000[0m[39m      [0m[35m/[0m[35m/[0m[39m TCP window size[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:struct connstate [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:  uint32_t seq, ack;           [0m[35m/[0m[35m/[0m[39m TCP seq/ack counters[0m                           [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  uint64_t timer;              [0m[35m/[0m[35m/[0m[39m TCP keep-alive [0m[35m/[0m[39m ACK timer[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:  uint32_t acked;              [0m[35m/[0m[35m/[0m[39m Last ACK-ed number[0m                             [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  size_t unacked;              [0m[35m/[0m[35m/[0m[39m Not acked bytes[0m                                [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:  uint8_t mac[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;              [0m[35m/[0m[35m/[0m[39m Peer MAC address[0m                               [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:  uint8_t ttype;               [0m[35m/[0m[35m/[0m[39m Timer type. [0m[1;36m0[0m[39m: ack, [0m[1;36m1[0m[39m: keep-alive[0m              [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#define MIP_TTYPE_KEEPALIVE [0m[1;36m0[0m[39m  [0m[35m/[0m[35m/[0m[39m Connection is idle for long, send keepalive[0m    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#define MIP_TTYPE_ACK [0m[1;36m1[0m[39m        [0m[35m/[0m[35m/[0m[39m Peer sent us data, we have to ack it soon[0m      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#define MIP_TTYPE_ARP [0m[1;36m2[0m[39m        [0m[35m/[0m[35m/[0m[39m ARP resolve sent, waiting for response[0m         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#define MIP_TTYPE_SYN [0m[1;36m3[0m[39m        [0m[35m/[0m[35m/[0m[39m SYN sent, waiting for response[0m                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#define MIP_TTYPE_FIN [0m[1;36m4[0m[39m  [0m[35m/[0m[35m/[0m[39m FIN sent, waiting until terminating the connection[0m   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:  uint8_t tmiss;         [0m[35m/[0m[35m/[0m[39m Number of keep-alive misses[0m                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:  struct mg_iobuf raw;   [0m[35m/[0m[35m/[0m[39m For TLS only. Incoming raw data[0m                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:  bool fin_rcvd;         [0m[35m/[0m[35m/[0m[39m We have received FIN from the peer[0m                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:  bool twclosure;        [0m[35m/[0m[35m/[0m[39m [0m[1;36m3[0m[39m-way closure done[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#pragma [0m[1;35mpack[0m[1;39m([0m[39mpush, [0m[1;36m1[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:struct lcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:  uint8_t addr, ctrl, proto[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m, code, id, len[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct ip6 [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  uint8_t ver;      [0m[35m/[0m[35m/[0m[39m Version[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  uint8_t opts[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Options[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  uint16_t len;     [0m[35m/[0m[35m/[0m[39m Length[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  uint8_t proto;    [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  uint8_t ttl;      [0m[35m/[0m[35m/[0m[39m Time to live[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:struct arp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  uint16_t fmt;    [0m[35m/[0m[35m/[0m[39m Format of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:  uint16_t pro;    [0m[35m/[0m[35m/[0m[39m Format of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:  uint8_t hlen;    [0m[35m/[0m[35m/[0m[39m Length of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:  uint8_t plen;    [0m[35m/[0m[35m/[0m[39m Length of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:  uint16_t op;     [0m[35m/[0m[35m/[0m[39m Operation[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:  uint8_t sha[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Sender hardware address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  uint32_t spa;    [0m[35m/[0m[35m/[0m[39m Sender protocol address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  uint8_t tha[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Target hardware address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:  uint32_t tpa;    [0m[35m/[0m[35m/[0m[39m Target protocol address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:  uint16_t win;   [0m[35m/[0m[35m/[0m[39m Window[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:  uint16_t urp;   [0m[35m/[0m[35m/[0m[39m Urgent pointer[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:struct dhcp [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:  uint8_t op, htype, hlen, hops;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  uint32_t xid;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:  uint16_t secs, flags;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:  uint32_t ciaddr, yiaddr, siaddr, giaddr;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:  uint8_t hwaddr[0m[1;39m[[0m[1;36m208[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:  uint32_t magic;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:  uint8_t options[0m[1;39m[[0m[1;36m32[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:#pragma [0m[1;35mpack[0m[1;39m([0m[39mpop[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:  if [0m[1;39m([0m[39mifp->fn != NULL[0m[1;39m)[0m[39m ifp->[0m[1;35mfn[0m[1;39m([0m[39mifp, ev, ev_data[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:static void [0m[1;35msend_syn[0m[1;39m([0m[39mstruct mg_connection *c[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:static uint32_t [0m[1;35mcsumup[0m[1;39m([0m[39muint32_t sum, const void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:  size_t i;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:  const uint8_t *p = [0m[1;39m([0m[39mconst uint8_t *[0m[1;39m)[0m[39m buf;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:  for [0m[1;39m([0m[39mi = [0m[1;36m0[0m[39m; i < len; i++[0m[1;39m)[0m[39m sum += i & [0m[1;36m1[0m[39m ? p[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m : [0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m p[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;39m)[0m[39m << [0m[1;36m8[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:  return sum;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:static uint16_t [0m[1;35mcsumfin[0m[1;39m([0m[39muint32_t sum[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:  while [0m[1;39m([0m[39msum >> [0m[1;36m16[0m[1;39m)[0m[39m sum = [0m[1;39m([0m[39msum & [0m[1;36m0xffff[0m[1;39m)[0m[39m + [0m[1;39m([0m[39msum >> [0m[1;36m16[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:  return [0m[1;35mmg_htons[0m[1;39m([0m[39m~sum & [0m[1;36m0xffff[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:static uint16_t [0m[1;35mipcsum[0m[1;39m([0m[39mconst void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:  uint32_t sum = [0m[1;35mcsumup[0m[1;39m([0m[1;36m0[0m[39m, buf, len[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:  return [0m[1;35mcsumfin[0m[1;39m([0m[39msum[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:static void [0m[1;35msettmout[0m[1;39m([0m[39mstruct mg_connection *c, uint8_t type[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:  struct mg_tcpip_if *ifp = c->mgr->ifp;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:  struct connstate *s = [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:  unsigned n = type == MIP_TTYPE_ACK   ? MIP_TCP_ACK_MS[0m                         [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:               : type == MIP_TTYPE_ARP ? MIP_ARP_RESP_MS[0m                        [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:               : type == MIP_TTYPE_SYN ? MIP_TCP_SYN_MS[0m                         [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:               : type == MIP_TTYPE_FIN ? MIP_TCP_FIN_MS[0m                         [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:                                       : MIP_TCP_KEEPALIVE_MS;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:  s->timer = ifp->now + n;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:  s->ttype = type;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:  [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"%lu %d -> %llx"[0m[39m, c->id, type, s->timer[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:static size_t [0m[1;35mether_output[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:  size_t n = ifp->driver->[0m[1;35mtx[0m[1;39m([0m[39mifp->tx.buf, len, ifp[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:  if [0m[1;39m([0m[39mn == len[0m[1;39m)[0m[39m ifp->nsent++;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:  return n;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:void [0m[1;35mmg_tcpip_arp_request[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, uint32_t ip, uint8_t *mac[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:  struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m ifp->tx.buf;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:  struct arp *arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39meth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39meth->dst, [0m[1;36m255[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39meth->dst[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39meth->src, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39meth->src[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:  eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39marp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*arp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:  arp->fmt = [0m[1;35mmg_htons[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m, arp->pro = [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[39m, arp->hlen = [0m[1;36m6[0m[39m,[0m            [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:  arp->plen = [0m[1;36m4[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:  arp->op = [0m[1;35mmg_htons[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m, arp->tpa = ip, arp->spa = ifp->ip;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39marp->sha, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39marp->sha[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:3[0m[39m-[0m[1;36m8[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#ifndef MIP_TCP_KEEPALIVE_MS[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#define MIP_TCP_KEEPALIVE_MS [0m[1;36m45000[0m[39m  [0m[35m/[0m[35m/[0m[39m TCP keep-alive period, ms[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:885[0m[39m-[0m[1;36m894[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/31/25 03:53:18][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=461791;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=441900;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:54:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=854560;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=31824;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[12/31/25 03:55:42][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=140605;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=849438;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=261520;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=633383;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[12/31/25 03:55:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.95[0m seconds;              ]8;id=758339;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=971531;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=93892;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=616283;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-380[0m,[1;36m17[0m +[1;36m380[0m,[1;36m28[0m @@                                                               [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mrx_icmp[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                    [2m                [0m
[2;36m                    [0m         -  [35m/[0m[35m/[0m [1;35mMG_DEBUG[0m[1m([0m[1m([0m[32m"ICMP %d"[0m, [1m([0mint[1m)[0m len[1m)[0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -  if [1m([0mpkt->icmp->type == [1;36m8[0m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[1m)[0m [1m{[0m        [2m                [0m
[2;36m                    [0m         -    size_t hlen = [1;35msizeof[0m[1m([0mstruct eth[1m)[0m + [1;35msizeof[0m[1m([0mstruct ip[1m)[0m + [1;35msizeof[0m[1m([0mstruct icmp[1m)[0m;    [2m                [0m
[2;36m                    [0m         -    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;                        [2m                [0m
[2;36m                    [0m         +  [35m/[0m* Validate IP presence and header length *[35m/[0m                                     [2m                [0m
[2;36m                    [0m         +  if [1m([0mpkt->ip == NULL[1m)[0m return;                                                     [2m                [0m
[2;36m                    [0m         +  size_t ihl = [1m([0mpkt->ip->ver & [1;36m0xF[0m[1m)[0m * [1;36m4[0m;                                           [2m                [0m
[2;36m                    [0m         +  if [1m([0mihl [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[39m* Check that ICMP header is fully present in raw buffer *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [39m+  size_t eth_hdr = [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+  size_t icmp_offset = eth_hdr + ihl;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+  if [0m[1;39m([0m[39mpkt->raw.len < icmp_offset + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                     [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[39m* Set pkt->icmp pointer to actual ICMP header *[0m[35m/[0m                                [2m                [0m
[2;36m                    [0m         [39m+  pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->eth + icmp_offset[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m+  [0m[35m/[0m[39m* Only handle echo request directed to us *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [39m+  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [39m+    size_t hlen = icmp_offset + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    size_t space = ifp->tx.len - hlen;[0m                                             [2m                [0m
[2;36m                    [0m         [39m+    size_t plen = pkt->raw.len > hlen ? pkt->raw.len - hlen : [0m[1;36m0[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m            [2m                [0m
[2;36m                    [0m         [39m-                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m-    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                        [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m                [2m                [0m
[2;36m                    [0m         [39m-    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m+    struct ip *rip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m           [2m                [0m
[2;36m                    [0m         [39m+                           [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m+    struct icmp *ricmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mrip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmemset[0m[1;39m([0m[39mricmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*ricmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[39m* Set csum to [0m[1;36m0[0m[39m *[0m[35m/[0m                   [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmemcpy[0m[1;39m([0m[39mricmp + [0m[1;36m1[0m[39m, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m, plen[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [39m+    ricmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39mricmp, [0m[1;35msizeof[0m[1;39m([0m[39m*ricmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m [0m[1;39m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-799[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m810[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m-    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m+      [0m[35m/[0m[39m* Compute IP header length and validate ICMP header presence *[0m[35m/[0m             [2m                [0m
[2;36m                    [0m         [39m+      size_t ihl = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[39mihl < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m || pkt->raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m + ihl + [0m      [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+      pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->ip + ihl[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+      [0m[35m/[0m[39m* Set payload to data after ICMP header *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [39m+      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt->icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+      [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-886[0m[39m,[0m[1;36m12[0m[39m +[0m[1;36m900[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [39m       pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m  [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m     [2m                [0m
[2;36m                    [0m         [39m+      [0m[35m/[0m[39m* Compute actual IP header length and validate *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [39m+      size_t ihl = [0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m+      if [0m[1;39m([0m[39mihl < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[39m || pkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ihl[0m[1;39m)[0m[39m return;[0m   [2m                [0m
[2;36m                    [0m         [39m+      [0m[35m/[0m[39m* Set payload to IP data after header *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [39m+      [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m pkt.ip + ihl[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1779220820[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65170708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55cc65171aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65171aa8[0m[39m,[0m[1;36m0x55cc65185448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55cc650f6c02[0m[39m bp [0m[1;36m0x7fff8cf12200[0m[39m sp [0m[1;36m0x7fff8cf121f8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc650f6c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650ded1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc650f38b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc64f427ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc6506b11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650f379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgr1k1w9v[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fuzzer run uncovered an AddressSanitizer heap-buffer-overflow in the function [0m  [2m                [0m
[2;36m                    [0m         [39m`rx_icmp` [0m[1;39m([0m[39mnet_builtin.[0m[1;92mc:385[0m[1;39m)[0m[39m. The crash occurs when reading one byte past an [0m      [2m                [0m
[2;36m                    [0m         [39mallocated region for the ICMP payload buffer. A patch was attempted that:[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Early-returns when IP headers or ICMP headers are incomplete.[0m                     [2m                [0m
[2;36m                    [0m         [39m- Recomputes IP header length [0m[1;39m([0m[39m`ihl`[0m[1;39m)[0m[39m and ICMP header offset [0m[1;39m([0m[39m`icmp_offset`[0m[1;39m)[0m[39m.[0m       [2m                [0m
[2;36m                    [0m         [39m- Resets `pkt->icmp` to point into the raw receive buffer.[0m                          [2m                [0m
[2;36m                    [0m         [39m- Adjusts payload length calculations and the reply packet construction.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the same sanitizer error persists at the same location in[0m [2m                [0m
[2;36m                    [0m         [39m`rx_icmp`, indicating the added checks did not prevent the out-of-bounds read.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Initial Issue  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer [0m[1;39m([0m[39m`LLVMFuzzerTestOneInput`[0m[1;39m)[0m[39m allocates a buffer for packet data and [0m  [2m                [0m
[2;36m                    [0m         [39minvokes `mg_tcpip_rx`, which eventually calls `rx_icmp`.  [0m                          [2m                [0m
[2;36m                    [0m         [39m   - In `rx_icmp`, the code reads `pkt->icmp->type` and proceeds to copy or [0m        [2m                [0m
[2;36m                    [0m         [39mchecksum data without fully verifying that the ICMP header and payload are within [0m  [2m                [0m
[2;36m                    [0m         [39mthe allocated buffer bounds.  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - AddressSanitizer reports:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m     heap-buffer-overflow on address …[0m[1;36m172[0m                                           [2m                [0m
[2;36m                    [0m         [39m     READ of size [0m[1;36m1[0m[39m at …[0m[1;36m172[0m                                                         [2m                [0m
[2;36m                    [0m         [39m     at [0m[1;35mrx_icmp[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m net_builtin.[0m[1;92mc:385:18[0m                                           [2m                [0m
[2;36m                    [0m         [39m     ```[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - The overflow happens at a read of one byte immediately past a [0m[1;36m34[0m[39m-byte [0m         [2m                [0m
[2;36m                    [0m         [39mallocation, pointing to an unchecked access of `pkt->icmp` or its payload.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Patch Attempt  [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m   - Added null-checks on `pkt->ip`.  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Computed the IP header length [0m[1;39m([0m[39m`ihl`[0m[1;39m)[0m[39m from `pkt->ip->ver` and validated it is [0m [2m                [0m
[2;36m                    [0m         [39mnot smaller than `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m`.  [0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Calculated `icmp_offset` = Ethernet header size + `ihl` and verified [0m          [2m                [0m
[2;36m                    [0m         [39m`pkt->raw.len >= icmp_offset + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[39m`.  [0m                               [2m                [0m
[2;36m                    [0m         [39m   - Reassigned `pkt->icmp` to point at `[0m[1;39m([0m[39mchar*[0m[1;39m)[0m[39mpkt->eth + icmp_offset`.  [0m          [2m                [0m
[2;36m                    [0m         [39m   - Limited the ICMP payload length `plen` by `ifp->tx.len - hlen`.  [0m              [2m                [0m
[2;36m                    [0m         [39m   - In the IP reception path, similarly recomputed `ihl` and reset `pkt->icmp` and[0m [2m                [0m
[2;36m                    [0m         [39mpayload pointers before calling `rx_icmp`.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Post-Patch Result  [0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - The fuzzer re-runs produce the same AddressSanitizer crash in `rx_icmp` at [0m    [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m385[0m[39m.  [0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - The error remains a [0m[1;36m1[0m[39m-byte read just beyond a [0m[1;36m34[0m[39m-byte region, indicating the [0m  [2m                [0m
[2;36m                    [0m         [39mnewly added header-length and buffer-length checks did not fully cover the [0m         [2m                [0m
[2;36m                    [0m         [39mout-of-bounds scenario.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Areas for Further Investigation  [0m                                                [2m                [0m
[2;36m                    [0m         [39m   - The logic that constructs `pkt->raw.len` and `pkt->pay.len` earlier in [0m        [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx`: ensure those fields truly reflect the available data.  [0m              [2m                [0m
[2;36m                    [0m         [39m   - Interaction between `mkpay` [0m[1;39m([0m[39mwhich sets `pkt->pay.buf` and `pkt->pay.len`[0m[1;39m)[0m[39m and[0m [2m                [0m
[2;36m                    [0m         [39mthe bounds checks in `rx_icmp`.  [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - The reply packet builder `tx_ip` and `ether_output` to confirm they are not [0m   [2m                [0m
[2;36m                    [0m         [39mreusing stale length fields.  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - Any implicit assumptions about contiguous memory layout for `eth`, `ip`, [0m      [2m                [0m
[2;36m                    [0m         [39m`icmp`, and payload buffers.  [0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - Other code paths in `net_builtin.c` that handle fragmented or truncated IP [0m    [2m                [0m
[2;36m                    [0m         [39mpackets, to see if they bypass the new checks.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m678814652[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8fef708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8ff0aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55f7f8ff0aa8[0m[39m,[0m[1;36m0x55f7f9004448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55f7f8f75c02[0m[39m bp [0m[1;36m0x7ffca6a34380[0m[39m sp [0m[1;36m0x7ffca6a34378[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8f75c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f5dd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8f728b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55f7f8dc17ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55f7f8eea11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55f7f8f7279d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55f7f8dde350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55f7f8dc95c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55f7f8dcf05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55f7f8dfa302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f0f21511082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpttm9vnjp[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1779220820[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65170708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55cc65171aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55cc65171aa8[0m[39m,[0m[1;36m0x55cc65185448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55cc650f6c02[0m[39m bp [0m[1;36m0x7fff8cf12200[0m[39m sp [0m[1;36m0x7fff8cf121f8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc650f6c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650ded1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc650f38b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55cc64f427ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55cc6506b11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55cc650f379d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55cc64f5f350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55cc64f4a5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55cc64f5005f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55cc64f7b302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f4d73bd2082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpgr1k1w9v[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:880[0m[39m-[0m[1;36m894[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Root Cause and Symptom Analysis  [0m                                                [2m                [0m
[2;36m                    [0m         [39m   - The AddressSanitizer report pinpoints a one-byte OOB read at `rx_icmp` when [0m   [2m                [0m
[2;36m                    [0m         [39mreading `pkt->icmp->type`.  [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - The core defect is that `pkt->icmp` and `pkt->pay` are set up in `rx_ip` [0m[1;39m([0m[39mand [0m [2m                [0m
[2;36m                    [0m         [39min the IPv6 path[0m[1;39m)[0m[39m by simple pointer arithmetic—without sufficient bounds checks—via[0m [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mfor no-options IPv4[0m[1;39m)[0m[39m or `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, [0m[1;39m([0m[39mchar*[0m[1;39m)[0m[39mpkt->ip + [0m    [2m                [0m
[2;36m                    [0m         [39mihl[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mfor IPv4 with options[0m[1;39m)[0m[39m. If the packet is truncated or carries IP options, [0m   [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp` can point past the end of `raw.buf`, leading to the OOB read.  [0m         [2m                [0m
[2;36m                    [0m         [39m   - The last patch tried to re-validate headers in `rx_icmp`, but left the [0m        [2m                [0m
[2;36m                    [0m         [39mupstream ICMP pointer setup in `rx_ip` and IPv6 reception untouched. As a result, [0m  [2m                [0m
[2;36m                    [0m         [39mstale/misaligned `pkt->icmp` or inflated `pkt->pay.len` can still sneak into [0m       [2m                [0m
[2;36m                    [0m         [39m`rx_icmp` on some code paths.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Strategy: Centralize ICMP parsing entirely inside `rx_icmp` and eliminate the [0m   [2m                [0m
[2;36m                    [0m         [39mfragile `mkpay`-based setup  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m   a. In `rx_ip` [0m[1;39m([0m[39mIPv4[0m[1;39m)[0m[39m and the IPv6 branch that feeds into ICMP, **remove the [0m     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmkpay[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m` call and any direct `pkt->icmp = …` setup**. Replace that branch with [0m [2m                [0m
[2;36m                    [0m         [39ma simple dispatch:  [0m                                                                [2m                [0m
[2;36m                    [0m         [39m      ```[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m      else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m          [0m[35m/[0m[35m/[0m[39m No mkpay or pkt->icmp setup here[0m                                       [2m                [0m
[2;36m                    [0m         [39m          [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m      [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m      ```[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m      This ensures that no misaligned ICMP pointer from `rx_ip` can slip through.  [0m [2m                [0m
[2;36m                    [0m         [39m   b. In `rx_icmp`, **ignore** `pkt->icmp` and `pkt->pay` entirely at entry. [0m       [2m                [0m
[2;36m                    [0m         [39mInstead, perform all pointer arithmetic and length checks against [0m                  [2m                [0m
[2;36m                    [0m         [39m`pkt->raw.buf`[0m[35m/[0m[39m`pkt->raw.len` in one place:  [0m                                       [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m1[0m[39m. Verify `pkt->ip != NULL` and extract the IPv4 header length [0m[1;39m([0m[39m`ihl = [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m`[0m[1;39m)[0m[39m, rejecting too-small or malformed headers.  [0m             [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m2[0m[39m. Compute `offset_eth = [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->eth[0m[1;39m)[0m[39m; offset_ip = ihl; offset_icmp = [0m   [2m                [0m
[2;36m                    [0m         [39moffset_eth + offset_ip;`  [0m                                                          [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m3[0m[39m. Ensure `pkt->raw.len >= offset_icmp + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m` so that the [0m    [2m                [0m
[2;36m                    [0m         [39mfull ICMP header is in-bounds.  [0m                                                    [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m4[0m[39m. Let `struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt->eth + [0m              [2m                [0m
[2;36m                    [0m         [39moffset_icmp[0m[1;39m)[0m[39m;`  [0m                                                                    [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m5[0m[39m. Only now read `icmp->type` and `pkt->ip->dst`.  [0m                           [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m6[0m[39m. If it is an echo request to us [0m[1;39m([0m[39m`type == [0m[1;36m8[0m[39m && pkt->ip->dst == ifp->ip`[0m[1;39m)[0m[39m, [0m  [2m                [0m
[2;36m                    [0m         [39mcompute the payload start at `offset_payload = offset_icmp + [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m` and [0m    [2m                [0m
[2;36m                    [0m         [39mcheck `pkt->raw.len >= offset_payload`. Truncate `payload_len = pkt->raw.len - [0m     [2m                [0m
[2;36m                    [0m         [39moffset_payload` against the available TX buffer space.  [0m                            [2m                [0m
[2;36m                    [0m         [39m      [0m[1;36m7[0m[39m. Build and send the echo reply via `[0m[1;35mtx_ip[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`, `[0m[1;35mmemcpy[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`, [0m            [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mipcsum[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`, and `[0m[1;35mether_output[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`, mirroring the existing logic but using [0m     [2m                [0m
[2;36m                    [0m         [39mthese well-guarded offsets.  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m   c. **Eliminate any dependence** on `pkt->pay.buf`[0m[35m/[0m[39m`pkt->pay.len` inside [0m         [2m                [0m
[2;36m                    [0m         [39m`rx_icmp`. All reads [0m[1;39m([0m[39mheader and payload[0m[1;39m)[0m[39m are indexed off `pkt->raw.buf` with [0m      [2m                [0m
[2;36m                    [0m         [39mprecise bounds checks.  [0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Preservation of Existing Functionality  [0m                                         [2m                [0m
[2;36m                    [0m         [39m   - We only alter the IPv4 ICMP reception branch [0m[1;39m([0m[39m`pkt->ip->proto == [0m[1;36m1[0m[39m`[0m[1;39m)[0m[39m and the [0m  [2m                [0m
[2;36m                    [0m         [39mshared `rx_icmp` routine.  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - No changes to harness, fuzzing logic, tests, or external libraries.  [0m          [2m                [0m
[2;36m                    [0m         [39m   - UDP/TCP paths and mkpay remain untouched for non-ICMP protocols.  [0m             [2m                [0m
[2;36m                    [0m         [39m   - The existing reply-packet building [0m[1;39m([0m[39m`tx_ip` + `ether_output`[0m[1;39m)[0m[39m is preserved [0m    [2m                [0m
[2;36m                    [0m         [39mverbatim; we simply feed it correctly sliced ICMP headers and payloads.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Why this is Optimal  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - By centralizing all header parsing in one place, we remove duplication [0m[1;39m([0m[39mthe [0m   [2m                [0m
[2;36m                    [0m         [39m`mkpay` hacks in multiple code paths[0m[1;39m)[0m[39m and eliminate stale pointer/state carry-over.[0m [2m                [0m
[2;36m                    [0m         [39m   - Single source of truth for buffer bounds prevents future slips if the IP [0m      [2m                [0m
[2;36m                    [0m         [39mparsing logic evolves.  [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - The explicit offset computations match the wire layout [0m[1;39m([0m[39mEthernet → IP → ICMP →[0m [2m                [0m
[2;36m                    [0m         [39mpayload[0m[1;39m)[0m[39m and directly guard against any truncated or malicious inputs.  [0m            [2m                [0m
[2;36m                    [0m         [39m   - This approach is self-contained: no external code or harness is modified, so [0m  [2m                [0m
[2;36m                    [0m         [39mexisting tests stay green.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Potential Side Effects and Mitigations  [0m                                         [2m                [0m
[2;36m                    [0m         [39m   - We remove `mkpay` usage in `rx_ip` for the ICMP branch. Any code that [0m         [2m                [0m
[2;36m                    [0m         [39mpreviously read from `pkt->pay` in that branch must now use the offsets in [0m         [2m                [0m
[2;36m                    [0m         [39m`rx_icmp`. As long as all ICMP-related operations are encapsulated in `rx_icmp`, no[0m [2m                [0m
[2;36m                    [0m         [39mdownstream code will break.  [0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - IPv6 ICMP [0m[1;39m([0m[39mproto [0m[1;36m58[0m[1;39m)[0m[39m still sets up `pkt->icmp` in `rx_ip6`; `rx_icmp` will [0m    [2m                [0m
[2;36m                    [0m         [39mignore that branch since `pkt->ip` is NULL. If ICMPv6 echo/reply support is needed [0m [2m                [0m
[2;36m                    [0m         [39min the future, we should create a parallel `rx_icmp6` following the same [0m           [2m                [0m
[2;36m                    [0m         [39mpattern—but that is beyond this fix’s scope.  [0m                                      [2m                [0m
[2;36m                    [0m         [39m   - All other protocols [0m[1;39m([0m[39mTCP, UDP[0m[1;39m)[0m[39m remain unaffected, as we do not touch their [0m    [2m                [0m
[2;36m                    [0m         [39m`mkpay` logic.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. References in Codebase  [0m                                                         [2m                [0m
[2;36m                    [0m         [39m   - Similar “defensive parsing” patterns exist in `rx_ip` for ETH-IPv4 truncation [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlines [0m[1;36m880[0m[39m–[0m[1;36m894[0m[1;39m)[0m[39m and in `rx_ip6` for extension-header stripping [0m[1;39m([0m[39mthough incomplete[0m[1;39m)[0m[39m.[0m [2m                [0m
[2;36m                    [0m         [39mWe align ICMP parsing with that defensive style.  [0m                                  [2m                [0m
[2;36m                    [0m         [39m   - No previous patches conflict; this strategy supersedes the last multi-stage [0m   [2m                [0m
[2;36m                    [0m         [39mpatch by consolidating ICMP handling.  [0m                                             [2m                [0m
[2;36m                    [0m         [39m   - We maintain the same API: `[0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m` call sites remain, ensuring the [0m [2m                [0m
[2;36m                    [0m         [39mfuzzer harness and higher-layer tests continue to drive exactly the same code [0m      [2m                [0m
[2;36m                    [0m         [39mpaths.  [0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[12/31/25 03:55:51][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=340321;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=164543;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m6[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=944243;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=829507;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpzgvg79l0[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_o4_mini/mongoose_mg-delta-02_mongoose_2/[0m[95magent-o[0m [2m               [0m
[2;36m                    [0m         [95mutput-1767153351.4351506[0m                                                             [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-no-delta/mongoose_mg-delta-02_mongoose_2.toml                  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-mongoose[0m         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mmongoose[0m       ]8;id=227011;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=796725;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=913369;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=240077;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mmongoose[0m              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=769481;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=687805;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m               [2m               [0m
