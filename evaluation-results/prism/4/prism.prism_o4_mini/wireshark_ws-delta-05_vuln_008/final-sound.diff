--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -1104,8 +1104,7 @@
 
 	hdr_len = tvb_get_letohs(tvb, offset + NB_LENGTH);
 	command = tvb_get_uint8( tvb, offset + NB_COMMAND);
-					/* limit command so no table overflows */
-	command = MIN(command, array_length(dissect_netb));
+					/* limit command so no table overflows -- removed; guard at dispatch */
 
 		/* print command name */
 	command_name = val_to_str_ext(command, &cmd_vals_ext, "Unknown (0x%02x)");
@@ -1140,9 +1139,13 @@
 		proto_tree_add_uint(netb_tree, hf_netb_cmd, tvb, offset + NB_COMMAND, 1, command);
 	}
 
-				/* branch to handle commands */
-	session_id = (dissect_netb[ command])( tvb, pinfo, offset, netb_tree);
-
+				/* branch to handle commands, guard against out-of-range */
+	if ((guint)command < array_length(dissect_netb)) {
+		session_id = dissect_netb[command](tvb, pinfo, offset, netb_tree);
+	} else {
+		/* unknown command: safely call the fallback handler */
+		session_id = dissect_netb_unknown(tvb, pinfo, offset, netb_tree);
+	}
 	offset += hdr_len;			/* move past header */
 
 	save_fragmented = pinfo->fragmented;
