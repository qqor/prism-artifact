{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-05_vuln_008",
  "source_directory": "/home/user/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.32657460000000005,
    "prompt_tokens": 221302,
    "completion_tokens": 18896
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-netbios.c\n+++ b/epan/dissectors/packet-netbios.c\n@@ -1104,8 +1104,7 @@\n \n \thdr_len = tvb_get_letohs(tvb, offset + NB_LENGTH);\n \tcommand = tvb_get_uint8( tvb, offset + NB_COMMAND);\n-\t\t\t\t\t/* limit command so no table overflows */\n-\tcommand = MIN(command, array_length(dissect_netb));\n+\t\t\t\t\t/* limit command so no table overflows -- removed; guard at dispatch */\n \n \t\t/* print command name */\n \tcommand_name = val_to_str_ext(command, &cmd_vals_ext, \"Unknown (0x%02x)\");\n@@ -1140,9 +1139,13 @@\n \t\tproto_tree_add_uint(netb_tree, hf_netb_cmd, tvb, offset + NB_COMMAND, 1, command);\n \t}\n \n-\t\t\t\t/* branch to handle commands */\n-\tsession_id = (dissect_netb[ command])( tvb, pinfo, offset, netb_tree);\n-\n+\t\t\t\t/* branch to handle commands, guard against out-of-range */\n+\tif ((guint)command < array_length(dissect_netb)) {\n+\t\tsession_id = dissect_netb[command](tvb, pinfo, offset, netb_tree);\n+\t} else {\n+\t\t/* unknown command: safely call the fallback handler */\n+\t\tsession_id = dissect_netb_unknown(tvb, pinfo, offset, netb_tree);\n+\t}\n \toffset += hdr_len;\t\t\t/* move past header */\n \n \tsave_fragmented = pinfo->fragmented;\n",
  "stdout": "",
  "stderr": ""
}