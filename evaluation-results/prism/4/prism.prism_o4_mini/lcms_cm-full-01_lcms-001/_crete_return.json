{
  "project_name": "lcms",
  "vulnerability_identifier": "lcms_cm-full-01_lcms-001",
  "source_directory": "/tasks_new/lcms_cm-full-01/official-afc-little-cms",
  "llm_usage": {
    "total_cost": 0.6208961000000001,
    "prompt_tokens": 432207,
    "completion_tokens": 33061
  },
  "variant": "sound",
  "diff": "--- a/src/cmsps2.c\n+++ b/src/cmsps2.c\n@@ -757,7 +757,11 @@\n     const char* PostMaj;\n     const char* PreMin, *PostMin;\n     cmsStage* mpe;\n-        \n+\n+    if (Pipeline == NULL || Pipeline->Elements == NULL) {\n+        return 0;\n+    }\n+\n     mpe = Pipeline->Elements;\n \n     switch (cmsStageInputChannels(mpe)) {\n@@ -792,12 +796,17 @@\n         mpe = mpe ->Next;\n     }\n \n-    if (cmsStageType(mpe) == cmsSigCLutElemType) {\n+    if (mpe == NULL) {\n+        return 0;\n+    }\n+\n+    if (cmsStageType(mpe) != cmsSigCLutElemType) {\n+        return 0;\n+    }\n \n             _cmsIOPrintf(m, \"/Table \");\n             WriteCLUT(m, mpe, PreMaj, PostMaj, PreMin, PostMin, FALSE, (cmsColorSpaceSignature) 0);\n             _cmsIOPrintf(m, \"]\\n\");\n-    }\n \n     EmitLab2XYZ(m);\n     EmitWhiteBlackD50(m, BlackPoint);\n",
  "stdout": "",
  "stderr": ""
}