{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-full-01_vuln_004",
  "source_directory": "/tasks_new/freerdp_fp-full-01/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.25884650000000003,
    "prompt_tokens": 76999,
    "completion_tokens": 39579
  },
  "variant": "sound",
  "diff": "--- a/winpr/include/winpr/stream.h\n+++ b/winpr/include/winpr/stream.h\n@@ -699,7 +699,7 @@\n \t{\n \t\tWINPR_ASSERT(_s);\n \t\tWINPR_ASSERT(_b || (_n == 0));\n-\t\tWINPR_ASSERT(Stream_GetRemainingCapacity(_s) >= _n);\n+\t\tWINPR_ASSERT(Stream_GetRemainingLength(_s) >= _n);\n \t\tmemcpy(_b, (_s->pointer), (_n));\n \t\tStream_Seek(_s, _n);\n \t}\n\n--- a/libfreerdp/core/gcc.c\n+++ b/libfreerdp/core/gcc.c\n@@ -1859,8 +1859,13 @@\n \tif (blockLength < 4 + (UINT8)mcs->channelCount * 12)\n \t\treturn FALSE;\n \n-\tif (mcs->channelCount > CHANNEL_MAX_COUNT)\n-\t\treturn FALSE;\n+\t{\n+\t\tsize_t requiredBytes = (size_t)mcs->channelCount * sizeof(rdpMcsChannel);\n+\t\tsize_t allocatedBytes = (size_t)CHANNEL_MAX_COUNT * sizeof(rdpMcsChannel);\n+\n+\t\tif (mcs->channelCount > CHANNEL_MAX_COUNT || requiredBytes > allocatedBytes)\n+\t\t\treturn FALSE;\n+\t}\n \n \t/* channelDefArray */\n \tfor (UINT32 i = 0; i < mcs->channelCount; i++)\n",
  "stdout": "",
  "stderr": ""
}