--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -85,11 +85,15 @@
     tcount = (unsigned int) exif_get_short(buf + ofs + 14, d->order);
 
     /* Sanity check the offset */
-    if (buf_size < 6 + 16 + tcount * 6 + 4) {
-        exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,
-                 "ExifMnoteDataApple", "Short MakerNote");
-        /*printf("%s(%d)\n", __FUNCTION__, __LINE__);*/
-        return;
+    /* Directory length sanity check: each entry 12 bytes + 4-byte terminator */
+    {
+        size_t dir_start = ofs + 16;
+        size_t needed = dir_start + (size_t)tcount * 12 + 4;
+        if (needed > buf_size) {
+            exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,
+                     "ExifMnoteDataApple", "Short MakerNote");
+            return;
+        }
     }
 
     /* printf("%s(%d): total %d tags\n", __FUNCTION__, __LINE__, tcount); */
