--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java
@@ -579,20 +579,19 @@
         }
         String xref = parser.readString();
         if( !xref.trim().equals( "xref" ) )
+        // read and verify "xref" token
+        String xref = readXrefLine(MAX_XREF_LINE_LENGTH);
+        if (xref == null || !xref.trim().equals("xref"))
         {
             return false;
         }
-        
-        // check for trailer after xref
-        String str = parser.readString();
-        byte[] b = str.getBytes(StandardCharsets.ISO_8859_1);
-        source.seek(source.getPosition() - b.length);
-        
         // signal start of new XRef
-        xrefTrailerResolver.nextXrefObj( startByteOffset, XRefType.TABLE );
-    
-        if (str.startsWith("trailer"))
-        {
+        xrefTrailerResolver.nextXrefObj(startByteOffset, XRefType.TABLE);
+
+        final int MAX_XREF_LINE_LENGTH = 4096;
+        final int MAX_XREF_SECTIONS = 1000;
+        final int MAX_XREF_SECTION_ENTRIES = 100_000;
+        int sectionCount = 0;
             LOG.warn("skipping empty xref table");
             return false;
         }
