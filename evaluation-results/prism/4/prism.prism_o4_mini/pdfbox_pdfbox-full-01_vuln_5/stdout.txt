[11/04/25 08:01:20] INFO     Building environment                                                                    __init__.py:132
                             - Cache directory: /tmp/tmpskc0myv8                                                                    
                             - Max timeout: 1800                                                                                    
                             - Output directory:                                                                                    
                             reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_5/agent-output-1762243280.269287                
                             6                                                                                                      
                             - Detection toml file:                                                                                 
                             /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_5.toml                           
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                    
                                                                                                                                    
                    INFO     Setting timeouts                                                                          default.py:83
                               - build: 600 (original: 88)                                                                          
                               - run tests: 600 (original: 0)                                                                       
                    INFO     Successfully created Cached for CLEAN environment                                       oss_fuzz.py:256
                    INFO     Current environments: ['CLEAN -> Cached']                                               oss_fuzz.py:265
                    INFO     Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                       __init__.py:160
                             (n evals: 0, patch status: PatchStatus.INITIALIZED)                                                    
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:01:21] INFO     [logging_performance](pdfbox Setting owner) Took 0.81 seconds; exception=False   context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:01:23] INFO     [logging_performance](pdfbox Setting owner) Took 1.07 seconds; exception=False   context_managers.py:23
[11/04/25 08:01:29] INFO     ===Evaluator Result===                                                                 evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                 
                             ===Evaluator Diff===                                                                                   
                                                                                                                                    
                             ===Patch Result===                                                                                     
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of                     
                             memory (use '-Xmx1710m' to reproduce)                                                                  
                             Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit                           
                                     at org.apache.fontbox.type1.Type1Lexer.readCharString(Type1Lexer.java:507)                     
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:232)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.read(Type1Parser.java:877)                             
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:109)                       
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaFo                 
                             rm$DMH)                                                                                                
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                   
                             DEDUP_TOKEN: 0d88e419df5aef8d                                                                          
                             == libFuzzer crashing input ==                                                                         
                             ===Issue===                                                                                            
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of                     
                             memory (use '-Xmx1710m' to reproduce)                                                                  
                             Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit                           
                                     at org.apache.fontbox.type1.Type1Lexer.readCharString(Type1Lexer.java:507)                     
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:232)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.read(Type1Parser.java:877)                             
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:109)                       
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaFo                 
                             rm$DMH)                                                                                                
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                   
                             DEDUP_TOKEN: 0d88e419df5aef8d                                                                          
                             == libFuzzer crashing input ==                                                                         
                             ===Evaluation Report===                                                                                
                                                                                                                                    
                             ===Analysis Report===                                                                                  
                                                                                                                                    
                             ===Evaluation End===                                                                                   
[11/04/25 08:01:41] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                     __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                     
[11/04/25 08:03:15] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                        __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                     
[11/04/25 08:05:54] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                       __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                     
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:05:55] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False   context_managers.py:23
[11/04/25 08:05:56] INFO     [logging_performance](pdfbox Patching) Started...                                 context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpf1gv_b_l                                                    default.py:171
[11/04/25 08:06:29] ERROR    Failed to build the challenge                                                            __init__.py:53
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_5/agent-output-1762243280.269287 functions.py:17
                             6/build_failed_stdout.txt: /src /src/project-parent/pdfbox                                             
                             /src/project-parent/pdfbox                                                                             
                             ---------------------------------------------------------------                                        
                             vm.mmap_rnd_bits = 28                                                                                  
                             ---------------------------------------------------------------                                        
                             CC=clang                                                                                               
                             CXX=clang++                                                                                            
                             CFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only                                              
                             -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                  
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations                                         
                             -Wno-error=implicit-function-declaration   -Wno-error=implicit-int                                     
                             -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION                              
                             -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link                        
                             -fno-sanitize=leak                                                                                     
                             CXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only                                            
                             -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                  
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations                                         
                             -Wno-error=implicit-function-declaration   -Wno-error=implicit-int                                     
                             -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION                              
                             -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link                        
                             -stdlib=libc++ -fno-sanitize=leak                                                                      
                             RUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers                       
                             ---------------------------------------------------------------                                        
                             + __REAL_MAVEN_REPO=/root/.m2/repository                                                               
                             + __SHARED_MAVEN_REPO=/work/mavencache                                                                 
                             + '[' '!' -L /root/.m2/repository ']'                                                                  
                             + unset __REAL_MAVEN_REPO                                                                              
                             + unset __SHARED_MAVEN_REPO                                                                            
                             + PROJECT=pdfbox                                                                                       
                             + PROJECT_GROUP_ID=org.apache.pdfbox                                                                   
                             + PROJECT_ARTIFACT_ID=pdfbox                                                                           
                             + XMPBOX_ARTIFACT_ID=xmpbox                                                                            
                             + MAIN_REPOSITORY=https://github.com/apache/pdfbox/                                                    
                             + MAVEN_ARGS='-Djavac.src.version=11 -Djavac.target.version=11 -DskipTests'                            
                             + cd /src/project-parent                                                                               
                             + [[ -v LOCAL_DEV ]]                                                                                   
                             + mv /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict /out                                 
                             + set_project_version_in_fuzz_targets_dependency                                                       
                             ++ cd pdfbox                                                                                           
                             ++ /src/maven/apache-maven-3.9.9/bin/mvn                                                               
                             org.apache.maven.plugins:maven-help-plugin:3.2.0:evaluate -Dexpression=project.version                 
                             -q -DforceStdout                                                                                       
                             + PROJECT_VERSION=4.0.0-SNAPSHOT                                                                       
                             + cd fuzz-targets                                                                                      
                             + /src/maven/apache-maven-3.9.9/bin/mvn versions:use-dep-version                                       
                             -Dexcludes=com.code-intelligence:jazzer -DdepVersion=4.0.0-SNAPSHOT -DforceVersion=true                
                             [INFO] Scanning for projects...                                                                        
                             [INFO]                                                                                                 
                             [INFO] ----------------------< com.fuzzer:fuzz-targets >-----------------------                        
                             [INFO] Building fuzz 0.0.1-SNAPSHOT                                                                    
                             [INFO]   from pom.xml                                                                                  
                             [INFO] --------------------------------[ jar ]---------------------------------                        
                             [INFO]                                                                                                 
                             [INFO] --- versions:2.19.1:use-dep-version (default-cli) @ fuzz-targets ---                            
                             [INFO] Updated org.apache.pdfbox:pdfbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                   
                             [INFO] Updated org.apache.pdfbox:xmpbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] BUILD SUCCESS                                                                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Total time:  0.708 s                                                                            
                             [INFO] Finished at: 2025-11-04T08:06:02Z                                                               
                             [INFO] ------------------------------------------------------------------------                        
                             + cd pdfbox                                                                                            
                             + /src/maven/apache-maven-3.9.9/bin/mvn install -Djavac.src.version=11                                 
                             -Djavac.target.version=11 -DskipTests -Dmaven.repo.local=/out/m2                                       
                             [INFO] Scanning for projects...                                                                        
                                                                                                                                    
                                                                                                                                    
                                                                                                                                    
                                                                                                                                    
                                                                                                                                    
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Reactor Build Order:                                                                            
                             [INFO]                                                                                                 
                             [INFO] Apache PDFBox parent                                               [pom]                        
                             [INFO] Apache PDFBox io                                                [bundle]                        
                             [INFO] Apache FontBox                                                  [bundle]                        
                             [INFO] Apache XmpBox                                                   [bundle]                        
                             [INFO] Apache PDFBox                                                   [bundle]                        
                             [INFO] Apache PDFBox Debugger                                             [jar]                        
                             [INFO] Apache PDFBox tools                                                [jar]                        
                             [INFO] Apache PDFBox application                                          [jar]                        
                             [INFO] Apache PDFBox Debugger application                                 [jar]                        
                             [INFO] Apache PDFBox examples                                             [jar]                        
                             [INFO] pdfbox-reactor                                                     [pom]                        
                             [INFO]                                                                                                 
                             [INFO] ------------------< org.apache.pdfbox:pdfbox-parent >-------------------                        
                             [INFO] Building Apache PDFBox parent 4.0.0-SNAPSHOT                      [1/11]                        
                             [INFO]   from parent/pom.xml                                                                           
                             [INFO] --------------------------------[ pom ]---------------------------------                        
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-parent ---                                        
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                      
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-parent ---                          
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-parent ---                           
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                       
                             [INFO]                                                                                                 
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-parent ---                                          
                                                                                                                                    
                                                                                                                                    
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-parent ---                                   
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-parent                   
                             ---                                                                                                    
                             [INFO] Preparing remote bundle                                                                         
                             org.apache.apache.resources:apache-jar-resource-bundle:1.7                                             
                             [INFO] Copying 3 resources from 1 bundle.                                                              
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-parent ---                                           
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-parent ---                               
                             [INFO]                                                                                                 
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-parent ---                                 
                             [INFO] Installing /src/project-parent/pdfbox/parent/pom.xml to                                         
                             /out/m2/org/apache/pdfbox/pdfbox-parent/4.0.0-SNAPSHOT/pdfbox-parent-4.0.0-SNAPSHOT.pom                
                             [INFO]                                                                                                 
                             [INFO] --------------------< org.apache.pdfbox:pdfbox-io >---------------------                        
                             [INFO] Building Apache PDFBox io 4.0.0-SNAPSHOT                          [2/11]                        
                             [INFO]   from io/pom.xml                                                                               
                             [INFO] -------------------------------[ bundle ]-------------------------------                        
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-io ---                                            
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                      
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-io ---                              
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-io ---                               
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                       
                             [INFO]                                                                                                 
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-io ---                                              
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-io ---                                       
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-io ---                   
                             [INFO] Preparing remote bundle                                                                         
                             org.apache.apache.resources:apache-jar-resource-bundle:1.7                                             
                             [INFO] Copying 3 resources from 1 bundle.                                                              
                             [INFO]                                                                                                 
                             [INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox-io ---                               
                             [INFO] skip non existing resourceDirectory                                                             
                             /src/project-parent/pdfbox/io/src/main/resources                                                       
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                
                             [INFO]                                                                                                 
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox-io ---                                   
                             [INFO] Recompiling the module because of changed source code.                                          
                             [INFO] Compiling 18 source files with javac [debug deprecation release 11] to                          
                             target/classes                                                                                         
                             [INFO]                                                                                                 
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ pdfbox-io ---                       
                             [INFO] Copying 2 resources from src/test/resources to target/test-classes                              
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to                               
                             target/test-classes                                                                                    
                             [INFO]                                                                                                 
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ pdfbox-io ---                           
                             [INFO] Recompiling the module because of changed dependency.                                           
                             [INFO] Compiling 10 source files with javac [debug deprecation release 11] to                          
                             target/test-classes                                                                                    
                             [WARNING]                                                                                              
                             /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[45,2                
                             9] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been                 
                             deprecated and marked for removal                                                                      
                             [WARNING]                                                                                              
                             /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[50,2                
                             4] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been                 
                             deprecated and marked for removal                                                                      
                             [WARNING]                                                                                              
                             /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[57,2                
                             4] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been                 
                             deprecated and marked for removal                                                                      
                             [INFO]                                                                                                 
                             [INFO] --- surefire:3.5.2:test (default-test) @ pdfbox-io ---                                          
                             [INFO] Tests are skipped.                                                                              
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-io ---                                               
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ pdfbox-io ---                                        
                             [INFO] Building bundle:                                                                                
                             /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar                                      
                             [INFO] Writing manifest:                                                                               
                             /src/project-parent/pdfbox/io/target/classes/META-INF/MANIFEST.MF                                      
                             [INFO]                                                                                                 
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-io ---                                   
                             [INFO] Building jar:                                                                                   
                             /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                              
                             [INFO]                                                                                                 
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-io ---                                     
                             [INFO] Installing /src/project-parent/pdfbox/io/pom.xml to                                             
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.pom                        
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar to                 
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                        
                             [INFO] Installing                                                                                      
                             /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar to                           
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                
                             [INFO]                                                                                                 
                             [INFO] --- bundle:5.1.9:install (default-install) @ pdfbox-io ---                                      
                             [INFO] Writing OBR metadata                                                                            
                             [INFO] Installing                                                                                      
                             org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                
                             [INFO] Writing OBR metadata                                                                            
                             [INFO]                                                                                                 
                             [INFO] ---------------------< org.apache.pdfbox:fontbox >----------------------                        
                             [INFO] Building Apache FontBox 4.0.0-SNAPSHOT                            [3/11]                        
                             [INFO]   from fontbox/pom.xml                                                                          
                             [INFO] -------------------------------[ bundle ]-------------------------------                        
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (default) @ fontbox ---                                              
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ fontbox ---                                
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ fontbox ---                                 
                             [INFO]                                                                                                 
                             [INFO] --- checkstyle:3.6.0:check (check) @ fontbox ---                                                
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ fontbox ---                                         
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ fontbox ---                     
                             [INFO] Preparing remote bundle                                                                         
                             org.apache.apache.resources:apache-jar-resource-bundle:1.7                                             
                             [INFO] Copying 3 resources from 1 bundle.                                                              
                             [INFO] Copying appended resource: META-INF/LICENSE                                                     
                             [INFO] Copying appended resource: META-INF/NOTICE                                                      
                             [INFO]                                                                                                 
                             [INFO] --- resources:3.3.1:resources (default-resources) @ fontbox ---                                 
                             [INFO] Copying 93 resources from src/main/resources to target/classes                                  
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                
                             [INFO]                                                                                                 
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ fontbox ---                                     
                             [INFO] Recompiling the module because of changed dependency.                                           
                             [INFO] Compiling 141 source files with javac [debug deprecation release 11] to                         
                             target/classes                                                                                         
                             [INFO] -------------------------------------------------------------                                   
                             [ERROR] COMPILATION ERROR :                                                                            
                             [INFO] -------------------------------------------------------------                                   
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[45,17] '{' expected                                                                                
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[46,19] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[47,13] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[49,26] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[50,6] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[52,26] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[52,76] <identifier> expected                                                                       
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[54,19] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[55,13] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[56,13] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[63,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[66,9] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[67,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[73,12] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[77,9] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[78,9] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[79,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[85,12] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[88,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[95,12] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[98,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[108,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[112,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[122,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[125,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[130,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[134,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[138,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[143,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[147,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[151,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[155,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[159,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[163,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[168,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[170,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[174,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[177,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[182,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[183,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[188,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[191,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[196,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[197,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[202,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[206,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[207,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[213,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[214,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[217,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[222,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[227,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[235,29] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[239,29] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[244,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[250,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[251,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[260,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[261,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[262,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[263,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[266,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[269,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[270,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[276,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[277,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[278,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[284,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[285,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[290,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[291,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[292,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[297,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[298,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[303,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[304,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[310,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[311,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[316,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[317,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[323,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[324,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[330,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[333,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[336,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[337,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[343,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[344,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[349,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[350,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[356,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[357,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[361,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[364,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[367,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[371,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[373,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[375,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[384,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[387,13] class, interface, or enum expected                                                         
                             [INFO] 100 errors                                                                                      
                             [INFO] -------------------------------------------------------------                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                              
                             [INFO]                                                                                                 
                             [INFO] Apache PDFBox parent ............................... SUCCESS [ 10.820 s]                        
                             [INFO] Apache PDFBox io ................................... SUCCESS [  5.032 s]                        
                             [INFO] Apache FontBox ..................................... FAILURE [  0.978 s]                        
                             [INFO] Apache XmpBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                    
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                    
                             [INFO] Apache PDFBox application .......................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                    
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                    
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                    
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] BUILD FAILURE                                                                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Total time:  25.666 s                                                                           
                             [INFO] Finished at: 2025-11-04T08:06:29Z                                                               
                             [INFO] ------------------------------------------------------------------------                        
                             [ERROR] Failed to execute goal                                                                         
                             org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on                     
                             project fontbox: Compilation failure: Compilation failure:                                             
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[45,17] '{' expected                                                                                
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[46,19] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[47,13] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[49,26] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[50,6] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[52,26] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[52,76] <identifier> expected                                                                       
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[54,19] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[55,13] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[56,13] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[63,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[66,9] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[67,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[73,12] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[77,9] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[78,9] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[79,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[85,12] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[88,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[95,12] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[98,5] class, interface, or enum expected                                                           
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[108,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[112,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[122,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[125,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[130,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[134,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[138,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[143,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[147,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[151,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[155,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[159,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[163,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[168,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[170,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[174,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[177,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[182,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[183,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[188,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[191,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[196,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[197,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[202,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[206,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[207,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[213,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[214,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[217,21] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[222,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[227,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[235,29] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[239,29] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[244,25] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[250,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[251,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[260,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[261,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[262,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[263,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[266,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[269,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[270,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[276,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[277,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[278,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[284,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[285,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[290,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[291,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[292,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[297,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[298,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[303,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[304,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[310,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[311,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[316,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[317,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[323,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[324,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[330,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[333,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[336,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[337,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[343,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[344,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[349,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[350,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[356,17] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[357,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[361,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[364,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[367,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[371,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[373,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[375,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[384,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[387,13] class, interface, or enum expected                                                         
                             [ERROR] -> [Help 1]                                                                                    
                             [ERROR]                                                                                                
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                    
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                 
                             [ERROR]                                                                                                
                             [ERROR] For more information about the errors and possible solutions, please read the                  
                             following articles:                                                                                    
                             [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException                 
                             [ERROR]                                                                                                
                             [ERROR] After correcting the problems, you can resume the build with the command                       
                             [ERROR]   mvn <args> -rf :fontbox                                                                      
                             subprocess command returned a non-zero exit status: 1                                                  
                                                                                                                                    
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_5/agent-output-1762243280.269287 functions.py:17
                             6/build_failed_stderr.txt: INFO:__main__:Running: docker build -t                                      
                             aixcc-afc/pdfbox:latest --file                                                                         
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox/Dockerfile                               
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox.                                         
                             #0 building with "default" instance using docker driver                                                
                                                                                                                                    
                             #1 [internal] load build definition from Dockerfile                                                    
                             #1 transferring dockerfile: 2.07kB done                                                                
                             #1 DONE 0.0s                                                                                           
                                                                                                                                    
                             #2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                           
                             #2 DONE 0.0s                                                                                           
                                                                                                                                    
                             #3 [internal] load .dockerignore                                                                       
                             #3 transferring context: 2B done                                                                       
                             #3 DONE 0.0s                                                                                           
                                                                                                                                    
                             #4 [ 1/13] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                           
                             #4 DONE 0.0s                                                                                           
                                                                                                                                    
                             #5 [internal] load build context                                                                       
                             #5 transferring context: 1.23kB done                                                                   
                             #5 DONE 0.0s                                                                                           
                                                                                                                                    
                             #6 [ 2/13] RUN set -eux     && apt-get update     && apt-get install --yes                             
                             --no-install-recommends         tesseract-ocr=4.1.1-2build2                                            
                             tesseract-ocr-eng=1:4.00~git30-7274cfa-1     && apt-get clean     && rm -rf                            
                             /var/lib/apt/lists/*                                                                                   
                             #6 CACHED                                                                                              
                                                                                                                                    
                             #7 [ 3/13] RUN mkdir /usr/my-bin && mv /usr/bin/tesseract /usr/my-bin/tesseract                        
                             #7 CACHED                                                                                              
                                                                                                                                    
                             #8 [ 9/13] RUN rm -rf /src/project-parent/pdfbox                                                       
                             #8 CACHED                                                                                              
                                                                                                                                    
                             #9 [ 8/13] COPY project-parent /src/project-parent/                                                    
                             #9 CACHED                                                                                              
                                                                                                                                    
                             #10 [11/13] RUN tar -zxf /src/pdfbox.tar.gz -C /src/project-parent && rm                               
                             /src/pdfbox.tar.gz                                                                                     
                             #10 CACHED                                                                                             
                                                                                                                                    
                             #11 [ 7/13] RUN gunzip /src/pdf.dict.gz &&     mv /src/pdf.dict                                        
                             /src/PDFStreamParserFuzzer.dict &&     cp /src/PDFStreamParserFuzzer.dict                              
                             /src/PDFWriteReadFuzzer.dict                                                                           
                             #11 CACHED                                                                                             
                                                                                                                                    
                             #12 [ 6/13] COPY pkgs/pdf.dict.gz /src/pdf.dict.gz                                                     
                             #12 CACHED                                                                                             
                                                                                                                                    
                             #13 [10/13] COPY pkgs/pdfbox.tar.gz /src/pdfbox.tar.gz                                                 
                             #13 CACHED                                                                                             
                                                                                                                                    
                             #14 [12/13] COPY build.sh /src/                                                                        
                             #14 CACHED                                                                                             
                                                                                                                                    
                             #15 [ 5/13] RUN unzip /src/maven.zip -d /src/maven && rm /src/maven.zip                                
                             #15 CACHED                                                                                             
                                                                                                                                    
                             #16 [ 4/13] COPY pkgs/maven.zip /src/maven.zip                                                         
                             #16 CACHED                                                                                             
                                                                                                                                    
                             #17 [13/13] WORKDIR /src/project-parent/pdfbox                                                         
                             #17 CACHED                                                                                             
                                                                                                                                    
                             #18 exporting to image                                                                                 
                             #18 exporting layers done                                                                              
                             #18 writing image                                                                                      
                             sha256:4d4597221200681f22ef920bad2dfdfa3ce5a921371aee8a4b6860c6c77d8cc8 done                           
                             #18 naming to docker.io/aixcc-afc/pdfbox:latest                                                        
                             #18 naming to docker.io/aixcc-afc/pdfbox:latest done                                                   
                             #18 DONE 0.0s                                                                                          
                             INFO:__main__:Keeping existing build artifacts as-is (if any).                                         
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64                    
                             --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64 -e                     
                             PROJECT_NAME=pdfbox -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e                
                             MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v                                                      
                             /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox:/local-source-mount:ro -v                         
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/:/out -v                                
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/work/pdfbox:/work -t                               
                             aixcc-afc/pdfbox:latest /bin/bash -c 'pushd $SRC && rm -rf /src/project-parent/pdfbox                  
                             && cp -r /local-source-mount /src/project-parent/pdfbox && popd && compile'.                           
                             ERROR:__main__:Building fuzzers failed.                                                                
                                                                                                                                    
                    INFO     [logging_performance](pdfbox Patching) Took 33.39 seconds; exception=False       context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:06:30] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False   context_managers.py:23
[11/04/25 08:06:31] INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:06:32] INFO     [logging_performance](pdfbox Setting owner) Took 0.96 seconds; exception=False   context_managers.py:23
                    INFO     ===Evaluator Result===                                                                 evaluator.py:204
                             PatchStatus.UNCOMPILABLE                                                                               
                             ===Evaluator Diff===                                                                                   
                             --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                                   
                             +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                                   
                             @@ -43,8 +43,10 @@                                                                                     
                               * @author John Hewson                                                                                
                               */                                                                                                   
                              class Type1Lexer                                                                                      
                             -{                                                                                                     
                             -    /**                                                                                               
                             +    private final ByteBuffer buffer;                                                                  
                             +    private Token aheadToken;                                                                         
                             +    // Maximum allowed size for a Type 1 charstring (16 MB)                                           
                             +    private static final int MAX_CHARSTRING_LENGTH = 16 * 1024 * 1024;                                
                                   * Log instance.                                                                                  
                                   */                                                                                               
                                  private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                         
                             @@ -501,6 +503,21 @@                                                                                   
                                   */                                                                                               
                                  private Token readCharString(int length) throws IOException                                       
                                  {                                                                                                 
                             +        // Validate charstring length to prevent resource exhaustion                                  
                             +        if (length < 0)                                                                               
                             +        {                                                                                             
                             +            throw new IOException("Invalid CharString length (negative): " + length);                 
                             +        }                                                                                             
                             +        // Account for the leading space byte                                                         
                             +        int remaining = buffer.remaining() - 1;                                                       
                             +        if (length > remaining)                                                                       
                             +        {                                                                                             
                             +            throw new IOException("CharString length exceeds available data: " +                      
                             length);                                                                                               
                             +        }                                                                                             
                             +        if (length > MAX_CHARSTRING_LENGTH)                                                           
                             +        {                                                                                             
                             +            throw new IOException("CharString length exceeds max allowed: " +                         
                             length);                                                                                               
                             +        }                                                                                             
                                      try                                                                                           
                                      {                                                                                             
                                          buffer.get(); // space                                                                    
                                                                                                                                    
                             ===Patch Result===                                                                                     
                             [ERROR] COMPILATION ERROR :                                                                            
                             [INFO] -------------------------------------------------------------                                   
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[45,17] '{' expected                                                                               
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[46,19] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[47,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[49,26] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[50,6] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[52,26] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[52,76] <identifier> expected                                                                      
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[54,19] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[55,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[56,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[63,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[66,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[67,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[73,12] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[77,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[78,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[79,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[85,12] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[88,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[95,12] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[98,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[108,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[112,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[122,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[125,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[130,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[134,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[138,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[143,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[147,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[151,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[155,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[159,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[163,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[168,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[170,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[174,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[177,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[182,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[183,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[188,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[191,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[196,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[197,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[202,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[206,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[207,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[213,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[214,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[217,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[222,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[227,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[235,29] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[239,29] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[244,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[250,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[251,5] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[260,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[261,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[262,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[263,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[266,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[269,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[270,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[276,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[277,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[278,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[284,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[285,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[290,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[291,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[292,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[297,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[298,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[303,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[304,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[310,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[311,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[316,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[317,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[323,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[324,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[330,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[333,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[336,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[337,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[343,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[344,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[349,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[350,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[356,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[357,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[361,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[364,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[367,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[371,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[373,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[375,5] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[384,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[387,13] class, interface, or enum expected                                                        
                             [INFO] 100 errors                                                                                      
                             [INFO] -------------------------------------------------------------                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                              
                             [INFO]                                                                                                 
                             [INFO] Apache PDFBox parent ............................... SUCCESS [ 10.820 s]                        
                             [INFO] Apache PDFBox io ................................... SUCCESS [  5.032 s]                        
                             [INFO] Apache FontBox ..................................... FAILURE [  0.978 s]                        
                             [INFO] Apache XmpBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                    
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                    
                             [INFO] Apache PDFBox application .......................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                    
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                    
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                    
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] BUILD FAILURE                                                                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Total time:  25.666 s                                                                           
                             [INFO] Finished at: 2025-11-04T08:06:29Z                                                               
                             [INFO] ------------------------------------------------------------------------                        
                             [ERROR] Failed to execute goal                                                                         
                             org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on                     
                             project fontbox: Compilation failure: Compilation failure:                                             
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[45,17] '{' expected                                                                               
                             [ERROR] /src/project-p                                                                                 
                             ... [TRUNCATED]                                                                                        
                             ===Issue===                                                                                            
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of                     
                             memory (use '-Xmx1710m' to reproduce)                                                                  
                             Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit                           
                                     at org.apache.fontbox.type1.Type1Lexer.readCharString(Type1Lexer.java:507)                     
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:232)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.read(Type1Parser.java:877)                             
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:109)                       
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaFo                 
                             rm$DMH)                                                                                                
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                   
                             DEDUP_TOKEN: 0d88e419df5aef8d                                                                          
                             == libFuzzer crashing input ==                                                                         
                             ===Evaluation Report===                                                                                
                             # Evaluation Report                                                                                    
                                                                                                                                    
                             ## Summary                                                                                             
                                                                                                                                    
                             A Jazzer-based fuzzing harness (`PDFExtractTextFuzzer`) triggered a low-severity                       
                             security issue due to an OutOfMemoryError when processing a malicious or malformed                     
                             PDF. The JVM crashed with Requested array size exceeds VM limit during parsing of a                  
                             Type 1 fonts charstring data in Apache PDFBox/FontBox. The failure is reproducible                    
                             with increased heap (`-Xmx1710m`).                                                                     
                                                                                                                                    
                             ## Description                                                                                         
                                                                                                                                    
                             - Issue type: Resource exhaustion (Out of memory)                                                      
                             - Exception trace:                                                                                     
                                FuzzerSecurityIssueLow: Out of memory (use -Xmx1710m to reproduce)                               
                                Caused by java.lang.OutOfMemoryError: Requested array size exceeds VM limit                        
                                at org.apache.fontbox.type1.Type1Lexer.readCharString(Type1Lexer.java:507)                         
                                                                                                                                  
                                at                                                                                                 
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                                                                                                                    
                             - Key observations:                                                                                    
                                The crash occurs while parsing a Type 1 font embedded in a PDF.                                    
                                `Type1Lexer.readCharString` attempts to allocate an array whose requested size is                  
                             beyond the VMs limits.                                                                                
                                Upstream calls traverse through `Type1Parser`, `Type1Font.createWithPFB`,                          
                             `PDType1Font`, `PDFontFactory`, and finally the PDF textextraction engine                             
                             (`PDFTextStripper`).                                                                                   
                                The fuzzer harness serves solely as an entry point; the fault lies in how the font                 
                             parsing code handles input lengths.                                                                    
                                                                                                                                    
                             - Affected components to review:                                                                       
                                org.apache.fontbox.type1.Type1Lexer (especially `readCharString`)                                  
                                org.apache.fontbox.type1.Type1Parser                                                               
                                org.apache.fontbox.type1.Type1Font.createWithPFB                                                   
                                org.apache.pdfbox.pdmodel.font.PDType1Font                                                         
                                org.apache.pdfbox.pdmodel.font.PDFontFactory                                                       
                                org.apache.pdfbox.text.PDFTextStripper and related streamengine classes                           
                                The fuzzing harness entry point (`PDFExtractTextFuzzer.fuzzerTestOneInput`) for                    
                             context on input flow                                                                                  
                                                                                                                                    
                             - No assumptions are made about the root cause beyond the unbounded memory allocation                  
                             request. The focus should be on understanding how the font parser computes buffer                      
                             sizes and why it fails to guard against excessive values.                                              
                                                                                                                                    
                             ## Initial Issue Log                                                                                   
                             Here is the initial issue log of the codebase:                                                         
                             <issue>                                                                                                
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of                     
                             memory (use '-Xmx1710m' to reproduce)                                                                  
                             Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit                           
                                     at org.apache.fontbox.type1.Type1Lexer.readCharString(Type1Lexer.java:507)                     
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:232)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.read(Type1Parser.java:877)                             
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:109)                       
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaFo                 
                             rm$DMH)                                                                                                
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                   
                             DEDUP_TOKEN: 0d88e419df5aef8d                                                                          
                             == libFuzzer crashing input ==                                                                         
                             </issue>                                                                                               
                             ===Analysis Report===                                                                                  
                             # Analysis Report                                                                                      
                                                                                                                                    
                             ## Relevant Code Snippets                                                                              
                             <code_snippets>                                                                                        
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:61-65                                   
                             ```                                                                                                    
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                     
                             62:    {                                                                                               
                             63:        buffer = ByteBuffer.wrap(bytes);                                                            
                             64:        aheadToken = readToken(null);                                                               
                             65:    }                                                                                               
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:502-515                                 
                             ```                                                                                                    
                             502:    private Token readCharString(int length) throws IOException                                    
                             503:    {                                                                                              
                             504:        try                                                                                        
                             505:        {                                                                                          
                             506:            buffer.get(); // space                                                                 
                             507:            byte[] data = new byte[length];                                                        
                             508:            buffer.get(data);                                                                      
                             509:            return new Token(data, Token.CHARSTRING);                                              
                             510:        }                                                                                          
                             511:        catch (BufferUnderflowException exception)                                                 
                             512:        {                                                                                          
                             513:            throw new IOException("Premature end of buffer reached");                              
                             514:        }                                                                                          
                             515:    }                                                                                              
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:777-805                                
                             ```                                                                                                    
                             777:    private void readCharStrings(int lenIV) throws IOException                                     
                             778:    {                                                                                              
                             779:        int length = read(Token.INTEGER).intValue();                                               
                             780:        read(Token.NAME, "dict");                                                                  
                             781:        // could actually be a sequence ending in "CharStrings begin", too                         
                             782:        // instead of the "dup begin"                                                              
                             783:        read(Token.NAME, "dup");                                                                   
                             784:        read(Token.NAME, "begin");                                                                 
                             785:                                                                                                   
                             786:        for (int i = 0; i < length; i++)                                                           
                             787:        {                                                                                          
                             788:            // premature end                                                                       
                             789:            if (lexer.peekToken() == null)                                                         
                             790:            {                                                                                      
                             791:                break;                                                                             
                             792:            }                                                                                      
                             793:            if (lexer.peekKind(Token.NAME) &&                                                      
                             794:                lexer.peekToken().getText().equals("end"))                                         
                             795:            {                                                                                      
                             796:                break;                                                                             
                             797:            }                                                                                      
                             798:            // key/value                                                                           
                             799:            String name = read(Token.LITERAL).getText();                                           
                             800:                                                                                                   
                             801:            // RD                                                                                  
                             802:            read(Token.INTEGER);                                                                   
                             803:            Token charstring = read(Token.CHARSTRING);                                             
                             804:            font.charstrings.put(name, decrypt(charstring.getData(),                               
                             CHARSTRING_KEY, lenIV));                                                                               
                             805:            readDef();                                                                             
                             ```                                                                                                    
                             </code>                                                                                                
                             </code_snippets>                                                                                       
                                                                                                                                    
                             ## Fix Strategy                                                                                        
                             <fix_strategy>                                                                                         
                                                                                                                                    
                             1. Summary of Root Cause                                                                               
                                - The crash is due to uncontrolled allocation in Type1Lexer.readCharString(int                      
                             length): it unconditionally does `new byte[length]` without verifying whether `length`                 
                             is reasonable or even within the bounds of the underlying ByteBuffer.                                  
                                - A malicious or malformed PDF can specify an arbitrarily large RD (charstring                      
                             data) length, causing an OutOfMemoryError (Requested array size exceeds VM limit).                   
                                                                                                                                    
                             2. Patch Location                                                                                      
                                - File: org/apache/fontbox/type1/Type1Lexer.java                                                    
                                - Method: private Token readCharString(int length) throws IOException                               
                                                                                                                                    
                             3. Patch Outline                                                                                       
                                A. Introduce explicit input validation for the `length` parameter before                            
                             allocation:                                                                                            
                                   a. Check for negative values.                                                                    
                                   b. Check that `length` does not exceed the remaining bytes in the buffer.                        
                                   c. Enforce a hard upper bound on charstring length to mitigate resource                          
                             exhaustion (e.g., 16 MB by default).                                                                   
                                B. Upon violation of any check, throw an IOException with a clear error message                     
                             (CharString length out of bounds:  + length).                                                        
                                C. No other parts of the codebase need to be modified; downstream logic                             
                             (decrypting, storing) remains intact for valid inputs.                                                 
                                D. Do not touch the fuzzing harness, tests, or external libs.                                       
                                                                                                                                    
                             4. Detailed Steps                                                                                      
                                1. In Type1Lexer.java, declare at class level:                                                      
                                     // Maximum allowed size for a Type 1 charstring (tunable if necessary)                         
                                     private static final int MAX_CHARSTRING_LENGTH = 16 * 1024 * 1024; // 16 MB                    
                                2. In readCharString(int length) (around line 502), before `buffer.get();` and `new                 
                             byte[length]`, insert:                                                                                 
                                     if (length < 0) {                                                                              
                                         throw new IOException("Invalid CharString length (negative): " + length);                  
                                     }                                                                                              
                                     int remaining = buffer.remaining() - 1; // account for the space byte                          
                                     if (length > remaining) {                                                                      
                                         throw new IOException("CharString length exceeds available data: " +                       
                             length);                                                                                               
                                     }                                                                                              
                                     if (length > MAX_CHARSTRING_LENGTH) {                                                          
                                         throw new IOException("CharString length exceeds max allowed: " + length);                 
                                     }                                                                                              
                                3. Proceed with the existing lines:                                                                 
                                     buffer.get(); // space                                                                         
                                     byte[] data = new byte[length];                                                                
                                     buffer.get(data);                                                                              
                                     return new Token(data, Token.CHARSTRING);                                                      
                                4. (Optional/Recommended) In Type1Parser.readCharStrings(int lenIV), add a similar                  
                             check on the integer returned by `read(Token.INTEGER)` when it denotes the RD length,                  
                             so oversized loops or negative counts are also rejected early:                                         
                                     int rdLength = read(Token.INTEGER).intValue();                                                 
                                     if (rdLength < 0 || rdLength > SOME_REASONABLE_LIMIT) {                                        
                                         throw new IOException("Invalid charstring RD length: " + rdLength);                        
                                     }                                                                                              
                                   Then use rdLength for the subsequent `read(Token.CHARSTRING)` call.                              
                                                                                                                                    
                             5. Justification                                                                                       
                                - Validates the untrusted length field before any memory allocation, preventing                     
                             OOME from maliciously large values.                                                                    
                                - The buffer.remaining() check guarantees we never read past input bounds,                          
                             preserving existing BufferUnderflowException logic for truncated inputs.                               
                                - The hard cap (e.g., 16 MB) defends against resource exhaustion but is unlikely to                 
                             block legitimate Type 1 charstrings, which are typically small.                                        
                                - Downstream parsing and decryption logic remain unchanged for valid inputs, so                     
                             existing functionality and tests are preserved.                                                        
                                - No harness, fuzzing logic, or external dependencies are modified, maintaining                     
                             reproducibility and test integrity.                                                                    
                                                                                                                                    
                             6. Potential Side Effects and Mitigations                                                              
                                - Extremely large but legitimate charstrings (if any) will now fail with                            
                             IOException. If users encounter false positives, the MAX_CHARSTRING_LENGTH constant                    
                             can be tuned or made configurable via a system property.                                               
                                - The new IOException messages are explicit and will propagate up the parsing                       
                             stack, causing PDF parsing to fail fast instead of crashing the JVM.                                   
                                - Upstream consumers (PDFTextStripper) already handle IOExceptions, so this change                  
                             cleanly integrates with existing errorhandling flows.                                                 
                                                                                                                                    
                             7. Testing                                                                                             
                                - Add unit tests for Type1Lexer.readCharString:                                                     
                                   length == 1  expect IOException                                                               
                                   length > buffer.remaining()  expect IOException                                                
                                   length == MAX_CHARSTRING_LENGTH+1  expect IOException                                          
                                   length within limits  expect successful read                                                   
                                - Fuzz harness need not change; malformed inputs triggering too-large lengths will                  
                             now produce a low-severity security issue without crashing the JVM.                                    
                                                                                                                                    
                             8. No Additional Files Required                                                                        
                                - All modifications are confined to org/apache/fontbox/type1/Type1Lexer.java (and                   
                             optionally Type1Parser.java).                                                                          
                                - No retrieval of external files is necessary.                                                      
                                                                                                                                    
                             </fix_strategy>                                                                                        
                             ===Evaluation End===                                                                                   
[11/04/25 08:06:47] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                     __init__.py:160
                             (n evals: 2, patch status: PatchStatus.UNCOMPILABLE)                                                   
[11/04/25 08:08:07] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                        __init__.py:160
                             (n evals: 2, patch status: PatchStatus.UNCOMPILABLE)                                                   
[11/04/25 08:10:06] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                       __init__.py:160
                             (n evals: 2, patch status: PatchStatus.UNCOMPILABLE)                                                   
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:10:07] INFO     [logging_performance](pdfbox Setting owner) Took 0.88 seconds; exception=False   context_managers.py:23
                    INFO     [logging_performance](pdfbox Patching) Started...                                 context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmpa0_hzhnd                                                    default.py:171
[11/04/25 08:10:40] ERROR    Failed to build the challenge                                                            __init__.py:53
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_5/agent-output-1762243280.269287 functions.py:17
                             6/build_failed_stdout.txt: /src /src/project-parent/pdfbox                                             
                             /src/project-parent/pdfbox                                                                             
                             ---------------------------------------------------------------                                        
                             vm.mmap_rnd_bits = 28                                                                                  
                             ---------------------------------------------------------------                                        
                             CC=clang                                                                                               
                             CXX=clang++                                                                                            
                             CFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only                                              
                             -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                  
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations                                         
                             -Wno-error=implicit-function-declaration   -Wno-error=implicit-int                                     
                             -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION                              
                             -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link                        
                             -fno-sanitize=leak                                                                                     
                             CXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only                                            
                             -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types                  
                             -Wno-error=int-conversion   -Wno-error=deprecated-declarations                                         
                             -Wno-error=implicit-function-declaration   -Wno-error=implicit-int                                     
                             -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION                              
                             -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link                        
                             -stdlib=libc++ -fno-sanitize=leak                                                                      
                             RUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers                       
                             ---------------------------------------------------------------                                        
                             + __REAL_MAVEN_REPO=/root/.m2/repository                                                               
                             + __SHARED_MAVEN_REPO=/work/mavencache                                                                 
                             + '[' '!' -L /root/.m2/repository ']'                                                                  
                             + unset __REAL_MAVEN_REPO                                                                              
                             + unset __SHARED_MAVEN_REPO                                                                            
                             + PROJECT=pdfbox                                                                                       
                             + PROJECT_GROUP_ID=org.apache.pdfbox                                                                   
                             + PROJECT_ARTIFACT_ID=pdfbox                                                                           
                             + XMPBOX_ARTIFACT_ID=xmpbox                                                                            
                             + MAIN_REPOSITORY=https://github.com/apache/pdfbox/                                                    
                             + MAVEN_ARGS='-Djavac.src.version=11 -Djavac.target.version=11 -DskipTests'                            
                             + cd /src/project-parent                                                                               
                             + [[ -v LOCAL_DEV ]]                                                                                   
                             + mv /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict /out                                 
                             + set_project_version_in_fuzz_targets_dependency                                                       
                             ++ cd pdfbox                                                                                           
                             ++ /src/maven/apache-maven-3.9.9/bin/mvn                                                               
                             org.apache.maven.plugins:maven-help-plugin:3.2.0:evaluate -Dexpression=project.version                 
                             -q -DforceStdout                                                                                       
                             + PROJECT_VERSION=4.0.0-SNAPSHOT                                                                       
                             + cd fuzz-targets                                                                                      
                             + /src/maven/apache-maven-3.9.9/bin/mvn versions:use-dep-version                                       
                             -Dexcludes=com.code-intelligence:jazzer -DdepVersion=4.0.0-SNAPSHOT -DforceVersion=true                
                             [INFO] Scanning for projects...                                                                        
                             [INFO]                                                                                                 
                             [INFO] ----------------------< com.fuzzer:fuzz-targets >-----------------------                        
                             [INFO] Building fuzz 0.0.1-SNAPSHOT                                                                    
                             [INFO]   from pom.xml                                                                                  
                             [INFO] --------------------------------[ jar ]---------------------------------                        
                             [INFO]                                                                                                 
                             [INFO] --- versions:2.19.1:use-dep-version (default-cli) @ fuzz-targets ---                            
                             [INFO] Updated org.apache.pdfbox:pdfbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                   
                             [INFO] Updated org.apache.pdfbox:xmpbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] BUILD SUCCESS                                                                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Total time:  0.710 s                                                                            
                             [INFO] Finished at: 2025-11-04T08:10:13Z                                                               
                             [INFO] ------------------------------------------------------------------------                        
                             + cd pdfbox                                                                                            
                             + /src/maven/apache-maven-3.9.9/bin/mvn install -Djavac.src.version=11                                 
                             -Djavac.target.version=11 -DskipTests -Dmaven.repo.local=/out/m2                                       
                             [INFO] Scanning for projects...                                                                        
                                                                                                                                    
                                                                                                                                    
                                                                                                                                    
                                                                                                                                    
                                                                                                                                    
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Reactor Build Order:                                                                            
                             [INFO]                                                                                                 
                             [INFO] Apache PDFBox parent                                               [pom]                        
                             [INFO] Apache PDFBox io                                                [bundle]                        
                             [INFO] Apache FontBox                                                  [bundle]                        
                             [INFO] Apache XmpBox                                                   [bundle]                        
                             [INFO] Apache PDFBox                                                   [bundle]                        
                             [INFO] Apache PDFBox Debugger                                             [jar]                        
                             [INFO] Apache PDFBox tools                                                [jar]                        
                             [INFO] Apache PDFBox application                                          [jar]                        
                             [INFO] Apache PDFBox Debugger application                                 [jar]                        
                             [INFO] Apache PDFBox examples                                             [jar]                        
                             [INFO] pdfbox-reactor                                                     [pom]                        
                             [INFO]                                                                                                 
                             [INFO] ------------------< org.apache.pdfbox:pdfbox-parent >-------------------                        
                             [INFO] Building Apache PDFBox parent 4.0.0-SNAPSHOT                      [1/11]                        
                             [INFO]   from parent/pom.xml                                                                           
                             [INFO] --------------------------------[ pom ]---------------------------------                        
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-parent ---                                        
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                      
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-parent ---                          
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-parent ---                           
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                       
                             [INFO]                                                                                                 
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-parent ---                                          
                                                                                                                                    
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-parent ---                                   
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-parent                   
                             ---                                                                                                    
                             [INFO] Preparing remote bundle                                                                         
                             org.apache.apache.resources:apache-jar-resource-bundle:1.7                                             
                             [INFO] Copying 3 resources from 1 bundle.                                                              
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-parent ---                                           
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-parent ---                               
                             [INFO]                                                                                                 
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-parent ---                                 
                             [INFO] Installing /src/project-parent/pdfbox/parent/pom.xml to                                         
                             /out/m2/org/apache/pdfbox/pdfbox-parent/4.0.0-SNAPSHOT/pdfbox-parent-4.0.0-SNAPSHOT.pom                
                             [INFO]                                                                                                 
                             [INFO] --------------------< org.apache.pdfbox:pdfbox-io >---------------------                        
                             [INFO] Building Apache PDFBox io 4.0.0-SNAPSHOT                          [2/11]                        
                             [INFO]   from io/pom.xml                                                                               
                             [INFO] -------------------------------[ bundle ]-------------------------------                        
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-io ---                                            
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed                      
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-io ---                              
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-io ---                               
                             [INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed                       
                             [INFO]                                                                                                 
                             [INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-io ---                                              
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-io ---                                       
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-io ---                   
                             [INFO] Preparing remote bundle                                                                         
                             org.apache.apache.resources:apache-jar-resource-bundle:1.7                                             
                             [INFO] Copying 3 resources from 1 bundle.                                                              
                             [INFO]                                                                                                 
                             [INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox-io ---                               
                             [INFO] skip non existing resourceDirectory                                                             
                             /src/project-parent/pdfbox/io/src/main/resources                                                       
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                
                             [INFO]                                                                                                 
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox-io ---                                   
                                                                                                                                    
                                                                                                                                    
                             [INFO] Recompiling the module because of changed source code.                                          
                             [INFO] Compiling 18 source files with javac [debug deprecation release 11] to                          
                             target/classes                                                                                         
                             [INFO]                                                                                                 
                             [INFO] --- resources:3.3.1:testResources (default-testResources) @ pdfbox-io ---                       
                             [INFO] Copying 2 resources from src/test/resources to target/test-classes                              
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to                               
                             target/test-classes                                                                                    
                             [INFO]                                                                                                 
                             [INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ pdfbox-io ---                           
                             [INFO] Recompiling the module because of changed dependency.                                           
                             [INFO] Compiling 10 source files with javac [debug deprecation release 11] to                          
                             target/test-classes                                                                                    
                             [WARNING]                                                                                              
                             /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[45,2                
                             9] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been                 
                             deprecated and marked for removal                                                                      
                             [WARNING]                                                                                              
                             /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[50,2                
                             4] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been                 
                             deprecated and marked for removal                                                                      
                             [WARNING]                                                                                              
                             /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[57,2                
                             4] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been                 
                             deprecated and marked for removal                                                                      
                             [INFO]                                                                                                 
                             [INFO] --- surefire:3.5.2:test (default-test) @ pdfbox-io ---                                          
                             [INFO] Tests are skipped.                                                                              
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:report (report) @ pdfbox-io ---                                               
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- bundle:5.1.9:bundle (default-bundle) @ pdfbox-io ---                                        
                             [INFO] Building bundle:                                                                                
                             /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar                                      
                             [INFO] Writing manifest:                                                                               
                             /src/project-parent/pdfbox/io/target/classes/META-INF/MANIFEST.MF                                      
                             [INFO]                                                                                                 
                             [INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-io ---                                   
                             [INFO] Building jar:                                                                                   
                             /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                              
                             [INFO]                                                                                                 
                             [INFO] --- install:3.1.4:install (default-install) @ pdfbox-io ---                                     
                             [INFO] Installing /src/project-parent/pdfbox/io/pom.xml to                                             
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.pom                        
                             [INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar to                 
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                        
                             [INFO] Installing                                                                                      
                             /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar to                           
                             /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT-sources.jar                
                             [INFO]                                                                                                 
                             [INFO] --- bundle:5.1.9:install (default-install) @ pdfbox-io ---                                      
                             [INFO] Writing OBR metadata                                                                            
                             [INFO] Installing                                                                                      
                             org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar                                
                             [INFO] Writing OBR metadata                                                                            
                             [INFO]                                                                                                 
                             [INFO] ---------------------< org.apache.pdfbox:fontbox >----------------------                        
                             [INFO] Building Apache FontBox 4.0.0-SNAPSHOT                            [3/11]                        
                             [INFO]   from fontbox/pom.xml                                                                          
                             [INFO] -------------------------------[ bundle ]-------------------------------                        
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (default) @ fontbox ---                                              
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ fontbox ---                                
                             [INFO]                                                                                                 
                             [INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ fontbox ---                                 
                             [INFO]                                                                                                 
                             [INFO] --- checkstyle:3.6.0:check (check) @ fontbox ---                                                
                             [INFO]                                                                                                 
                             [INFO] --- jacoco:0.8.13:prepare-agent (default) @ fontbox ---                                         
                             [INFO] Skipping JaCoCo execution because property jacoco.skip is set.                                  
                             [INFO]                                                                                                 
                             [INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ fontbox ---                     
                             [INFO] Preparing remote bundle                                                                         
                             org.apache.apache.resources:apache-jar-resource-bundle:1.7                                             
                             [INFO] Copying 3 resources from 1 bundle.                                                              
                             [INFO] Copying appended resource: META-INF/LICENSE                                                     
                             [INFO] Copying appended resource: META-INF/NOTICE                                                      
                             [INFO]                                                                                                 
                             [INFO] --- resources:3.3.1:resources (default-resources) @ fontbox ---                                 
                             [INFO] Copying 93 resources from src/main/resources to target/classes                                  
                             [INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes                
                             [INFO]                                                                                                 
                             [INFO] --- compiler:3.14.0:compile (default-compile) @ fontbox ---                                     
                             [INFO] Recompiling the module because of changed dependency.                                           
                             [INFO] Compiling 141 source files with javac [debug deprecation release 11] to                         
                             target/classes                                                                                         
                             [INFO]                                                                                                 
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java:                  
                             Some input files use unchecked or unsafe operations.                                                   
                             [INFO]                                                                                                 
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java:                  
                             Recompile with -Xlint:unchecked for details.                                                           
                             [INFO] -------------------------------------------------------------                                   
                             [ERROR] COMPILATION ERROR :                                                                            
                             [INFO] -------------------------------------------------------------                                   
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[515,22] cannot find symbol                                                                         
                               symbol:   variable MAX_CHARSTRING_LENGTH                                                             
                               location: class org.apache.fontbox.type1.Type1Lexer                                                  
                             [INFO] 1 error                                                                                         
                             [INFO] -------------------------------------------------------------                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                              
                             [INFO]                                                                                                 
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.936 s]                        
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.724 s]                        
                             [INFO] Apache FontBox ..................................... FAILURE [  2.032 s]                        
                             [INFO] Apache XmpBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                    
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                    
                             [INFO] Apache PDFBox application .......................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                    
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                    
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                    
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] BUILD FAILURE                                                                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Total time:  25.377 s                                                                           
                             [INFO] Finished at: 2025-11-04T08:10:39Z                                                               
                             [INFO] ------------------------------------------------------------------------                        
                             [ERROR] Failed to execute goal                                                                         
                             org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on                     
                             project fontbox: Compilation failure                                                                   
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.ja                
                             va:[515,22] cannot find symbol                                                                         
                             [ERROR]   symbol:   variable MAX_CHARSTRING_LENGTH                                                     
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Lexer                                          
                             [ERROR]                                                                                                
                             [ERROR] -> [Help 1]                                                                                    
                             [ERROR]                                                                                                
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                    
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                 
                             [ERROR]                                                                                                
                             [ERROR] For more information about the errors and possible solutions, please read the                  
                             following articles:                                                                                    
                             [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException                 
                             [ERROR]                                                                                                
                             [ERROR] After correcting the problems, you can resume the build with the command                       
                             [ERROR]   mvn <args> -rf :fontbox                                                                      
                             subprocess command returned a non-zero exit status: 1                                                  
                                                                                                                                    
                    INFO     reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_5/agent-output-1762243280.269287 functions.py:17
                             6/build_failed_stderr.txt: INFO:__main__:Running: docker build -t                                      
                             aixcc-afc/pdfbox:latest --file                                                                         
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox/Dockerfile                               
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/projects/pdfbox.                                         
                             #0 building with "default" instance using docker driver                                                
                                                                                                                                    
                             #1 [internal] load build definition from Dockerfile                                                    
                             #1 transferring dockerfile: 2.07kB done                                                                
                             #1 DONE 0.0s                                                                                           
                                                                                                                                    
                             #2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                           
                             #2 DONE 0.0s                                                                                           
                                                                                                                                    
                             #3 [internal] load .dockerignore                                                                       
                             #3 transferring context: 2B done                                                                       
                             #3 DONE 0.0s                                                                                           
                                                                                                                                    
                             #4 [ 1/13] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0                                           
                             #4 DONE 0.0s                                                                                           
                                                                                                                                    
                             #5 [internal] load build context                                                                       
                             #5 transferring context: 1.23kB done                                                                   
                             #5 DONE 0.0s                                                                                           
                                                                                                                                    
                             #6 [ 4/13] COPY pkgs/maven.zip /src/maven.zip                                                          
                             #6 CACHED                                                                                              
                                                                                                                                    
                             #7 [ 6/13] COPY pkgs/pdf.dict.gz /src/pdf.dict.gz                                                      
                             #7 CACHED                                                                                              
                                                                                                                                    
                             #8 [ 8/13] COPY project-parent /src/project-parent/                                                    
                             #8 CACHED                                                                                              
                                                                                                                                    
                             #9 [ 5/13] RUN unzip /src/maven.zip -d /src/maven && rm /src/maven.zip                                 
                             #9 CACHED                                                                                              
                                                                                                                                    
                             #10 [ 7/13] RUN gunzip /src/pdf.dict.gz &&     mv /src/pdf.dict                                        
                             /src/PDFStreamParserFuzzer.dict &&     cp /src/PDFStreamParserFuzzer.dict                              
                             /src/PDFWriteReadFuzzer.dict                                                                           
                             #10 CACHED                                                                                             
                                                                                                                                    
                             #11 [12/13] COPY build.sh /src/                                                                        
                             #11 CACHED                                                                                             
                                                                                                                                    
                             #12 [ 3/13] RUN mkdir /usr/my-bin && mv /usr/bin/tesseract /usr/my-bin/tesseract                       
                             #12 CACHED                                                                                             
                                                                                                                                    
                             #13 [11/13] RUN tar -zxf /src/pdfbox.tar.gz -C /src/project-parent && rm                               
                             /src/pdfbox.tar.gz                                                                                     
                             #13 CACHED                                                                                             
                                                                                                                                    
                             #14 [ 9/13] RUN rm -rf /src/project-parent/pdfbox                                                      
                             #14 CACHED                                                                                             
                                                                                                                                    
                             #15 [ 2/13] RUN set -eux     && apt-get update     && apt-get install --yes                            
                             --no-install-recommends         tesseract-ocr=4.1.1-2build2                                            
                             tesseract-ocr-eng=1:4.00~git30-7274cfa-1     && apt-get clean     && rm -rf                            
                             /var/lib/apt/lists/*                                                                                   
                             #15 CACHED                                                                                             
                                                                                                                                    
                             #16 [10/13] COPY pkgs/pdfbox.tar.gz /src/pdfbox.tar.gz                                                 
                             #16 CACHED                                                                                             
                                                                                                                                    
                             #17 [13/13] WORKDIR /src/project-parent/pdfbox                                                         
                             #17 CACHED                                                                                             
                                                                                                                                    
                             #18 exporting to image                                                                                 
                             #18 exporting layers done                                                                              
                             #18 writing image                                                                                      
                             sha256:4d4597221200681f22ef920bad2dfdfa3ce5a921371aee8a4b6860c6c77d8cc8                                
                             #18 writing image                                                                                      
                             sha256:4d4597221200681f22ef920bad2dfdfa3ce5a921371aee8a4b6860c6c77d8cc8 done                           
                             #18 naming to docker.io/aixcc-afc/pdfbox:latest done                                                   
                             #18 DONE 0.0s                                                                                          
                             INFO:__main__:Keeping existing build artifacts as-is (if any).                                         
                             INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64                    
                             --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64 -e                     
                             PROJECT_NAME=pdfbox -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e                
                             MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v                                                      
                             /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox:/local-source-mount:ro -v                         
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/:/out -v                                
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/work/pdfbox:/work -t                               
                             aixcc-afc/pdfbox:latest /bin/bash -c 'pushd $SRC && rm -rf /src/project-parent/pdfbox                  
                             && cp -r /local-source-mount /src/project-parent/pdfbox && popd && compile'.                           
                             ERROR:__main__:Building fuzzers failed.                                                                
                                                                                                                                    
                    INFO     [logging_performance](pdfbox Patching) Took 32.75 seconds; exception=False       context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:10:41] INFO     [logging_performance](pdfbox Setting owner) Took 0.87 seconds; exception=False   context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:10:42] INFO     [logging_performance](pdfbox Setting owner) Took 1.02 seconds; exception=False   context_managers.py:23
[11/04/25 08:10:43] INFO     ===Evaluator Result===                                                                 evaluator.py:204
                             PatchStatus.UNCOMPILABLE                                                                               
                             ===Evaluator Diff===                                                                                   
                             --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                                   
                             +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                                   
                             @@ -501,6 +501,21 @@                                                                                   
                                   */                                                                                               
                                  private Token readCharString(int length) throws IOException                                       
                                  {                                                                                                 
                             +        // Validate charstring length to prevent resource exhaustion                                  
                             +        if (length < 0)                                                                               
                             +        {                                                                                             
                             +            throw new IOException("CharString length is negative: " + length);                        
                             +        }                                                                                             
                             +        // Account for the leading space byte                                                         
                             +        int remaining = buffer.remaining() - 1;                                                       
                             +        if (length > remaining)                                                                       
                             +        {                                                                                             
                             +            throw new IOException("CharString length exceeds available data: " +                      
                             length);                                                                                               
                             +        }                                                                                             
                             +        if (length > MAX_CHARSTRING_LENGTH)                                                           
                             +        {                                                                                             
                             +            throw new IOException("CharString length exceeds maximum allowed: " +                     
                             length);                                                                                               
                             +        }                                                                                             
                                      try                                                                                           
                                      {                                                                                             
                                          buffer.get(); // space                                                                    
                                                                                                                                    
                             ===Patch Result===                                                                                     
                             [ERROR] COMPILATION ERROR :                                                                            
                             [INFO] -------------------------------------------------------------                                   
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[515,22] cannot find symbol                                                                        
                               symbol:   variable MAX_CHARSTRING_LENGTH                                                             
                               location: class org.apache.fontbox.type1.Type1Lexer                                                  
                             [INFO] 1 error                                                                                         
                             [INFO] -------------------------------------------------------------                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                              
                             [INFO]                                                                                                 
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.936 s]                        
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.724 s]                        
                             [INFO] Apache FontBox ..................................... FAILURE [  2.032 s]                        
                             [INFO] Apache XmpBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                    
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                    
                             [INFO] Apache PDFBox application .......................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                    
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                    
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                    
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] BUILD FAILURE                                                                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Total time:  25.377 s                                                                           
                             [INFO] Finished at: 2025-11-04T08:10:39Z                                                               
                             [INFO] ------------------------------------------------------------------------                        
                             [ERROR] Failed to execute goal                                                                         
                             org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on                     
                             project fontbox: Compilation failure                                                                   
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[515,22] cannot find symbol                                                                        
                             [ERROR]   symbol:   variable MAX_CHARSTRING_LENGTH                                                     
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Lexer                                          
                             [ERROR]                                                                                                
                             [ERROR] -> [Help 1]                                                                                    
                             [ERROR]                                                                                                
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                    
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                 
                             [ERROR]                                                                                                
                             [ERROR] For more information about the errors                                                          
                             ===Issue===                                                                                            
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of                     
                             memory (use '-Xmx1710m' to reproduce)                                                                  
                             Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit                           
                                     at org.apache.fontbox.type1.Type1Lexer.readCharString(Type1Lexer.java:507)                     
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:232)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.read(Type1Parser.java:877)                             
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:109)                       
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaFo                 
                             rm$DMH)                                                                                                
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                   
                             DEDUP_TOKEN: 0d88e419df5aef8d                                                                          
                             == libFuzzer crashing input ==                                                                         
                             ===Evaluation Report===                                                                                
                             # Evaluation Report                                                                                    
                                                                                                                                    
                             ## Summary                                                                                             
                             The projects Java fuzzer triggered an OutOfMemoryError while parsing a Type 1 font                    
                             charstring in Type1Lexer.readCharString. In response, a patch was introduced to add:                   
                             - Two new fields (`buffer` and `aheadToken`) and a maximum charstring length constant                  
                             at the top of the class.                                                                               
                             - Input validation in `readCharString(int length)` (negative-length, available-data,                   
                             and max-length checks).                                                                                
                                                                                                                                    
                             After applying that patch, the FontBox module fails to compile with dozens of class,                  
                             interface, or enum expected and { expected errors, indicating the patch has                       
                             broken the files structure (e.g., misplaced braces or declarations outside the class                  
                             body).                                                                                                 
                                                                                                                                    
                             ## Description                                                                                         
                                                                                                                                    
                             1. Initial Issue                                                                                       
                                - A Jazzer fuzzer run on `PDFExtractTextFuzzer` caused:                                             
                                  ```                                                                                               
                                  java.lang.OutOfMemoryError: Requested array size exceeds VM limit                                 
                                    at Type1Lexer.readCharString(Type1Lexer.java:507)                                               
                                     tracing through FontBox and PDFBox to the fuzzer entry                                        
                                  com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of memory                            
                                  ```                                                                                               
                                - The stack trace shows the error occurs when reading a Type 1 font charstring of                   
                             excessive length.                                                                                      
                                                                                                                                    
                             2. Patch Attempt                                                                                       
                                - At the top of `Type1Lexer.java`, the patch attempts to insert:                                    
                                  ```java                                                                                           
                                  private final ByteBuffer buffer;                                                                  
                                  private Token aheadToken;                                                                         
                                  private static final int MAX_CHARSTRING_LENGTH = 16 * 1024 * 1024;                                
                                  ```                                                                                               
                                - Inside `readCharString(int length)`, before reading the data, it adds:                            
                                  ```java                                                                                           
                                  if (length < 0) { throw new IOException(...); }                                                   
                                  int remaining = buffer.remaining() - 1;                                                           
                                  if (length > remaining) { throw new IOException(...); }                                           
                                  if (length > MAX_CHARSTRING_LENGTH) { throw new IOException(...); }                               
                                  ```                                                                                               
                                - The rest of the method remains intact (it still calls `buffer.get()` to skip the                  
                             space).                                                                                                
                                                                                                                                    
                             3. Build and Compilation Result                                                                        
                                - Maven compile of the FontBox module fails immediately with around 100 errors all                  
                             of the form:                                                                                           
                                  ```                                                                                               
                                  [ERROR] Type1Lexer.java:[45,17] '{' expected                                                      
                                  [ERROR] Type1Lexer.java:[46,19] class, interface, or enum expected                                
                                   (many similar errors)                                                                           
                                  ```                                                                                               
                                - These errors indicate that the new field declarations or the inserted code blocks                 
                             are not correctly placed within the class structure, causing the parser to see                         
                             orphaned tokens at the top of the file or in incorrect contexts.                                       
                                                                                                                                    
                             4. Areas for Further Investigation                                                                     
                                - **Class Declaration and Bracing**: Verify `class Type1Lexer {  }` braces; ensure                 
                             new fields are inside the class, not before or after its closing brace.                                
                                - **Import Statements and Package Declaration**: Confirm that imports for                           
                             `java.nio.ByteBuffer` and the `Token` type are present and that no code was inserted                   
                             above the `package` statement.                                                                         
                                - **Field Initialization**: Check if `buffer` and `aheadToken` are meant to be                      
                             final and whether they must be initialized in every constructor or lazy-initialized.                   
                                - **Context of readCharString**: Re-review indentation and surrounding code in the                  
                             method to ensure the added validation sits inside the method body.                                     
                                - **Related Methods**: Look at other methods that reference `buffer` or `Token                      
                             aheadToken` to confirm consistency once the class compiles again.                                      
                                                                                                                                    
                             ## Initial Issue Log                                                                                   
                             Here is the initial issue log of the codebase:                                                         
                             <issue>                                                                                                
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of                     
                             memory (use '-Xmx1710m' to reproduce)                                                                  
                             Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit                           
                                     at org.apache.fontbox.type1.Type1Lexer.readCharString(Type1Lexer.java:507)                     
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:232)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.read(Type1Parser.java:877)                             
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:109)                       
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaFo                 
                             rm$DMH)                                                                                                
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                   
                             DEDUP_TOKEN: 0d88e419df5aef8d                                                                          
                             == libFuzzer crashing input ==                                                                         
                             </issue>                                                                                               
                                                                                                                                    
                             ## Additional Issue Log                                                                                
                             Here is the additional issue log after the last patch attempt:                                         
                             <additional_issue>                                                                                     
                             [ERROR] COMPILATION ERROR :                                                                            
                             [INFO] -------------------------------------------------------------                                   
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[45,17] '{' expected                                                                               
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[46,19] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[47,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[49,26] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[50,6] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[52,26] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[52,76] <identifier> expected                                                                      
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[54,19] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[55,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[56,13] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[63,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[66,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[67,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[73,12] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[77,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[78,9] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[79,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[85,12] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[88,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[95,12] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[98,5] class, interface, or enum expected                                                          
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[108,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[112,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[122,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[125,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[130,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[134,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[138,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[143,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[147,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[151,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[155,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[159,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[163,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[168,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[170,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[174,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[177,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[182,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[183,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[188,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[191,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[196,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[197,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[202,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[206,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[207,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[213,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[214,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[217,21] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[222,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[227,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[235,29] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[239,29] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[244,25] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[250,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[251,5] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[260,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[261,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[262,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[263,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[266,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[269,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[270,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[276,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[277,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[278,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[284,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[285,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[290,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[291,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[292,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[297,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[298,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[303,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[304,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[310,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[311,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[316,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[317,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[323,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[324,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[330,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[333,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[336,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[337,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[343,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[344,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[349,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[350,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[356,17] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[357,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[361,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[364,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[367,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[371,13] class, interface, or enum expected                                                        
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[373,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[375,5] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[384,9] class, interface, or enum expected                                                         
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[387,13] class, interface, or enum expected                                                        
                             [INFO] 100 errors                                                                                      
                             [INFO] -------------------------------------------------------------                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                              
                             [INFO]                                                                                                 
                             [INFO] Apache PDFBox parent ............................... SUCCESS [ 10.820 s]                        
                             [INFO] Apache PDFBox io ................................... SUCCESS [  5.032 s]                        
                             [INFO] Apache FontBox ..................................... FAILURE [  0.978 s]                        
                             [INFO] Apache XmpBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                    
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                    
                             [INFO] Apache PDFBox application .......................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                    
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                    
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                    
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] BUILD FAILURE                                                                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Total time:  25.666 s                                                                           
                             [INFO] Finished at: 2025-11-04T08:06:29Z                                                               
                             [INFO] ------------------------------------------------------------------------                        
                             [ERROR] Failed to execute goal                                                                         
                             org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on                     
                             project fontbox: Compilation failure: Compilation failure:                                             
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[45,17] '{' expected                                                                               
                             [ERROR] /src/project-p                                                                                 
                             ... [TRUNCATED]                                                                                        
                             </additional_issue>                                                                                    
                                                                                                                                    
                             ## Notes                                                                                               
                             - All patch attempts are applied to the initial codebase. Reapply the the previous                     
                             patches if needed.                                                                                     
                             - If multiple different issues are present, all the issues must be resolved in a                       
                             single patch attempt.                                                                                  
                             - Try different approaches to resolve the issues.                                                      
                             ===Analysis Report===                                                                                  
                             # Analysis Report                                                                                      
                                                                                                                                    
                             ## Relevant Code Snippets                                                                              
                             <code_snippets>                                                                                        
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-100                                   
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                        
                             3: * or more contributor license agreements.  See the NOTICE file                                      
                             4: * distributed with this work for additional information                                             
                             5: * regarding copyright ownership.  The ASF licenses this file                                        
                             6: * to you under the Apache License, Version 2.0 (the                                                 
                             7: * "License"); you may not use this file except in compliance                                        
                             8: * with the License.  You may obtain a copy of the License at                                        
                             9: *                                                                                                   
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                       
                             11: *                                                                                                  
                             12: * Unless required by applicable law or agreed to in writing,                                       
                             13: * software distributed under the License is distributed on an                                      
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                           
                             15: * KIND, either express or implied.  See the License for the                                        
                             16: * specific language governing permissions and limitations                                          
                             17: * under the License.                                                                               
                             18: */                                                                                                 
                             19:                                                                                                    
                             20:package org.apache.fontbox.type1;                                                                   
                             21:                                                                                                    
                             22:import java.io.IOException;                                                                         
                             23:import java.nio.BufferUnderflowException;                                                           
                             24:import java.nio.ByteBuffer;                                                                         
                             25:import org.apache.logging.log4j.Logger;                                                             
                             26:import org.apache.logging.log4j.LogManager;                                                         
                             27:/**                                                                                                 
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                            
                             29: *                                                                                                  
                             30: * @see Type1Parser                                                                                 
                             31: *                                                                                                  
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                               
                             33: * somewhat awkward lexical structure. It is neither regular nor                                    
                             34: * context-free, and the execution of the program can modify the                                    
                             35: * the behaviour of the lexer/parser.                                                               
                             36: *                                                                                                  
                             37: * Nevertheless, this class represents an attempt to artificially separate                          
                             38: * the PostScript parsing process into separate lexing and parsing phases                           
                             39: * in order to reduce the complexity of the parsing phase.                                          
                             40: *                                                                                                  
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                
                             42: *                                                                                                  
                             43: * @author John Hewson                                                                              
                             44: */                                                                                                 
                             45:class Type1Lexer                                                                                    
                             46:{                                                                                                   
                             47:    /**                                                                                             
                             48:     * Log instance.                                                                                
                             49:     */                                                                                             
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                       
                             51:                                                                                                    
                             52:    private final ByteBuffer buffer;                                                                
                             53:    private Token aheadToken;                                                                       
                             54:    private int openParens = 0;                                                                     
                             55:                                                                                                    
                             56:    /**                                                                                             
                             57:     * Constructs a new Type1Lexer given a header-less .pfb segment.                                
                             58:     * @param bytes Header-less .pfb segment                                                        
                             59:     * @throws IOException                                                                          
                             60:     */                                                                                             
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                     
                             62:    {                                                                                               
                             63:        buffer = ByteBuffer.wrap(bytes);                                                            
                             64:        aheadToken = readToken(null);                                                               
                             65:    }                                                                                               
                             66:                                                                                                    
                             67:    /**                                                                                             
                             68:     * Returns the next token and consumes it.                                                      
                             69:     * @return The next token.                                                                      
                             70:     */                                                                                             
                             71:    public Token nextToken() throws IOException                                                     
                             72:    {                                                                                               
                             73:        Token curToken = aheadToken;                                                                
                             74:        //System.out.println(curToken); // for debugging                                            
                             75:        aheadToken = readToken(curToken);                                                           
                             76:        return curToken;                                                                            
                             77:    }                                                                                               
                             78:                                                                                                    
                             79:    /**                                                                                             
                             80:     * Returns the next token without consuming it.                                                 
                             81:     * @return The next token                                                                       
                             82:     */                                                                                             
                             83:    public Token peekToken()                                                                        
                             84:    {                                                                                               
                             85:        return aheadToken;                                                                          
                             86:    }                                                                                               
                             87:                                                                                                    
                             88:    /**                                                                                             
                             89:     * Checks if the kind of the next token equals the given one without consuming                  
                             it.                                                                                                    
                             90:     *                                                                                              
                             91:     * @return true if the kind of the next token equals the given one                              
                             92:     */                                                                                             
                             93:    public boolean peekKind(Token.Kind kind)                                                        
                             94:    {                                                                                               
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                  
                             96:    }                                                                                               
                             97:                                                                                                    
                             98:    /**                                                                                             
                             99:     * Reads an ASCII char from the buffer.                                                         
                             100:     */                                                                                            
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-20                                    
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                        
                             3: * or more contributor license agreements.  See the NOTICE file                                      
                             4: * distributed with this work for additional information                                             
                             5: * regarding copyright ownership.  The ASF licenses this file                                        
                             6: * to you under the Apache License, Version 2.0 (the                                                 
                             7: * "License"); you may not use this file except in compliance                                        
                             8: * with the License.  You may obtain a copy of the License at                                        
                             9: *                                                                                                   
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                       
                             11: *                                                                                                  
                             12: * Unless required by applicable law or agreed to in writing,                                       
                             13: * software distributed under the License is distributed on an                                      
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                           
                             15: * KIND, either express or implied.  See the License for the                                        
                             16: * specific language governing permissions and limitations                                          
                             17: * under the License.                                                                               
                             18: */                                                                                                 
                             19:                                                                                                    
                             20:package org.apache.fontbox.type1;                                                                   
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:21-40                                   
                             ```                                                                                                    
                             21:                                                                                                    
                             22:import java.io.IOException;                                                                         
                             23:import java.nio.BufferUnderflowException;                                                           
                             24:import java.nio.ByteBuffer;                                                                         
                             25:import org.apache.logging.log4j.Logger;                                                             
                             26:import org.apache.logging.log4j.LogManager;                                                         
                             27:/**                                                                                                 
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                            
                             29: *                                                                                                  
                             30: * @see Type1Parser                                                                                 
                             31: *                                                                                                  
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                               
                             33: * somewhat awkward lexical structure. It is neither regular nor                                    
                             34: * context-free, and the execution of the program can modify the                                    
                             35: * the behaviour of the lexer/parser.                                                               
                             36: *                                                                                                  
                             37: * Nevertheless, this class represents an attempt to artificially separate                          
                             38: * the PostScript parsing process into separate lexing and parsing phases                           
                             39: * in order to reduce the complexity of the parsing phase.                                          
                             40: *                                                                                                  
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-100                                   
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                        
                             3: * or more contributor license agreements.  See the NOTICE file                                      
                             4: * distributed with this work for additional information                                             
                             5: * regarding copyright ownership.  The ASF licenses this file                                        
                             6: * to you under the Apache License, Version 2.0 (the                                                 
                             7: * "License"); you may not use this file except in compliance                                        
                             8: * with the License.  You may obtain a copy of the License at                                        
                             9: *                                                                                                   
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                       
                             11: *                                                                                                  
                             12: * Unless required by applicable law or agreed to in writing,                                       
                             13: * software distributed under the License is distributed on an                                      
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                           
                             15: * KIND, either express or implied.  See the License for the                                        
                             16: * specific language governing permissions and limitations                                          
                             17: * under the License.                                                                               
                             18: */                                                                                                 
                             19:                                                                                                    
                             20:package org.apache.fontbox.type1;                                                                   
                             21:                                                                                                    
                             22:import java.io.IOException;                                                                         
                             23:import java.nio.BufferUnderflowException;                                                           
                             24:import java.nio.ByteBuffer;                                                                         
                             25:import org.apache.logging.log4j.Logger;                                                             
                             26:import org.apache.logging.log4j.LogManager;                                                         
                             27:/**                                                                                                 
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                            
                             29: *                                                                                                  
                             30: * @see Type1Parser                                                                                 
                             31: *                                                                                                  
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                               
                             33: * somewhat awkward lexical structure. It is neither regular nor                                    
                             34: * context-free, and the execution of the program can modify the                                    
                             35: * the behaviour of the lexer/parser.                                                               
                             36: *                                                                                                  
                             37: * Nevertheless, this class represents an attempt to artificially separate                          
                             38: * the PostScript parsing process into separate lexing and parsing phases                           
                             39: * in order to reduce the complexity of the parsing phase.                                          
                             40: *                                                                                                  
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                
                             42: *                                                                                                  
                             43: * @author John Hewson                                                                              
                             44: */                                                                                                 
                             45:class Type1Lexer                                                                                    
                             46:{                                                                                                   
                             47:    /**                                                                                             
                             48:     * Log instance.                                                                                
                             49:     */                                                                                             
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                       
                             51:                                                                                                    
                             52:    private final ByteBuffer buffer;                                                                
                             53:    private Token aheadToken;                                                                       
                             54:    private int openParens = 0;                                                                     
                             55:                                                                                                    
                             56:    /**                                                                                             
                             57:     * Constructs a new Type1Lexer given a header-less .pfb segment.                                
                             58:     * @param bytes Header-less .pfb segment                                                        
                             59:     * @throws IOException                                                                          
                             60:     */                                                                                             
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                     
                             62:    {                                                                                               
                             63:        buffer = ByteBuffer.wrap(bytes);                                                            
                             64:        aheadToken = readToken(null);                                                               
                             65:    }                                                                                               
                             66:                                                                                                    
                             67:    /**                                                                                             
                             68:     * Returns the next token and consumes it.                                                      
                             69:     * @return The next token.                                                                      
                             70:     */                                                                                             
                             71:    public Token nextToken() throws IOException                                                     
                             72:    {                                                                                               
                             73:        Token curToken = aheadToken;                                                                
                             74:        //System.out.println(curToken); // for debugging                                            
                             75:        aheadToken = readToken(curToken);                                                           
                             76:        return curToken;                                                                            
                             77:    }                                                                                               
                             78:                                                                                                    
                             79:    /**                                                                                             
                             80:     * Returns the next token without consuming it.                                                 
                             81:     * @return The next token                                                                       
                             82:     */                                                                                             
                             83:    public Token peekToken()                                                                        
                             84:    {                                                                                               
                             85:        return aheadToken;                                                                          
                             86:    }                                                                                               
                             87:                                                                                                    
                             88:    /**                                                                                             
                             89:     * Checks if the kind of the next token equals the given one without consuming                  
                             it.                                                                                                    
                             90:     *                                                                                              
                             91:     * @return true if the kind of the next token equals the given one                              
                             92:     */                                                                                             
                             93:    public boolean peekKind(Token.Kind kind)                                                        
                             94:    {                                                                                               
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                  
                             96:    }                                                                                               
                             97:                                                                                                    
                             98:    /**                                                                                             
                             99:     * Reads an ASCII char from the buffer.                                                         
                             100:     */                                                                                            
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-100                                   
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                        
                             3: * or more contributor license agreements.  See the NOTICE file                                      
                             4: * distributed with this work for additional information                                             
                             5: * regarding copyright ownership.  The ASF licenses this file                                        
                             6: * to you under the Apache License, Version 2.0 (the                                                 
                             7: * "License"); you may not use this file except in compliance                                        
                             8: * with the License.  You may obtain a copy of the License at                                        
                             9: *                                                                                                   
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                       
                             11: *                                                                                                  
                             12: * Unless required by applicable law or agreed to in writing,                                       
                             13: * software distributed under the License is distributed on an                                      
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                           
                             15: * KIND, either express or implied.  See the License for the                                        
                             16: * specific language governing permissions and limitations                                          
                             17: * under the License.                                                                               
                             18: */                                                                                                 
                             19:                                                                                                    
                             20:package org.apache.fontbox.type1;                                                                   
                             21:                                                                                                    
                             22:import java.io.IOException;                                                                         
                             23:import java.nio.BufferUnderflowException;                                                           
                             24:import java.nio.ByteBuffer;                                                                         
                             25:import org.apache.logging.log4j.Logger;                                                             
                             26:import org.apache.logging.log4j.LogManager;                                                         
                             27:/**                                                                                                 
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                            
                             29: *                                                                                                  
                             30: * @see Type1Parser                                                                                 
                             31: *                                                                                                  
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                               
                             33: * somewhat awkward lexical structure. It is neither regular nor                                    
                             34: * context-free, and the execution of the program can modify the                                    
                             35: * the behaviour of the lexer/parser.                                                               
                             36: *                                                                                                  
                             37: * Nevertheless, this class represents an attempt to artificially separate                          
                             38: * the PostScript parsing process into separate lexing and parsing phases                           
                             39: * in order to reduce the complexity of the parsing phase.                                          
                             40: *                                                                                                  
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                
                             42: *                                                                                                  
                             43: * @author John Hewson                                                                              
                             44: */                                                                                                 
                             45:class Type1Lexer                                                                                    
                             46:{                                                                                                   
                             47:    /**                                                                                             
                             48:     * Log instance.                                                                                
                             49:     */                                                                                             
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                       
                             51:                                                                                                    
                             52:    private final ByteBuffer buffer;                                                                
                             53:    private Token aheadToken;                                                                       
                             54:    private int openParens = 0;                                                                     
                             55:                                                                                                    
                             56:    /**                                                                                             
                             57:     * Constructs a new Type1Lexer given a header-less .pfb segment.                                
                             58:     * @param bytes Header-less .pfb segment                                                        
                             59:     * @throws IOException                                                                          
                             60:     */                                                                                             
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                     
                             62:    {                                                                                               
                             63:        buffer = ByteBuffer.wrap(bytes);                                                            
                             64:        aheadToken = readToken(null);                                                               
                             65:    }                                                                                               
                             66:                                                                                                    
                             67:    /**                                                                                             
                             68:     * Returns the next token and consumes it.                                                      
                             69:     * @return The next token.                                                                      
                             70:     */                                                                                             
                             71:    public Token nextToken() throws IOException                                                     
                             72:    {                                                                                               
                             73:        Token curToken = aheadToken;                                                                
                             74:        //System.out.println(curToken); // for debugging                                            
                             75:        aheadToken = readToken(curToken);                                                           
                             76:        return curToken;                                                                            
                             77:    }                                                                                               
                             78:                                                                                                    
                             79:    /**                                                                                             
                             80:     * Returns the next token without consuming it.                                                 
                             81:     * @return The next token                                                                       
                             82:     */                                                                                             
                             83:    public Token peekToken()                                                                        
                             84:    {                                                                                               
                             85:        return aheadToken;                                                                          
                             86:    }                                                                                               
                             87:                                                                                                    
                             88:    /**                                                                                             
                             89:     * Checks if the kind of the next token equals the given one without consuming                  
                             it.                                                                                                    
                             90:     *                                                                                              
                             91:     * @return true if the kind of the next token equals the given one                              
                             92:     */                                                                                             
                             93:    public boolean peekKind(Token.Kind kind)                                                        
                             94:    {                                                                                               
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                  
                             96:    }                                                                                               
                             97:                                                                                                    
                             98:    /**                                                                                             
                             99:     * Reads an ASCII char from the buffer.                                                         
                             100:     */                                                                                            
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-100                                   
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                        
                             3: * or more contributor license agreements.  See the NOTICE file                                      
                             4: * distributed with this work for additional information                                             
                             5: * regarding copyright ownership.  The ASF licenses this file                                        
                             6: * to you under the Apache License, Version 2.0 (the                                                 
                             7: * "License"); you may not use this file except in compliance                                        
                             8: * with the License.  You may obtain a copy of the License at                                        
                             9: *                                                                                                   
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                       
                             11: *                                                                                                  
                             12: * Unless required by applicable law or agreed to in writing,                                       
                             13: * software distributed under the License is distributed on an                                      
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                           
                             15: * KIND, either express or implied.  See the License for the                                        
                             16: * specific language governing permissions and limitations                                          
                             17: * under the License.                                                                               
                             18: */                                                                                                 
                             19:                                                                                                    
                             20:package org.apache.fontbox.type1;                                                                   
                             21:                                                                                                    
                             22:import java.io.IOException;                                                                         
                             23:import java.nio.BufferUnderflowException;                                                           
                             24:import java.nio.ByteBuffer;                                                                         
                             25:import org.apache.logging.log4j.Logger;                                                             
                             26:import org.apache.logging.log4j.LogManager;                                                         
                             27:/**                                                                                                 
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                            
                             29: *                                                                                                  
                             30: * @see Type1Parser                                                                                 
                             31: *                                                                                                  
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                               
                             33: * somewhat awkward lexical structure. It is neither regular nor                                    
                             34: * context-free, and the execution of the program can modify the                                    
                             35: * the behaviour of the lexer/parser.                                                               
                             36: *                                                                                                  
                             37: * Nevertheless, this class represents an attempt to artificially separate                          
                             38: * the PostScript parsing process into separate lexing and parsing phases                           
                             39: * in order to reduce the complexity of the parsing phase.                                          
                             40: *                                                                                                  
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                
                             42: *                                                                                                  
                             43: * @author John Hewson                                                                              
                             44: */                                                                                                 
                             45:class Type1Lexer                                                                                    
                             46:{                                                                                                   
                             47:    /**                                                                                             
                             48:     * Log instance.                                                                                
                             49:     */                                                                                             
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                       
                             51:                                                                                                    
                             52:    private final ByteBuffer buffer;                                                                
                             53:    private Token aheadToken;                                                                       
                             54:    private int openParens = 0;                                                                     
                             55:                                                                                                    
                             56:    /**                                                                                             
                             57:     * Constructs a new Type1Lexer given a header-less .pfb segment.                                
                             58:     * @param bytes Header-less .pfb segment                                                        
                             59:     * @throws IOException                                                                          
                             60:     */                                                                                             
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                     
                             62:    {                                                                                               
                             63:        buffer = ByteBuffer.wrap(bytes);                                                            
                             64:        aheadToken = readToken(null);                                                               
                             65:    }                                                                                               
                             66:                                                                                                    
                             67:    /**                                                                                             
                             68:     * Returns the next token and consumes it.                                                      
                             69:     * @return The next token.                                                                      
                             70:     */                                                                                             
                             71:    public Token nextToken() throws IOException                                                     
                             72:    {                                                                                               
                             73:        Token curToken = aheadToken;                                                                
                             74:        //System.out.println(curToken); // for debugging                                            
                             75:        aheadToken = readToken(curToken);                                                           
                             76:        return curToken;                                                                            
                             77:    }                                                                                               
                             78:                                                                                                    
                             79:    /**                                                                                             
                             80:     * Returns the next token without consuming it.                                                 
                             81:     * @return The next token                                                                       
                             82:     */                                                                                             
                             83:    public Token peekToken()                                                                        
                             84:    {                                                                                               
                             85:        return aheadToken;                                                                          
                             86:    }                                                                                               
                             87:                                                                                                    
                             88:    /**                                                                                             
                             89:     * Checks if the kind of the next token equals the given one without consuming                  
                             it.                                                                                                    
                             90:     *                                                                                              
                             91:     * @return true if the kind of the next token equals the given one                              
                             92:     */                                                                                             
                             93:    public boolean peekKind(Token.Kind kind)                                                        
                             94:    {                                                                                               
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                  
                             96:    }                                                                                               
                             97:                                                                                                    
                             98:    /**                                                                                             
                             99:     * Reads an ASCII char from the buffer.                                                         
                             100:     */                                                                                            
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:450-516                                 
                             ```                                                                                                    
                             450:                        // end of string                                                           
                             451:                        return new Token(sb.toString(), Token.STRING);                             
                             452:                    }                                                                              
                             453:                    sb.append(')');                                                                
                             454:                    openParens--;                                                                  
                             455:                    break;                                                                         
                             456:                case '\\':                                                                         
                             457:                    // escapes: \n \r \t \b \f \\ \( \)                                            
                             458:                    char c1 = getChar();                                                           
                             459:                    switch (c1)                                                                    
                             460:                    {                                                                              
                             461:                        case 'n':                                                                  
                             462:                        case 'r': sb.append("\n"); break;                                          
                             463:                        case 't': sb.append('\t'); break;                                          
                             464:                        case 'b': sb.append('\b'); break;                                          
                             465:                        case 'f': sb.append('\f'); break;                                          
                             466:                        case '\\': sb.append('\\'); break;                                         
                             467:                        case '(': sb.append('('); break;                                           
                             468:                        case ')': sb.append(')'); break;                                           
                             469:                        default:                                                                   
                             470:                            break;                                                                 
                             471:                    }                                                                              
                             472:                    // octal \ddd                                                                  
                             473:                    if (Character.isDigit(c1))                                                     
                             474:                    {                                                                              
                             475:                        String num = String.valueOf(new char[] { c1, getChar(),                    
                             getChar() });                                                                                          
                             476:                        try                                                                        
                             477:                        {                                                                          
                             478:                            int code = Integer.parseInt(num, 8);                                   
                             479:                            sb.append((char) code);                                                
                             480:                        }                                                                          
                             481:                        catch (NumberFormatException ex)                                           
                             482:                        {                                                                          
                             483:                            throw new IOException(ex);                                             
                             484:                        }                                                                          
                             485:                    }                                                                              
                             486:                    break;                                                                         
                             487:                case '\r':                                                                         
                             488:                case '\n':                                                                         
                             489:                    sb.append("\n");                                                               
                             490:                    break;                                                                         
                             491:                default:                                                                           
                             492:                    sb.append(c);                                                                  
                             493:                    break;                                                                         
                             494:            }                                                                                      
                             495:        }                                                                                          
                             496:        return null;                                                                               
                             497:    }                                                                                              
                             498:                                                                                                   
                             499:    /**                                                                                            
                             500:     * Reads a binary CharString.                                                                  
                             501:     */                                                                                            
                             502:    private Token readCharString(int length) throws IOException                                    
                             503:    {                                                                                              
                             504:        try                                                                                        
                             505:        {                                                                                          
                             506:            buffer.get(); // space                                                                 
                             507:            byte[] data = new byte[length];                                                        
                             508:            buffer.get(data);                                                                      
                             509:            return new Token(data, Token.CHARSTRING);                                              
                             510:        }                                                                                          
                             511:        catch (BufferUnderflowException exception)                                                 
                             512:        {                                                                                          
                             513:            throw new IOException("Premature end of buffer reached");                              
                             514:        }                                                                                          
                             515:    }                                                                                              
                             516:}                                                                                                  
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:516-516                                 
                             ```                                                                                                    
                             516:}                                                                                                  
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-100                                   
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                        
                             3: * or more contributor license agreements.  See the NOTICE file                                      
                             4: * distributed with this work for additional information                                             
                             5: * regarding copyright ownership.  The ASF licenses this file                                        
                             6: * to you under the Apache License, Version 2.0 (the                                                 
                             7: * "License"); you may not use this file except in compliance                                        
                             8: * with the License.  You may obtain a copy of the License at                                        
                             9: *                                                                                                   
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                       
                             11: *                                                                                                  
                             12: * Unless required by applicable law or agreed to in writing,                                       
                             13: * software distributed under the License is distributed on an                                      
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                           
                             15: * KIND, either express or implied.  See the License for the                                        
                             16: * specific language governing permissions and limitations                                          
                             17: * under the License.                                                                               
                             18: */                                                                                                 
                             19:                                                                                                    
                             20:package org.apache.fontbox.type1;                                                                   
                             21:                                                                                                    
                             22:import java.io.IOException;                                                                         
                             23:import java.nio.BufferUnderflowException;                                                           
                             24:import java.nio.ByteBuffer;                                                                         
                             25:import org.apache.logging.log4j.Logger;                                                             
                             26:import org.apache.logging.log4j.LogManager;                                                         
                             27:/**                                                                                                 
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                            
                             29: *                                                                                                  
                             30: * @see Type1Parser                                                                                 
                             31: *                                                                                                  
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                               
                             33: * somewhat awkward lexical structure. It is neither regular nor                                    
                             34: * context-free, and the execution of the program can modify the                                    
                             35: * the behaviour of the lexer/parser.                                                               
                             36: *                                                                                                  
                             37: * Nevertheless, this class represents an attempt to artificially separate                          
                             38: * the PostScript parsing process into separate lexing and parsing phases                           
                             39: * in order to reduce the complexity of the parsing phase.                                          
                             40: *                                                                                                  
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                
                             42: *                                                                                                  
                             43: * @author John Hewson                                                                              
                             44: */                                                                                                 
                             45:class Type1Lexer                                                                                    
                             46:{                                                                                                   
                             47:    /**                                                                                             
                             48:     * Log instance.                                                                                
                             49:     */                                                                                             
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                       
                             51:                                                                                                    
                             52:    private final ByteBuffer buffer;                                                                
                             53:    private Token aheadToken;                                                                       
                             54:    private int openParens = 0;                                                                     
                             55:                                                                                                    
                             56:    /**                                                                                             
                             57:     * Constructs a new Type1Lexer given a header-less .pfb segment.                                
                             58:     * @param bytes Header-less .pfb segment                                                        
                             59:     * @throws IOException                                                                          
                             60:     */                                                                                             
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                     
                             62:    {                                                                                               
                             63:        buffer = ByteBuffer.wrap(bytes);                                                            
                             64:        aheadToken = readToken(null);                                                               
                             65:    }                                                                                               
                             66:                                                                                                    
                             67:    /**                                                                                             
                             68:     * Returns the next token and consumes it.                                                      
                             69:     * @return The next token.                                                                      
                             70:     */                                                                                             
                             71:    public Token nextToken() throws IOException                                                     
                             72:    {                                                                                               
                             73:        Token curToken = aheadToken;                                                                
                             74:        //System.out.println(curToken); // for debugging                                            
                             75:        aheadToken = readToken(curToken);                                                           
                             76:        return curToken;                                                                            
                             77:    }                                                                                               
                             78:                                                                                                    
                             79:    /**                                                                                             
                             80:     * Returns the next token without consuming it.                                                 
                             81:     * @return The next token                                                                       
                             82:     */                                                                                             
                             83:    public Token peekToken()                                                                        
                             84:    {                                                                                               
                             85:        return aheadToken;                                                                          
                             86:    }                                                                                               
                             87:                                                                                                    
                             88:    /**                                                                                             
                             89:     * Checks if the kind of the next token equals the given one without consuming                  
                             it.                                                                                                    
                             90:     *                                                                                              
                             91:     * @return true if the kind of the next token equals the given one                              
                             92:     */                                                                                             
                             93:    public boolean peekKind(Token.Kind kind)                                                        
                             94:    {                                                                                               
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                  
                             96:    }                                                                                               
                             97:                                                                                                    
                             98:    /**                                                                                             
                             99:     * Reads an ASCII char from the buffer.                                                         
                             100:     */                                                                                            
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-120                                   
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                        
                             3: * or more contributor license agreements.  See the NOTICE file                                      
                             4: * distributed with this work for additional information                                             
                             5: * regarding copyright ownership.  The ASF licenses this file                                        
                             6: * to you under the Apache License, Version 2.0 (the                                                 
                             7: * "License"); you may not use this file except in compliance                                        
                             8: * with the License.  You may obtain a copy of the License at                                        
                             9: *                                                                                                   
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                       
                             11: *                                                                                                  
                             12: * Unless required by applicable law or agreed to in writing,                                       
                             13: * software distributed under the License is distributed on an                                      
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                           
                             15: * KIND, either express or implied.  See the License for the                                        
                             16: * specific language governing permissions and limitations                                          
                             17: * under the License.                                                                               
                             18: */                                                                                                 
                             19:                                                                                                    
                             20:package org.apache.fontbox.type1;                                                                   
                             21:                                                                                                    
                             22:import java.io.IOException;                                                                         
                             23:import java.nio.BufferUnderflowException;                                                           
                             24:import java.nio.ByteBuffer;                                                                         
                             25:import org.apache.logging.log4j.Logger;                                                             
                             26:import org.apache.logging.log4j.LogManager;                                                         
                             27:/**                                                                                                 
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                            
                             29: *                                                                                                  
                             30: * @see Type1Parser                                                                                 
                             31: *                                                                                                  
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                               
                             33: * somewhat awkward lexical structure. It is neither regular nor                                    
                             34: * context-free, and the execution of the program can modify the                                    
                             35: * the behaviour of the lexer/parser.                                                               
                             36: *                                                                                                  
                             37: * Nevertheless, this class represents an attempt to artificially separate                          
                             38: * the PostScript parsing process into separate lexing and parsing phases                           
                             39: * in order to reduce the complexity of the parsing phase.                                          
                             40: *                                                                                                  
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                
                             42: *                                                                                                  
                             43: * @author John Hewson                                                                              
                             44: */                                                                                                 
                             45:class Type1Lexer                                                                                    
                             46:{                                                                                                   
                             47:    /**                                                                                             
                             48:     * Log instance.                                                                                
                             49:     */                                                                                             
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                       
                             51:                                                                                                    
                             52:    private final ByteBuffer buffer;                                                                
                             53:    private Token aheadToken;                                                                       
                             54:    private int openParens = 0;                                                                     
                             55:                                                                                                    
                             56:    /**                                                                                             
                             57:     * Constructs a new Type1Lexer given a header-less .pfb segment.                                
                             58:     * @param bytes Header-less .pfb segment                                                        
                             59:     * @throws IOException                                                                          
                             60:     */                                                                                             
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                     
                             62:    {                                                                                               
                             63:        buffer = ByteBuffer.wrap(bytes);                                                            
                             64:        aheadToken = readToken(null);                                                               
                             65:    }                                                                                               
                             66:                                                                                                    
                             67:    /**                                                                                             
                             68:     * Returns the next token and consumes it.                                                      
                             69:     * @return The next token.                                                                      
                             70:     */                                                                                             
                             71:    public Token nextToken() throws IOException                                                     
                             72:    {                                                                                               
                             73:        Token curToken = aheadToken;                                                                
                             74:        //System.out.println(curToken); // for debugging                                            
                             75:        aheadToken = readToken(curToken);                                                           
                             76:        return curToken;                                                                            
                             77:    }                                                                                               
                             78:                                                                                                    
                             79:    /**                                                                                             
                             80:     * Returns the next token without consuming it.                                                 
                             81:     * @return The next token                                                                       
                             82:     */                                                                                             
                             83:    public Token peekToken()                                                                        
                             84:    {                                                                                               
                             85:        return aheadToken;                                                                          
                             86:    }                                                                                               
                             87:                                                                                                    
                             88:    /**                                                                                             
                             89:     * Checks if the kind of the next token equals the given one without consuming                  
                             it.                                                                                                    
                             90:     *                                                                                              
                             91:     * @return true if the kind of the next token equals the given one                              
                             92:     */                                                                                             
                             93:    public boolean peekKind(Token.Kind kind)                                                        
                             94:    {                                                                                               
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                  
                             96:    }                                                                                               
                             97:                                                                                                    
                             98:    /**                                                                                             
                             99:     * Reads an ASCII char from the buffer.                                                         
                             100:     */                                                                                            
                             101:    private char getChar() throws IOException                                                      
                             102:    {                                                                                              
                             103:        try                                                                                        
                             104:        {                                                                                          
                             105:            return (char) buffer.get();                                                            
                             106:        }                                                                                          
                             107:        catch (BufferUnderflowException exception)                                                 
                             108:        {                                                                                          
                             109:            throw new IOException("Premature end of buffer reached");                              
                             110:        }                                                                                          
                             111:    }                                                                                              
                             112:                                                                                                   
                             113:    /**                                                                                            
                             114:     * Reads a single token.                                                                       
                             115:     * @param prevToken the previous token                                                         
                             116:     */                                                                                            
                             117:    private Token readToken(Token prevToken) throws IOException                                    
                             118:    {                                                                                              
                             119:        boolean skip;                                                                              
                             120:        do                                                                                         
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:52-55                                   
                             ```                                                                                                    
                             52:    private final ByteBuffer buffer;                                                                
                             53:    private Token aheadToken;                                                                       
                             54:    private int openParens = 0;                                                                     
                             55:                                                                                                    
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:502-515                                 
                             ```                                                                                                    
                             502:    private Token readCharString(int length) throws IOException                                    
                             503:    {                                                                                              
                             504:        try                                                                                        
                             505:        {                                                                                          
                             506:            buffer.get(); // space                                                                 
                             507:            byte[] data = new byte[length];                                                        
                             508:            buffer.get(data);                                                                      
                             509:            return new Token(data, Token.CHARSTRING);                                              
                             510:        }                                                                                          
                             511:        catch (BufferUnderflowException exception)                                                 
                             512:        {                                                                                          
                             513:            throw new IOException("Premature end of buffer reached");                              
                             514:        }                                                                                          
                             515:    }                                                                                              
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:516-516                                 
                             ```                                                                                                    
                             516:}                                                                                                  
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:801-805                                
                             ```                                                                                                    
                             801:            // RD                                                                                  
                             802:            read(Token.INTEGER);                                                                   
                             803:            Token charstring = read(Token.CHARSTRING);                                             
                             804:            font.charstrings.put(name, decrypt(charstring.getData(),                               
                             CHARSTRING_KEY, lenIV));                                                                               
                             805:            readDef();                                                                             
                             ```                                                                                                    
                             </code>                                                                                                
                             </code_snippets>                                                                                       
                                                                                                                                    
                             ## Fix Strategy                                                                                        
                             <fix_strategy>                                                                                         
                                                                                                                                    
                             </fix_strategy>                                                                                        
                             ===Evaluation End===                                                                                   
[11/04/25 08:10:56] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                     __init__.py:160
                             (n evals: 3, patch status: PatchStatus.UNCOMPILABLE)                                                   
[11/04/25 08:12:05] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                        __init__.py:160
                             (n evals: 3, patch status: PatchStatus.UNCOMPILABLE)                                                   
[11/04/25 08:12:56] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                       __init__.py:160
                             (n evals: 3, patch status: PatchStatus.UNCOMPILABLE)                                                   
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:12:57] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False   context_managers.py:23
[11/04/25 08:12:58] INFO     [logging_performance](pdfbox Patching) Started...                                 context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmp7bpyok0q                                                    default.py:171
[11/04/25 08:14:00] INFO     [logging_performance](pdfbox Patching) Took 61.81 seconds; exception=False       context_managers.py:23
                    INFO     [logging_performance](pdfbox Checking build) Started...                           context_managers.py:9
[11/04/25 08:14:14] INFO     [logging_performance](pdfbox Checking build) Took 14.23 seconds; exception=False context_managers.py:23
                    INFO     [logging_performance](pdfbox Running PoV) Started...                              context_managers.py:9
[11/04/25 08:14:20] INFO     [logging_performance](pdfbox Running PoV) Took 5.87 seconds; exception=False     context_managers.py:23
                    INFO     [logging_performance](pdfbox Testing) Started...                                  context_managers.py:9
                    INFO     [logging_performance](pdfbox Testing) Took 0.00 seconds; exception=False         context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:14:21] INFO     [logging_performance](pdfbox Setting owner) Took 0.83 seconds; exception=False   context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:14:22] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False   context_managers.py:23
[11/04/25 08:14:23] INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:14:24] INFO     [logging_performance](pdfbox Setting owner) Took 1.01 seconds; exception=False   context_managers.py:23
                    INFO     ===Evaluator Result===                                                                 evaluator.py:204
                             PatchStatus.SOUND                                                                                      
                             ===Evaluator Diff===                                                                                   
                             --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                                   
                             +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java                                   
                             @@ -48,7 +48,13 @@                                                                                     
                                   * Log instance.                                                                                  
                                   */                                                                                               
                                  private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                         
                             -                                                                                                      
                             +                                                                                                      
                             +    /**                                                                                               
                             +     * Maximum allowed CharString length to prevent unbounded memory allocation.                      
                             +     * Typical Type 1 CharStrings are small; 10 MiB is a safe upper bound.                            
                             +     */                                                                                               
                             +    private static final int MAX_CHARSTRING_LENGTH = 10 * 1024 * 1024;                                
                             +                                                                                                      
                                  private final ByteBuffer buffer;                                                                  
                                  private Token aheadToken;                                                                         
                                  private int openParens = 0;                                                                       
                             @@ -501,16 +507,32 @@                                                                                  
                                   */                                                                                               
                                  private Token readCharString(int length) throws IOException                                       
                                  {                                                                                                 
                             +        // Validate charstring length to prevent resource exhaustion                                  
                             +        if (length < 0)                                                                               
                             +        {                                                                                             
                             +            throw new IOException("CharString length is negative: " + length);                        
                             +        }                                                                                             
                             +        // Ensure there is at least one space byte plus the declared data                             
                             +        int remaining = buffer.remaining();                                                           
                             +        if (length + 1 > remaining)                                                                   
                             +        {                                                                                             
                             +            throw new IOException("CharString length exceeds available data: " +                      
                             length);                                                                                               
                             +        }                                                                                             
                             +        // Enforce an upper bound to prevent OOM                                                      
                             +        if (length > MAX_CHARSTRING_LENGTH)                                                           
                             +        {                                                                                             
                             +            throw new IOException("CharString length exceeds maximum allowed: " +                     
                             length);                                                                                               
                             +        }                                                                                             
                                      try                                                                                           
                                      {                                                                                             
                             -            buffer.get(); // space                                                                    
                             +            buffer.get(); // consume space delimiter                                                  
                                          byte[] data = new byte[length];                                                           
                                          buffer.get(data);                                                                         
                                          return new Token(data, Token.CHARSTRING);                                                 
                                      }                                                                                             
                             -        catch (BufferUnderflowException exception)                                                    
                             -        {                                                                                             
                             -            throw new IOException("Premature end of buffer reached");                                 
                             +        catch (BufferUnderflowException e)                                                            
                             +        {                                                                                             
                             +            throw new IOException("Premature end of buffer reached", e);                              
                                      }                                                                                             
                                  }                                                                                                 
                              }                                                                                                     
                                                                                                                                    
                             ===Patch Result===                                                                                     
                                                                                                                                    
                             ===Issue===                                                                                            
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of                     
                             memory (use '-Xmx1710m' to reproduce)                                                                  
                             Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit                           
                                     at org.apache.fontbox.type1.Type1Lexer.readCharString(Type1Lexer.java:507)                     
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:232)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.read(Type1Parser.java:877)                             
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:109)                       
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaFo                 
                             rm$DMH)                                                                                                
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                   
                             DEDUP_TOKEN: 0d88e419df5aef8d                                                                          
                             == libFuzzer crashing input ==                                                                         
                             ===Evaluation Report===                                                                                
                             # Evaluation Report                                                                                    
                                                                                                                                    
                             ## Summary                                                                                             
                                                                                                                                    
                             An out-of-memory error was triggered during fuzzing when `Type1Lexer.readCharString`                   
                             attempted to allocate or read a very large character string buffer. The user submitted                 
                             a patch that adds range checks on the `length` parameterrejecting negative,                           
                             too-large, or inconsistent valuesbut introduced a reference to an undefined constant,                 
                             `MAX_CHARSTRING_LENGTH`. The build then failed with a compilation error in                             
                             `Type1Lexer.java` due to that missing symbol.                                                          
                                                                                                                                    
                             ## Description                                                                                         
                                                                                                                                    
                             1. Initial issue                                                                                       
                                - During fuzz testing of PDF text extraction, the fuzzer drove                                      
                             `Type1Lexer.readCharString(int length)` to request a buffer size that exceeded the JVM                 
                             limit.                                                                                                 
                                - The stack trace shows `java.lang.OutOfMemoryError: Requested array size exceeds                   
                             VM limit`, raised at line 507 in `Type1Lexer.readCharString`. This originates from                     
                             parsing a Type 1 charstring in a PDF font.                                                             
                                - The failure mode is resource exhaustion: the code does not validate the declared                  
                             charstring length before attempting to read or allocate.                                               
                                                                                                                                    
                             2. Important observations                                                                              
                                - The length parameter comes directly from the PDF data stream (via `buffer`), with                 
                             no prior validation.                                                                                   
                                - The error class (`FuzzerSecurityIssueLow`) indicates a low-severity                               
                             fuzzer-detected crash but it still permits unbounded memory allocation.                                
                                - The exception is reproducible by passing `-Xmx1710m` and feeding a crafted font                   
                             stream that declares an extremely large charstring.                                                    
                                                                                                                                    
                             3. Patch attempt                                                                                       
                                - A snippet was added at the top of `readCharString(int length)` (around line 501)                  
                             to validate `length`:                                                                                  
                                  * Reject negative values.                                                                         
                                  * Ensure `length` does not exceed the remaining bytes in the buffer minus one.                    
                                  * Enforce an upper bound `MAX_CHARSTRING_LENGTH`.                                                 
                                - The patch context (before/after) looks like:                                                      
                                                                                                                                    
                                  ```diff                                                                                           
                                   private Token readCharString(int length) throws IOException                                      
                                   {                                                                                                
                             +       if (length < 0) {                                                                              
                             +           throw new IOException("CharString length is negative: " + length);                         
                             +       }                                                                                              
                             +       int remaining = buffer.remaining() - 1;                                                        
                             +       if (length > remaining) {                                                                      
                             +           throw new IOException("CharString length exceeds available data: " +                       
                             length);                                                                                               
                             +       }                                                                                              
                             +       if (length > MAX_CHARSTRING_LENGTH) {                                                          
                             +           throw new IOException("CharString length exceeds maximum allowed: " +                      
                             length);                                                                                               
                             +       }                                                                                              
                                       try {                                                                                        
                                           buffer.get(); // space                                                                   
                                                                                                                                   
                                  ```                                                                                               
                                                                                                                                    
                             4. Patch result                                                                                        
                                - The build failed in the FontBox module with a compile error:                                      
                                  ```                                                                                               
                                  cannot find symbol                                                                                
                                    symbol:   variable MAX_CHARSTRING_LENGTH                                                        
                                    location: class org.apache.fontbox.type1.Type1Lexer                                             
                                  ```                                                                                               
                                - No such constant is declared in `Type1Lexer` (or imported), so the compiler                       
                             rejects the patch.                                                                                     
                                                                                                                                    
                             5. Areas for further investigation                                                                     
                                - Define or import an appropriate `MAX_CHARSTRING_LENGTH` constant, and decide on a                 
                             safe upper bound.                                                                                      
                                - Audit other code paths in `Type1Lexer` and related parsers (`Type1Parser`,                        
                             `PDFontFactory`) for unbounded allocations or unsanitized length fields.                               
                                - Review how `buffer.remaining()` and `buffer.get()` are used elsewhere to ensure                   
                             consistent bounds checking.                                                                            
                                - Examine whether similar validation is needed in ASCII vs. binary (PFB) parsing                    
                             branches.                                                                                              
                                                                                                                                    
                             ## Initial Issue Log                                                                                   
                             Here is the initial issue log of the codebase:                                                         
                             <issue>                                                                                                
                             == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of                     
                             memory (use '-Xmx1710m' to reproduce)                                                                  
                             Caused by: java.lang.OutOfMemoryError: Requested array size exceeds VM limit                           
                                     at org.apache.fontbox.type1.Type1Lexer.readCharString(Type1Lexer.java:507)                     
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:232)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.read(Type1Parser.java:877)                             
                                     at org.apache.fontbox.type1.Type1Parser.parseASCII(Type1Parser.java:109)                       
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:63)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(LambdaFo                 
                             rm$DMH)                                                                                                
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(LambdaForm$MH)                      
                                     at                                                                                             
                             java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(LambdaForm$MH)                   
                             DEDUP_TOKEN: 0d88e419df5aef8d                                                                          
                             == libFuzzer crashing input ==                                                                         
                             </issue>                                                                                               
                                                                                                                                    
                             ## Additional Issue Log                                                                                
                             Here is the additional issue log after the last patch attempt:                                         
                             <additional_issue>                                                                                     
                             [ERROR] COMPILATION ERROR :                                                                            
                             [INFO] -------------------------------------------------------------                                   
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[515,22] cannot find symbol                                                                        
                               symbol:   variable MAX_CHARSTRING_LENGTH                                                             
                               location: class org.apache.fontbox.type1.Type1Lexer                                                  
                             [INFO] 1 error                                                                                         
                             [INFO] -------------------------------------------------------------                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:                                              
                             [INFO]                                                                                                 
                             [INFO] Apache PDFBox parent ............................... SUCCESS [  9.936 s]                        
                             [INFO] Apache PDFBox io ................................... SUCCESS [  4.724 s]                        
                             [INFO] Apache FontBox ..................................... FAILURE [  2.032 s]                        
                             [INFO] Apache XmpBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox ...................................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger ............................. SKIPPED                                    
                             [INFO] Apache PDFBox tools ................................ SKIPPED                                    
                             [INFO] Apache PDFBox application .......................... SKIPPED                                    
                             [INFO] Apache PDFBox Debugger application ................. SKIPPED                                    
                             [INFO] Apache PDFBox examples ............................. SKIPPED                                    
                             [INFO] pdfbox-reactor ..................................... SKIPPED                                    
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] BUILD FAILURE                                                                                   
                             [INFO] ------------------------------------------------------------------------                        
                             [INFO] Total time:  25.377 s                                                                           
                             [INFO] Finished at: 2025-11-04T08:10:39Z                                                               
                             [INFO] ------------------------------------------------------------------------                        
                             [ERROR] Failed to execute goal                                                                         
                             org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on                     
                             project fontbox: Compilation failure                                                                   
                             [ERROR]                                                                                                
                             /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.j                 
                             ava:[515,22] cannot find symbol                                                                        
                             [ERROR]   symbol:   variable MAX_CHARSTRING_LENGTH                                                     
                             [ERROR]   location: class org.apache.fontbox.type1.Type1Lexer                                          
                             [ERROR]                                                                                                
                             [ERROR] -> [Help 1]                                                                                    
                             [ERROR]                                                                                                
                             [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.                    
                             [ERROR] Re-run Maven using the -X switch to enable full debug logging.                                 
                             [ERROR]                                                                                                
                             [ERROR] For more information about the errors                                                          
                             </additional_issue>                                                                                    
                                                                                                                                    
                             ## Notes                                                                                               
                             - All patch attempts are applied to the initial codebase. Reapply the the previous                     
                             patches if needed.                                                                                     
                             - If multiple different issues are present, all the issues must be resolved in a                       
                             single patch attempt.                                                                                  
                             - Try different approaches to resolve the issues.                                                      
                             ===Analysis Report===                                                                                  
                             # Analysis Report                                                                                      
                                                                                                                                    
                             ## Relevant Code Snippets                                                                              
                             <code_snippets>                                                                                        
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:100-180                                 
                             ```                                                                                                    
                             100:     */                                                                                            
                             101:    private char getChar() throws IOException                                                      
                             102:    {                                                                                              
                             103:        try                                                                                        
                             104:        {                                                                                          
                             105:            return (char) buffer.get();                                                            
                             106:        }                                                                                          
                             107:        catch (BufferUnderflowException exception)                                                 
                             108:        {                                                                                          
                             109:            throw new IOException("Premature end of buffer reached");                              
                             110:        }                                                                                          
                             111:    }                                                                                              
                             112:                                                                                                   
                             113:    /**                                                                                            
                             114:     * Reads a single token.                                                                       
                             115:     * @param prevToken the previous token                                                         
                             116:     */                                                                                            
                             117:    private Token readToken(Token prevToken) throws IOException                                    
                             118:    {                                                                                              
                             119:        boolean skip;                                                                              
                             120:        do                                                                                         
                             121:        {                                                                                          
                             122:            skip = false;                                                                          
                             123:            while (buffer.hasRemaining())                                                          
                             124:            {                                                                                      
                             125:                char c = getChar();                                                                
                             126:                                                                                                   
                             127:                // delimiters                                                                      
                             128:                if (c == '%')                                                                      
                             129:                {                                                                                  
                             130:                    // comment                                                                     
                             131:                    readComment();                                                                 
                             132:                }                                                                                  
                             133:                else if (c == '(')                                                                 
                             134:                {                                                                                  
                             135:                    return readString();                                                           
                             136:                }                                                                                  
                             137:                else if (c == ')')                                                                 
                             138:                {                                                                                  
                             139:                    // not allowed outside a string context                                        
                             140:                    throw new IOException("unexpected closing parenthesis");                       
                             141:                }                                                                                  
                             142:                else if (c == '[')                                                                 
                             143:                {                                                                                  
                             144:                    return new Token(c, Token.START_ARRAY);                                        
                             145:                }                                                                                  
                             146:                else if (c == '{')                                                                 
                             147:                {                                                                                  
                             148:                    return new Token(c, Token.START_PROC);                                         
                             149:                }                                                                                  
                             150:                else if (c == ']')                                                                 
                             151:                {                                                                                  
                             152:                    return new Token(c, Token.END_ARRAY);                                          
                             153:                }                                                                                  
                             154:                else if (c == '}')                                                                 
                             155:                {                                                                                  
                             156:                    return new Token(c, Token.END_PROC);                                           
                             157:                }                                                                                  
                             158:                else if (c == '/')                                                                 
                             159:                {                                                                                  
                             160:                    String regular = readRegular();                                                
                             161:                    if (regular == null)                                                           
                             162:                    {                                                                              
                             163:                        // the stream is corrupt                                                   
                             164:                        throw new DamagedFontException("Could not read token at                    
                             position " +                                                                                           
                             165:                                                        buffer.position());                        
                             166:                    }                                                                              
                             167:                    return new Token(regular, Token.LITERAL);                                      
                             168:                }                                                                                  
                             169:                else if (c == '<')                                                                 
                             170:                {                                                                                  
                             171:                    char c2 = getChar();                                                           
                             172:                    if (c2 == c)                                                                   
                             173:                    {                                                                              
                             174:                        return new Token("<<", Token.START_DICT);                                  
                             175:                    }                                                                              
                             176:                    else                                                                           
                             177:                    {                                                                              
                             178:                        // code may have to be changed in something better, maybe                  
                             new token type                                                                                         
                             179:                        buffer.position(buffer.position() - 1);                                    
                             180:                        return new Token(c, Token.NAME);                                           
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:180-260                                 
                             ```                                                                                                    
                             180:                        return new Token(c, Token.NAME);                                           
                             181:                    }                                                                              
                             182:                }                                                                                  
                             183:                else if (c == '>')                                                                 
                             184:                {                                                                                  
                             185:                    char c2 = getChar();                                                           
                             186:                    if (c2 == c)                                                                   
                             187:                    {                                                                              
                             188:                        return new Token(">>", Token.END_DICT);                                    
                             189:                    }                                                                              
                             190:                    else                                                                           
                             191:                    {                                                                              
                             192:                        // code may have to be changed in something better, maybe                  
                             new token type                                                                                         
                             193:                        buffer.position(buffer.position() - 1);                                    
                             194:                        return new Token(c, Token.NAME);                                           
                             195:                    }                                                                              
                             196:                }                                                                                  
                             197:                else if (Character.isWhitespace(c))                                                
                             198:                {                                                                                  
                             199:                    skip = true;                                                                   
                             200:                }                                                                                  
                             201:                else if (c == 0)                                                                   
                             202:                {                                                                                  
                             203:                    LOG.warn("NULL byte in font, skipped");                                        
                             204:                    skip = true;                                                                   
                             205:                }                                                                                  
                             206:                else                                                                               
                             207:                {                                                                                  
                             208:                    buffer.position(buffer.position() -1);                                         
                             209:                                                                                                   
                             210:                    // regular character: try parse as number                                      
                             211:                    Token number = tryReadNumber();                                                
                             212:                    if (number != null)                                                            
                             213:                    {                                                                              
                             214:                        return number;                                                             
                             215:                    }                                                                              
                             216:                    else                                                                           
                             217:                    {                                                                              
                             218:                        // otherwise this must be a name                                           
                             219:                        String name = readRegular();                                               
                             220:                        if (name == null)                                                          
                             221:                        {                                                                          
                             222:                            // the stream is corrupt                                               
                             223:                            throw new DamagedFontException("Could not read token                   
                             at position " +                                                                                        
                             224:                                                           buffer.position());                     
                             225:                        }                                                                          
                             226:                                                                                                   
                             227:                        if (name.equals("RD") || name.equals("-|"))                                
                             228:                        {                                                                          
                             229:                            // return the next CharString instead                                  
                             230:                            if (prevToken != null && prevToken.getKind() ==                        
                             Token.INTEGER)                                                                                         
                             231:                            {                                                                      
                             232:                                return readCharString(prevToken.intValue());                       
                             233:                            }                                                                      
                             234:                            else                                                                   
                             235:                            {                                                                      
                             236:                                throw new IOException("expected INTEGER before -|                  
                             or RD");                                                                                               
                             237:                            }                                                                      
                             238:                        }                                                                          
                             239:                        else                                                                       
                             240:                        {                                                                          
                             241:                            return new Token(name, Token.NAME);                                    
                             242:                        }                                                                          
                             243:                    }                                                                              
                             244:                }                                                                                  
                             245:            }                                                                                      
                             246:        }                                                                                          
                             247:        while (skip);                                                                              
                             248:        return null;                                                                               
                             249:    }                                                                                              
                             250:                                                                                                   
                             251:    /**                                                                                            
                             252:     * Reads a number or returns null.                                                             
                             253:     */                                                                                            
                             254:    private Token tryReadNumber() throws IOException                                               
                             255:    {                                                                                              
                             256:        buffer.mark();                                                                             
                             257:                                                                                                   
                             258:        StringBuilder sb = new StringBuilder();                                                    
                             259:        StringBuilder radix = null;                                                                
                             260:        char c = getChar();                                                                        
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:450-516                                 
                             ```                                                                                                    
                             450:                        // end of string                                                           
                             451:                        return new Token(sb.toString(), Token.STRING);                             
                             452:                    }                                                                              
                             453:                    sb.append(')');                                                                
                             454:                    openParens--;                                                                  
                             455:                    break;                                                                         
                             456:                case '\\':                                                                         
                             457:                    // escapes: \n \r \t \b \f \\ \( \)                                            
                             458:                    char c1 = getChar();                                                           
                             459:                    switch (c1)                                                                    
                             460:                    {                                                                              
                             461:                        case 'n':                                                                  
                             462:                        case 'r': sb.append("\n"); break;                                          
                             463:                        case 't': sb.append('\t'); break;                                          
                             464:                        case 'b': sb.append('\b'); break;                                          
                             465:                        case 'f': sb.append('\f'); break;                                          
                             466:                        case '\\': sb.append('\\'); break;                                         
                             467:                        case '(': sb.append('('); break;                                           
                             468:                        case ')': sb.append(')'); break;                                           
                             469:                        default:                                                                   
                             470:                            break;                                                                 
                             471:                    }                                                                              
                             472:                    // octal \ddd                                                                  
                             473:                    if (Character.isDigit(c1))                                                     
                             474:                    {                                                                              
                             475:                        String num = String.valueOf(new char[] { c1, getChar(),                    
                             getChar() });                                                                                          
                             476:                        try                                                                        
                             477:                        {                                                                          
                             478:                            int code = Integer.parseInt(num, 8);                                   
                             479:                            sb.append((char) code);                                                
                             480:                        }                                                                          
                             481:                        catch (NumberFormatException ex)                                           
                             482:                        {                                                                          
                             483:                            throw new IOException(ex);                                             
                             484:                        }                                                                          
                             485:                    }                                                                              
                             486:                    break;                                                                         
                             487:                case '\r':                                                                         
                             488:                case '\n':                                                                         
                             489:                    sb.append("\n");                                                               
                             490:                    break;                                                                         
                             491:                default:                                                                           
                             492:                    sb.append(c);                                                                  
                             493:                    break;                                                                         
                             494:            }                                                                                      
                             495:        }                                                                                          
                             496:        return null;                                                                               
                             497:    }                                                                                              
                             498:                                                                                                   
                             499:    /**                                                                                            
                             500:     * Reads a binary CharString.                                                                  
                             501:     */                                                                                            
                             502:    private Token readCharString(int length) throws IOException                                    
                             503:    {                                                                                              
                             504:        try                                                                                        
                             505:        {                                                                                          
                             506:            buffer.get(); // space                                                                 
                             507:            byte[] data = new byte[length];                                                        
                             508:            buffer.get(data);                                                                      
                             509:            return new Token(data, Token.CHARSTRING);                                              
                             510:        }                                                                                          
                             511:        catch (BufferUnderflowException exception)                                                 
                             512:        {                                                                                          
                             513:            throw new IOException("Premature end of buffer reached");                              
                             514:        }                                                                                          
                             515:    }                                                                                              
                             516:}                                                                                                  
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:801-805                                
                             ```                                                                                                    
                             801:            // RD                                                                                  
                             802:            read(Token.INTEGER);                                                                   
                             803:            Token charstring = read(Token.CHARSTRING);                                             
                             804:            font.charstrings.put(name, decrypt(charstring.getData(),                               
                             CHARSTRING_KEY, lenIV));                                                                               
                             805:            readDef();                                                                             
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1CharStringReader.java:1-38                         
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                
                             3: * contributor license agreements.  See the NOTICE file distributed with                             
                             4: * this work for additional information regarding copyright ownership.                               
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                           
                             6: * (the "License"); you may not use this file except in compliance with                              
                             7: * the License.  You may obtain a copy of the License at                                             
                             8: *                                                                                                   
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                   
                             10: *                                                                                                  
                             11: * Unless required by applicable law or agreed to in writing, software                              
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                         
                             14: * See the License for the specific language governing permissions and                              
                             15: * limitations under the License.                                                                   
                             16: */                                                                                                 
                             17:                                                                                                    
                             18:package org.apache.fontbox.type1;                                                                   
                             19:                                                                                                    
                             20:import org.apache.fontbox.cff.Type1CharString;                                                      
                             21:import java.io.IOException;                                                                         
                             22:                                                                                                    
                             23:/**                                                                                                 
                             24: * Something which can read Type 1 CharStrings, namely Type 1 and CFF fonts.                        
                             25: *                                                                                                  
                             26: * @author John Hewson                                                                              
                             27: */                                                                                                 
                             28:public interface Type1CharStringReader                                                              
                             29:{                                                                                                   
                             30:    /**                                                                                             
                             31:     * Returns the Type 1 CharString for the character with the given name.                         
                             32:     *                                                                                              
                             33:     * @param name the character name of the Type1 charstring                                       
                             34:     * @return Type 1 CharString                                                                    
                             35:     * @throws IOException if something went wrong                                                  
                             36:     */                                                                                             
                             37:    Type1CharString getType1CharString(String name) throws IOException;                             
                             38:}                                                                                                   
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:45-55                                   
                             ```                                                                                                    
                             45:class Type1Lexer                                                                                    
                             46:{                                                                                                   
                             47:    /**                                                                                             
                             48:     * Log instance.                                                                                
                             49:     */                                                                                             
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                       
                             51:                                                                                                    
                             52:    private final ByteBuffer buffer;                                                                
                             53:    private Token aheadToken;                                                                       
                             54:    private int openParens = 0;                                                                     
                             55:                                                                                                    
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:502-515                                 
                             ```                                                                                                    
                             502:    private Token readCharString(int length) throws IOException                                    
                             503:    {                                                                                              
                             504:        try                                                                                        
                             505:        {                                                                                          
                             506:            buffer.get(); // space                                                                 
                             507:            byte[] data = new byte[length];                                                        
                             508:            buffer.get(data);                                                                      
                             509:            return new Token(data, Token.CHARSTRING);                                              
                             510:        }                                                                                          
                             511:        catch (BufferUnderflowException exception)                                                 
                             512:        {                                                                                          
                             513:            throw new IOException("Premature end of buffer reached");                              
                             514:        }                                                                                          
                             515:    }                                                                                              
                             ```                                                                                                    
                             </code>                                                                                                
                             </code_snippets>                                                                                       
                                                                                                                                    
                             ## Fix Strategy                                                                                        
                             <fix_strategy>                                                                                         
                                                                                                                                    
                             1. Define the missing `MAX_CHARSTRING_LENGTH` constant:                                                
                                - In `Type1Lexer.java`, immediately after the `Logger` and before any methods                       
                             (e.g., around line 50), add                                                                            
                                  ```java                                                                                           
                                  /**                                                                                               
                                   * Maximum allowed CharString length to prevent unbounded memory allocation.                      
                                   * Typical Type 1 CharStrings are small; 10 MiB is a safe upper bound.                            
                                   */                                                                                               
                                  private static final int MAX_CHARSTRING_LENGTH = 10 * 1024 * 1024;                                
                                  ```                                                                                               
                                - This provides a compile-time symbol and enforces a reasonable cap on the                          
                             bytearray allocation.                                                                                 
                                                                                                                                    
                             2. Centralize all length validations inside `readCharString(int length)` before                        
                             consuming any bytes:                                                                                   
                                - Reject negative lengths.                                                                          
                                - Ensure there are at least `(1 + length)` bytes remaining (one space byte plus the                 
                             data).                                                                                                 
                                - Enforce the `MAX_CHARSTRING_LENGTH` upper bound.                                                  
                                - Only after these checks pass do we call `buffer.get()` to consume the space and                   
                             allocate the data array.                                                                               
                                - Sample revised structure:                                                                         
                                  ```java                                                                                           
                                  private Token readCharString(int length) throws IOException                                       
                                  {                                                                                                 
                                      // 1) Negative length                                                                         
                                      if (length < 0)                                                                               
                                      {                                                                                             
                                          throw new IOException("CharString length is negative: " + length);                        
                                      }                                                                                             
                                      // 2) Available bytes: need one 'space' + length bytes                                        
                                      int remaining = buffer.remaining();                                                           
                                      if (length + 1 > remaining)                                                                   
                                      {                                                                                             
                                          throw new IOException("CharString length exceeds available data: " +                      
                             length);                                                                                               
                                      }                                                                                             
                                      // 3) Prevent resource exhaustion                                                             
                                      if (length > MAX_CHARSTRING_LENGTH)                                                           
                                      {                                                                                             
                                          throw new IOException("CharString length exceeds maximum allowed: " +                     
                             length);                                                                                               
                                      }                                                                                             
                                      try                                                                                           
                                      {                                                                                             
                                          buffer.get();               // consume the space delimiter                                
                                          byte[] data = new byte[length];                                                           
                                          buffer.get(data);           // read actual charstring bytes                               
                                          return new Token(data, Token.CHARSTRING);                                                 
                                      }                                                                                             
                                      catch (BufferUnderflowException e)                                                            
                                      {                                                                                             
                                          throw new IOException("Premature end of buffer reached", e);                              
                                      }                                                                                             
                                  }                                                                                                 
                                  ```                                                                                               
                                - By performing all checks first, we avoid partially consuming the buffer when                      
                             throwing an exception, preserving lexer state for any higher-level error handling.                     
                                                                                                                                    
                             3. Audit related parsing flows for consistency:                                                        
                                - The only place that invokes `readCharString(int)` is in `readToken` when                          
                             encountering the `RD` or `-|` operator, so no further changes are required elsewhere                   
                             in the codebase.                                                                                       
                                - Downstream consumers (`Type1Parser`, decryption logic, `Type1CharStringReader`)                   
                             receive wellbounded byte arrays without needing additional checks.                                    
                                                                                                                                    
                             4. Justification and sideeffect mitigation:                                                           
                                - Introducing `MAX_CHARSTRING_LENGTH` fixes the compilation failure and prevents                    
                             unbounded allocations that lead to OOM.                                                                
                                - A 10 MiB cap is unlikely to reject any valid Type 1 font, whose charstrings are                   
                             typically a few kilobytes at most. If a specific font legitimately exceeds this, the                   
                             threshold can be adjusted in a future patch or made configurable.                                      
                                - Existing functionality (ASCII vs. binary parsing, PFB support) remains unchanged                  
                             beyond the added safety checks.                                                                        
                                - No tests, fuzz harnesses, or external libraries are modified, preserving the                      
                             existing test suite and fuzzer entry points.                                                           
                                                                                                                                    
                             5. Implementation steps:                                                                               
                                a. Open `fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java`.                           
                                b. Add the `MAX_CHARSTRING_LENGTH` constant at the class level.                                     
                                c. Replace the current `readCharString(int length)` body with the guarded version                   
                             above.                                                                                                 
                                d. Rebuild the FontBox module and run existing unit tests and fuzz targets to                       
                             confirm that:                                                                                          
                                   - The compilation error is resolved.                                                             
                                   - Legitimate small charstrings continue to parse correctly.                                      
                                   - Maliciously large lengths now fail fast with `IOException` rather than                         
                             triggering OOM.                                                                                        
                                                                                                                                    
                             </fix_strategy>                                                                                        
                             ===Tests Result===                                                                                     
                             No tests found                                                                                         
                             ===Evaluation End===                                                                                   
                    INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                         __init__.py:160
                             (n evals: 4, patch status: PatchStatus.SOUND)                                                          
                    INFO     Building environment                                                                    __init__.py:132
                             - Cache directory: /tmp/tmpskc0myv8                                                                    
                             - Max timeout: 1800                                                                                    
                             - Output directory:                                                                                    
                             reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_5/agent-output-1762244064.579592                
                             7                                                                                                      
                             - Detection toml file:                                                                                 
                             /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_5.toml                           
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                    
                                                                                                                                    
