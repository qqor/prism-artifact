[11/04/25 07:54:50] INFO     Building environment                                                                    __init__.py:132
                             - Cache directory: /tmp/tmprxynlyqd                                                                    
                             - Max timeout: 1800                                                                                    
                             - Output directory:                                                                                    
                             reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_4/agent-output-1762242890.505456                
                             - Detection toml file:                                                                                 
                             /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_4.toml                           
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                    
                                                                                                                                    
                    INFO     Setting timeouts                                                                          default.py:83
                               - build: 600 (original: 88)                                                                          
                               - run tests: 600 (original: 0)                                                                       
                    INFO     Successfully created Cached for CLEAN environment                                       oss_fuzz.py:256
                    INFO     Current environments: ['CLEAN -> Cached']                                               oss_fuzz.py:265
                    INFO     Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                       __init__.py:160
                             (n evals: 0, patch status: PatchStatus.INITIALIZED)                                                    
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 07:54:51] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False   context_managers.py:23
[11/04/25 07:54:52] INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 07:54:53] INFO     [logging_performance](pdfbox Setting owner) Took 1.09 seconds; exception=False   context_managers.py:23
[11/04/25 07:55:24] INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 07:55:25] INFO     [logging_performance](pdfbox Setting owner) Took 0.89 seconds; exception=False   context_managers.py:23
                    INFO     [logging_performance](pdfbox Running a pov) Started...                            context_managers.py:9
[11/04/25 07:55:56] INFO     [logging_performance](pdfbox Running a pov) Took 30.73 seconds; exception=True   context_managers.py:23
                    WARNING  Crash analysis results is empty. This should not happen.                                 __init__.py:41
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 07:55:57] INFO     [logging_performance](pdfbox Setting owner) Took 0.92 seconds; exception=False   context_managers.py:23
[11/04/25 07:56:28] INFO     Found jstack output at                                                                   __init__.py:43
                             /tasks_new/pdfbox_pdfbox-full-01/fuzz-tooling/build/out/pdfbox/jstack.txt                              
                    INFO     ===Evaluator Result===                                                                 evaluator.py:204
                             PatchStatus.VULNERABLE                                                                                 
                             ===Evaluator Diff===                                                                                   
                                                                                                                                    
                             ===Patch Result===                                                                                     
                             ERROR: libFuzzer: timeout                                                                              
                             2025-11-04 07:56:27                                                                                    
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                           
                                                                                                                                    
                             Threads class SMR info:                                                                                
                             _java_thread_list=0x00007f35745cd9d0, length=14, elements={                                            
                             0x0000559a7a7ceb70, 0x0000559a7a8d9bf0, 0x0000559a7a8db000, 0x0000559a7a8e4090,                        
                             0x0000559a7a8e5410, 0x0000559a7a8e67f0, 0x0000559a7a8e81f0, 0x0000559a7a8e96f0,                        
                             0x0000559a7a8eab30, 0x0000559a7a927bf0, 0x0000559a7a92b160, 0x0000559a7aaa8300,                        
                             0x00007f35a4000e70, 0x0000559a7aff8900                                                                 
                             }                                                                                                      
                                                                                                                                    
                             "main" #1 prio=5 os_prio=0 cpu=26612.83ms elapsed=28.71s tid=0x0000559a7a7ceb70                        
                             nid=0x13 runnable  [0x00007fffc19d7000]                                                                
                                java.lang.Thread.State: RUNNABLE                                                                    
                                     at                                                                                             
                             com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Nat                 
                             ive Method)                                                                                            
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.parseBinary(Type1Parser.java:643)                      
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:71)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/L                 
                             ambdaForm$DMH)                                                                                         
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$M                 
                             H)                                                                                                     
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaFor                 
                             m$MH)                                                                                                  
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                 
                                     at                                                                                             
                             com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native                     
                             Method)                                                                                                
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.j                 
                             ava:551)                                                                                               
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.j                 
                             ava:441)                                                                                               
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                           
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                  
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                    
                                                                                                                                    
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.85ms elapsed=28.67s                              
                             tid=0x0000559a7a8d9bf0 nid=0x16 waiting on condition  [0x00007f35b9d02000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native                 
                             Method)                                                                                                
                                     at                                                                                             
                             java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                  
                                     at                                                                                             
                             java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                      
                                                                                                                                    
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.53ms elapsed=28.67s                                       
                             tid=0x0000559a7a8db000 nid=0x17 in Object.wait()  [0x00007f35b93fe000]                                 
                                java.lang.Thread.State: WAITING (on object monitor)                                                 
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                          
                                     at                                                                                             
                             java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                       
                                                                                                                                    
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.45ms elapsed=28.67s                               
                             tid=0x0000559a7a8e4090 nid=0x18 waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.78ms elapsed=28.67s                                  
                             tid=0x0000559a7a8e5410 nid=0x19 runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.63ms elapsed=28.67s                        
                             tid=0x0000559a7a8e67f0 nid=0x1a runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1806.35ms elapsed=28.67s                           
                             tid=0x0000559a7a8e81f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                No compile task                                                                                     
                                                                                                                                    
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=822.17ms elapsed=28.67s                           
                             tid=0x0000559a7a8e96f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                No compile task                                                                                     
                                                                                                                                    
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=47.46ms elapsed=28.67s                                
                             tid=0x0000559a7a8eab30 nid=0x1d runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.15ms elapsed=28.65s                            
                             tid=0x0000559a7a927bf0 nid=0x21 runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.78ms elapsed=28.65s                                 
                             tid=0x0000559a7a92b160 nid=0x23 in Object.wait()  [0x00007f35b870c000]                                 
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                           
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x0000000089418388> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x0000000089418388> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                     
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                     at                                                                                             
                             jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                       
                                                                                                                                    
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.53s                                
                             tid=0x0000559a7aaa8300 nid=0x26 waiting on condition  [0x00007f35b84b1000]                             
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                     
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                               
                                     - parking to wait for  <0x000000008941e1f8> (a                                                 
                             java.util.concurrent.SynchronousQueue$TransferStack)                                                   
                                     at                                                                                             
                             java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252                 
                             )                                                                                                      
                                     at                                                                                             
                             java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/Synchron                 
                             ousQueue.java:401)                                                                                     
                                     at                                                                                             
                             java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                 
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.ja                 
                             va:1061)                                                                                               
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.                 
                             java:1122)                                                                                             
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor                 
                             .java:635)                                                                                             
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                                                                                                                    
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.74ms elapsed=28.41s                                
                             tid=0x00007f35a4000e70 nid=0x3c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.21ms elapsed=25.43s                                     
                             tid=0x0000559a7aff8900 nid=0x299 in Object.wait()  [0x00007f3563ab8000]                                
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                           
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x00000000f6418178> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x00000000f6418178> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                     
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                     at                                                                                             
                             jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                       
                                                                                                                                    
                             "VM Thread" os_prio=0 cpu=55.26ms elapsed=28.68s tid=0x0000559a7a8d5400 nid=0x15                       
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#0" os_prio=0 cpu=48.95ms elapsed=28.69s tid=0x0000559a7a7e5da0 nid=0x14                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#1" os_prio=0 cpu=46.36ms elapsed=27.61s tid=0x00007f35b4001570 nid=0x5c                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#2" os_prio=0 cpu=48.66ms elapsed=27.61s tid=0x00007f35b4001f70 nid=0x5d                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#3" os_prio=0 cpu=48.66ms elapsed=27.61s tid=0x00007f35b4002970 nid=0x5e                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#4" os_prio=0 cpu=44.02ms elapsed=27.61s tid=0x00007f35b4003370 nid=0x5f                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#5" os_prio=0 cpu=42.66ms elapsed=27.61s tid=0x00007f35b4003d70 nid=0x60                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#6" os_prio=0 cpu=45.23ms elapsed=27.61s tid=0x00007f35b4004770 nid=0x61                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#7" os_prio=0 cpu=44.74ms elapsed=27.61s tid=0x00007f35b4005170 nid=0x62                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#8" os_prio=0 cpu=43.87ms elapsed=27.61s tid=0x00007f35b4005b70 nid=0x63                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#9" os_prio=0 cpu=48.42ms elapsed=27.61s tid=0x00007f35b4006570 nid=0x64                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#10" os_prio=0 cpu=40.80ms elapsed=27.61s tid=0x00007f35b4006f70 nid=0x65                    
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#11" os_prio=0 cpu=43.24ms elapsed=27.61s tid=0x00007f35b4007970 nid=0x66                    
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#12" os_prio=0 cpu=40.02ms elapsed=27.61s tid=0x00007f35b4008760 nid=0x67                    
                             runnable                                                                                               
                                                                                                                                    
                             "VM Periodic Task Thread" os_prio=0 cpu=10.40ms elapsed=28.65s tid=0x0000559a7a929590                  
                             nid=0x22 waiting on condition                                                                          
                                                                                                                                    
                             JNI global refs: 20, weak refs: 0                                                                      
                                                                                                                                    
                                                                                                                                    
                             ===Issue===                                                                                            
                             ERROR: libFuzzer: timeout                                                                              
                             2025-11-04 07:56:27                                                                                    
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                           
                                                                                                                                    
                             Threads class SMR info:                                                                                
                             _java_thread_list=0x00007f35745cd9d0, length=14, elements={                                            
                             0x0000559a7a7ceb70, 0x0000559a7a8d9bf0, 0x0000559a7a8db000, 0x0000559a7a8e4090,                        
                             0x0000559a7a8e5410, 0x0000559a7a8e67f0, 0x0000559a7a8e81f0, 0x0000559a7a8e96f0,                        
                             0x0000559a7a8eab30, 0x0000559a7a927bf0, 0x0000559a7a92b160, 0x0000559a7aaa8300,                        
                             0x00007f35a4000e70, 0x0000559a7aff8900                                                                 
                             }                                                                                                      
                                                                                                                                    
                             "main" #1 prio=5 os_prio=0 cpu=26612.83ms elapsed=28.71s tid=0x0000559a7a7ceb70                        
                             nid=0x13 runnable  [0x00007fffc19d7000]                                                                
                                java.lang.Thread.State: RUNNABLE                                                                    
                                     at                                                                                             
                             com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Nat                 
                             ive Method)                                                                                            
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.parseBinary(Type1Parser.java:643)                      
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:71)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/L                 
                             ambdaForm$DMH)                                                                                         
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$M                 
                             H)                                                                                                     
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaFor                 
                             m$MH)                                                                                                  
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                 
                                     at                                                                                             
                             com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native                     
                             Method)                                                                                                
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.j                 
                             ava:551)                                                                                               
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.j                 
                             ava:441)                                                                                               
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                           
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                  
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                    
                                                                                                                                    
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.85ms elapsed=28.67s                              
                             tid=0x0000559a7a8d9bf0 nid=0x16 waiting on condition  [0x00007f35b9d02000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native                 
                             Method)                                                                                                
                                     at                                                                                             
                             java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                  
                                     at                                                                                             
                             java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                      
                                                                                                                                    
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.53ms elapsed=28.67s                                       
                             tid=0x0000559a7a8db000 nid=0x17 in Object.wait()  [0x00007f35b93fe000]                                 
                                java.lang.Thread.State: WAITING (on object monitor)                                                 
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                          
                                     at                                                                                             
                             java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                       
                                                                                                                                    
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.45ms elapsed=28.67s                               
                             tid=0x0000559a7a8e4090 nid=0x18 waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.78ms elapsed=28.67s                                  
                             tid=0x0000559a7a8e5410 nid=0x19 runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.63ms elapsed=28.67s                        
                             tid=0x0000559a7a8e67f0 nid=0x1a runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1806.35ms elapsed=28.67s                           
                             tid=0x0000559a7a8e81f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                No compile task                                                                                     
                                                                                                                                    
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=822.17ms elapsed=28.67s                           
                             tid=0x0000559a7a8e96f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                No compile task                                                                                     
                                                                                                                                    
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=47.46ms elapsed=28.67s                                
                             tid=0x0000559a7a8eab30 nid=0x1d runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.15ms elapsed=28.65s                            
                             tid=0x0000559a7a927bf0 nid=0x21 runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.78ms elapsed=28.65s                                 
                             tid=0x0000559a7a92b160 nid=0x23 in Object.wait()  [0x00007f35b870c000]                                 
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                           
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x0000000089418388> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x0000000089418388> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                     
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                     at                                                                                             
                             jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                       
                                                                                                                                    
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.53s                                
                             tid=0x0000559a7aaa8300 nid=0x26 waiting on condition  [0x00007f35b84b1000]                             
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                     
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                               
                                     - parking to wait for  <0x000000008941e1f8> (a                                                 
                             java.util.concurrent.SynchronousQueue$TransferStack)                                                   
                                     at                                                                                             
                             java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252                 
                             )                                                                                                      
                                     at                                                                                             
                             java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/Synchron                 
                             ousQueue.java:401)                                                                                     
                                     at                                                                                             
                             java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                 
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.ja                 
                             va:1061)                                                                                               
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.                 
                             java:1122)                                                                                             
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor                 
                             .java:635)                                                                                             
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                                                                                                                    
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.74ms elapsed=28.41s                                
                             tid=0x00007f35a4000e70 nid=0x3c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.21ms elapsed=25.43s                                     
                             tid=0x0000559a7aff8900 nid=0x299 in Object.wait()  [0x00007f3563ab8000]                                
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                           
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x00000000f6418178> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x00000000f6418178> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                     
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                     at                                                                                             
                             jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                       
                                                                                                                                    
                             "VM Thread" os_prio=0 cpu=55.26ms elapsed=28.68s tid=0x0000559a7a8d5400 nid=0x15                       
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#0" os_prio=0 cpu=48.95ms elapsed=28.69s tid=0x0000559a7a7e5da0 nid=0x14                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#1" os_prio=0 cpu=46.36ms elapsed=27.61s tid=0x00007f35b4001570 nid=0x5c                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#2" os_prio=0 cpu=48.66ms elapsed=27.61s tid=0x00007f35b4001f70 nid=0x5d                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#3" os_prio=0 cpu=48.66ms elapsed=27.61s tid=0x00007f35b4002970 nid=0x5e                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#4" os_prio=0 cpu=44.02ms elapsed=27.61s tid=0x00007f35b4003370 nid=0x5f                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#5" os_prio=0 cpu=42.66ms elapsed=27.61s tid=0x00007f35b4003d70 nid=0x60                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#6" os_prio=0 cpu=45.23ms elapsed=27.61s tid=0x00007f35b4004770 nid=0x61                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#7" os_prio=0 cpu=44.74ms elapsed=27.61s tid=0x00007f35b4005170 nid=0x62                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#8" os_prio=0 cpu=43.87ms elapsed=27.61s tid=0x00007f35b4005b70 nid=0x63                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#9" os_prio=0 cpu=48.42ms elapsed=27.61s tid=0x00007f35b4006570 nid=0x64                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#10" os_prio=0 cpu=40.80ms elapsed=27.61s tid=0x00007f35b4006f70 nid=0x65                    
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#11" os_prio=0 cpu=43.24ms elapsed=27.61s tid=0x00007f35b4007970 nid=0x66                    
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#12" os_prio=0 cpu=40.02ms elapsed=27.61s tid=0x00007f35b4008760 nid=0x67                    
                             runnable                                                                                               
                                                                                                                                    
                             "VM Periodic Task Thread" os_prio=0 cpu=10.40ms elapsed=28.65s tid=0x0000559a7a929590                  
                             nid=0x22 waiting on condition                                                                          
                                                                                                                                    
                             JNI global refs: 20, weak refs: 0                                                                      
                                                                                                                                    
                                                                                                                                    
                             ===Evaluation Report===                                                                                
                                                                                                                                    
                             ===Analysis Report===                                                                                  
                                                                                                                                    
                             ===Evaluation End===                                                                                   
[11/04/25 07:56:40] INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                     __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                     
[11/04/25 07:58:15] INFO     Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.PATCH                        __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                     
[11/04/25 07:58:52] INFO     Prism Supervisor Routing: TeamStatus.PATCH -> TeamStatus.EVALUATE                       __init__.py:160
                             (n evals: 1, patch status: PatchStatus.VULNERABLE)                                                     
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 07:58:53] INFO     [logging_performance](pdfbox Setting owner) Took 0.89 seconds; exception=False   context_managers.py:23
                    INFO     [logging_performance](pdfbox Patching) Started...                                 context_managers.py:9
                    INFO     Checking valid diff: /tmp/tmp46orvg73                                                    default.py:171
[11/04/25 07:59:57] INFO     [logging_performance](pdfbox Patching) Took 64.27 seconds; exception=False       context_managers.py:23
                    INFO     [logging_performance](pdfbox Checking build) Started...                           context_managers.py:9
[11/04/25 08:00:12] INFO     [logging_performance](pdfbox Checking build) Took 14.44 seconds; exception=False context_managers.py:23
                    INFO     [logging_performance](pdfbox Running PoV) Started...                              context_managers.py:9
[11/04/25 08:00:18] INFO     [logging_performance](pdfbox Running PoV) Took 6.45 seconds; exception=False     context_managers.py:23
                    INFO     [logging_performance](pdfbox Testing) Started...                                  context_managers.py:9
                    INFO     [logging_performance](pdfbox Testing) Took 0.00 seconds; exception=False         context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:00:19] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False   context_managers.py:23
[11/04/25 08:00:20] INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:00:21] INFO     [logging_performance](pdfbox Setting owner) Took 0.91 seconds; exception=False   context_managers.py:23
                    INFO     [logging_performance](pdfbox Setting owner) Started...                            context_managers.py:9
[11/04/25 08:00:22] INFO     [logging_performance](pdfbox Setting owner) Took 1.00 seconds; exception=False   context_managers.py:23
[11/04/25 08:00:23] INFO     ===Evaluator Result===                                                                 evaluator.py:204
                             PatchStatus.SOUND                                                                                      
                             ===Evaluator Diff===                                                                                   
                             --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                  
                             +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java                                  
                             @@ -637,12 +637,17 @@                                                                                  
                                      // some fonts have "2 index" here, others have "end noaccess put"                             
                                      // sometimes followed by "put". Either way, we just skip until                                
                                      // the /CharStrings dict is found                                                             
                             -        while (!(lexer.peekKind(Token.LITERAL)                                                        
                             -                && lexer.peekToken().getText().equals("CharStrings")))                                
                             +        Token t;                                                                                      
                             +        while ((t = lexer.peekToken()) != null                                                        
                             +                && !(t.getKind() == Token.Kind.LITERAL                                                
                             +                     && "CharStrings".equals(t.getText())))                                           
                                      {                                                                                             
                                          lexer.nextToken();                                                                        
                                      }                                                                                             
                             -                                                                                                      
                             +        if (t == null)                                                                                
                             +        {                                                                                             
                             +            throw new IOException("/CharStrings token not found");                                    
                             +        }                                                                                             
                                      // CharStrings dict                                                                           
                                      read(Token.LITERAL, "CharStrings");                                                           
                                      readCharStrings(lenIV);                                                                       
                                                                                                                                    
                             ===Patch Result===                                                                                     
                                                                                                                                    
                             ===Issue===                                                                                            
                             ERROR: libFuzzer: timeout                                                                              
                             2025-11-04 07:56:27                                                                                    
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                           
                                                                                                                                    
                             Threads class SMR info:                                                                                
                             _java_thread_list=0x00007f35745cd9d0, length=14, elements={                                            
                             0x0000559a7a7ceb70, 0x0000559a7a8d9bf0, 0x0000559a7a8db000, 0x0000559a7a8e4090,                        
                             0x0000559a7a8e5410, 0x0000559a7a8e67f0, 0x0000559a7a8e81f0, 0x0000559a7a8e96f0,                        
                             0x0000559a7a8eab30, 0x0000559a7a927bf0, 0x0000559a7a92b160, 0x0000559a7aaa8300,                        
                             0x00007f35a4000e70, 0x0000559a7aff8900                                                                 
                             }                                                                                                      
                                                                                                                                    
                             "main" #1 prio=5 os_prio=0 cpu=26612.83ms elapsed=28.71s tid=0x0000559a7a7ceb70                        
                             nid=0x13 runnable  [0x00007fffc19d7000]                                                                
                                java.lang.Thread.State: RUNNABLE                                                                    
                                     at                                                                                             
                             com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Nat                 
                             ive Method)                                                                                            
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.parseBinary(Type1Parser.java:643)                      
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:71)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/L                 
                             ambdaForm$DMH)                                                                                         
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$M                 
                             H)                                                                                                     
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaFor                 
                             m$MH)                                                                                                  
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                 
                                     at                                                                                             
                             com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native                     
                             Method)                                                                                                
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.j                 
                             ava:551)                                                                                               
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.j                 
                             ava:441)                                                                                               
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                           
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                  
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                    
                                                                                                                                    
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.85ms elapsed=28.67s                              
                             tid=0x0000559a7a8d9bf0 nid=0x16 waiting on condition  [0x00007f35b9d02000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native                 
                             Method)                                                                                                
                                     at                                                                                             
                             java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                  
                                     at                                                                                             
                             java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                      
                                                                                                                                    
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.53ms elapsed=28.67s                                       
                             tid=0x0000559a7a8db000 nid=0x17 in Object.wait()  [0x00007f35b93fe000]                                 
                                java.lang.Thread.State: WAITING (on object monitor)                                                 
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                          
                                     at                                                                                             
                             java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                       
                                                                                                                                    
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.45ms elapsed=28.67s                               
                             tid=0x0000559a7a8e4090 nid=0x18 waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.78ms elapsed=28.67s                                  
                             tid=0x0000559a7a8e5410 nid=0x19 runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.63ms elapsed=28.67s                        
                             tid=0x0000559a7a8e67f0 nid=0x1a runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1806.35ms elapsed=28.67s                           
                             tid=0x0000559a7a8e81f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                No compile task                                                                                     
                                                                                                                                    
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=822.17ms elapsed=28.67s                           
                             tid=0x0000559a7a8e96f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                No compile task                                                                                     
                                                                                                                                    
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=47.46ms elapsed=28.67s                                
                             tid=0x0000559a7a8eab30 nid=0x1d runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.15ms elapsed=28.65s                            
                             tid=0x0000559a7a927bf0 nid=0x21 runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.78ms elapsed=28.65s                                 
                             tid=0x0000559a7a92b160 nid=0x23 in Object.wait()  [0x00007f35b870c000]                                 
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                           
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x0000000089418388> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x0000000089418388> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                     
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                     at                                                                                             
                             jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                       
                                                                                                                                    
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.53s                                
                             tid=0x0000559a7aaa8300 nid=0x26 waiting on condition  [0x00007f35b84b1000]                             
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                     
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                               
                                     - parking to wait for  <0x000000008941e1f8> (a                                                 
                             java.util.concurrent.SynchronousQueue$TransferStack)                                                   
                                     at                                                                                             
                             java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252                 
                             )                                                                                                      
                                     at                                                                                             
                             java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/Synchron                 
                             ousQueue.java:401)                                                                                     
                                     at                                                                                             
                             java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                 
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.ja                 
                             va:1061)                                                                                               
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.                 
                             java:1122)                                                                                             
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor                 
                             .java:635)                                                                                             
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                                                                                                                    
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.74ms elapsed=28.41s                                
                             tid=0x00007f35a4000e70 nid=0x3c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.21ms elapsed=25.43s                                     
                             tid=0x0000559a7aff8900 nid=0x299 in Object.wait()  [0x00007f3563ab8000]                                
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                           
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x00000000f6418178> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x00000000f6418178> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                     
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                     at                                                                                             
                             jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                       
                                                                                                                                    
                             "VM Thread" os_prio=0 cpu=55.26ms elapsed=28.68s tid=0x0000559a7a8d5400 nid=0x15                       
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#0" os_prio=0 cpu=48.95ms elapsed=28.69s tid=0x0000559a7a7e5da0 nid=0x14                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#1" os_prio=0 cpu=46.36ms elapsed=27.61s tid=0x00007f35b4001570 nid=0x5c                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#2" os_prio=0 cpu=48.66ms elapsed=27.61s tid=0x00007f35b4001f70 nid=0x5d                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#3" os_prio=0 cpu=48.66ms elapsed=27.61s tid=0x00007f35b4002970 nid=0x5e                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#4" os_prio=0 cpu=44.02ms elapsed=27.61s tid=0x00007f35b4003370 nid=0x5f                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#5" os_prio=0 cpu=42.66ms elapsed=27.61s tid=0x00007f35b4003d70 nid=0x60                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#6" os_prio=0 cpu=45.23ms elapsed=27.61s tid=0x00007f35b4004770 nid=0x61                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#7" os_prio=0 cpu=44.74ms elapsed=27.61s tid=0x00007f35b4005170 nid=0x62                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#8" os_prio=0 cpu=43.87ms elapsed=27.61s tid=0x00007f35b4005b70 nid=0x63                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#9" os_prio=0 cpu=48.42ms elapsed=27.61s tid=0x00007f35b4006570 nid=0x64                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#10" os_prio=0 cpu=40.80ms elapsed=27.61s tid=0x00007f35b4006f70 nid=0x65                    
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#11" os_prio=0 cpu=43.24ms elapsed=27.61s tid=0x00007f35b4007970 nid=0x66                    
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#12" os_prio=0 cpu=40.02ms elapsed=27.61s tid=0x00007f35b4008760 nid=0x67                    
                             runnable                                                                                               
                                                                                                                                    
                             "VM Periodic Task Thread" os_prio=0 cpu=10.40ms elapsed=28.65s tid=0x0000559a7a929590                  
                             nid=0x22 waiting on condition                                                                          
                                                                                                                                    
                             JNI global refs: 20, weak refs: 0                                                                      
                                                                                                                                    
                                                                                                                                    
                             ===Evaluation Report===                                                                                
                             # Evaluation Report                                                                                    
                                                                                                                                    
                             ## Summary                                                                                             
                                                                                                                                    
                             A libFuzzer-based fuzzing run using Jazzer on the `PDFExtractTextFuzzer` harness                       
                             terminated with a timeout. The main thread remains in a RUNNABLE state deep inside                     
                             FontBoxs Type1 font parsing logic and never completes within the allotted time. This                  
                             suggests the fuzzer input triggered a hang or excessively long-running code path                       
                             during PDF text extraction.                                                                            
                                                                                                                                    
                             ## Description                                                                                         
                                                                                                                                    
                             - Issue                                                                                                
                               The fuzzer invocation (`PDFExtractTextFuzzer.fuzzerTestOneInput`) timed out. The                     
                             error message at the top of the log is:                                                                
                                 ERROR: libFuzzer: timeout                                                                        
                               No crash or exception is reportedonly that the fuzz target failed to finish within                  
                             the configured timeout window.                                                                         
                                                                                                                                    
                             - Vulnerability Type                                                                                   
                               While not an explicit memory safety flaw, this behavior indicates a potential                        
                             Denial-of-Service (DoS) scenario or infinite loop/hang in the font parsing or PDF                      
                             text-extraction code path.                                                                             
                                                                                                                                    
                             - Important Observations                                                                               
                                The sole non-daemon thread (main) is RUNNABLE and spending CPU time in                           
                             `com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Na                 
                             tive Method)`.                                                                                         
                                The Java stack trace shows repeated calls in the FontBox library:                                  
                                  `Type1Lexer.readToken`                                                                           
                                  `Type1Lexer.nextToken`                                                                           
                                  `Type1Parser.parseBinary` / `Type1Parser.parse`                                                  
                                  `Type1Font.createWithPFB`                                                                        
                                Control then flows into PDFBox constructors and processors:                                        
                                  `PDType1Font.<init>`                                                                             
                                  `PDFontFactory.createFont`                                                                       
                                  `PDResources.getFont`                                                                            
                                  `SetFontAndSize.process`                                                                         
                                  `PDFStreamEngine.processPage` / `PDFTextStripper.getText`                                        
                                The harness entry point is `PDFExtractTextFuzzer.fuzzerTestOneInput`, which                        
                             invokes PDFTextStripper on the mutated input. The harness simply feeds data to the                     
                             parser; it is not the root cause.                                                                      
                                                                                                                                    
                             - Code Areas to Investigate                                                                            
                               1. **FontBox Type1 Parsing**                                                                         
                                   `Type1Lexer.readToken` / `nextToken`                                                            
                                   `Type1Parser.parseBinary` and `parse` methods                                                   
                                   `Type1Font.createWithPFB` (handling of PFB streams)                                             
                               2. **PDFBox Font Loading**                                                                           
                                   `PDType1Font` constructor logic                                                                 
                                   `PDFontFactory.createFont` and `PDResources.getFont`                                            
                               3. **Text-Extraction Flow**                                                                          
                                   `SetFontAndSize.process` operator implementation                                                
                                   `PDFStreamEngine.processOperator` / `processPage`                                               
                                   `PDFTextStripper.processPages` / `getText`                                                      
                               4. **Jazzer Trace Callbacks**                                                                        
                                   Impact of `TraceDataFlowNativeCallbacks.traceConstCmpInt` on performance/hangs                  
                                                                                                                                    
                             These components collectively form the execution path that lead to the timeout. A full                 
                             investigation should instrument or log progress through the Type1 lexer/parser and                     
                             PDFBox stream engine to pinpoint the exact loop or blocking condition.                                 
                                                                                                                                    
                             ## Initial Issue Log                                                                                   
                             Here is the initial issue log of the codebase:                                                         
                             <issue>                                                                                                
                             ERROR: libFuzzer: timeout                                                                              
                             2025-11-04 07:56:27                                                                                    
                             Full thread dump OpenJDK 64-Bit Server VM (17.0.2+8-86 mixed mode, sharing):                           
                                                                                                                                    
                             Threads class SMR info:                                                                                
                             _java_thread_list=0x00007f35745cd9d0, length=14, elements={                                            
                             0x0000559a7a7ceb70, 0x0000559a7a8d9bf0, 0x0000559a7a8db000, 0x0000559a7a8e4090,                        
                             0x0000559a7a8e5410, 0x0000559a7a8e67f0, 0x0000559a7a8e81f0, 0x0000559a7a8e96f0,                        
                             0x0000559a7a8eab30, 0x0000559a7a927bf0, 0x0000559a7a92b160, 0x0000559a7aaa8300,                        
                             0x00007f35a4000e70, 0x0000559a7aff8900                                                                 
                             }                                                                                                      
                                                                                                                                    
                             "main" #1 prio=5 os_prio=0 cpu=26612.83ms elapsed=28.71s tid=0x0000559a7a7ceb70                        
                             nid=0x13 runnable  [0x00007fffc19d7000]                                                                
                                java.lang.Thread.State: RUNNABLE                                                                    
                                     at                                                                                             
                             com.code_intelligence.jazzer.runtime.TraceDataFlowNativeCallbacks.traceConstCmpInt(Nat                 
                             ive Method)                                                                                            
                                     at org.apache.fontbox.type1.Type1Lexer.readToken(Type1Lexer.java:123)                          
                                     at org.apache.fontbox.type1.Type1Lexer.nextToken(Type1Lexer.java:75)                           
                                     at org.apache.fontbox.type1.Type1Parser.parseBinary(Type1Parser.java:643)                      
                                     at org.apache.fontbox.type1.Type1Parser.parse(Type1Parser.java:71)                             
                                     at org.apache.fontbox.type1.Type1Font.createWithPFB(Type1Font.java:71)                         
                                     at org.apache.pdfbox.pdmodel.font.PDType1Font.<init>(PDType1Font.java:227)                     
                                     at                                                                                             
                             org.apache.pdfbox.pdmodel.font.PDFontFactory.createFont(PDFontFactory.java:140)                        
                                     at org.apache.pdfbox.pdmodel.PDResources.getFont(PDResources.java:170)                         
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.operator.text.SetFontAndSize.process(SetFontAndSize.ja                 
                             va:72)                                                                                                 
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processOperator(PDFStreamEngine.java:9                 
                             24)                                                                                                    
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStreamOperators(PDFStreamEngine                 
                             .java:557)                                                                                             
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processStream(PDFStreamEngine.java:515                 
                             )                                                                                                      
                                     at                                                                                             
                             org.apache.pdfbox.contentstream.PDFStreamEngine.processPage(PDFStreamEngine.java:158)                  
                                     at                                                                                             
                             org.apache.pdfbox.text.LegacyPDFStreamEngine.processPage(LegacyPDFStreamEngine.java:15                 
                             3)                                                                                                     
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPage(PDFTextStripper.java:378)                           
                                     at                                                                                             
                             org.apache.pdfbox.text.PDFTextStripper.processPages(PDFTextStripper.java:303)                          
                                     at org.apache.pdfbox.text.PDFTextStripper.writeText(PDFTextStripper.java:251)                  
                                     at org.apache.pdfbox.text.PDFTextStripper.getText(PDFTextStripper.java:218)                    
                                     at                                                                                             
                             com.example.PDFExtractTextFuzzer.fuzzerTestOneInput(PDFExtractTextFuzzer.java:41)                      
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$DMH/0x0000000800cbc000.invokeStaticInit(java.base@17.0.2/L                 
                             ambdaForm$DMH)                                                                                         
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$MH/0x0000000800cbd000.invoke(java.base@17.0.2/LambdaForm$M                 
                             H)                                                                                                     
                                     at                                                                                             
                             java.lang.invoke.LambdaForm$MH/0x0000000800cbc800.invoke_MT(java.base@17.0.2/LambdaFor                 
                             m$MH)                                                                                                  
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.runOne(FuzzTargetRunner.java:234)                 
                                     at                                                                                             
                             com.code_intelligence.jazzer.runtime.FuzzTargetRunnerNatives.startLibFuzzer(Native                     
                             Method)                                                                                                
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.j                 
                             ava:551)                                                                                               
                                     at                                                                                             
                             com.code_intelligence.jazzer.driver.FuzzTargetRunner.startLibFuzzer(FuzzTargetRunner.j                 
                             ava:441)                                                                                               
                                     at com.code_intelligence.jazzer.driver.Driver.start(Driver.java:166)                           
                                     at com.code_intelligence.jazzer.Jazzer.start(Jazzer.java:118)                                  
                                     at com.code_intelligence.jazzer.Jazzer.main(Jazzer.java:77)                                    
                                                                                                                                    
                             "Reference Handler" #2 daemon prio=10 os_prio=0 cpu=0.85ms elapsed=28.67s                              
                             tid=0x0000559a7a8d9bf0 nid=0x16 waiting on condition  [0x00007f35b9d02000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                     at java.lang.ref.Reference.waitForReferencePendingList(java.base@17.0.2/Native                 
                             Method)                                                                                                
                                     at                                                                                             
                             java.lang.ref.Reference.processPendingReferences(java.base@17.0.2/Reference.java:253)                  
                                     at                                                                                             
                             java.lang.ref.Reference$ReferenceHandler.run(java.base@17.0.2/Reference.java:215)                      
                                                                                                                                    
                             "Finalizer" #3 daemon prio=8 os_prio=0 cpu=0.53ms elapsed=28.67s                                       
                             tid=0x0000559a7a8db000 nid=0x17 in Object.wait()  [0x00007f35b93fe000]                                 
                                java.lang.Thread.State: WAITING (on object monitor)                                                 
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x0000000089416178> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:176)                          
                                     at                                                                                             
                             java.lang.ref.Finalizer$FinalizerThread.run(java.base@17.0.2/Finalizer.java:172)                       
                                                                                                                                    
                             "Signal Dispatcher" #4 daemon prio=9 os_prio=0 cpu=0.45ms elapsed=28.67s                               
                             tid=0x0000559a7a8e4090 nid=0x18 waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Service Thread" #5 daemon prio=9 os_prio=0 cpu=4.78ms elapsed=28.67s                                  
                             tid=0x0000559a7a8e5410 nid=0x19 runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Monitor Deflation Thread" #6 daemon prio=9 os_prio=0 cpu=0.63ms elapsed=28.67s                        
                             tid=0x0000559a7a8e67f0 nid=0x1a runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "C2 CompilerThread0" #7 daemon prio=9 os_prio=0 cpu=1806.35ms elapsed=28.67s                           
                             tid=0x0000559a7a8e81f0 nid=0x1b waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                No compile task                                                                                     
                                                                                                                                    
                             "C1 CompilerThread0" #15 daemon prio=9 os_prio=0 cpu=822.17ms elapsed=28.67s                           
                             tid=0x0000559a7a8e96f0 nid=0x1c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                No compile task                                                                                     
                                                                                                                                    
                             "Sweeper thread" #19 daemon prio=9 os_prio=0 cpu=47.46ms elapsed=28.67s                                
                             tid=0x0000559a7a8eab30 nid=0x1d runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Notification Thread" #20 daemon prio=9 os_prio=0 cpu=0.15ms elapsed=28.65s                            
                             tid=0x0000559a7a927bf0 nid=0x21 runnable  [0x0000000000000000]                                         
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Common-Cleaner" #21 daemon prio=8 os_prio=0 cpu=0.78ms elapsed=28.65s                                 
                             tid=0x0000559a7a92b160 nid=0x23 in Object.wait()  [0x00007f35b870c000]                                 
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                           
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x0000000089418388> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x0000000089418388> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                     
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                     at                                                                                             
                             jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                       
                                                                                                                                    
                             "process reaper" #22 daemon prio=10 os_prio=0 cpu=1.57ms elapsed=28.53s                                
                             tid=0x0000559a7aaa8300 nid=0x26 waiting on condition  [0x00007f35b84b1000]                             
                                java.lang.Thread.State: TIMED_WAITING (parking)                                                     
                                     at jdk.internal.misc.Unsafe.park(java.base@17.0.2/Native Method)                               
                                     - parking to wait for  <0x000000008941e1f8> (a                                                 
                             java.util.concurrent.SynchronousQueue$TransferStack)                                                   
                                     at                                                                                             
                             java.util.concurrent.locks.LockSupport.parkNanos(java.base@17.0.2/LockSupport.java:252                 
                             )                                                                                                      
                                     at                                                                                             
                             java.util.concurrent.SynchronousQueue$TransferStack.transfer(java.base@17.0.2/Synchron                 
                             ousQueue.java:401)                                                                                     
                                     at                                                                                             
                             java.util.concurrent.SynchronousQueue.poll(java.base@17.0.2/SynchronousQueue.java:903)                 
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor.getTask(java.base@17.0.2/ThreadPoolExecutor.ja                 
                             va:1061)                                                                                               
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor.runWorker(java.base@17.0.2/ThreadPoolExecutor.                 
                             java:1122)                                                                                             
                                     at                                                                                             
                             java.util.concurrent.ThreadPoolExecutor$Worker.run(java.base@17.0.2/ThreadPoolExecutor                 
                             .java:635)                                                                                             
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                                                                                                                    
                             "Attach Listener" #23 daemon prio=9 os_prio=0 cpu=5.74ms elapsed=28.41s                                
                             tid=0x00007f35a4000e70 nid=0x3c waiting on condition  [0x0000000000000000]                             
                                java.lang.Thread.State: RUNNABLE                                                                    
                                                                                                                                    
                             "Cleaner-0" #556 daemon prio=5 os_prio=0 cpu=0.21ms elapsed=25.43s                                     
                             tid=0x0000559a7aff8900 nid=0x299 in Object.wait()  [0x00007f3563ab8000]                                
                                java.lang.Thread.State: TIMED_WAITING (on object monitor)                                           
                                     at java.lang.Object.wait(java.base@17.0.2/Native Method)                                       
                                     - waiting on <0x00000000f6418178> (a java.lang.ref.ReferenceQueue$Lock)                        
                                     at                                                                                             
                             java.lang.ref.ReferenceQueue.remove(java.base@17.0.2/ReferenceQueue.java:155)                          
                                     - locked <0x00000000f6418178> (a java.lang.ref.ReferenceQueue$Lock)                            
                                     at jdk.internal.ref.CleanerImpl.run(java.base@17.0.2/CleanerImpl.java:140)                     
                                     at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)                                      
                                     at                                                                                             
                             jdk.internal.misc.InnocuousThread.run(java.base@17.0.2/InnocuousThread.java:162)                       
                                                                                                                                    
                             "VM Thread" os_prio=0 cpu=55.26ms elapsed=28.68s tid=0x0000559a7a8d5400 nid=0x15                       
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#0" os_prio=0 cpu=48.95ms elapsed=28.69s tid=0x0000559a7a7e5da0 nid=0x14                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#1" os_prio=0 cpu=46.36ms elapsed=27.61s tid=0x00007f35b4001570 nid=0x5c                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#2" os_prio=0 cpu=48.66ms elapsed=27.61s tid=0x00007f35b4001f70 nid=0x5d                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#3" os_prio=0 cpu=48.66ms elapsed=27.61s tid=0x00007f35b4002970 nid=0x5e                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#4" os_prio=0 cpu=44.02ms elapsed=27.61s tid=0x00007f35b4003370 nid=0x5f                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#5" os_prio=0 cpu=42.66ms elapsed=27.61s tid=0x00007f35b4003d70 nid=0x60                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#6" os_prio=0 cpu=45.23ms elapsed=27.61s tid=0x00007f35b4004770 nid=0x61                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#7" os_prio=0 cpu=44.74ms elapsed=27.61s tid=0x00007f35b4005170 nid=0x62                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#8" os_prio=0 cpu=43.87ms elapsed=27.61s tid=0x00007f35b4005b70 nid=0x63                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#9" os_prio=0 cpu=48.42ms elapsed=27.61s tid=0x00007f35b4006570 nid=0x64                     
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#10" os_prio=0 cpu=40.80ms elapsed=27.61s tid=0x00007f35b4006f70 nid=0x65                    
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#11" os_prio=0 cpu=43.24ms elapsed=27.61s tid=0x00007f35b4007970 nid=0x66                    
                             runnable                                                                                               
                                                                                                                                    
                             "GC Thread#12" os_prio=0 cpu=40.02ms elapsed=27.61s tid=0x00007f35b4008760 nid=0x67                    
                             runnable                                                                                               
                                                                                                                                    
                             "VM Periodic Task Thread" os_prio=0 cpu=10.40ms elapsed=28.65s tid=0x0000559a7a929590                  
                             nid=0x22 waiting on condition                                                                          
                                                                                                                                    
                             JNI global refs: 20, weak refs: 0                                                                      
                                                                                                                                    
                                                                                                                                    
                             </issue>                                                                                               
                             ===Analysis Report===                                                                                  
                             # Analysis Report                                                                                      
                                                                                                                                    
                             ## Relevant Code Snippets                                                                              
                             <code_snippets>                                                                                        
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java:1-120                                   
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one                                        
                             3: * or more contributor license agreements.  See the NOTICE file                                      
                             4: * distributed with this work for additional information                                             
                             5: * regarding copyright ownership.  The ASF licenses this file                                        
                             6: * to you under the Apache License, Version 2.0 (the                                                 
                             7: * "License"); you may not use this file except in compliance                                        
                             8: * with the License.  You may obtain a copy of the License at                                        
                             9: *                                                                                                   
                             10: * http://www.apache.org/licenses/LICENSE-2.0                                                       
                             11: *                                                                                                  
                             12: * Unless required by applicable law or agreed to in writing,                                       
                             13: * software distributed under the License is distributed on an                                      
                             14: * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY                                           
                             15: * KIND, either express or implied.  See the License for the                                        
                             16: * specific language governing permissions and limitations                                          
                             17: * under the License.                                                                               
                             18: */                                                                                                 
                             19:                                                                                                    
                             20:package org.apache.fontbox.type1;                                                                   
                             21:                                                                                                    
                             22:import java.io.IOException;                                                                         
                             23:import java.nio.BufferUnderflowException;                                                           
                             24:import java.nio.ByteBuffer;                                                                         
                             25:import org.apache.logging.log4j.Logger;                                                             
                             26:import org.apache.logging.log4j.LogManager;                                                         
                             27:/**                                                                                                 
                             28: * Lexer for the ASCII portions of an Adobe Type 1 font.                                            
                             29: *                                                                                                  
                             30: * @see Type1Parser                                                                                 
                             31: *                                                                                                  
                             32: * The PostScript language, of which Type 1 fonts are a subset, has a                               
                             33: * somewhat awkward lexical structure. It is neither regular nor                                    
                             34: * context-free, and the execution of the program can modify the                                    
                             35: * the behaviour of the lexer/parser.                                                               
                             36: *                                                                                                  
                             37: * Nevertheless, this class represents an attempt to artificially separate                          
                             38: * the PostScript parsing process into separate lexing and parsing phases                           
                             39: * in order to reduce the complexity of the parsing phase.                                          
                             40: *                                                                                                  
                             41: * @see "PostScript Language Reference 3rd ed, Adobe Systems (1999)"                                
                             42: *                                                                                                  
                             43: * @author John Hewson                                                                              
                             44: */                                                                                                 
                             45:class Type1Lexer                                                                                    
                             46:{                                                                                                   
                             47:    /**                                                                                             
                             48:     * Log instance.                                                                                
                             49:     */                                                                                             
                             50:    private static final Logger LOG = LogManager.getLogger(Type1Lexer.class);                       
                             51:                                                                                                    
                             52:    private final ByteBuffer buffer;                                                                
                             53:    private Token aheadToken;                                                                       
                             54:    private int openParens = 0;                                                                     
                             55:                                                                                                    
                             56:    /**                                                                                             
                             57:     * Constructs a new Type1Lexer given a header-less .pfb segment.                                
                             58:     * @param bytes Header-less .pfb segment                                                        
                             59:     * @throws IOException                                                                          
                             60:     */                                                                                             
                             61:    Type1Lexer(byte[] bytes) throws IOException                                                     
                             62:    {                                                                                               
                             63:        buffer = ByteBuffer.wrap(bytes);                                                            
                             64:        aheadToken = readToken(null);                                                               
                             65:    }                                                                                               
                             66:                                                                                                    
                             67:    /**                                                                                             
                             68:     * Returns the next token and consumes it.                                                      
                             69:     * @return The next token.                                                                      
                             70:     */                                                                                             
                             71:    public Token nextToken() throws IOException                                                     
                             72:    {                                                                                               
                             73:        Token curToken = aheadToken;                                                                
                             74:        //System.out.println(curToken); // for debugging                                            
                             75:        aheadToken = readToken(curToken);                                                           
                             76:        return curToken;                                                                            
                             77:    }                                                                                               
                             78:                                                                                                    
                             79:    /**                                                                                             
                             80:     * Returns the next token without consuming it.                                                 
                             81:     * @return The next token                                                                       
                             82:     */                                                                                             
                             83:    public Token peekToken()                                                                        
                             84:    {                                                                                               
                             85:        return aheadToken;                                                                          
                             86:    }                                                                                               
                             87:                                                                                                    
                             88:    /**                                                                                             
                             89:     * Checks if the kind of the next token equals the given one without consuming                  
                             it.                                                                                                    
                             90:     *                                                                                              
                             91:     * @return true if the kind of the next token equals the given one                              
                             92:     */                                                                                             
                             93:    public boolean peekKind(Token.Kind kind)                                                        
                             94:    {                                                                                               
                             95:        return aheadToken != null && aheadToken.getKind() == kind;                                  
                             96:    }                                                                                               
                             97:                                                                                                    
                             98:    /**                                                                                             
                             99:     * Reads an ASCII char from the buffer.                                                         
                             100:     */                                                                                            
                             101:    private char getChar() throws IOException                                                      
                             102:    {                                                                                              
                             103:        try                                                                                        
                             104:        {                                                                                          
                             105:            return (char) buffer.get();                                                            
                             106:        }                                                                                          
                             107:        catch (BufferUnderflowException exception)                                                 
                             108:        {                                                                                          
                             109:            throw new IOException("Premature end of buffer reached");                              
                             110:        }                                                                                          
                             111:    }                                                                                              
                             112:                                                                                                   
                             113:    /**                                                                                            
                             114:     * Reads a single token.                                                                       
                             115:     * @param prevToken the previous token                                                         
                             116:     */                                                                                            
                             117:    private Token readToken(Token prevToken) throws IOException                                    
                             118:    {                                                                                              
                             119:        boolean skip;                                                                              
                             120:        do                                                                                         
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java:1-200                                      
                             ```                                                                                                    
                             1:/*                                                                                                   
                             2: * Licensed to the Apache Software Foundation (ASF) under one or more                                
                             3: * contributor license agreements.  See the NOTICE file distributed with                             
                             4: * this work for additional information regarding copyright ownership.                               
                             5: * The ASF licenses this file to You under the Apache License, Version 2.0                           
                             6: * (the "License"); you may not use this file except in compliance with                              
                             7: * the License.  You may obtain a copy of the License at                                             
                             8: *                                                                                                   
                             9: *      http://www.apache.org/licenses/LICENSE-2.0                                                   
                             10: *                                                                                                  
                             11: * Unless required by applicable law or agreed to in writing, software                              
                             12: * distributed under the License is distributed on an "AS IS" BASIS,                                
                             13: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.                         
                             14: * See the License for the specific language governing permissions and                              
                             15: * limitations under the License.                                                                   
                             16: */                                                                                                 
                             17:package org.apache.fontbox.pfb;                                                                     
                             18:                                                                                                    
                             19:import java.io.ByteArrayInputStream;                                                                
                             20:import java.io.EOFException;                                                                        
                             21:import java.io.IOException;                                                                         
                             22:import java.io.InputStream;                                                                         
                             23:import java.nio.file.Files;                                                                         
                             24:import java.nio.file.Paths;                                                                         
                             25:import java.util.ArrayList;                                                                         
                             26:import java.util.Arrays;                                                                            
                             27:import java.util.List;                                                                              
                             28:import org.apache.logging.log4j.LogManager;                                                         
                             29:import org.apache.logging.log4j.Logger;                                                             
                             30:                                                                                                    
                             31:/**                                                                                                 
                             32: * Parser for a pfb-file.                                                                           
                             33: *                                                                                                  
                             34: * @author Ben Litchfield                                                                           
                             35: * @author Michael Niedermair                                                                       
                             36: */                                                                                                 
                             37:public class PfbParser                                                                              
                             38:{                                                                                                   
                             39:    private static final Logger LOG = LogManager.getLogger(PfbParser.class);                        
                             40:                                                                                                    
                             41:    /**                                                                                             
                             42:     * the pfb header length.                                                                       
                             43:     * (start-marker (1 byte), ascii-/binary-marker (1 byte), size (4 byte))                        
                             44:     * 3*6 == 18                                                                                    
                             45:     */                                                                                             
                             46:    private static final int PFB_HEADER_LENGTH = 18;                                                
                             47:                                                                                                    
                             48:    /**                                                                                             
                             49:     * the start marker.                                                                            
                             50:     */                                                                                             
                             51:    private static final int START_MARKER = 0x80;                                                   
                             52:                                                                                                    
                             53:    /**                                                                                             
                             54:     * the ascii marker.                                                                            
                             55:     */                                                                                             
                             56:    private static final int ASCII_MARKER = 0x01;                                                   
                             57:                                                                                                    
                             58:    /**                                                                                             
                             59:     * the binary marker.                                                                           
                             60:     */                                                                                             
                             61:    private static final int BINARY_MARKER = 0x02;                                                  
                             62:                                                                                                    
                             63:    /**                                                                                             
                             64:     * the EOF marker.                                                                              
                             65:     */                                                                                             
                             66:    private static final int EOF_MARKER = 0x03;                                                     
                             67:                                                                                                    
                             68:    /**                                                                                             
                             69:     * Heuristically chosen max length to buffer a Type1 font                                       
                             70:     */                                                                                             
                             71:    private static final long MAX_LENGTH = 100_000_000;                                             
                             72:                                                                                                    
                             73:    /**                                                                                             
                             74:     * the parsed pfb-data.                                                                         
                             75:     */                                                                                             
                             76:    private byte[] pfbdata;                                                                         
                             77:                                                                                                    
                             78:    /**                                                                                             
                             79:     * the lengths of the records (ASCII, BINARY, ASCII)                                            
                             80:     */                                                                                             
                             81:    private final int[] lengths = new int[3];                                                       
                             82:                                                                                                    
                             83:    // sample (pfb-file)                                                                            
                             84:    // 00000000 80 01 8b 15  00 00 25 21  50 53 2d 41  64 6f 62 65                                  
                             85:    //          ......%!PS-Adobe                                                                    
                             86:                                                                                                    
                             87:                                                                                                    
                             88:    /**                                                                                             
                             89:     * Create a new object.                                                                         
                             90:     * @param filename  the file name                                                               
                             91:     * @throws IOException if an IO-error occurs.                                                   
                             92:     */                                                                                             
                             93:    public PfbParser(final String filename) throws IOException                                      
                             94:    {                                                                                               
                             95:        this(Files.readAllBytes(Paths.get(filename)));                                              
                             96:    }                                                                                               
                             97:                                                                                                    
                             98:    /**                                                                                             
                             99:     * Create a new object.                                                                         
                             100:     * @param in   The input.                                                                      
                             101:     * @throws IOException if an IO-error occurs.                                                  
                             102:     */                                                                                            
                             103:    public PfbParser(final InputStream in) throws IOException                                      
                             104:    {                                                                                              
                             105:        byte[] pfb = in.readAllBytes();                                                            
                             106:        parsePfb(pfb);                                                                             
                             107:    }                                                                                              
                             108:                                                                                                   
                             109:    /**                                                                                            
                             110:     * Create a new object.                                                                        
                             111:     * @param bytes   The input.                                                                   
                             112:     * @throws IOException if an IO-error occurs.                                                  
                             113:     */                                                                                            
                             114:    public PfbParser(final byte[] bytes) throws IOException                                        
                             115:    {                                                                                              
                             116:        parsePfb(bytes);                                                                           
                             117:    }                                                                                              
                             118:                                                                                                   
                             119:    /**                                                                                            
                             120:     * Parse the pfb-array.                                                                        
                             121:     * @param pfb   The pfb-Array                                                                  
                             122:     * @throws IOException in an IO-error occurs.                                                  
                             123:     */                                                                                            
                             124:    private void parsePfb(final byte[] pfb) throws IOException                                     
                             125:    {                                                                                              
                             126:        if (pfb.length < PFB_HEADER_LENGTH)                                                        
                             127:        {                                                                                          
                             128:            throw new IOException("PFB header missing");                                           
                             129:        }                                                                                          
                             130:        // read into segments and keep them                                                        
                             131:        List<Integer> typeList = new ArrayList<>(3);                                               
                             132:        List<byte[]> barrList = new ArrayList<>(3);                                                
                             133:        ByteArrayInputStream in = new ByteArrayInputStream(pfb);                                   
                             134:        int total = 0;                                                                             
                             135:        do                                                                                         
                             136:        {                                                                                          
                             137:            int r = in.read();                                                                     
                             138:            if (r == -1 && total > 0)                                                              
                             139:            {                                                                                      
                             140:                break; // EOF                                                                      
                             141:            }                                                                                      
                             142:            if (r != START_MARKER)                                                                 
                             143:            {                                                                                      
                             144:                throw new IOException("Start marker missing");                                     
                             145:            }                                                                                      
                             146:            int recordType = in.read();                                                            
                             147:            if (recordType == EOF_MARKER)                                                          
                             148:            {                                                                                      
                             149:                break;                                                                             
                             150:            }                                                                                      
                             151:            if (recordType != ASCII_MARKER && recordType != BINARY_MARKER)                         
                             152:            {                                                                                      
                             153:                throw new IOException("Incorrect record type: " + recordType);                     
                             154:            }                                                                                      
                             155:                                                                                                   
                             156:            int size = in.read();                                                                  
                             157:            size += in.read() << 8;                                                                
                             158:            size += in.read() << 16;                                                               
                             159:            size += in.read() << 24;                                                               
                             160:            LOG.debug("record type: {}, segment size: {}", recordType, size);                      
                             161:            long newTotal = total + size;                                                          
                             162:            if (newTotal > MAX_LENGTH) {                                                           
                             163:                throw new IOException("record size would be too large: " +                         
                             newTotal);                                                                                             
                             164:            }                                                                                      
                             165:                                                                                                   
                             166:            byte[] ar = new byte[size];                                                            
                             167:            int got = in.read(ar);                                                                 
                             168:            if (got != size)                                                                       
                             169:            {                                                                                      
                             170:                throw new EOFException("EOF while reading PFB font");                              
                             171:            }                                                                                      
                             172:            total += size;                                                                         
                             173:            typeList.add(recordType);                                                              
                             174:            barrList.add(ar);                                                                      
                             175:        }                                                                                          
                             176:        while (true);                                                                              
                             177:                                                                                                   
                             178:        // We now have ASCII and binary segments. Lets arrange these so that the                   
                             ASCII segments                                                                                         
                             179:        // come first, then the binary segments, then the last ASCII segment if it                 
                             is                                                                                                     
                             180:        // 0000... cleartomark                                                                     
                             181:                                                                                                   
                             182:        pfbdata = new byte[total];                                                                 
                             183:        byte[] cleartomarkSegment = null;                                                          
                             184:        int dstPos = 0;                                                                            
                             185:                                                                                                   
                             186:        // copy the ASCII segments                                                                 
                             187:        for (int i = 0; i < typeList.size(); ++i)                                                  
                             188:        {                                                                                          
                             189:            if (typeList.get(i) != ASCII_MARKER)                                                   
                             190:            {                                                                                      
                             191:                continue;                                                                          
                             192:            }                                                                                      
                             193:            byte[] ar = barrList.get(i);                                                           
                             194:            if (i == typeList.size() - 1 && ar.length < 600 && new                                 
                             String(ar).contains("cleartomark"))                                                                    
                             195:            {                                                                                      
                             196:                cleartomarkSegment = ar;                                                           
                             197:                continue;                                                                          
                             198:            }                                                                                      
                             199:            System.arraycopy(ar, 0, pfbdata, dstPos, ar.length);                                   
                             200:            dstPos += ar.length;                                                                   
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:541-649                                
                             ```                                                                                                    
                             541:    private void parseBinary(byte[] bytes) throws IOException                                      
                             542:    {                                                                                              
                             543:        byte[] decrypted;                                                                          
                             544:        // Sometimes, fonts use the hex format, so this needs to be converted                      
                             before decryption                                                                                      
                             545:        if (isBinary(bytes))                                                                       
                             546:        {                                                                                          
                             547:            decrypted = decrypt(bytes, EEXEC_KEY, 4);                                              
                             548:        }                                                                                          
                             549:        else                                                                                       
                             550:        {                                                                                          
                             551:            decrypted = decrypt(hexToBinary(bytes), EEXEC_KEY, 4);                                 
                             552:        }                                                                                          
                             553:        lexer = new Type1Lexer(decrypted);                                                         
                             554:                                                                                                   
                             555:        // find /Private dict                                                                      
                             556:        Token peekToken = lexer.peekToken();                                                       
                             557:        while (peekToken != null && !"Private".equals(peekToken.getText()))                        
                             558:        {                                                                                          
                             559:            // for a more thorough validation, the presence of "begin" before                      
                             Private                                                                                                
                             560:            // determines how code before and following charstrings should look                    
                             561:            // it is not currently checked anyway                                                  
                             562:            lexer.nextToken();                                                                     
                             563:            peekToken = lexer.peekToken();                                                         
                             564:        }                                                                                          
                             565:        if (peekToken == null)                                                                     
                             566:        {                                                                                          
                             567:            throw new IOException("/Private token not found");                                     
                             568:        }                                                                                          
                             569:                                                                                                   
                             570:        // Private dict                                                                            
                             571:        read(Token.LITERAL, "Private");                                                            
                             572:        int length = read(Token.INTEGER).intValue();                                               
                             573:        read(Token.NAME, "dict");                                                                  
                             574:        // actually could also be "/Private 10 dict def Private begin"                             
                             575:        // instead of the "dup"                                                                    
                             576:        readMaybe(Token.NAME, "dup");                                                              
                             577:        read(Token.NAME, "begin");                                                                 
                             578:                                                                                                   
                             579:        int lenIV = 4; // number of random bytes at start of charstring                            
                             580:                                                                                                   
                             581:        for (int i = 0; i < length; i++)                                                           
                             582:        {                                                                                          
                             583:            // premature end                                                                       
                             584:            if (!lexer.peekKind(Token.LITERAL))                                                    
                             585:            {                                                                                      
                             586:                break;                                                                             
                             587:            }                                                                                      
                             588:                                                                                                   
                             589:            // key/value                                                                           
                             590:            String key = read(Token.LITERAL).getText();                                            
                             591:                                                                                                   
                             592:            switch (key)                                                                           
                             593:            {                                                                                      
                             594:                case "Subrs":                                                                      
                             595:                    readSubrs(lenIV);                                                              
                             596:                    break;                                                                         
                             597:                case "OtherSubrs":                                                                 
                             598:                    readOtherSubrs();                                                              
                             599:                    break;                                                                         
                             600:                case "lenIV":                                                                      
                             601:                    lenIV = readDictValue().get(0).intValue();                                     
                             602:                    break;                                                                         
                             603:                case "ND":                                                                         
                             604:                    read(Token.START_PROC);                                                        
                             605:                    // the access restrictions are not mandatory                                   
                             606:                    readMaybe(Token.NAME, "noaccess");                                             
                             607:                    read(Token.NAME, "def");                                                       
                             608:                    read(Token.END_PROC);                                                          
                             609:                    readMaybe(Token.NAME, "executeonly");                                          
                             610:                    readMaybe(Token.NAME, "readonly");                                             
                             611:                    read(Token.NAME, "def");                                                       
                             612:                    break;                                                                         
                             613:                case "NP":                                                                         
                             614:                    read(Token.START_PROC);                                                        
                             615:                    readMaybe(Token.NAME, "noaccess");                                             
                             616:                    read(Token.NAME);                                                              
                             617:                    read(Token.END_PROC);                                                          
                             618:                    readMaybe(Token.NAME, "executeonly");                                          
                             619:                    readMaybe(Token.NAME, "readonly");                                             
                             620:                    read(Token.NAME, "def");                                                       
                             621:                    break;                                                                         
                             622:                case "RD":                                                                         
                             623:                    // /RD {string currentfile exch readstring pop} bind                           
                             executeonly def                                                                                        
                             624:                    read(Token.START_PROC);                                                        
                             625:                    readProcVoid();                                                                
                             626:                    readMaybe(Token.NAME, "bind");                                                 
                             627:                    readMaybe(Token.NAME, "executeonly");                                          
                             628:                    readMaybe(Token.NAME, "readonly");                                             
                             629:                    read(Token.NAME, "def");                                                       
                             630:                    break;                                                                         
                             631:                default:                                                                           
                             632:                    readPrivate(key, readDictValue());                                             
                             633:                    break;                                                                         
                             634:            }                                                                                      
                             635:        }                                                                                          
                             636:                                                                                                   
                             637:        // some fonts have "2 index" here, others have "end noaccess put"                          
                             638:        // sometimes followed by "put". Either way, we just skip until                             
                             639:        // the /CharStrings dict is found                                                          
                             640:        while (!(lexer.peekKind(Token.LITERAL)                                                     
                             641:                && lexer.peekToken().getText().equals("CharStrings")))                             
                             642:        {                                                                                          
                             643:            lexer.nextToken();                                                                     
                             644:        }                                                                                          
                             645:                                                                                                   
                             646:        // CharStrings dict                                                                        
                             647:        read(Token.LITERAL, "CharStrings");                                                        
                             648:        readCharStrings(lenIV);                                                                    
                             649:    }                                                                                              
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:553-564                                
                             ```                                                                                                    
                             553:        lexer = new Type1Lexer(decrypted);                                                         
                             554:                                                                                                   
                             555:        // find /Private dict                                                                      
                             556:        Token peekToken = lexer.peekToken();                                                       
                             557:        while (peekToken != null && !"Private".equals(peekToken.getText()))                        
                             558:        {                                                                                          
                             559:            // for a more thorough validation, the presence of "begin" before                      
                             Private                                                                                                
                             560:            // determines how code before and following charstrings should look                    
                             561:            // it is not currently checked anyway                                                  
                             562:            lexer.nextToken();                                                                     
                             563:            peekToken = lexer.peekToken();                                                         
                             564:        }                                                                                          
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:637-650                                
                             ```                                                                                                    
                             637:        // some fonts have "2 index" here, others have "end noaccess put"                          
                             638:        // sometimes followed by "put". Either way, we just skip until                             
                             639:        // the /CharStrings dict is found                                                          
                             640:        while (!(lexer.peekKind(Token.LITERAL)                                                     
                             641:                && lexer.peekToken().getText().equals("CharStrings")))                             
                             642:        {                                                                                          
                             643:            lexer.nextToken();                                                                     
                             644:        }                                                                                          
                             645:                                                                                                   
                             646:        // CharStrings dict                                                                        
                             647:        read(Token.LITERAL, "CharStrings");                                                        
                             648:        readCharStrings(lenIV);                                                                    
                             649:    }                                                                                              
                             650:                                                                                                   
                             ```                                                                                                    
                             </code>                                                                                                
                             <code>                                                                                                 
                             fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:637-649                                
                             ```                                                                                                    
                             637:        // some fonts have "2 index" here, others have "end noaccess put"                          
                             638:        // sometimes followed by "put". Either way, we just skip until                             
                             639:        // the /CharStrings dict is found                                                          
                             640:        while (!(lexer.peekKind(Token.LITERAL)                                                     
                             641:                && lexer.peekToken().getText().equals("CharStrings")))                             
                             642:        {                                                                                          
                             643:            lexer.nextToken();                                                                     
                             644:        }                                                                                          
                             645:                                                                                                   
                             646:        // CharStrings dict                                                                        
                             647:        read(Token.LITERAL, "CharStrings");                                                        
                             648:        readCharStrings(lenIV);                                                                    
                             649:    }                                                                                              
                             ```                                                                                                    
                             </code>                                                                                                
                             </code_snippets>                                                                                       
                                                                                                                                    
                             ## Fix Strategy                                                                                        
                             <fix_strategy>                                                                                         
                                                                                                                                    
                             1. Identify and fix the unbounded skip-to-CharStrings loop in                                        
                             Type1Parser.parseBinary:                                                                               
                                - Root cause: After handling the Private dictionary, parseBinary uses                               
                                  ```                                                                                               
                                  while (!(lexer.peekKind(Token.LITERAL)                                                            
                                       && lexer.peekToken().getText().equals("CharStrings")))                                       
                                  {                                                                                                 
                                      lexer.nextToken();                                                                            
                                  }                                                                                                 
                                  ```                                                                                               
                                  This loop has no termination check for end-of-data. If a malformed or truncated                   
                             font never produces the CharStrings literal, the loop never exits, leading to an                     
                             apparent hang (or extremely long running time) even though eventually peekToken would                  
                             go null.                                                                                               
                             2. Proposed patch steps:                                                                               
                                a. Add a null-token break condition:                                                                
                                   - Change the loop to also break when peekToken()==null.                                          
                                   - For example:                                                                                   
                                     ```                                                                                            
                                     Token t;                                                                                       
                                     while ((t = lexer.peekToken()) != null                                                         
                                            && !(t.getKind() == Token.Kind.LITERAL                                                  
                                                 && "CharStrings".equals(t.getText())))                                             
                                     {                                                                                              
                                         lexer.nextToken();                                                                         
                                     }                                                                                              
                                     if (t == null)                                                                                 
                                     {                                                                                              
                                         throw new IOException("/CharStrings token not found");                                     
                                     }                                                                                              
                                     ```                                                                                            
                                   - This guarantees the loop cannot run past EOF without either finding                            
                             CharStrings or throwing an error.                                                                    
                                b. Symmetrically, ensure that later code reads the expected /CharStrings literal                    
                             only after confirming t!=null:                                                                         
                                   - Replace the existing `read(Token.LITERAL, "CharStrings");` with the above                      
                             guarded logic, then proceed to readCharStrings(lenIV).                                                 
                             3. Preserve existing functionality:                                                                    
                                - On well-formed fonts, nothing changes: the loop will iterate until CharStrings                  
                             is found, exactly as before.                                                                           
                                - On malformed or adversarial inputs, instead of infinite looping, parseBinary will                 
                             promptly abort with an IOException and return control to PDFBoxs font-loading code,                   
                             which will skip or fail that font gracefully.                                                          
                             4. Side-effects and mitigation:                                                                        
                                - Fuzzer harness (PDFExtractTextFuzzer) expects IOExceptions on invalid inputs, and                 
                             PDFBox already catches and continues when font parsing fails.                                          
                                - Downstream logic in PDFontFactory.createFont and SetFontAndSize.process will                      
                             catch and ignore parsing exceptions for individual fonts.                                              
                                - No new exceptions leak to production use beyond the existing /CharStrings token                  
                             not found IOException.                                                                                
                             5. Justification:                                                                                      
                                - The missing null check is the minimal, direct fix that prevents an infinite loop                  
                             when an expected PostScript token is absent.                                                           
                                - Similar null-check patterns already protect the /Private search loop earlier in                 
                             the method (lines 557567).                                                                            
                                - This approach aligns with existing PDFBox behavior (abort on missing structures)                  
                             and does not alter harness, fuzzing logic, or utility functions.                                       
                             <code_range>fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java:637-649</c                 
                             ode_range>                                                                                             
                                                                                                                                    
                             </fix_strategy>                                                                                        
                             ===Tests Result===                                                                                     
                             No tests found                                                                                         
                             ===Evaluation End===                                                                                   
                    INFO     Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                         __init__.py:160
                             (n evals: 2, patch status: PatchStatus.SOUND)                                                          
                    INFO     Building environment                                                                    __init__.py:132
                             - Cache directory: /tmp/tmprxynlyqd                                                                    
                             - Max timeout: 1800                                                                                    
                             - Output directory:                                                                                    
                             reports/prism.prism_o4_mini/pdfbox_pdfbox-full-01_vuln_4/agent-output-1762243223.167664                
                             - Detection toml file:                                                                                 
                             /tasks_new/pdfbox_pdfbox-full-01/detection/pdfbox_pdfbox-full-01_vuln_4.toml                           
                             - Challenge project directory: /tasks_new/pdfbox_pdfbox-full-01/official-afc-pdfbox                    
                                                                                                                                    
