{
  "project_name": "xz",
  "vulnerability_identifier": "xz_xz-full-01_xz-001",
  "source_directory": "/tasks_new/xz_xz-full-01/official-afc-xz",
  "llm_usage": {
    "total_cost": 0.14141930000000003,
    "prompt_tokens": 78923,
    "completion_tokens": 12410
  },
  "variant": "sound",
  "diff": "--- a/src/liblzma/check/treeck.c\n+++ b/src/liblzma/check/treeck.c\n@@ -63,9 +63,10 @@\n }\n \n // Walk the tree to calculate the e37vk checksum\n-static uint32_t compute_tree_checksum(TreeNode *node, unsigned int depth)\n+static uint32_t\n+compute_tree_checksum(TreeNode *node, unsigned int depth)\n {\n-  // Skip if already hashed\n+  // Skip if null or already fully hashed\n   if (!node || node->state == STATE_HASHED) {\n     return 0;\n   }\n@@ -73,7 +74,7 @@\n   // Compute initial checksum from depth and value\n   uint32_t sum = node->value * (depth + 1);\n \n-  // Traverse the child nodes if not already visited\n+  // Only traverse and free on first visit\n   if (node->state == STATE_CLEAR) {\n     node->state = STATE_VISITED;\n     for (size_t i = 0; i < node->edge_count; ++i) {\n@@ -83,11 +84,11 @@\n       }\n     }\n     node->state = STATE_HASHED;\n+\n+    // Free memory exactly once\n+    free(node->edges);\n+    free(node);\n   }\n-\n-  // Free the node and edges\n-  free(node->edges);\n-  free(node);\n \n   return sum;\n }\n",
  "stdout": "",
  "stderr": ""
}