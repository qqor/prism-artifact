--- a/epan/dissectors/packet-telnet.c
+++ b/epan/dissectors/packet-telnet.c
@@ -2007,6 +2007,8 @@
 telnet_sub_option(packet_info *pinfo, proto_tree *option_tree, proto_item *option_item, tvbuff_t *tvb, int start_offset)
 {
   int           offset = start_offset;
+  /* Prevent premature free of NAWS data; defer free to end of dissect_telnet */
+  hf_telnet_naws_subopt_set = 0;
   uint8_t       opt_byte;
   const tn_opt *opt;
   int           subneg_len;
@@ -2274,6 +2276,12 @@
 static int
 dissect_telnet(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)
 {
+  /* Initialize NAWS state to avoid use-after-free */
+  hf_telnet_naws_subopt_set = 0;
+  hf_telnet_line = 0;
+  hf_telnet_width = 0;
+  hf_telnet_height = 0;
+  hf_naws_data = NULL;
   proto_tree *telnet_tree, *ti;
   tvbuff_t   *next_tvb;
   int         offset    = 0;
@@ -2339,6 +2347,12 @@
       break;
     }
   }
+  if (hf_telnet_naws_subopt_set && hf_naws_data) {
+    wmem_free(pinfo->pool, hf_naws_data);
+    hf_telnet_naws_subopt_set = 0;
+    hf_telnet_line = 0;
+    hf_naws_data = NULL;
+  }
   return tvb_captured_length(tvb);
 }
 
