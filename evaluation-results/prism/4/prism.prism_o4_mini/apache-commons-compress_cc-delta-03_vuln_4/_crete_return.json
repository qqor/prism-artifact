{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-delta-03_vuln_4",
  "source_directory": "/home/user/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 0.13719420000000002,
    "prompt_tokens": 67602,
    "completion_tokens": 14280
  },
  "variant": "sound",
  "diff": "--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n@@ -219,8 +219,7 @@\n      * </p>\n      */\n     private static final Pattern PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN =\n-            Pattern.compile(\"-?\\\\d{1,19}(?:\\\\.\\\\d*)?\");\n-\n+            Pattern.compile(\"-?\\\\d{1,19}(?:\\\\.\\\\d{0,9})?\");\n     private static FileTime fileTimeFromOptionalSeconds(final long seconds) {\n         return seconds <= 0 ? null : FileTimes.fromUnixTime(seconds);\n     }\n@@ -271,15 +270,37 @@\n         if (!PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN.matcher(value).matches()) {\n             throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\");\n         }\n-\n-        final BigDecimal epochSeconds = new BigDecimal(value);\n-        final long seconds = epochSeconds.longValue();\n-        final long nanos = epochSeconds.remainder(BigDecimal.ONE).movePointRight(9).longValue();\n+        String[] parts = value.split(\"\\\\.\", 2);\n+        String secondsPart = parts[0];\n+        String fractionPart = parts.length > 1 ? parts[1] : \"\";\n+        long seconds;\n+        try {\n+            seconds = Long.parseLong(secondsPart);\n+        } catch (NumberFormatException e) {\n+            throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\", e);\n+        }\n+        // Trim or pad fraction to exactly 9 digits\n+        if (fractionPart.length() > 9) {\n+            fractionPart = fractionPart.substring(0, 9);\n+        } else {\n+            fractionPart = String.format(\"%-9s\", fractionPart).replace(' ', '0');\n+        }\n+        long nanos;\n+        if (fractionPart.isEmpty()) {\n+            nanos = 0L;\n+        } else {\n+            try {\n+                nanos = Long.parseLong(fractionPart);\n+            } catch (NumberFormatException e) {\n+                throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\", e);\n+            }\n+        }\n+        if (value.charAt(0) == '-') {\n+            nanos = -nanos;\n+        }\n         try {\n             return Instant.ofEpochSecond(seconds, nanos);\n         } catch (DateTimeException | ArithmeticException e) {\n-            // DateTimeException: Thrown if the instant exceeds the maximum or minimum instant.\n-            // ArithmeticException: Thrown if numeric overflow occurs.\n             throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\", e);\n         }\n     }\n",
  "stdout": "",
  "stderr": ""
}