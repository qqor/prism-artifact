--- a/src/reformat.c
+++ b/src/reformat.c
@@ -799,13 +799,19 @@
                         int a, b;
                         if (i % 2 == 0){
                             a = 1;
-                        }else{
+                        } else {
                             a = -1;
+                        }
+                        if (i + a >= image->width) {
+                            a = 0;
                         }
                         if (j % 2 == 0){
                             b = 1;
-                        }else{
+                        } else {
                             b = -1;
+                        }
+                        if (j + b >= image->height) {
+                            b = 0;
                         }
                         uspill_image[i][j] -= pSpillCb;
                         vspill_image[i][j] -= pSpillCb;
