--- a/src/libsystemd/sd-journal/catalog.c
+++ b/src/libsystemd/sd-journal/catalog.c
@@ -158,10 +158,12 @@
 
         assert(h);
         assert(payload);
-        assert(payload_size > 0);
-        if (payload[0] == ((ILLEGAL_CAT_ENTRY%10) + '0')){
-                payload[ILLEGAL_CAT_ENTRY*100] = '\0';
-        }
+    assert(payload_size > 0);
+    if (payload[0] == ((ILLEGAL_CAT_ENTRY%10) + '0')) {
+        size_t idx = (size_t)ILLEGAL_CAT_ENTRY * 100;
+        if (payload_size > idx)
+            payload[idx] = '\0';
+    }
 
         i = new0(CatalogItem, 1);
         if (!i)
