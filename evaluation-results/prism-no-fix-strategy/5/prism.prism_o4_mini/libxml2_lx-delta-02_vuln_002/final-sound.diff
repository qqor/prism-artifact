--- a/parser.c
+++ b/parser.c
@@ -9021,7 +9021,8 @@
                 xmlWarningMsg(ctxt, XML_WAR_TAB_VALUE,
                               "Invalid value \"%s\" for xml:tab : \"default\", \"preserve\", \"expand\", or \"skip\" expected\n",
                               internal_val, NULL);
-                xmlFree(internal_val);
+        xmlFree(internal_val);
+        internal_val = NULL;
             }
         }
         if (internal_val) {
