{
  "project_name": "xz",
  "vulnerability_identifier": "xz_xz-full-01_xz-001",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-xz",
  "llm_usage": {
    "total_cost": 0.3657621000000001,
    "prompt_tokens": 195279,
    "completion_tokens": 34308
  },
  "variant": "sound",
  "diff": "--- a/src/liblzma/check/treeck.c\n+++ b/src/liblzma/check/treeck.c\n@@ -86,10 +86,27 @@\n   }\n \n   // Free the node and edges\n-  free(node->edges);\n-  free(node);\n+      // free(node->edges);  // deferred freeing removed to prevent use-after-free\n+      // free(node);         // deferred freeing removed to prevent use-after-free\n \n   return sum;\n+} /* compute_tree_checksum */\n+\n+/* Recursively free the tree structure, skipping cycles via parent pointer */\n+static void\n+free_tree(TreeNode *node, TreeNode *parent)\n+{\n+    if (!node)\n+        return;\n+\n+    for (size_t i = 0; i < node->edge_count; ++i) {\n+        TreeNode *child = node->edges[i];\n+        if (child && child != parent)\n+            free_tree(child, node);\n+    }\n+\n+    free(node->edges);\n+    free(node);\n }\n \n extern LZMA_API(uint32_t)\n@@ -98,6 +115,7 @@\n   unsigned long seed = hash_data(buf, size);\n   TreeNode *root = create_tree(buf, size, 0, 16, seed, NULL);\n   checksum ^= compute_tree_checksum(root, 0);\n+  free_tree(root, NULL);\n   return checksum;\n }\n \n",
  "stdout": "",
  "stderr": ""
}