--- a/epan/dissectors/packet-openvpn.c
+++ b/epan/dissectors/packet-openvpn.c
@@ -309,9 +309,15 @@
 
     wkc_len = tvb_get_ntohs(tvb, tvb_reported_length(tvb) - 2);
     data_len = msg_length_remaining - wkc_len;
-    tvb_memcpy(tvb, buf, offset, data_len);
-    if (!strcmp((char*)&buf[0], "OpenVPN"))
-        return 0;
+            {
+                /* limit copy to buf size to avoid overflow */
+                int copy_len = data_len < (int)sizeof(buf) - 1 ? data_len : sizeof(buf) - 1;
+                tvb_memcpy(tvb, buf, offset, copy_len);
+                buf[copy_len] = '\0';
+            }
+            /* check prefix safely */
+            if (!strncmp((char *)buf, "OpenVPN", 7))
+                return 0;
   }
 
   if (openvpn_opcode != P_CONTROL_V1) {
