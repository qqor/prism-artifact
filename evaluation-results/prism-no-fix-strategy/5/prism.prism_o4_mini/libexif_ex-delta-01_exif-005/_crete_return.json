{
  "project_name": "libexif",
  "vulnerability_identifier": "libexif_ex-delta-01_exif-005",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-libexif",
  "llm_usage": {
    "total_cost": 0.2982661,
    "prompt_tokens": 172431,
    "completion_tokens": 24680
  },
  "variant": "sound",
  "diff": "--- a/libexif/apple/exif-mnote-data-apple.c\n+++ b/libexif/apple/exif-mnote-data-apple.c\n@@ -62,7 +62,13 @@\n \n     /*printf(\"%s\\n\", __FUNCTION__);*/\n \n-    if (!d || !buf || (buf_size < 6 + 16)) {\n+    if (!d || !buf) {\n+        exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,\n+                 \"ExifMnoteDataApple\", \"Short MakerNote\");\n+        return;\n+    }\n+    size_t min_header = d->offset + 6 + 16;\n+    if (buf_size < min_header) {\n         exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,\n                  \"ExifMnoteDataApple\", \"Short MakerNote\");\n         return;\n@@ -85,10 +91,10 @@\n     tcount = (unsigned int) exif_get_short(buf + ofs + 14, d->order);\n \n     /* Sanity check the offset */\n-    if (buf_size < 6 + 16 + tcount * 6 + 4) {\n+    size_t min_size = d->offset + 6 + 16 + tcount * 12 + 4;\n+    if (buf_size < min_size) {\n         exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,\n                  \"ExifMnoteDataApple\", \"Short MakerNote\");\n-        /*printf(\"%s(%d)\\n\", __FUNCTION__, __LINE__);*/\n         return;\n     }\n \n",
  "stdout": "",
  "stderr": ""
}