{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_4",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.6520932,
    "prompt_tokens": 542956,
    "completion_tokens": 12464
  },
  "variant": "sound",
  "diff": "--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n@@ -637,14 +637,18 @@\n         // some fonts have \"2 index\" here, others have \"end noaccess put\"\n         // sometimes followed by \"put\". Either way, we just skip until\n         // the /CharStrings dict is found\n-        while (!(lexer.peekKind(Token.LITERAL)\n-                && lexer.peekToken().getText().equals(\"CharStrings\")))\n-        {\n-            lexer.nextToken();\n-        }\n-\n-        // CharStrings dict\n-        read(Token.LITERAL, \"CharStrings\");\n+            int tokenCount = 0;\n+            final int MAX_BINARY_TOKEN_COUNT = 10000;\n+            while (!(lexer.peekKind(Token.LITERAL)\n+                    && lexer.peekToken().getText().equals(\"CharStrings\"))) {\n+                if (++tokenCount > MAX_BINARY_TOKEN_COUNT) {\n+                    throw new IOException(\"Too many tokens consuming PFB binary section\");\n+                }\n+                lexer.nextToken();\n+            }\n+\n+            // CharStrings dict\n+            read(Token.LITERAL, \"CharStrings\");\n         readCharStrings(lenIV);\n     }\n \n",
  "stdout": "",
  "stderr": ""
}