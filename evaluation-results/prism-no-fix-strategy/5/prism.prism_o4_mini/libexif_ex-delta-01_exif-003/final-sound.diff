--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -236,15 +236,15 @@
 int
 exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e) {
     int variant;
-
-    if (!strcmp((const char *) e->data, "Apple iOS")) {
-        variant = 1;
-    } else {
-        variant = 0;
-    }
-
-    return variant;
-}
+     /* safe comparison: ensure buffer holds literal before comparing */
+     if (e->size >= 9 && memcmp((const char *) e->data, "Apple iOS", 9) == 0) {
+         variant = 1;
+     } else {
+         variant = 0;
+     }
+
+     return variant;
+ }
 
 ExifMnoteData *
 exif_mnote_data_apple_new(ExifMem *mem) {
