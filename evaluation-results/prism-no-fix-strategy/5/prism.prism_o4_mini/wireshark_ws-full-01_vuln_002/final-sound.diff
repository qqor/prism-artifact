--- a/epan/dissectors/packet-telnet.c
+++ b/epan/dissectors/packet-telnet.c
@@ -633,11 +633,11 @@
 }
 
 static void
-dissect_linemode_subopt(packet_info *pinfo, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,
-                    int len _U_, proto_tree *tree _U_, proto_item *item _U_)
-{
-  if ( hf_telnet_naws_subopt_set )
-    wmem_free(pinfo->pool, hf_naws_data);
+dissect_linemode_subopt(packet_info *pinfo _U_, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,
+                         int len _U_, proto_tree *tree _U_, proto_item *item _U_)
+{
+    if (hf_telnet_naws_subopt_set)
+        /* hf_naws_data will be freed at protocol cleanup; do not free here */;
 
   return;
 }
