{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_7",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 1.0313996,
    "prompt_tokens": 823556,
    "completion_tokens": 28520
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n@@ -258,30 +258,20 @@\n             xhtml.startElement(\"a\", \"href\", url);\n             xhtml.characters(name);\n             xhtml.endElement(\"a\");\n-            processURL(url, name, xhtml, metadata, context);\n+            // Disabled network fetch to prevent SSRF\n+            // processURL(url, name, xhtml, metadata, context);\n         } else {\n             xhtml.characters(cellContent);\n         }\n         xhtml.endElement(TD);\n     }\n \n-    private void processURL(String urlString, String name, XHTMLContentHandler xhtml,\n+    private void processURL(String urlString, String name,\n+                            XHTMLContentHandler xhtml,\n                             Metadata parentMetadata,\n-                            ParseContext context) throws IOException, SAXException {\n-        EmbeddedDocumentExtractor ex = EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context);\n-        Metadata metadata = new Metadata();\n-        metadata.set(TikaCoreProperties.RESOURCE_NAME_KEY, name);\n-        try {\n-            URL url = new URL(urlString);\n-            URLConnection connection = url.openConnection();\n-            connection.setConnectTimeout(5000);\n-            try (TikaInputStream tis = TikaInputStream.get(connection.getInputStream())) {\n-                ex.parseEmbedded(tis, xhtml, metadata, false);\n-            }\n-        } catch (Exception e) {\n-            parentMetadata.set(TikaCoreProperties.EMBEDDED_EXCEPTION,\n-                    ExceptionUtils.getStackTrace(e));\n-        }\n+                            ParseContext context)\n+            throws IOException, SAXException {\n+        // Disabled to avoid external network calls from untrusted input (prevent SSRF)\n     }\n \n \n",
  "stdout": "",
  "stderr": ""
}