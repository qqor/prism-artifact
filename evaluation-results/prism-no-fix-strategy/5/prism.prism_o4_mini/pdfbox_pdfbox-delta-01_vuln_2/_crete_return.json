{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-delta-01_vuln_2",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.2382897,
    "prompt_tokens": 162735,
    "completion_tokens": 13473
  },
  "variant": "sound",
  "diff": "--- a/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java\n@@ -155,15 +155,23 @@\n     }\n \n     private String runTesseract(Path image) throws IOException {\n-        String actualTessPath = pdDocument.getDocumentInformation()\n-                .getCustomMetadataValue(TESSERACT_PATH_KEY);\n-        if (actualTessPath == null || actualTessPath.isEmpty()) {\n-            actualTessPath = tesseractPath;\n-        }\n-\n-        Path txt = Paths.get(image.toAbsolutePath().toString());\n-        doOCR(actualTessPath, image, txt);\n-        return extractContent(txt);\n+    String actualTessPath = pdDocument.getDocumentInformation()\n+        .getCustomMetadataValue(TESSERACT_PATH_KEY);\n+    if (actualTessPath == null || actualTessPath.isEmpty()) {\n+        actualTessPath = tesseractPath;\n+    }\n+    // Validate the tesseract path to prevent OS command injection\n+    Path tessPath = Paths.get(actualTessPath);\n+    if (!tessPath.isAbsolute()) {\n+        tessPath = tessPath.toAbsolutePath();\n+    }\n+    if (!Files.exists(tessPath) || !Files.isExecutable(tessPath)) {\n+        throw new IOException(\"Invalid Tesseract path: \" + actualTessPath);\n+    }\n+    String validatedTessPath = tessPath.toString();\n+    Path txt = Paths.get(image.toAbsolutePath().toString());\n+    doOCR(validatedTessPath, image, txt);\n+    return extractContent(txt);\n     }\n \n     private String extractContent(Path base) throws IOException {\n",
  "stdout": "",
  "stderr": ""
}