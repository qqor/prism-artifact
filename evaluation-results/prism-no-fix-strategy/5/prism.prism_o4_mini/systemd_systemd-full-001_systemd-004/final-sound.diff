--- a/src/shared/condition.c
+++ b/src/shared/condition.c
@@ -97,10 +97,19 @@
 }
 
 Condition* condition_free_list_type(Condition *head, ConditionType type) {
-        LIST_FOREACH(conditions, c, head)
-                if (type < 0 || c->type == type) {
-                        condition_free(c);
-                }
+        Condition *c, *prev = NULL, *next;
+        for (c = head; c; c = next) {
+            next = c->conditions_next;
+            if (type < 0 || c->type == type) {
+                condition_free(c);
+                if (prev)
+                    prev->conditions_next = next;
+                else
+                    head = next;
+            } else {
+                prev = c;
+            }
+        }
 
         assert(type >= 0 || !head);
         return head;
