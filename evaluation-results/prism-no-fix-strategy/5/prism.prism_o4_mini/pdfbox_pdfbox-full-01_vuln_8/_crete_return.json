{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_8",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 2.7392464,
    "prompt_tokens": 2187140,
    "completion_tokens": 75771
  },
  "variant": "sound",
  "diff": "--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/BaseParser.java\n@@ -57,7 +57,8 @@\n      * Log instance.\n      */\n     private static final Logger LOG = LogManager.getLogger(BaseParser.class);\n-\n+    private static final int MAX_SKIP_SPACE_LENGTH = 1000;\n+    private int skipSpaceBudget = MAX_SKIP_SPACE_LENGTH;\n     private static final long OBJECT_NUMBER_THRESHOLD = 10000000000L;\n \n     private static final long GENERATION_NUMBER_THRESHOLD = 65535;\n@@ -1319,14 +1320,19 @@\n     protected void skipSpaces() throws IOException\n     {\n         int c = source.read();\n-        // 37 is the % character, a comment\n-        while( isWhitespace(c) || c == 37)\n-        {\n-            if ( c == 37 )\n+        // skip up to MAX_SKIP_SPACE_LENGTH spaces/comments across all calls\n+        while (isWhitespace(c) || c == 37)\n+        {\n+            if (--skipSpaceBudget < 0)\n+            {\n+                source.rewind(1);\n+                return;\n+            }\n+            if (c == 37)\n             {\n                 // skip past the comment section\n                 c = source.read();\n-                while(!isEOL(c) && c != -1)\n+                while (!isEOL(c) && c != -1)\n                 {\n                     c = source.read();\n                 }\n",
  "stdout": "",
  "stderr": ""
}