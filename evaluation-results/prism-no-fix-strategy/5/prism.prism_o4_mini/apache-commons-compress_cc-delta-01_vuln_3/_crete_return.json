{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-delta-01_vuln_3",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 0.5908726999999999,
    "prompt_tokens": 415345,
    "completion_tokens": 30453
  },
  "variant": "sound",
  "diff": "--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n@@ -270,27 +270,38 @@\n     private static Instant parseInstantFromDecimalSeconds(final String key,\n                                                           final String value) throws IOException {\n \n-        // Validate field values to prevent denial of service attacks with BigDecimal values (see JDK-6560193)\n-        Matcher fileTimesMatcher = PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN.matcher(value);\n-        if (! fileTimesMatcher.matches()) {\n-            throw new IOException(\n-                    \"Corrupted PAX header. Time field value is invalid '\" + value + \"'\");\n-        }\n-        //As with the check above, exponents should not be allowed.\n-        if (value.contains(\"e\") || value.contains(\"E\")) {\n-            throw new IOException(\n-                    \"Corrupted PAX header. Time field value is invalid '\" + value + \"'\");\n-        }\n-\n-        final BigDecimal epochSeconds = new BigDecimal(value);\n-        final long seconds = epochSeconds.longValue();\n-        final long nanos = epochSeconds.remainder(BigDecimal.ONE).movePointRight(9).longValue();\n+        // Validate PAX time field: optional leading '-', digits, optional single '.', up to 9 fractional digits\n+        String val = value;\n+        if (val.startsWith(\"-\")) {\n+            val = val.substring(1);\n+        }\n+        String[] parts = val.split(\"\\\\.\", -1);\n+        if (parts.length == 0 || parts.length > 2) {\n+            throw new IOException(\"Corrupt PAX header. Time field value is invalid '\" + value + \"'\");\n+        }\n+        String intPart = parts[0];\n+        String fracPart = parts.length == 2 ? parts[1] : \"\";\n+        if (intPart.length() < 1 || intPart.length() > 19 || fracPart.length() > 9) {\n+            throw new IOException(\"Corrupt PAX header. Time field value is invalid '\" + value + \"'\");\n+        }\n+        // ensure all characters are digits\n+        for (char c : intPart.toCharArray()) {\n+            if (!Character.isDigit(c)) {\n+                throw new IOException(\"Corrupt PAX header. Time field value is invalid '\" + value + \"'\");\n+            }\n+        }\n+        for (char c : fracPart.toCharArray()) {\n+            if (!Character.isDigit(c)) {\n+                throw new IOException(\"Corrupt PAX header. Time field value is invalid '\" + value + \"'\");\n+            }\n+        }\n         try {\n+            BigDecimal epochSeconds = new BigDecimal(value);\n+            long seconds = epochSeconds.longValue();\n+            long nanos = epochSeconds.remainder(BigDecimal.ONE).movePointRight(9).longValue();\n             return Instant.ofEpochSecond(seconds, nanos);\n-        } catch (DateTimeException | ArithmeticException e) {\n-            // DateTimeException: Thrown if the instant exceeds the maximum or minimum instant.\n-            // ArithmeticException: Thrown if numeric overflow occurs.\n-            throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\", e);\n+        } catch (NumberFormatException | DateTimeException | ArithmeticException e) {\n+            throw new IOException(\"Corrupt PAX header. Time field value is invalid '\" + value + \"'\", e);\n         }\n     }\n \n",
  "stdout": "",
  "stderr": ""
}