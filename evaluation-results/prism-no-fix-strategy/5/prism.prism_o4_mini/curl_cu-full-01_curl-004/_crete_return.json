{
  "project_name": "curl",
  "vulnerability_identifier": "curl_cu-full-01_curl-004",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-curl",
  "llm_usage": {
    "total_cost": 0.513843,
    "prompt_tokens": 389566,
    "completion_tokens": 19391
  },
  "variant": "sound",
  "diff": "--- a/lib/file.c\n+++ b/lib/file.c\n@@ -491,12 +491,19 @@\n       return result;\n \n     if(data->req.no_body) {\n+      /* format suppressed-body notice safely into header */\n       headerlen =\n-      msnprintf(header, sizeof(no_body), \"%s (%ld bytes) \\r\\n\",\n+        msnprintf(header, sizeof(header),\n+                  \"%s (%\" FMT_OFF_T \" bytes)\\r\\n\",\n                   no_body, expected_size);\n-      result = Curl_client_write(data, CLIENTWRITE_HEADER, header, headerlen);\n+      if((size_t)headerlen >= sizeof(header))\n+        headerlen = sizeof(header) - 1;\n+      header[headerlen] = '\\0';\n+      result = Curl_client_write(data, CLIENTWRITE_HEADER,\n+                                 header, headerlen);\n     }\n     else {\n+      /* emit File-body: included safely */\n       result = Curl_client_write(data, CLIENTWRITE_HEADER,\n                                  body_msg, sizeof(body_msg) - 1);\n     }\n",
  "stdout": "",
  "stderr": ""
}