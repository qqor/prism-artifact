--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -703,11 +703,11 @@
 	flag = tvb_get_uint8(tvb, offset + NB_DATA1);
 
 	/* Allocate buffer for signature field */
-	if (flag & 0x80) {
-		signature = g_malloc( NB_SIZE_HMAC + 1);
-	} else {
-		signature = g_malloc( NB_SIZE_TMAC + 1);
-	}
+    {
+        /* Determine raw signature byte length and allocate hex string (2 chars per byte + NUL) */
+        int raw_len = (flag & 0x80) ? NB_SIZE_HMAC : NB_SIZE_TMAC;
+        signature = g_malloc(raw_len * 2 + 1);
+    }
 
 	if (signature == NULL)
 		return 0;
@@ -719,14 +719,15 @@
     proto_tree_add_item(ttree, hf_netb_trace_signature, tvb, offset + NB_SIGNATURE, 8, ENC_NA);
 
 	/* Convert signature field to a string */
-	while ( tvb_offset_exists(tvb, offset + NB_SIGNATURE + i) ) {
-		byte = tvb_get_uint8(tvb, offset + NB_SIGNATURE + i);
-
-		signature[index++] = hex_digits[byte >> 4];
-		signature[index++] = hex_digits[byte & 0x0F];
-
-		i++;
-	}
+    {
+        /* Convert raw signature bytes to hexadecimal string */
+        int raw_len = (flag & 0x80) ? NB_SIZE_HMAC : NB_SIZE_TMAC;
+        for (i = 0; i < raw_len && tvb_offset_exists(tvb, offset + NB_SIGNATURE + i); i++) {
+            byte = tvb_get_uint8(tvb, offset + NB_SIGNATURE + i);
+            signature[index++] = hex_digits[byte >> 4];
+            signature[index++] = hex_digits[byte & 0x0F];
+        }
+    }
 
 	signature[index] = '\0';
 	
