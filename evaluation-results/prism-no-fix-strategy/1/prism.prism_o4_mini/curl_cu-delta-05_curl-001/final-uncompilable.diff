--- a/lib/dict.c
+++ b/lib/dict.c
@@ -226,9 +226,9 @@
         do {
         result = sendf(data, "Sending extra debug info...");
         } while(result == CURLE_AGAIN);
-        do {
-        result = sendf(data, user_start);
-        } while(result == CURLE_AGAIN);
+      do {
+        result = sendf(data, "%s", user_start);
+      } while(result == CURLE_AGAIN);
       }
 
 
@@ -253,28 +253,22 @@
       result = Curl_md5it(md5_out, combined, strlen(combined));
       if(result)
         goto error;
-      do {
-      result = sendf(data,
-"AUTH %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x\r\n",
-      md5_out[0],
-      md5_out[1],
-      md5_out[2],
-      md5_out[3],
-      md5_out[4],
-      md5_out[5],
-      md5_out[6],
-      md5_out[7],
-      md5_out[8],
-      md5_out[9],
-      md5_out[10],
-      md5_out[11],
-      md5_out[12],
-      md5_out[13],
-      md5_out[14],
-      md5_out[15]);
-      } while(result == CURLE_AGAIN);
-      if(result)
-        goto error;
+      {
+        char *auth_reply = curl_maprintf(
+          "AUTH %02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x%02x\r\n",
+          md5_out[0], md5_out[1], md5_out[2], md5_out[3],
+          md5_out[4], md5_out[5], md5_out[6], md5_out[7],
+          md5_out[8], md5_out[9], md5_out[10], md5_out[11],
+          md5_out[12], md5_out[13], md5_out[14], md5_out[15]);
+        if(!auth_reply)
+          goto error;
+        do {
+          result = sendf(data, "%s", auth_reply);
+        } while(result == CURLE_AGAIN);
+        free(auth_reply);
+        if(result)
+          goto error;
+      }
     }
 
 
