{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-delta-02_vuln_9",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 3.8372312000000006,
    "prompt_tokens": 3090868,
    "completion_tokens": 99381
  },
  "variant": "vulnerable",
  "diff": "--- a/src/main/java/org/apache/commons/compress/compressors/z/ZCompressorInputStream.java\n+++ b/src/main/java/org/apache/commons/compress/compressors/z/ZCompressorInputStream.java\n@@ -36,6 +36,7 @@\n     private static final int MAGIC_2 = 0x9d;\n     private static final int BLOCK_MODE_MASK = 0x80;\n     private static final int MAX_CODE_SIZE_MASK = 0x1f;\n+    private static final int DEFAULT_MEMORY_LIMIT_KIB = 256;\n \n     /**\n      * Checks if the signature matches what is expected for a Unix compress file.\n@@ -60,7 +61,7 @@\n      * @throws IOException if an I/O error occurs.\n      */\n     public ZCompressorInputStream(final InputStream inputStream) throws IOException {\n-        this(inputStream, -1);\n+        this(inputStream, DEFAULT_MEMORY_LIMIT_KIB);\n     }\n \n     /**\n",
  "stdout": "+ FUZZER=ExpanderFuzzer\r\n+ shift\r\n+ '[' '!' -v TESTCASE ']'\r\n+ TESTCASE=/testcase\r\n+ '[' '!' -f /testcase ']'\r\n+ export RUN_FUZZER_MODE=interactive\r\n+ RUN_FUZZER_MODE=interactive\r\n+ export FUZZING_ENGINE=libfuzzer\r\n+ FUZZING_ENGINE=libfuzzer\r\n+ export SKIP_SEED_CORPUS=1\r\n+ SKIP_SEED_CORPUS=1\r\n+ run_fuzzer ExpanderFuzzer -runs=100 /testcase\r\nvm.mmap_rnd_bits = 28\r\n/out/ExpanderFuzzer -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -timeout_exitcode=0 < /dev/null\r\nOpenJDK 64-Bit Server VM warning: Option CriticalJNINatives was deprecated in version 16.0 and will likely be removed in a future release.\r\nOpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended\r\nINFO: Loaded 273 hooks from com.code_intelligence.jazzer.runtime.TraceCmpHooks\r\nINFO: Loaded 5 hooks from com.code_intelligence.jazzer.runtime.TraceDivHooks\r\nINFO: Loaded 2 hooks from com.code_intelligence.jazzer.runtime.TraceIndirHooks\r\nINFO: Loaded 4 hooks from com.code_intelligence.jazzer.runtime.NativeLibHooks\r\nINFO: Loaded 2 hooks from com.code_intelligence.jazzer.sanitizers.ClojureLangHooks\r\nINFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.Deserialization\r\nINFO: Loaded 5 hooks from com.code_intelligence.jazzer.sanitizers.ExpressionLanguageInjection\r\nINFO: Loaded 32 hooks from com.code_intelligence.jazzer.sanitizers.FilePathTraversal\r\nINFO: Loaded 70 hooks from com.code_intelligence.jazzer.sanitizers.LdapInjection\r\nINFO: Loaded 46 hooks from com.code_intelligence.jazzer.sanitizers.NamingContextLookup\r\nINFO: Loaded 1 hooks from com.code_intelligence.jazzer.sanitizers.OsCommandInjection\r\nINFO: Loaded 48 hooks from com.code_intelligence.jazzer.sanitizers.ReflectiveCall\r\nINFO: Loaded 8 hooks from com.code_intelligence.jazzer.sanitizers.RegexInjection\r\nINFO: Loaded 16 hooks from com.code_intelligence.jazzer.sanitizers.RegexRoadblocks\r\nINFO: Loaded 12 hooks from com.code_intelligence.jazzer.sanitizers.ScriptEngineInjection\r\nINFO: Loaded 3 hooks from com.code_intelligence.jazzer.sanitizers.ServerSideRequestForgery\r\nINFO: Loaded 19 hooks from com.code_intelligence.jazzer.sanitizers.SqlInjection\r\nINFO: Loaded 6 hooks from com.code_intelligence.jazzer.sanitizers.XPathInjection\r\nINFO: Instrumented ExpanderFuzzer (took 40 ms, size +37%)\r\nINFO: Instrumented BaseTests (took 4 ms, size +11%)\r\nINFO: Instrumented org.apache.commons.compress.archivers.ArchiveInputStream (took 9 ms, size +9%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.CompressorInputStream (took 3 ms, size +23%)\r\nINFO: using inputs from: /testcase\r\nINFO: found LLVMFuzzerCustomMutator (0x7fe3b84eda00). Disabling -len_control by default.\r\nINFO: libFuzzer ignores flags that start with '--'\r\nINFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 624015428\r\nINFO: Loaded 1 modules   (512 inline 8-bit counters): 512 [0x564584dfb750, 0x564584dfb950), \r\nINFO: Loaded 1 PC tables (512 PCs): 512 [0x564584dc5d20,0x564584dc7d20), \r\njazzer: Running 1 inputs 100 time(s) each.\r\nRunning: /testcase\r\nINFO: Instrumented org.apache.commons.compress.archivers.examples.Expander (took 22 ms, size +17%)\r\nINFO: Instrumented org.apache.commons.compress.archivers.ArchiveException (took 1 ms, size +14%)\r\nINFO: Instrumented org.apache.commons.io.output.NullOutputStream (took 1 ms, size +12%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.CompressorException (took 0 ms, size +15%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.CompressorStreamFactory (took 18 ms, size +25%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.CompressorStreamProvider (took 0 ms, size +0%)\r\nINFO: New number of coverage counters: 1024\r\nINFO: Instrumented org.apache.commons.compress.compressors.gzip.GzipCompressorInputStream (took 9 ms, size +15%)\r\nINFO: Instrumented org.apache.commons.compress.utils.InputStreamStatistics (took 0 ms, size +0%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream (took 17 ms, size +23%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.bzip2.BZip2Constants (took 0 ms, size +0%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.brotli.BrotliCompressorInputStream (took 3 ms, size +11%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.xz.XZCompressorInputStream (took 3 ms, size +14%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.zstandard.ZstdCompressorInputStream (took 3 ms, size +12%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.lzma.LZMACompressorInputStream (took 2 ms, size +16%)\r\nINFO: New number of coverage counters: 2048\r\nINFO: Instrumented org.apache.commons.compress.compressors.pack200.Pack200CompressorInputStream (took 5 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.snappy.SnappyCompressorInputStream (took 3 ms, size +18%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.lz77support.AbstractLZ77CompressorInputStream (took 6 ms, size +15%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.snappy.FramedSnappyCompressorInputStream (took 7 ms, size +20%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.z.ZCompressorInputStream (took 3 ms, size +24%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.lzw.LZWInputStream (took 6 ms, size +15%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.deflate.DeflateCompressorInputStream (took 3 ms, size +16%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.deflate64.Deflate64CompressorInputStream (took 4 ms, size +19%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.lz4.BlockLZ4CompressorInputStream (took 2 ms, size +18%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.lz4.FramedLZ4CompressorInputStream (took 8 ms, size +23%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.CompressorOutputStream (took 0 ms, size +12%)\r\nINFO: Instrumented org.apache.commons.compress.CompressFilterOutputStream (took 3 ms, size +20%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.gzip.GzipCompressorOutputStream (took 4 ms, size +17%)\r\nINFO: New number of coverage counters: 4096\r\nINFO: Instrumented org.apache.commons.compress.compressors.bzip2.BZip2CompressorOutputStream (took 12 ms, size +22%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.xz.XZCompressorOutputStream (took 1 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.pack200.Pack200CompressorOutputStream (took 2 ms, size +10%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.lzma.LZMACompressorOutputStream (took 1 ms, size +9%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.deflate.DeflateCompressorOutputStream (took 1 ms, size +14%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.snappy.FramedSnappyCompressorOutputStream (took 2 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.lz4.BlockLZ4CompressorOutputStream (took 6 ms, size +12%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.lz4.FramedLZ4CompressorOutputStream (took 3 ms, size +17%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.zstandard.ZstdCompressorOutputStream (took 1 ms, size +9%)\r\nINFO: Instrumented org.apache.commons.compress.utils.Sets (took 0 ms, size +13%)\r\nINFO: Instrumented org.apache.commons.compress.utils.IOUtils (took 3 ms, size +18%)\r\nINFO: Instrumented org.apache.commons.io.IOUtils (took 39 ms, size +13%)\r\nINFO: Instrumented org.apache.commons.io.output.StringBuilderWriter (took 2 ms, size +9%)\r\nINFO: Instrumented org.apache.commons.io.output.AppendableWriter (took 2 ms, size +12%)\r\nINFO: Instrumented org.apache.commons.io.output.ThresholdingOutputStream (took 3 ms, size +11%)\r\nINFO: Instrumented org.apache.commons.io.CloseableURLConnection (took 6 ms, size +11%)\r\nINFO: Instrumented org.apache.commons.io.output.ByteArrayOutputStream (took 2 ms, size +14%)\r\nINFO: Instrumented org.apache.commons.io.output.AbstractByteArrayOutputStream (took 2 ms, size +15%)\r\nINFO: Instrumented org.apache.commons.io.output.QueueOutputStream (took 0 ms, size +6%)\r\nINFO: Instrumented org.apache.commons.io.output.NullWriter (took 2 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.io.input.CharSequenceReader (took 2 ms, size +18%)\r\nINFO: Instrumented org.apache.commons.io.output.UnsynchronizedByteArrayOutputStream (took 2 ms, size +10%)\r\nINFO: Instrumented org.apache.commons.io.StandardLineSeparator (took 1 ms, size +9%)\r\nINFO: Instrumented org.apache.commons.io.function.IOTriFunction (took 0 ms, size +5%)\r\nINFO: Instrumented org.apache.commons.io.input.CloseShieldInputStream (took 0 ms, size +11%)\r\nINFO: Instrumented org.apache.commons.io.input.ProxyInputStream (took 3 ms, size +12%)\r\nINFO: Instrumented org.apache.commons.io.input.BoundedInputStream (took 3 ms, size +13%)\r\nINFO: Instrumented org.apache.commons.io.function.IOConsumer (took 2 ms, size +3%)\r\nINFO: Instrumented org.apache.commons.compress.compressors.pack200.AbstractStreamBridge (took 0 ms, size +15%)\r\nINFO: Instrumented org.apache.commons.compress.MemoryLimitException (took 1 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.compress.utils.BitInputStream (took 2 ms, size +17%)\r\nINFO: Instrumented org.apache.commons.io.input.ProxyInputStream$AbstractBuilder (took 0 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractStreamBuilder (took 4 ms, size +7%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOriginSupplier (took 4 ms, size +4%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractSupplier (took 0 ms, size +13%)\r\nINFO: Instrumented org.apache.commons.io.function.IOSupplier (took 0 ms, size +7%)\r\nINFO: Instrumented org.apache.commons.io.input.BoundedInputStream$Builder (took 1 ms, size +7%)\r\nINFO: Instrumented org.apache.commons.io.input.BoundedInputStream$AbstractBuilder (took 1 ms, size +5%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin (took 2 ms, size +16%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$InputStreamOrigin (took 0 ms, size +7%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$ByteArrayOrigin (took 0 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$CharSequenceOrigin (took 1 ms, size +5%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$FileOrigin (took 0 ms, size +9%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$OutputStreamOrigin (took 0 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$PathOrigin (took 0 ms, size +5%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$RandomAccessFileOrigin (took 0 ms, size +11%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$AbstractRandomAccessFileOrigin (took 1 ms, size +6%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$IORandomAccessFileOrigin (took 0 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$ReaderOrigin (took 0 ms, size +5%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$URIOrigin (took 1 ms, size +45%)\r\nINFO: Instrumented org.apache.commons.io.build.AbstractOrigin$WriterOrigin (took 0 ms, size +6%)\r\nINFO: New number of coverage counters: 8192\r\nINFO: Instrumented org.apache.commons.io.file.PathUtils (took 19 ms, size +12%)\r\nINFO: Instrumented org.apache.commons.io.file.DeleteOption (took 0 ms, size +0%)\r\nINFO: Instrumented org.apache.commons.io.function.IOBiConsumer (took 1 ms, size +5%)\r\nINFO: Instrumented org.apache.commons.io.function.Constants (took 1 ms, size +6%)\r\nINFO: Instrumented org.apache.commons.io.function.IORunnable (took 0 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.io.function.IOBiFunction (took 0 ms, size +4%)\r\nINFO: Instrumented org.apache.commons.io.function.IOFunction (took 2 ms, size +3%)\r\nINFO: Instrumented org.apache.commons.io.function.IOPredicate (took 2 ms, size +20%)\r\nINFO: Instrumented org.apache.commons.io.function.IOTriConsumer (took 0 ms, size +5%)\r\nINFO: Instrumented org.apache.commons.io.function.Uncheck (took 3 ms, size +4%)\r\nINFO: Instrumented org.apache.commons.io.function.Erase (took 1 ms, size +5%)\r\nINFO: Instrumented org.apache.commons.io.function.IOIntConsumer (took 1 ms, size +5%)\r\nINFO: Instrumented org.apache.commons.io.FileUtils (took 31 ms, size +14%)\r\nINFO: Instrumented org.apache.commons.io.FileExistsException (took 0 ms, size +12%)\r\nINFO: Instrumented org.apache.commons.io.filefilter.IOFileFilter (took 1 ms, size +14%)\r\nINFO: Instrumented org.apache.commons.io.file.PathFilter (took 0 ms, size +0%)\r\nINFO: Instrumented org.apache.commons.io.function.IOStreams (took 1 ms, size +4%)\r\nINFO: Instrumented org.apache.commons.io.function.IOStream (took 9 ms, size +3%)\r\nINFO: Instrumented org.apache.commons.io.function.IOBaseStream (took 1 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.io.function.IOIterator (took 0 ms, size +11%)\r\nINFO: Instrumented org.apache.commons.io.function.IOSpliterator (took 1 ms, size +9%)\r\nINFO: Instrumented org.apache.commons.io.function.IOStreamAdapter (took 0 ms, size +8%)\r\nINFO: Instrumented org.apache.commons.io.function.IOBaseStreamAdapter (took 0 ms, size +9%)\r\nINFO: Instrumented org.apache.commons.io.IOIndexedException (took 0 ms, size +11%)\r\nINFO: Instrumented org.apache.commons.io.file.StandardDeleteOption (took 1 ms, size +11%)\r\nINFO: Instrumented org.apache.commons.io.file.Counters (took 1 ms, size +7%)\r\nINFO: Instrumented org.apache.commons.io.file.Counters$PathCounters (took 0 ms, size +16%)\r\nINFO: Instrumented org.apache.commons.io.file.Counters$Counter (took 0 ms, size +18%)\r\nINFO: Instrumented org.apache.commons.io.file.Counters$LongPathCounters (took 0 ms, size +12%)\r\nINFO: Instrumented org.apache.commons.io.file.Counters$AbstractPathCounters (took 1 ms, size +40%)\r\nINFO: Instrumented org.apache.commons.io.file.Counters$LongCounter (took 1 ms, size +18%)\r\nINFO: Instrumented org.apache.commons.io.IOExceptionList (took 1 ms, size +10%)\r\n\r\n== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueLow: Out of memory (use '-Xmx1710m' to reproduce)\r\nCaused by: java.lang.OutOfMemoryError: Java heap space\r\n\tat org.apache.commons.compress.compressors.lzw.LZWInputStream.initializeTables(LZWInputStream.java:186)\r\n\tat org.apache.commons.compress.compressors.lzw.LZWInputStream.initializeTables(LZWInputStream.java:220)\r\n\tat org.apache.commons.compress.compressors.z.ZCompressorInputStream.<init>(ZCompressorInputStream.java:87)\r\n\tat org.apache.commons.compress.compressors.CompressorStreamFactory.createCompressorInputStream(CompressorStreamFactory.java:562)\r\n\tat org.apache.commons.compress.compressors.CompressorStreamFactory.createCompressorInputStream(CompressorStreamFactory.java:512)\r\n\tat org.apache.commons.compress.archivers.examples.Expander.decompress(Expander.java:223)\r\n\tat org.apache.commons.compress.archivers.examples.Expander.expand(Expander.java:210)\r\n\tat ExpanderFuzzer.fuzzerTestOneInput(ExpanderFuzzer.java:52)\r\n\tat java.base/java.lang.invoke.LambdaForm$DMH/0x0000000800cb8800.invokeStaticInit(LambdaForm$DMH)\r\n\tat java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cb9800.invoke(LambdaForm$MH)\r\n\tat java.base/java.lang.invoke.LambdaForm$MH/0x0000000800cb9000.invoke_MT(LambdaForm$MH)\r\nDEDUP_TOKEN: 96bcd04edc053cb9\r\n== libFuzzer crashing input ==\r\nreproducer_path='.'; Java reproducer written to ./Crash_ffc606ca8d3c2820239ab2d725e567e23327b470.java\r\n\r\nsubprocess command returned a non-zero exit status: 77\n",
  "stderr": "INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/user/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/apache-commons-compress:/out -v /tmp/tmpp7pi3yno:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce ExpanderFuzzer -runs=100.\n"
}