--- a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
@@ -33,20 +33,32 @@
     public static void main(String[] args) throws IOException {
         Path inputFile = Paths.get(args[0]);
         Path extractDir = Paths.get(args[1]);
+        Path normalizedExtractDir = extractDir.toAbsolutePath().normalize();
         try (InputStream is = Files.newInputStream(inputFile);
                 TarArchiveInputStream tais = new TarArchiveInputStream(is)) {
 
-            TarArchiveEntry tae = tais.getNextEntry();
-
-            while (tae != null) {
-                if (tae.isFile()) {
-                    Path target = extractDir.resolve(tae.getName()).normalize();
-                    if (!Files.isDirectory(target.getParent())) {
-                        Files.createDirectories(target.getParent());
-                    }
-                    Files.write(target, tais.readAllBytes());
+            // iterate through archive entries and extract safely
+            TarArchiveEntry tae;
+            while ((tae = tais.getNextEntry()) != null) {
+                // resolve and normalize target path
+                Path target = normalizedExtractDir.resolve(tae.getName()).toAbsolutePath().normalize();
+                if (!target.startsWith(normalizedExtractDir)) {
+                    System.err.println("Skipping entry outside extraction directory: " + tae.getName());
+                    continue;
                 }
-                tae = tais.getNextEntry();
+                if (tae.isDirectory()) {
+                    Files.createDirectories(target);
+                    continue;
+                }
+                if (tae.isSymbolicLink() || tae.isLink()) {
+                    System.err.println("Skipping link entry in archive: " + tae.getName());
+                    continue;
+                }
+                // handle regular files: ensure parent directory exists then write
+                if (!Files.isDirectory(target.getParent())) {
+                    Files.createDirectories(target.getParent());
+                }
+                Files.write(target, tais.readAllBytes());
             }
         }
     }
