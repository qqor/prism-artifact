--- a/parser.c
+++ b/parser.c
@@ -9021,7 +9021,7 @@
                 xmlWarningMsg(ctxt, XML_WAR_TAB_VALUE,
                               "Invalid value \"%s\" for xml:tab : \"default\", \"preserve\", \"expand\", or \"skip\" expected\n",
                               internal_val, NULL);
-                xmlFree(internal_val);
+                /* deferred free: handled at mem_error label */
             }
         }
         if (internal_val) {
@@ -9033,7 +9033,11 @@
     return (hname);
 
 mem_error:
-    xmlErrMemory(ctxt);
+        if (internal_val) {
+            xmlFree(internal_val);
+            internal_val = NULL;
+        }
+        xmlErrMemory(ctxt);
 error:
     if ((val != NULL) && (*alloc != 0))
         xmlFree(val);
