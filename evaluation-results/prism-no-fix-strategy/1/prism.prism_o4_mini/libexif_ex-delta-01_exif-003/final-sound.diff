--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -235,14 +235,14 @@
 
 int
 exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e) {
-    int variant;
-
-    if (!strcmp((const char *) e->data, "Apple iOS")) {
+    const char *id = "Apple iOS";
+    size_t idlen = strlen(id);
+    int variant = 0;
+    /* ensure buffer holds id plus NUL and compare safely */
+    if (e->size > idlen &&
+        memcmp((const char *)e->data, id, idlen) == 0 &&
+        ((const unsigned char *)e->data)[idlen] == '\0')
         variant = 1;
-    } else {
-        variant = 0;
-    }
-
     return variant;
 }
 
