--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -84,13 +84,17 @@
 
     tcount = (unsigned int) exif_get_short(buf + ofs + 14, d->order);
 
-    /* Sanity check the offset */
-    if (buf_size < 6 + 16 + tcount * 6 + 4) {
-        exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,
-                 "ExifMnoteDataApple", "Short MakerNote");
-        /*printf("%s(%d)\n", __FUNCTION__, __LINE__);*/
-        return;
-    }
+        /* Sanity check: ensure enough bytes for all entries */
+        if (buf_size < ofs + 16 + tcount * 12)
+        {
+            exif_log(
+                md->log,
+                EXIF_LOG_CODE_CORRUPT_DATA,
+                "ExifMnoteDataApple",
+                "Short MakerNote"
+            );
+            return;
+        }
 
     /* printf("%s(%d): total %d tags\n", __FUNCTION__, __LINE__, tcount); */
 
