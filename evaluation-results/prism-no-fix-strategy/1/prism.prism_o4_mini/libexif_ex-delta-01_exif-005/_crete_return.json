{
  "project_name": "libexif",
  "vulnerability_identifier": "libexif_ex-delta-01_exif-005",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-libexif",
  "llm_usage": {
    "total_cost": 0.24558600000000003,
    "prompt_tokens": 170068,
    "completion_tokens": 13298
  },
  "variant": "sound",
  "diff": "--- a/libexif/apple/exif-mnote-data-apple.c\n+++ b/libexif/apple/exif-mnote-data-apple.c\n@@ -84,13 +84,17 @@\n \n     tcount = (unsigned int) exif_get_short(buf + ofs + 14, d->order);\n \n-    /* Sanity check the offset */\n-    if (buf_size < 6 + 16 + tcount * 6 + 4) {\n-        exif_log(md->log, EXIF_LOG_CODE_CORRUPT_DATA,\n-                 \"ExifMnoteDataApple\", \"Short MakerNote\");\n-        /*printf(\"%s(%d)\\n\", __FUNCTION__, __LINE__);*/\n-        return;\n-    }\n+        /* Sanity check: ensure enough bytes for all entries */\n+        if (buf_size < ofs + 16 + tcount * 12)\n+        {\n+            exif_log(\n+                md->log,\n+                EXIF_LOG_CODE_CORRUPT_DATA,\n+                \"ExifMnoteDataApple\",\n+                \"Short MakerNote\"\n+            );\n+            return;\n+        }\n \n     /* printf(\"%s(%d): total %d tags\\n\", __FUNCTION__, __LINE__, tcount); */\n \n",
  "stdout": "",
  "stderr": ""
}