{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_6",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 3.4042733999999997,
    "prompt_tokens": 2619490,
    "completion_tokens": 118826
  },
  "variant": "uncompilable",
  "diff": "--- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java\n@@ -153,16 +153,19 @@\n                 throw new IOException(\"Incorrect record type: \" + recordType);\n             }\n \n-            int size = in.read();\n-            size += in.read() << 8;\n-            size += in.read() << 16;\n-            size += in.read() << 24;\n-            LOG.debug(\"record type: {}, segment size: {}\", recordType, size);\n-            long newTotal = total + size;\n+            long rawSize = ((long)in.read() & 0xFF)\n+                | (((long)in.read() & 0xFF) << 8)\n+                | (((long)in.read() & 0xFF) << 16)\n+                | (((long)in.read() & 0xFF) << 24);\n+            if (rawSize < 0 || rawSize > MAX_LENGTH) {\n+                throw new IOException(\"PFB segment size too large: \" + rawSize);\n+            }\n+            long newTotal = total + rawSize;\n             if (newTotal > MAX_LENGTH) {\n-                throw new IOException(\"record size would be too large: \" + newTotal);\n-            }\n-\n+                throw new IOException(\"cumulative PFB data too large: \" + newTotal);\n+            }\n+            total = newTotal;\n+            int size = (int) rawSize;\n             byte[] ar = new byte[size];\n             int got = in.read(ar);\n             if (got != size)\n",
  "stdout": "/src /src/project-parent/pdfbox\r\n/src/project-parent/pdfbox\r\n---------------------------------------------------------------\r\nvm.mmap_rnd_bits = 28\r\n---------------------------------------------------------------\r\nCC=clang\r\nCXX=clang++\r\nCFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types   -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -fno-sanitize=leak\r\nCXXFLAGS=-O1   -fno-omit-frame-pointer   -gline-tables-only   -Wno-error=enum-constexpr-conversion   -Wno-error=incompatible-function-pointer-types   -Wno-error=int-conversion   -Wno-error=deprecated-declarations   -Wno-error=implicit-function-declaration   -Wno-error=implicit-int   -Wno-error=vla-cxx-extension   -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -fsanitize=address -fsanitize-address-use-after-scope -fsanitize=fuzzer-no-link -stdlib=libc++ -fno-sanitize=leak\r\nRUSTFLAGS=--cfg fuzzing -Zsanitizer=address -Cdebuginfo=1 -Cforce-frame-pointers\r\n---------------------------------------------------------------\r\n+ __REAL_MAVEN_REPO=/root/.m2/repository\r\n+ __SHARED_MAVEN_REPO=/work/mavencache\r\n+ '[' '!' -L /root/.m2/repository ']'\r\n+ unset __REAL_MAVEN_REPO\r\n+ unset __SHARED_MAVEN_REPO\r\n+ PROJECT=pdfbox\r\n+ PROJECT_GROUP_ID=org.apache.pdfbox\r\n+ PROJECT_ARTIFACT_ID=pdfbox\r\n+ XMPBOX_ARTIFACT_ID=xmpbox\r\n+ MAIN_REPOSITORY=https://github.com/apache/pdfbox/\r\n+ MAVEN_ARGS='-Djavac.src.version=11 -Djavac.target.version=11 -DskipTests'\r\n+ cd /src/project-parent\r\n+ [[ -v LOCAL_DEV ]]\r\n+ mv /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict /out\r\n+ set_project_version_in_fuzz_targets_dependency\r\n++ cd pdfbox\r\n++ /src/maven/apache-maven-3.9.9/bin/mvn org.apache.maven.plugins:maven-help-plugin:3.2.0:evaluate -Dexpression=project.version -q -DforceStdout\r\n+ PROJECT_VERSION=4.0.0-SNAPSHOT\r\n+ cd fuzz-targets\r\n+ /src/maven/apache-maven-3.9.9/bin/mvn versions:use-dep-version -Dexcludes=com.code-intelligence:jazzer -DdepVersion=4.0.0-SNAPSHOT -DforceVersion=true\r\n[INFO] Scanning for projects...\r\n[INFO] \r\n[INFO] ----------------------< com.fuzzer:fuzz-targets >-----------------------\r\n[INFO] Building fuzz 0.0.1-SNAPSHOT\r\n[INFO]   from pom.xml\r\n[INFO] --------------------------------[ jar ]---------------------------------\r\n[INFO] \r\n[INFO] --- versions:2.20.1:use-dep-version (default-cli) @ fuzz-targets ---\r\n[INFO] Updated org.apache.pdfbox:pdfbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT\r\n[INFO] Updated org.apache.pdfbox:xmpbox:jar:4.0.0-SNAPSHOT to version 4.0.0-SNAPSHOT\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD SUCCESS\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Total time:  0.903 s\r\n[INFO] Finished at: 2025-12-12T20:13:01Z\r\n[INFO] ------------------------------------------------------------------------\r\n+ cd pdfbox\r\n+ /src/maven/apache-maven-3.9.9/bin/mvn install -Djavac.src.version=11 -Djavac.target.version=11 -DskipTests -Dmaven.repo.local=/out/m2\r\n[INFO] Scanning for projects...\r\n\r\n\r\n\r\n\r\n\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Reactor Build Order:\r\n[INFO] \r\n[INFO] Apache PDFBox parent                                               [pom]\r\n[INFO] Apache PDFBox io                                                [bundle]\r\n[INFO] Apache FontBox                                                  [bundle]\r\n[INFO] Apache XmpBox                                                   [bundle]\r\n[INFO] Apache PDFBox                                                   [bundle]\r\n[INFO] Apache PDFBox Debugger                                             [jar]\r\n[INFO] Apache PDFBox tools                                                [jar]\r\n[INFO] Apache PDFBox application                                          [jar]\r\n[INFO] Apache PDFBox Debugger application                                 [jar]\r\n[INFO] Apache PDFBox examples                                             [jar]\r\n[INFO] pdfbox-reactor                                                     [pom]\r\n[INFO] \r\n[INFO] ------------------< org.apache.pdfbox:pdfbox-parent >-------------------\r\n[INFO] Building Apache PDFBox parent 4.0.0-SNAPSHOT                      [1/11]\r\n[INFO]   from parent/pom.xml\r\n[INFO] --------------------------------[ pom ]---------------------------------\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-parent ---\r\n[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-parent ---\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-parent ---\r\n[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed\r\n[INFO] \r\n[INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-parent ---\r\n\r\n\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-parent ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-parent ---\r\n[INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7\r\n[INFO] Copying 3 resources from 1 bundle.\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:report (report) @ pdfbox-parent ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-parent ---\r\n\r\n[INFO] \r\n[INFO] --- install:3.1.4:install (default-install) @ pdfbox-parent ---\r\n[INFO] Installing /src/project-parent/pdfbox/parent/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-parent/4.0.0-SNAPSHOT/pdfbox-parent-4.0.0-SNAPSHOT.pom\r\n[INFO] \r\n[INFO] --------------------< org.apache.pdfbox:pdfbox-io >---------------------\r\n[INFO] Building Apache PDFBox io 4.0.0-SNAPSHOT                          [2/11]\r\n[INFO]   from io/pom.xml\r\n[INFO] -------------------------------[ bundle ]-------------------------------\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (default) @ pdfbox-io ---\r\n[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ pdfbox-io ---\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ pdfbox-io ---\r\n[INFO] Rule 0: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed\r\n[INFO] \r\n[INFO] --- checkstyle:3.6.0:check (check) @ pdfbox-io ---\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:prepare-agent (default) @ pdfbox-io ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ pdfbox-io ---\r\n[INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7\r\n[INFO] Copying 3 resources from 1 bundle.\r\n[INFO] \r\n[INFO] --- resources:3.3.1:resources (default-resources) @ pdfbox-io ---\r\n[INFO] skip non existing resourceDirectory /src/project-parent/pdfbox/io/src/main/resources\r\n[INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes\r\n[INFO] \r\n[INFO] --- compiler:3.14.0:compile (default-compile) @ pdfbox-io ---\r\n\r\n[INFO] Recompiling the module because of changed source code.\r\n[INFO] Compiling 18 source files with javac [debug deprecation release 11] to target/classes\r\n[INFO] \r\n[INFO] --- resources:3.3.1:testResources (default-testResources) @ pdfbox-io ---\r\n[INFO] Copying 2 resources from src/test/resources to target/test-classes\r\n[INFO] Copying 3 resources from target/maven-shared-archive-resources to target/test-classes\r\n[INFO] \r\n[INFO] --- compiler:3.14.0:testCompile (default-testCompile) @ pdfbox-io ---\r\n[INFO] Recompiling the module because of changed dependency.\r\n[INFO] Compiling 10 source files with javac [debug deprecation release 11] to target/test-classes\r\n[WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[45,29] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal\r\n[WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[50,24] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal\r\n[WARNING] /src/project-parent/pdfbox/io/src/test/java/org/apache/pdfbox/io/TestIOUtils.java:[57,24] populateBuffer(java.io.InputStream,byte[]) in org.apache.pdfbox.io.IOUtils has been deprecated and marked for removal\r\n[INFO] \r\n[INFO] --- surefire:3.5.2:test (default-test) @ pdfbox-io ---\r\n\r\n[INFO] Tests are skipped.\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:report (report) @ pdfbox-io ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- bundle:5.1.9:bundle (default-bundle) @ pdfbox-io ---\r\n[INFO] Building bundle: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar\r\n[INFO] Writing manifest: /src/project-parent/pdfbox/io/target/classes/META-INF/MANIFEST.MF\r\n[INFO] \r\n[INFO] --- source:3.3.1:jar-no-fork (attach-sources) @ pdfbox-io ---\r\n[INFO] Building jar: /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar\r\n[INFO] \r\n[INFO] --- install:3.1.4:install (default-install) @ pdfbox-io ---\r\n[INFO] Installing /src/project-parent/pdfbox/io/pom.xml to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.pom\r\n[INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT.jar to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar\r\n[INFO] Installing /src/project-parent/pdfbox/io/target/pdfbox-io-4.0.0-SNAPSHOT-sources.jar to /out/m2/org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT-sources.jar\r\n[INFO] \r\n[INFO] --- bundle:5.1.9:install (default-install) @ pdfbox-io ---\r\n[INFO] Writing OBR metadata\r\n[INFO] Installing org/apache/pdfbox/pdfbox-io/4.0.0-SNAPSHOT/pdfbox-io-4.0.0-SNAPSHOT.jar\r\n[INFO] Writing OBR metadata\r\n[INFO] \r\n[INFO] ---------------------< org.apache.pdfbox:fontbox >----------------------\r\n[INFO] Building Apache FontBox 4.0.0-SNAPSHOT                            [3/11]\r\n[INFO]   from fontbox/pom.xml\r\n[INFO] -------------------------------[ bundle ]-------------------------------\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (default) @ fontbox ---\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-maven-version) @ fontbox ---\r\n[INFO] \r\n[INFO] --- enforcer:3.5.0:enforce (enforce-java-version) @ fontbox ---\r\n[INFO] \r\n[INFO] --- checkstyle:3.6.0:check (check) @ fontbox ---\r\n[INFO] \r\n[INFO] --- jacoco:0.8.13:prepare-agent (default) @ fontbox ---\r\n[INFO] Skipping JaCoCo execution because property jacoco.skip is set.\r\n[INFO] \r\n[INFO] --- remote-resources:3.3.0:process (process-resource-bundles) @ fontbox ---\r\n[INFO] Preparing remote bundle org.apache.apache.resources:apache-jar-resource-bundle:1.7\r\n[INFO] Copying 3 resources from 1 bundle.\r\n[INFO] Copying appended resource: META-INF/LICENSE\r\n[INFO] Copying appended resource: META-INF/NOTICE\r\n[INFO] \r\n[INFO] --- resources:3.3.1:resources (default-resources) @ fontbox ---\r\n[INFO] Copying 93 resources from src/main/resources to target/classes\r\n[INFO] Copying 3 resources from target/maven-shared-archive-resources to target/classes\r\n[INFO] \r\n[INFO] --- compiler:3.14.0:compile (default-compile) @ fontbox ---\r\n[INFO] Recompiling the module because of changed dependency.\r\n[INFO] Compiling 141 source files with javac [debug deprecation release 11] to target/classes\r\n[INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Some input files use unchecked or unsafe operations.\r\n[INFO] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/cff/CFFFont.java: Recompile with -Xlint:unchecked for details.\r\n[INFO] -------------------------------------------------------------\r\n[ERROR] COMPILATION ERROR : \r\n[INFO] -------------------------------------------------------------\r\n[ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java:[167,21] incompatible types: possible lossy conversion from long to int\r\n[INFO] 1 error\r\n[INFO] -------------------------------------------------------------\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Reactor Summary for pdfbox-reactor 4.0.0-SNAPSHOT:\r\n[INFO] \r\n[INFO] Apache PDFBox parent ............................... SUCCESS [  8.612 s]\r\n[INFO] Apache PDFBox io ................................... SUCCESS [  4.858 s]\r\n[INFO] Apache FontBox ..................................... FAILURE [  2.398 s]\r\n[INFO] Apache XmpBox ...................................... SKIPPED\r\n[INFO] Apache PDFBox ...................................... SKIPPED\r\n[INFO] Apache PDFBox Debugger ............................. SKIPPED\r\n[INFO] Apache PDFBox tools ................................ SKIPPED\r\n[INFO] Apache PDFBox application .......................... SKIPPED\r\n[INFO] Apache PDFBox Debugger application ................. SKIPPED\r\n[INFO] Apache PDFBox examples ............................. SKIPPED\r\n[INFO] pdfbox-reactor ..................................... SKIPPED\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] BUILD FAILURE\r\n[INFO] ------------------------------------------------------------------------\r\n[INFO] Total time:  21.887 s\r\n[INFO] Finished at: 2025-12-12T20:13:24Z\r\n[INFO] ------------------------------------------------------------------------\r\n[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.14.0:compile (default-compile) on project fontbox: Compilation failure\r\n[ERROR] /src/project-parent/pdfbox/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java:[167,21] incompatible types: possible lossy conversion from long to int\r\n[ERROR] \r\n[ERROR] -> [Help 1]\r\n[ERROR] \r\n[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.\r\n[ERROR] Re-run Maven using the -X switch to enable full debug logging.\r\n[ERROR] \r\n[ERROR] For more information about the errors and possible solutions, please read the following articles:\r\n[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException\r\n[ERROR] \r\n[ERROR] After correcting the problems, you can resume the build with the command\r\n[ERROR]   mvn <args> -rf :fontbox\r\nsubprocess command returned a non-zero exit status: 1\n",
  "stderr": "INFO:__main__:Running: docker build -t aixcc-afc/pdfbox:latest --file /home/qqor/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/projects/pdfbox/Dockerfile /home/qqor/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/projects/pdfbox.\n#0 building with \"default\" instance using docker driver\n\n#1 [internal] load build definition from Dockerfile\n#1 transferring dockerfile: 2.07kB done\n#1 DONE 0.0s\n\n#2 [internal] load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0\n#2 DONE 0.0s\n\n#3 [internal] load .dockerignore\n#3 transferring context: 2B done\n#3 DONE 0.0s\n\n#4 [ 1/13] FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.3.0\n#4 DONE 0.0s\n\n#5 [internal] load build context\n#5 transferring context: 1.23kB done\n#5 DONE 0.0s\n\n#6 [11/13] RUN tar -zxf /src/pdfbox.tar.gz -C /src/project-parent && rm /src/pdfbox.tar.gz\n#6 CACHED\n\n#7 [ 3/13] RUN mkdir /usr/my-bin && mv /usr/bin/tesseract /usr/my-bin/tesseract\n#7 CACHED\n\n#8 [ 8/13] COPY project-parent /src/project-parent/\n#8 CACHED\n\n#9 [ 6/13] COPY pkgs/pdf.dict.gz /src/pdf.dict.gz\n#9 CACHED\n\n#10 [ 9/13] RUN rm -rf /src/project-parent/pdfbox\n#10 CACHED\n\n#11 [ 4/13] COPY pkgs/maven.zip /src/maven.zip\n#11 CACHED\n\n#12 [10/13] COPY pkgs/pdfbox.tar.gz /src/pdfbox.tar.gz\n#12 CACHED\n\n#13 [ 7/13] RUN gunzip /src/pdf.dict.gz &&     mv /src/pdf.dict /src/PDFStreamParserFuzzer.dict &&     cp /src/PDFStreamParserFuzzer.dict /src/PDFWriteReadFuzzer.dict\n#13 CACHED\n\n#14 [ 2/13] RUN set -eux     && apt-get update     && apt-get install --yes --no-install-recommends         tesseract-ocr=4.1.1-2build2         tesseract-ocr-eng=1:4.00~git30-7274cfa-1     && apt-get clean     && rm -rf /var/lib/apt/lists/*\n#14 CACHED\n\n#15 [ 5/13] RUN unzip /src/maven.zip -d /src/maven && rm /src/maven.zip\n#15 CACHED\n\n#16 [12/13] COPY build.sh /src/\n#16 CACHED\n\n#17 [13/13] WORKDIR /src/project-parent/pdfbox\n#17 CACHED\n\n#18 exporting to image\n#18 exporting layers done\n#18 writing image sha256:0a5dbb93011682e08467afab34aebcbd3809a3acb80f8dcb128175f0d0902a73 done\n#18 naming to docker.io/aixcc-afc/pdfbox:latest done\n#18 DONE 0.0s\nINFO:__main__:Keeping existing build artifacts as-is (if any).\nINFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e FUZZING_ENGINE=libfuzzer -e SANITIZER=address -e ARCHITECTURE=x86_64 -e PROJECT_NAME=pdfbox -e HELPER=True -e FUZZING_LANGUAGE=jvm -e BASH_ENV=/work/bashrc0 -e MAVEN_OPTS=-Dmaven.repo.local=/work/mavencache -v /home/qqor/aixcc/crete/.cache/official-afc-pdfbox:/local-source-mount:ro -v /home/qqor/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/pdfbox/:/out -v /home/qqor/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/pdfbox:/work -t aixcc-afc/pdfbox:latest /bin/bash -c 'pushd $SRC && rm -rf /src/project-parent/pdfbox && cp -r /local-source-mount /src/project-parent/pdfbox && popd && compile'.\nERROR:__main__:Building fuzzers failed.\n"
}