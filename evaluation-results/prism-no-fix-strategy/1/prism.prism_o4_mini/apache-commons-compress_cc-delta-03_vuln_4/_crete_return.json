{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-delta-03_vuln_4",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 0.36521760000000003,
    "prompt_tokens": 287404,
    "completion_tokens": 11153
  },
  "variant": "sound",
  "diff": "--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java\n@@ -267,20 +267,52 @@\n     }\n \n     private static Instant parseInstantFromDecimalSeconds(final String value) throws IOException {\n-        // Validate field values to prevent denial of service attacks with BigDecimal values (see JDK-6560193)\n+        // Validate field values to prevent denial of service attacks\n         if (!PAX_EXTENDED_HEADER_FILE_TIMES_PATTERN.matcher(value).matches()) {\n-            throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\");\n-        }\n-\n-        final BigDecimal epochSeconds = new BigDecimal(value);\n-        final long seconds = epochSeconds.longValue();\n-        final long nanos = epochSeconds.remainder(BigDecimal.ONE).movePointRight(9).longValue();\n+            throw new IOException(\"Corrupted PAX header. Time field value is invalid '\"\n+                                  + value + \"'\");\n+        }\n+        // Manual parse without BigDecimal to avoid expensive arbitrary-precision operations\n+        String secondsStr;\n+        String fracStr = \"\";\n+        int dotIndex = value.indexOf('.');\n+        if (dotIndex >= 0) {\n+            secondsStr = value.substring(0, dotIndex);\n+            fracStr = value.substring(dotIndex + 1);\n+        } else {\n+            secondsStr = value;\n+        }\n+        if (secondsStr.length() > 19) {\n+            throw new IOException(\"Corrupted PAX header. Time field value is too long '\"\n+                                  + value + \"'\");\n+        }\n+        long seconds;\n+        try {\n+            seconds = Long.parseLong(secondsStr);\n+        } catch (NumberFormatException e) {\n+            throw new IOException(\"Corrupted PAX header. Time field value is invalid '\"\n+                                  + value + \"'\", e);\n+        }\n+        int nanos = 0;\n+        if (!fracStr.isEmpty()) {\n+            if (fracStr.length() > 9) {\n+                fracStr = fracStr.substring(0, 9);\n+            }\n+            while (fracStr.length() < 9) {\n+                fracStr += '0';\n+            }\n+            try {\n+                nanos = Integer.parseInt(fracStr);\n+            } catch (NumberFormatException e) {\n+                throw new IOException(\"Corrupted PAX header. Time field value is invalid '\"\n+                                      + value + \"'\", e);\n+            }\n+        }\n         try {\n             return Instant.ofEpochSecond(seconds, nanos);\n         } catch (DateTimeException | ArithmeticException e) {\n-            // DateTimeException: Thrown if the instant exceeds the maximum or minimum instant.\n-            // ArithmeticException: Thrown if numeric overflow occurs.\n-            throw new IOException(\"Corrupted PAX header. Time field value is invalid '\" + value + \"'\", e);\n+            throw new IOException(\"Corrupted PAX header. Time field value is invalid '\"\n+                                  + value + \"'\", e);\n         }\n     }\n \n",
  "stdout": "",
  "stderr": ""
}