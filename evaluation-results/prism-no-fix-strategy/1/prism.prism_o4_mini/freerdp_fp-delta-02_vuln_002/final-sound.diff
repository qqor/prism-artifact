--- a/libfreerdp/crypto/x509_utils.c
+++ b/libfreerdp/crypto/x509_utils.c
@@ -449,13 +449,14 @@
 
         if (gen_name->type == GEN_DNS) {
 			// Allocate string length + 1 for security
-			dns_name = malloc( strlen((char *)ASN1_STRING_get0_data(gen_name->d.dNSName)) + 1);
-
-			if (dns_name == NULL)
-				goto end;
-			
-			memcpy(dns_name, (char *)ASN1_STRING_get0_data(gen_name->d.dNSName),  
-				ASN1_STRING_length(gen_name->d.dNSName)) ;
+			{
+				int len = ASN1_STRING_length(gen_name->d.dNSName);
+				dns_name = malloc((size_t)len + 1);
+				if (dns_name == NULL)
+					goto end;
+				memcpy(dns_name, ASN1_STRING_get0_data(gen_name->d.dNSName), len);
+				dns_name[len] = '\0';
+			}
 			
             if (!verify_san(dns_name)) {
 				free(dns_name);
