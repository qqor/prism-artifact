{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_4",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 1.9377710000000006,
    "prompt_tokens": 1580458,
    "completion_tokens": 45288
  },
  "variant": "sound",
  "diff": "--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.java\n@@ -53,6 +53,10 @@\n     private Token aheadToken;\n     private int openParens = 0;\n \n+    // guard to prevent infinite token reading\n+    private static final long MAX_LEXER_TOKENS = 1000000L;\n+    private long tokenCount;\n+\n     /**\n      * Constructs a new Type1Lexer given a header-less .pfb segment.\n      * @param bytes Header-less .pfb segment\n@@ -116,9 +120,11 @@\n      */\n     private Token readToken(Token prevToken) throws IOException\n     {\n+        if (++tokenCount > MAX_LEXER_TOKENS) {\n+            throw new IOException(\"Too many tokens read in lexer; possible infinite loop.\");\n+        }\n         boolean skip;\n-        do\n-        {\n+        do {\n             skip = false;\n             while (buffer.hasRemaining())\n             {\n",
  "stdout": "",
  "stderr": ""
}