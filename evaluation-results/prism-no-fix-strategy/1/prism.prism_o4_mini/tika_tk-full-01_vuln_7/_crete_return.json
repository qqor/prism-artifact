{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_7",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 1.603954,
    "prompt_tokens": 1384532,
    "completion_tokens": 18402
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n@@ -272,11 +272,17 @@\n         Metadata metadata = new Metadata();\n         metadata.set(TikaCoreProperties.RESOURCE_NAME_KEY, name);\n         try {\n-            URL url = new URL(urlString);\n-            URLConnection connection = url.openConnection();\n-            connection.setConnectTimeout(5000);\n-            try (TikaInputStream tis = TikaInputStream.get(connection.getInputStream())) {\n-                ex.parseEmbedded(tis, xhtml, metadata, false);\n+                 URL url = new URL(urlString);\n+                 String protocol = url.getProtocol();\n+                 if (\"http\".equalsIgnoreCase(protocol) || \"https\".equalsIgnoreCase(protocol)) {\n+                     // Skip remote HTTP/HTTPS URLs to prevent SSRF\n+                     return;\n+                 }\n+                 URLConnection connection = url.openConnection();\n+                 connection.setConnectTimeout(5000);\n+                 try (TikaInputStream tis =\n+                          TikaInputStream.get(connection.getInputStream())) {\n+                     ex.parseEmbedded(tis, xhtml, metadata, false);\n             }\n         } catch (Exception e) {\n             parentMetadata.set(TikaCoreProperties.EMBEDDED_EXCEPTION,\n",
  "stdout": "",
  "stderr": ""
}