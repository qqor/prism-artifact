{
  "project_name": "apache-poi",
  "vulnerability_identifier": "apache-poi_poi-full-01_vuln_1",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-poi",
  "llm_usage": {
    "total_cost": 0.31007680000000004,
    "prompt_tokens": 213024,
    "completion_tokens": 17216
  },
  "variant": "sound",
  "diff": "--- a/poi/src/main/java/org/apache/poi/util/StringUtil.java\n+++ b/poi/src/main/java/org/apache/poi/util/StringUtil.java\n@@ -30,6 +30,7 @@\n  */\n @Internal\n public final class StringUtil {\n+    private static final int MAX_UNICODE_CHARS = 100_000;\n     //arbitrarily selected; may need to increase\n     private static final int DEFAULT_MAX_RECORD_LENGTH = 10000000;\n     private static int MAX_RECORD_LENGTH = DEFAULT_MAX_RECORD_LENGTH;\n@@ -89,6 +90,9 @@\n         }\n         if ((len < 0) || (((string.length - offset) / 2) < len)) {\n             throw new IllegalArgumentException(\"Illegal length \" + len);\n+        }\n+        if (len > MAX_UNICODE_CHARS) {\n+            throw new IllegalArgumentException(\"Requested Unicode string length \" + len + \" exceeds limit \" + MAX_UNICODE_CHARS);\n         }\n \n         return new String(string, offset, len * 2, UTF16LE);\n",
  "stdout": "",
  "stderr": ""
}