{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_8",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 2.8651469000000014,
    "prompt_tokens": 2254079,
    "completion_tokens": 87650
  },
  "variant": "sound",
  "diff": "--- a/tika-core/src/main/java/org/apache/tika/utils/ProcessUtils.java\n+++ b/tika-core/src/main/java/org/apache/tika/utils/ProcessUtils.java\n@@ -84,11 +84,17 @@\n      * @return\n      * @throws IOException\n      */\n-    public static FileProcessResult execute(ProcessBuilder pb,\n-                                            long timeoutMillis,\n-                                            int maxStdoutBuffer, int maxStdErrBuffer)\n-            throws IOException {\n-        Process p = null;\n+public static FileProcessResult execute(ProcessBuilder pb,\n+                                        long timeoutMillis,\n+                                        int maxStdoutBuffer,\n+                                        int maxStdErrBuffer)\n+        throws IOException {\n+    // By default, disable external process execution to prevent OS command injection.\n+    // Set system property tika.enable.external.exec=true to allow executions.\n+    if (!Boolean.getBoolean(\"tika.enable.external.exec\")) {\n+        return new FileProcessResult();\n+    }\n+    Process p = null;\n         String id = null;\n         try {\n             p = pb.start();\n",
  "stdout": "",
  "stderr": ""
}