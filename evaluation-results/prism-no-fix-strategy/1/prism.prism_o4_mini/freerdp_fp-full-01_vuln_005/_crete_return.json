{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-full-01_vuln_005",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 1.1324885,
    "prompt_tokens": 869267,
    "completion_tokens": 40067
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/core/freerdp.c\n+++ b/libfreerdp/core/freerdp.c\n@@ -1452,6 +1452,13 @@\n \tWINPR_ASSERT(data || (size == 0));\n \tWINPR_ASSERT(s);\n \n+\t/* Validate and consume TPKT header */\n+\t{\n+\t\tUINT16 tpktLength = 0;\n+\t\tif (!tpkt_read_header(s, &tpktLength) || (tpktLength < 4) || (tpktLength > size))\n+\t\t\treturn FALSE;\n+\t}\n+\n \trdpMcs* mcs = test_mcs_new();\n \tWINPR_ASSERT(mcs);\n \n\n--- a/libfreerdp/core/mcs.c\n+++ b/libfreerdp/core/mcs.c\n@@ -905,6 +905,14 @@\n \tif (!mcs || !s)\n \t\treturn FALSE;\n \n+\t/* Ensure transport and context are valid */\n+\tif (!mcs->transport)\n+\t\treturn FALSE;\n+\n+\trdpContext* context = transport_get_context(mcs->transport);\n+\tif (!context)\n+\t\treturn FALSE;\n+\n \tif (!tpkt_read_header(s, &tlength))\n \t\treturn FALSE;\n \n",
  "stdout": "",
  "stderr": ""
}