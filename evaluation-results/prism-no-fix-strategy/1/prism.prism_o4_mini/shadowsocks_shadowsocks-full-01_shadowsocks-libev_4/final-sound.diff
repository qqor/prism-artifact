--- a/src/json.c
+++ b/src/json.c
@@ -599,11 +599,11 @@
 
                      case 't':
 
-                        if ((end - state.ptr) < 3 || *(++ state.ptr) != 'r' ||
-                            *(++ state.ptr) != 'u' || *(++ state.ptr) != 'e')
+                        if ((end - state.ptr) < 4 ||
+                            *++state.ptr != 'r' ||
+                            *++state.ptr != 'u' ||
+                            *++state.ptr != 'e')
                         {
-                           goto e_unknown_value;
-                        }
 
                         if (!new_value (&state, &top, &root, &alloc, json_boolean))
                            goto e_alloc_failure;
@@ -615,10 +615,11 @@
 
                      case 'f':
 
-                        if ((end - state.ptr) < 4 || *(++ state.ptr) != 'a' ||
-                            *(++ state.ptr) != 'l' || *(++ state.ptr) != 's' ||
-                            *(++ state.ptr) != 'e')
-                        {
+                        if ((end - state.ptr) < 5 ||
+                            *++state.ptr != 'a' ||
+                            *++state.ptr != 'l' ||
+                            *++state.ptr != 's' ||
+                            *++state.ptr != 'e')
                            goto e_unknown_value;
                         }
 
