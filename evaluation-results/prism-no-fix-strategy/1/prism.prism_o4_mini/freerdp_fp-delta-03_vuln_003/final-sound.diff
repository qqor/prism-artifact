--- a/libfreerdp/codec/rfx.c
+++ b/libfreerdp/codec/rfx.c
@@ -731,8 +731,10 @@
 		WLog_Print(context->priv->log, WLOG_ERROR, "invalid magic number 0x%08" PRIX32 "", magic);
 		return FALSE;
 	}
-	*(UINT64*)metadataBlock = metadataData;
-	return TRUE;
+    /* Dropping metadata blocks to avoid unsafe pointer writes */
+    WLog_Print(context->priv->log, WLOG_ERROR,
+               "rfx_process_message_metadata: skipping metadata block");
+    return FALSE;
 }
 
 static INLINE BOOL rfx_resize_rects(RFX_MESSAGE* WINPR_RESTRICT message)
