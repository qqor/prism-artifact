--- a/libexif/exif-data.c
+++ b/libexif/exif-data.c
@@ -40,6 +40,7 @@
 #include <stdlib.h>
 #include <stdio.h>
 #include <string.h>
+#include <limits.h>
 
 #undef JPEG_MARKER_SOI
 #define JPEG_MARKER_SOI  0xd8
@@ -182,9 +183,9 @@
 	 *   -> { 0x000000000 .. 0x7fffffff8 } */
 	s = exif_format_get_size(entry->format) * entry->components;
 	if ((s < entry->components) || (s == 0)){
-		return 0;
-	}
-
+            exif_log(data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
+                     "Inline tag data extends past directory region (%zu > %zu)",
+                     (size_t)offset + 8 + s, (size_t)size);
 	/*
 	 * Size? If bigger than 4 bytes, the actual data is not
 	 * in the entry but somewhere else (offset).
@@ -192,9 +193,9 @@
 	if (s > 4)
 		doff = exif_get_long (d + offset + 8, data->priv->order);
 	else
-		doff = offset + 8;
-
-	/* Sanity checks */
+            exif_log(data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
+                     "External data offset extends past directory region (%zu > %zu)",
+                     (size_t)offset + 8 + 4, (size_t)size);
 	if (doff >= size) {
 		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
 				  "Tag starts past end of buffer (%u > %u)", doff, size);
