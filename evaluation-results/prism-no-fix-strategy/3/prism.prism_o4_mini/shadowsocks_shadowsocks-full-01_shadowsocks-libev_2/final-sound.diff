--- a/src/json.c
+++ b/src/json.c
@@ -599,10 +599,13 @@
 
                      case 't':
 
-                        if ((end - state.ptr) < 3 || *(++ state.ptr) != 'r' ||
-                            *(++ state.ptr) != 'u' || *(++ state.ptr) != 'e')
+                        /* require at least "true" (4 chars) remaining, not just 3 */
+                        if ((end - state.ptr) < 4 ||
+                            *(++state.ptr) != 'r' ||
+                            *(++state.ptr) != 'u' ||
+                            *(++state.ptr) != 'e')
                         {
-                           goto e_unknown_value;
+                            goto e_unknown_value;
                         }
 
                         if (!new_value (&state, &top, &root, &alloc, json_boolean))
