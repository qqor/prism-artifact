--- a/poi/src/main/java/org/apache/poi/util/StringUtil.java
+++ b/poi/src/main/java/org/apache/poi/util/StringUtil.java
@@ -77,22 +77,27 @@
      *                                        length)
      */
     public static String getFromUnicodeLE(
-            final byte[] string,
-            final int offset,
-            final int len)
-            throws ArrayIndexOutOfBoundsException, IllegalArgumentException {
+        final byte[] string,
+        final int offset,
+        final int len)
+    throws ArrayIndexOutOfBoundsException, IllegalArgumentException {
         if (len == 0) {
             return "";
         }
+        // Prevent unbounded allocation: cap Unicode string length
+        if (len > getMaxRecordLength()) {
+            throw new IllegalArgumentException("Requested Unicode string length " + len
+                + " exceeds maximum allowed " + getMaxRecordLength());
+        }
         if ((offset < 0) || (offset >= string.length)) {
             throw new ArrayIndexOutOfBoundsException("Illegal offset " + offset + " (String data is of length " + string.length + ")");
         }
         if ((len < 0) || (((string.length - offset) / 2) < len)) {
             throw new IllegalArgumentException("Illegal length " + len);
         }
-
         return new String(string, offset, len * 2, UTF16LE);
     }
+
 
     /**
      * Given a byte array of 16-bit unicode characters in little endian
