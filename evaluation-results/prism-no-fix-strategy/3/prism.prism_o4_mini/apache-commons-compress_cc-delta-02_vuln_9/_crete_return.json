{
  "project_name": "apache-commons-compress",
  "vulnerability_identifier": "apache-commons-compress_cc-delta-02_vuln_9",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-commons-compress",
  "llm_usage": {
    "total_cost": 0.3129203,
    "prompt_tokens": 224089,
    "completion_tokens": 15096
  },
  "variant": "sound",
  "diff": "--- a/src/main/java/org/apache/commons/compress/compressors/lzw/LZWInputStream.java\n+++ b/src/main/java/org/apache/commons/compress/compressors/lzw/LZWInputStream.java\n@@ -178,10 +178,10 @@\n     protected void initializeTables(final int maxCodeSize) {\n         // maxCodeSize shifted cannot be less than 256, otherwise the loop in initializeTables() will throw an ArrayIndexOutOfBoundsException\n         // maxCodeSize cannot be smaller than getCodeSize(), otherwise addEntry() will throw an ArrayIndexOutOfBoundsException\n-        if (1 << maxCodeSize < 256 || getCodeSize() > maxCodeSize) {\n-            // TODO test against prefixes.length and characters.length?\n-            throw new IllegalArgumentException(\"maxCodeSize \" + maxCodeSize + \" is out of bounds.\");\n-        }\n+    if ((1 << maxCodeSize) < 256 || getCodeSize() > maxCodeSize || maxCodeSize > 16) {\n+\n+        throw new IllegalArgumentException(\"maxCodeSize \" + maxCodeSize + \" is out of bounds.\");\n+    }\n         final int maxTableSize = 1 << maxCodeSize;\n         prefixes = new int[maxTableSize];\n         characters = new byte[maxTableSize];\n",
  "stdout": "",
  "stderr": ""
}