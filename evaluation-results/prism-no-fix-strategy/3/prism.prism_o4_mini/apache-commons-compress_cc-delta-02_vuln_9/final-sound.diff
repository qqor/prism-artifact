--- a/src/main/java/org/apache/commons/compress/compressors/lzw/LZWInputStream.java
+++ b/src/main/java/org/apache/commons/compress/compressors/lzw/LZWInputStream.java
@@ -178,10 +178,10 @@
     protected void initializeTables(final int maxCodeSize) {
         // maxCodeSize shifted cannot be less than 256, otherwise the loop in initializeTables() will throw an ArrayIndexOutOfBoundsException
         // maxCodeSize cannot be smaller than getCodeSize(), otherwise addEntry() will throw an ArrayIndexOutOfBoundsException
-        if (1 << maxCodeSize < 256 || getCodeSize() > maxCodeSize) {
-            // TODO test against prefixes.length and characters.length?
-            throw new IllegalArgumentException("maxCodeSize " + maxCodeSize + " is out of bounds.");
-        }
+    if ((1 << maxCodeSize) < 256 || getCodeSize() > maxCodeSize || maxCodeSize > 16) {
+
+        throw new IllegalArgumentException("maxCodeSize " + maxCodeSize + " is out of bounds.");
+    }
         final int maxTableSize = 1 << maxCodeSize;
         prefixes = new int[maxTableSize];
         characters = new byte[maxTableSize];
