--- a/libexif/fuji/exif-mnote-data-fuji.c
+++ b/libexif/fuji/exif-mnote-data-fuji.c
@@ -168,16 +168,28 @@
 			  "ExifMnoteDataFuji", "Short MakerNote");
 		return;
 	}
-	datao = 6 + n->offset;
-
-	n->order = EXIF_BYTE_ORDER_INTEL;
-
-	datao += exif_get_long (buf + datao + 8, EXIF_BYTE_ORDER_INTEL);
-	if (CHECKOVERFLOW(datao, buf_size, 2)) {
-		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
-			  "ExifMnoteDataFuji", "Short MakerNote");
-		return;
-	}
+    datao = 6 + n->offset;
+
+    n->order = EXIF_BYTE_ORDER_INTEL;
+
+    /* Ensure enough bytes to read maker-note offset (4 bytes) */
+    if (CHECKOVERFLOW(datao + 8, buf_size, 4)) {
+        exif_log(en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+                 "ExifMnoteDataFuji",
+                 "Short MakerNote");
+        return;
+    }
+
+    datao += exif_get_long (buf + datao + 8,
+                            EXIF_BYTE_ORDER_INTEL);
+
+    /* Ensure enough bytes to read number of entries (2 bytes) */
+    if (CHECKOVERFLOW(datao, buf_size, 2)) {
+        exif_log(en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+                 "ExifMnoteDataFuji",
+                 "Short MakerNote");
+        return;
+    }
 
 	/* Read the number of tags */
 	c = exif_get_short (buf + datao, EXIF_BYTE_ORDER_INTEL);
