{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-full-01_vuln_010",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.33337040000000007,
    "prompt_tokens": 236532,
    "completion_tokens": 16633
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-netbios.c\n+++ b/epan/dissectors/packet-netbios.c\n@@ -703,11 +703,14 @@\n \tflag = tvb_get_uint8(tvb, offset + NB_DATA1);\n \n \t/* Allocate buffer for signature field */\n-\tif (flag & 0x80) {\n-\t\tsignature = g_malloc( NB_SIZE_HMAC + 1);\n-\t} else {\n-\t\tsignature = g_malloc( NB_SIZE_TMAC + 1);\n-\t}\n+/* Determine raw signature length based on flag */\n+int sig_len;\n+if (flag & 0x80)\n+    sig_len = NB_SIZE_HMAC;\n+else\n+    sig_len = NB_SIZE_TMAC;\n+/* Allocate buffer for hex-encoded signature (2 chars per byte + null) */\n+signature = g_malloc(sig_len * 2 + 1);\n \n \tif (signature == NULL)\n \t\treturn 0;\n@@ -719,14 +722,13 @@\n     proto_tree_add_item(ttree, hf_netb_trace_signature, tvb, offset + NB_SIGNATURE, 8, ENC_NA);\n \n \t/* Convert signature field to a string */\n-\twhile ( tvb_offset_exists(tvb, offset + NB_SIGNATURE + i) ) {\n-\t\tbyte = tvb_get_uint8(tvb, offset + NB_SIGNATURE + i);\n-\n-\t\tsignature[index++] = hex_digits[byte >> 4];\n-\t\tsignature[index++] = hex_digits[byte & 0x0F];\n-\n-\t\ti++;\n-\t}\n+/* Convert each byte up to the raw signature length to hex */\n+while (i < sig_len && tvb_offset_exists(tvb, offset + NB_SIGNATURE + i)) {\n+    byte = tvb_get_uint8(tvb, offset + NB_SIGNATURE + i);\n+    signature[index++] = hex_digits[byte >> 4];\n+    signature[index++] = hex_digits[byte & 0x0F];\n+    i++;\n+}\n \n \tsignature[index] = '\\0';\n \t\n",
  "stdout": "",
  "stderr": ""
}