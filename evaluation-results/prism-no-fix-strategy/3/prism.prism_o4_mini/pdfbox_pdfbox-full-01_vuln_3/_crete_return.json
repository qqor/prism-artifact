{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_3",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 3.3159159000000007,
    "prompt_tokens": 2659529,
    "completion_tokens": 88735
  },
  "variant": "sound",
  "diff": "--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n@@ -44,6 +44,9 @@\n     private static final int EEXEC_KEY = 55665;\n     private static final int CHARSTRING_KEY = 4330;\n \n+    private static final int MAX_ENCODING_FETCH = 100000;\n+    private int encodingInvocationCount;\n+\n     // state\n     private Type1Lexer lexer;\n     private Type1Font font;\n@@ -191,6 +194,8 @@\n \n     private void readEncoding() throws IOException\n     {\n+        // reset guard counter for this invocation\n+        encodingInvocationCount = 0;\n         if (lexer.peekKind(Token.NAME))\n         {\n             String name = lexer.nextToken().getText();\n@@ -219,6 +224,9 @@\n                             || lexer.peekToken().getText().equals(\"readonly\")\n                             || lexer.peekToken().getText().equals(\"def\"))))\n             {\n+                if (++encodingInvocationCount > MAX_ENCODING_FETCH) {\n+                    throw new IOException(\"Exceeded max encoding fetch in parser\");\n+                }\n                 lexer.nextToken();\n             }\n             \n@@ -226,6 +234,9 @@\n             while (lexer.peekKind(Token.NAME) &&\n                     lexer.peekToken().getText().equals(\"dup\"))\n             {\n+                if (++encodingInvocationCount > MAX_ENCODING_FETCH) {\n+                    throw new IOException(\"Exceeded max encoding fetch in parser\");\n+                }\n                 read(Token.NAME, \"dup\");\n                 int code = read(Token.INTEGER).intValue();\n                 String name = read(Token.LITERAL).getText();\n",
  "stdout": "",
  "stderr": ""
}