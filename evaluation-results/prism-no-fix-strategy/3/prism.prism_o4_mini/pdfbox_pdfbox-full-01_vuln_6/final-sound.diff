--- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java
+++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java
@@ -121,8 +121,12 @@
      * @param pfb   The pfb-Array
      * @throws IOException in an IO-error occurs.
      */
-    private void parsePfb(final byte[] pfb) throws IOException 
-    {
+    private void parsePfb(final byte[] pfb) throws IOException
+    {
+        if (pfb.length > MAX_LENGTH)
+        {
+            throw new IOException("PFB file too large: " + pfb.length);
+        }
         if (pfb.length < PFB_HEADER_LENGTH)
         {
             throw new IOException("PFB header missing");
@@ -157,6 +161,11 @@
             size += in.read() << 8;
             size += in.read() << 16;
             size += in.read() << 24;
+            // guard each segment size to prevent excessive allocation
+            if (size < 0 || size > MAX_LENGTH)
+            {
+                throw new IOException("PFB segment size invalid: " + size);
+            }
             LOG.debug("record type: {}, segment size: {}", recordType, size);
             long newTotal = total + size;
             if (newTotal > MAX_LENGTH) {
