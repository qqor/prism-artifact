{
  "project_name": "systemd",
  "vulnerability_identifier": "systemd_systemd-full-001_systemd-004",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-systemd",
  "llm_usage": {
    "total_cost": 0.21079630000000002,
    "prompt_tokens": 133897,
    "completion_tokens": 14434
  },
  "variant": "sound",
  "diff": "--- a/src/shared/condition.c\n+++ b/src/shared/condition.c\n@@ -96,14 +96,24 @@\n         return mfree(c);\n }\n \n-Condition* condition_free_list_type(Condition *head, ConditionType type) {\n-        LIST_FOREACH(conditions, c, head)\n-                if (type < 0 || c->type == type) {\n-                        condition_free(c);\n-                }\n-\n-        assert(type >= 0 || !head);\n-        return head;\n+Condition* condition_free_list_type(Condition* head, ConditionType type)\n+{\n+    Condition *c, *next, *new_head = head;\n+    for (c = head; c; c = next) {\n+        next = c->conditions_next;\n+        if (type < 0 || c->type == type) {\n+            if (c->conditions_prev)\n+                c->conditions_prev->conditions_next = c->conditions_next;\n+            if (c->conditions_next)\n+                c->conditions_next->conditions_prev = c->conditions_prev;\n+            if (new_head == c)\n+                new_head = c->conditions_next;\n+            condition_free(c);\n+        }\n+    }\n+\n+    assert(type >= 0 || !new_head);\n+    return new_head;\n }\n \n static int condition_test_kernel_command_line(Condition *c, char **env) {\n",
  "stdout": "",
  "stderr": ""
}