--- a/epan/dissectors/packet-aim.c
+++ b/epan/dissectors/packet-aim.c
@@ -581,16 +581,17 @@
 static int
 aim_get_buddyname(wmem_allocator_t *pool, uint8_t **name, tvbuff_t *tvb, int offset)
 {
-	uint16_t buddyname_length;
-
-	*name = wmem_alloc(pool, 256);
-
-	buddyname_length = tvb_get_ntohs(tvb, offset);
-
-	if (pool)
-		memcpy(*name, tvb_get_ptr(tvb,offset,1), buddyname_length);
-
-	return buddyname_length;
+    uint16_t buddyname_length, copylen;
+
+    buddyname_length = tvb_get_ntohs(tvb, offset);
+    copylen = buddyname_length;
+    if (copylen > 255)
+        copylen = 255;
+    *name = wmem_alloc(pool, copylen + 1);
+    if (pool)
+        memcpy(*name, tvb_get_ptr(tvb, offset + 2, copylen), copylen);
+    (*name)[copylen] = '\0';
+    return buddyname_length;
 }
 
 
