{
  "project_name": "shadowsocks",
  "vulnerability_identifier": "shadowsocks_shadowsocks-full-01_shadowsocks-libev_4",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-shadowsocks-libev",
  "llm_usage": {
    "total_cost": 3.215591500000001,
    "prompt_tokens": 2394721,
    "completion_tokens": 132136
  },
  "variant": "vulnerable",
  "diff": "--- a/src/json.c\n+++ b/src/json.c\n@@ -303,7 +303,8 @@\n                   case 't':  string_add ('\\t');  break;\n                   case 'u':\n \n-                    if (end - state.ptr < 4 || \n+                    /* require at least 'u' + 4 hex digits = 5 bytes */\n+                    if (end - state.ptr < 5 || \n                         (uc_b1 = hex_value (*++ state.ptr)) == 0xFF ||\n                         (uc_b2 = hex_value (*++ state.ptr)) == 0xFF ||\n                         (uc_b3 = hex_value (*++ state.ptr)) == 0xFF ||\n@@ -320,7 +321,8 @@\n                     if ((uchar & 0xF800) == 0xD800) {\n                         json_uchar uchar2;\n                         \n-                        if (end - state.ptr < 6 || (*++ state.ptr) != '\\\\' || (*++ state.ptr) != 'u' ||\n+                        /* require at least '\\u' + 4 hex digits = 7 bytes */\n+                        if (end - state.ptr < 7 || (*++ state.ptr) != '\\\\' || (*++ state.ptr) != 'u' ||\n                             (uc_b1 = hex_value (*++ state.ptr)) == 0xFF ||\n                             (uc_b2 = hex_value (*++ state.ptr)) == 0xFF ||\n                             (uc_b3 = hex_value (*++ state.ptr)) == 0xFF ||\n",
  "stdout": "+ FUZZER=json_fuzz\r\n+ shift\r\n+ '[' '!' -v TESTCASE ']'\r\n+ TESTCASE=/testcase\r\n+ '[' '!' -f /testcase ']'\r\n+ export RUN_FUZZER_MODE=interactive\r\n+ RUN_FUZZER_MODE=interactive\r\n+ export FUZZING_ENGINE=libfuzzer\r\n+ FUZZING_ENGINE=libfuzzer\r\n+ export SKIP_SEED_CORPUS=1\r\n+ SKIP_SEED_CORPUS=1\r\n+ run_fuzzer json_fuzz -runs=100 /testcase\r\nvm.mmap_rnd_bits = 28\r\n/out/json_fuzz -rss_limit_mb=2560 -timeout=25 -runs=100 /testcase -timeout_exitcode=0 < /dev/null\r\nINFO: Running with entropic power schedule (0xFF, 100).\r\nINFO: Seed: 3164748336\r\nINFO: Loaded 1 modules   (1917 inline 8-bit counters): 1917 [0x56112e1f7ff0, 0x56112e1f876d), \r\nINFO: Loaded 1 PC tables (1917 PCs): 1917 [0x56112e1f8770,0x56112e1fff40), \r\n/out/json_fuzz: Running 1 inputs 100 time(s) each.\r\nRunning: /testcase\r\n=================================================================\r\n==18==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x5020000000b5 at pc 0x56112e0935d4 bp 0x7fff31c62590 sp 0x7fff31c62588\r\nREAD of size 1 at 0x5020000000b5 thread T0\r\nSCARINESS: 12 (1-byte-read-heap-buffer-overflow)\r\n    #0 0x56112e0935d3 in json_parse_ex /src/shadowsocks/src/json.c:622:29\r\n    #1 0x56112e0947ac in json_parse /src/shadowsocks/src/json.c:960:11\r\n    #2 0x56112e08dc04 in LLVMFuzzerTestOneInput /src/json_fuzz.c:12:9\r\n    #3 0x56112df44a80 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13\r\n    #4 0x56112df2fcf5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6\r\n    #5 0x56112df3578f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9\r\n    #6 0x56112df60a32 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\r\n    #7 0x7fe52b680082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)\r\n    #8 0x56112df27edd in _start (/out/json_fuzz+0x53edd)\r\n\r\nDEDUP_TOKEN: json_parse_ex--json_parse--LLVMFuzzerTestOneInput\r\n0x5020000000b5 is located 0 bytes after 5-byte region [0x5020000000b0,0x5020000000b5)\r\nallocated by thread T0 here:\r\n    #0 0x56112e05084f in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3\r\n    #1 0x56112e14fca3 in operator new(unsigned long) cxa_noexception.cpp\r\n    #2 0x56112df2fcf5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6\r\n    #3 0x56112df3578f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9\r\n    #4 0x56112df60a32 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10\r\n    #5 0x7fe52b680082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 5792732f783158c66fb4f3756458ca24e46e827d)\r\n\r\nDEDUP_TOKEN: __interceptor_malloc--operator new(unsigned long)--fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long)\r\nSUMMARY: AddressSanitizer: heap-buffer-overflow /src/shadowsocks/src/json.c:622:29 in json_parse_ex\r\nShadow bytes around the buggy address:\r\n  0x501ffffffe00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x501ffffffe80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x501fffffff00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x501fffffff80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\r\n  0x502000000000: fa fa 00 00 fa fa 00 fa fa fa 00 fa fa fa 00 fa\r\n=>0x502000000080: fa fa 05 fa fa fa[05]fa fa fa fa fa fa fa fa fa\r\n  0x502000000100: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x502000000180: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x502000000200: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x502000000280: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\n  0x502000000300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa\r\nShadow byte legend (one shadow byte represents 8 application bytes):\r\n  Addressable:           00\r\n  Partially addressable: 01 02 03 04 05 06 07 \r\n  Heap left redzone:       fa\r\n  Freed heap region:       fd\r\n  Stack left redzone:      f1\r\n  Stack mid redzone:       f2\r\n  Stack right redzone:     f3\r\n  Stack after return:      f5\r\n  Stack use after scope:   f8\r\n  Global redzone:          f9\r\n  Global init order:       f6\r\n  Poisoned by user:        f7\r\n  Container overflow:      fc\r\n  Array cookie:            ac\r\n  Intra object redzone:    bb\r\n  ASan internal:           fe\r\n  Left alloca redzone:     ca\r\n  Right alloca redzone:    cb\r\n==18==ABORTING\r\nsubprocess command returned a non-zero exit status: 1\n",
  "stderr": "INFO:__main__:Running: docker run --privileged --shm-size=2g --platform linux/amd64 --rm -i -e HELPER=True -e ARCHITECTURE=x86_64 -v /home/user/aixcc/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/shadowsocks:/out -v /tmp/tmp220u5679:/testcase -t ghcr.io/aixcc-finals/base-runner:v1.3.0 reproduce json_fuzz -runs=100.\n"
}