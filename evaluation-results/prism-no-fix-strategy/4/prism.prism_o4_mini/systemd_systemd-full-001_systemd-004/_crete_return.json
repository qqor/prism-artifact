{
  "project_name": "systemd",
  "vulnerability_identifier": "systemd_systemd-full-001_systemd-004",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-systemd",
  "llm_usage": {
    "total_cost": 0.8866946000000001,
    "prompt_tokens": 587462,
    "completion_tokens": 54656
  },
  "variant": "sound",
  "diff": "--- a/src/shared/condition.c\n+++ b/src/shared/condition.c\n@@ -97,11 +97,21 @@\n }\n \n Condition* condition_free_list_type(Condition *head, ConditionType type) {\n-        LIST_FOREACH(conditions, c, head)\n+        Condition *prev = NULL;\n+        Condition *c = head;\n+        while (c) {\n+                Condition *n = c->conditions_next;\n                 if (type < 0 || c->type == type) {\n+                        if (prev)\n+                                prev->conditions_next = n;\n+                        else\n+                                head = n;\n                         condition_free(c);\n+                } else {\n+                        prev = c;\n                 }\n-\n+                c = n;\n+        }\n         assert(type >= 0 || !head);\n         return head;\n }\n",
  "stdout": "",
  "stderr": ""
}