{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_3",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 2.3274163,
    "prompt_tokens": 1815845,
    "completion_tokens": 74997
  },
  "variant": "sound",
  "diff": "--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java\n@@ -43,7 +43,7 @@\n     // constants for encryption\n     private static final int EEXEC_KEY = 55665;\n     private static final int CHARSTRING_KEY = 4330;\n-\n+    private static final int MAX_ASCII_TOKENS = 10000;\n     // state\n     private Type1Lexer lexer;\n     private Type1Font font;\n@@ -214,18 +214,28 @@\n             // 0 1 255 {1 index exch /.notdef put } for\n             // we have to check \"readonly\" and \"def\" too\n             // as some fonts don't provide any dup-values, see PDFBOX-2134\n+            int tokenCountReadEnc = 0;\n             while (!(lexer.peekKind(Token.NAME)\n                     && (lexer.peekToken().getText().equals(\"dup\")\n                             || lexer.peekToken().getText().equals(\"readonly\")\n                             || lexer.peekToken().getText().equals(\"def\"))))\n             {\n+                if (tokenCountReadEnc++ > MAX_ASCII_TOKENS)\n+                {\n+                    throw new IOException(\"Too many tokens in readEncoding skip loop: \" + tokenCountReadEnc);\n+                }\n                 lexer.nextToken();\n             }\n-            \n+\n             Map<Integer, String> codeToName = new HashMap<>();\n-            while (lexer.peekKind(Token.NAME) &&\n-                    lexer.peekToken().getText().equals(\"dup\"))\n-            {\n+            int dupCountReadEnc = 0;\n+            while (lexer.peekKind(Token.NAME)\n+                    && lexer.peekToken().getText().equals(\"dup\"))\n+            {\n+                if (dupCountReadEnc++ > MAX_ASCII_TOKENS)\n+                {\n+                    throw new IOException(\"Too many dup entries in readEncoding: \" + dupCountReadEnc);\n+                }\n                 read(Token.NAME, \"dup\");\n                 int code = read(Token.INTEGER).intValue();\n                 String name = read(Token.LITERAL).getText();\n",
  "stdout": "",
  "stderr": ""
}