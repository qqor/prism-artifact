--- a/epan/dissectors/packet-netbios.c
+++ b/epan/dissectors/packet-netbios.c
@@ -703,11 +703,14 @@
 	flag = tvb_get_uint8(tvb, offset + NB_DATA1);
 
 	/* Allocate buffer for signature field */
-	if (flag & 0x80) {
-		signature = g_malloc( NB_SIZE_HMAC + 1);
-	} else {
-		signature = g_malloc( NB_SIZE_TMAC + 1);
-	}
+    if (flag & 0x80)
+    {
+        signature = g_malloc((NB_SIZE_HMAC * 2) + 1);
+    }
+    else
+    {
+        signature = g_malloc((NB_SIZE_TMAC * 2) + 1);
+    }
 
 	if (signature == NULL)
 		return 0;
