{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-full-01_vuln_005",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.35030710000000004,
    "prompt_tokens": 234089,
    "completion_tokens": 21093
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/core/freerdp.c\n+++ b/libfreerdp/core/freerdp.c\n@@ -1449,15 +1449,22 @@\n \twStream sbuffer = { 0 };\n \twStream* s = Stream_StaticConstInit(&sbuffer, data, size);\n \n-\tWINPR_ASSERT(data || (size == 0));\n-\tWINPR_ASSERT(s);\n-\n-\trdpMcs* mcs = test_mcs_new();\n-\tWINPR_ASSERT(mcs);\n-\n-\tBOOL result = mcs_recv_connect_response(mcs, s);\n-\ttest_mcs_free(mcs);\n-\treturn result;\n+    if (!data && (size != 0))\n+        return FALSE;\n+    if (!s)\n+        return FALSE;\n+\n+    rdpMcs* mcs = test_mcs_new();\n+    if (!mcs)\n+        return FALSE;\n+\n+    BOOL result = FALSE;\n+    if (mcs_recv_connect_initial(mcs, s))\n+        result = mcs_recv_connect_response(mcs, s);\n+\n+    test_mcs_free(mcs);\n+\n+    return result;\n }\n \n BOOL freerdp_persist_credentials(rdpContext* context)\n",
  "stdout": "",
  "stderr": ""
}