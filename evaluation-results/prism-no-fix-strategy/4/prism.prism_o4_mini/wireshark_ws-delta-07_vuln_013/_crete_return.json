{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-delta-07_vuln_013",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 0.2962113,
    "prompt_tokens": 247039,
    "completion_tokens": 5561
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-gvcp.c\n+++ b/epan/dissectors/packet-gvcp.c\n@@ -980,9 +980,12 @@\n {\n \tuint32_t value = 0;\n \t\n-\tvalue = tvb_get_letohl(tvb, offset);\n-\tgvcp_register_number[gvcp_register_count] = addr;\n-\tgvcp_register_value[gvcp_register_count++] = value;\n+    value = tvb_get_letohl(tvb, offset);\n+    if (gvcp_register_count < GVCP_MAX_REGISTER_COUNT) {\n+        gvcp_register_number[gvcp_register_count] = addr;\n+        gvcp_register_value[gvcp_register_count] = value;\n+        gvcp_register_count++;\n+    }\n \n \tswitch (addr)\n \t{\n@@ -1495,9 +1498,12 @@\n {\n \tuint32_t value = 0;\n \t\n-\tvalue = tvb_get_letohl(tvb, offset);\n-\tgvcp_register_number[gvcp_register_count] = addr;\n-\tgvcp_register_value[gvcp_register_count++] = value;\n+    value = tvb_get_letohl(tvb, offset);\n+    if (gvcp_register_count < GVCP_MAX_REGISTER_COUNT) {\n+        gvcp_register_number[gvcp_register_count] = addr;\n+        gvcp_register_value[gvcp_register_count] = value;\n+        gvcp_register_count++;\n+    }\n \n \tswitch (addr)\n \t{\n",
  "stdout": "",
  "stderr": ""
}