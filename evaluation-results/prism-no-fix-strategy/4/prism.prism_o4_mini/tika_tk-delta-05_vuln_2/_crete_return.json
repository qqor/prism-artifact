{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-delta-05_vuln_2",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.9855769000000001,
    "prompt_tokens": 841683,
    "completion_tokens": 13574
  },
  "variant": "sound",
  "diff": "--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java\n+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java\n@@ -1125,7 +1125,7 @@\n             }\n         }\n \n-        private File getOutputFile(String name, Metadata metadata, MediaType contentType) {\n+    private File getOutputFile(String name, Metadata metadata, MediaType contentType) throws IOException {\n             String ext = getExtension(contentType);\n             if (name.indexOf('.') == -1 && contentType != null) {\n                 name += ext;\n@@ -1157,16 +1157,23 @@\n             } catch (IllegalArgumentException e) {\n                 LOG.warn(\"couldn't url decode name {}\", normalizedName);\n             }\n-            File outputFile = new File(extractDir, normalizedName);\n-            //if file already exists, prepend uuid\n-            if (outputFile.exists()) {\n-                String fileName = FilenameUtils.getName(normalizedName);\n-                outputFile = new File(extractDir, UUID\n-                        .randomUUID()\n-                        .toString() + \"-\" + fileName);\n-            }\n-            return outputFile;\n-        }\n+        // resolve and normalize to prevent path traversal\n+        Path normalizedPath = extractDir.toPath()\n+            .resolve(normalizedName)\n+            .normalize();\n+        if (!normalizedPath.startsWith(extractDir.toPath())) {\n+          throw new IOException(\"Invalid embedded entry name: \" + normalizedName);\n+        }\n+        File outputFile = normalizedPath.toFile();\n+\n+        // if file already exists, prepend uuid\n+        if (outputFile.exists()) {\n+          String fileName = FilenameUtils.getName(normalizedName);\n+          outputFile = new File(extractDir,\n+              UUID.randomUUID().toString() + \"-\" + fileName);\n+        }\n+        return outputFile;\n+      }\n \n         private String getExtension(MediaType contentType) {\n             try {\n",
  "stdout": "",
  "stderr": ""
}