--- a/epan/dissectors/packet-telnet.c
+++ b/epan/dissectors/packet-telnet.c
@@ -632,14 +632,14 @@
   }
 }
 
-static void
-dissect_linemode_subopt(packet_info *pinfo, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,
+ static void
+ dissect_linemode_subopt(packet_info *pinfo _U_, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,
                     int len _U_, proto_tree *tree _U_, proto_item *item _U_)
 {
-  if ( hf_telnet_naws_subopt_set )
-    wmem_free(pinfo->pool, hf_naws_data);
-
-  return;
+  if (hf_telnet_naws_subopt_set) {
+    return;
+  }
+
 }
 
 static void
@@ -2321,6 +2321,7 @@
        */
       offset = telnet_command(pinfo, telnet_tree, tvb, iac_offset, &num_info_items);
     } else {
+        telnet_add_text(telnet_tree, tvb, offset, data_len);
       /* get more data if tn3270 */
       if (is_tn3270 || is_tn5250) {
         pinfo->desegment_offset = offset;
