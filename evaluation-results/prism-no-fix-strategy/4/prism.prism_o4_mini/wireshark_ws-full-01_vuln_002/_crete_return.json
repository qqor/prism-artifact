{
  "project_name": "wireshark",
  "vulnerability_identifier": "wireshark_ws-full-01_vuln_002",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-wireshark",
  "llm_usage": {
    "total_cost": 1.8922970000000006,
    "prompt_tokens": 1367866,
    "completion_tokens": 88101
  },
  "variant": "sound",
  "diff": "--- a/epan/dissectors/packet-telnet.c\n+++ b/epan/dissectors/packet-telnet.c\n@@ -632,14 +632,14 @@\n   }\n }\n \n-static void\n-dissect_linemode_subopt(packet_info *pinfo, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,\n+ static void\n+ dissect_linemode_subopt(packet_info *pinfo _U_, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,\n                     int len _U_, proto_tree *tree _U_, proto_item *item _U_)\n {\n-  if ( hf_telnet_naws_subopt_set )\n-    wmem_free(pinfo->pool, hf_naws_data);\n-\n-  return;\n+  if (hf_telnet_naws_subopt_set) {\n+    return;\n+  }\n+\n }\n \n static void\n@@ -2321,6 +2321,7 @@\n        */\n       offset = telnet_command(pinfo, telnet_tree, tvb, iac_offset, &num_info_items);\n     } else {\n+        telnet_add_text(telnet_tree, tvb, offset, data_len);\n       /* get more data if tn3270 */\n       if (is_tn3270 || is_tn5250) {\n         pinfo->desegment_offset = offset;\n",
  "stdout": "",
  "stderr": ""
}