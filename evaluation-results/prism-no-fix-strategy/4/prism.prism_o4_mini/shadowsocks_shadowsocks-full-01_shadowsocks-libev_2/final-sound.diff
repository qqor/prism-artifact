--- a/src/json.c
+++ b/src/json.c
@@ -597,21 +597,21 @@
 
                         continue;
 
-                     case 't':
-
-                        if ((end - state.ptr) < 3 || *(++ state.ptr) != 'r' ||
-                            *(++ state.ptr) != 'u' || *(++ state.ptr) != 'e')
-                        {
-                           goto e_unknown_value;
-                        }
-
-                        if (!new_value (&state, &top, &root, &alloc, json_boolean))
-                           goto e_alloc_failure;
-
-                        top->u.boolean = 1;
-
-                        flags |= flag_next;
-                        break;
+         case 't':
+             /* literal true: ensure we have "true" safely */
+             if ((size_t)(end - state.ptr) < 4 ||
+                 strncmp((char*)state.ptr, "true", 4) != 0)
+             {
+                 goto e_unknown_value;
+             }
+             /* skip over 'r','u','e' */
+             state.ptr += 3;
+
+             if (!new_value(&state, &top, &root, &alloc, json_boolean))
+                 goto e_alloc_failure;
+             top->u.boolean = 1;
+             flags |= flag_next;
+             break;
 
                      case 'f':
 
