{
  "project_name": "xz",
  "vulnerability_identifier": "xz_xz-full-01_xz-001",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-xz",
  "llm_usage": {
    "total_cost": 0.11864600000000002,
    "prompt_tokens": 60504,
    "completion_tokens": 11839
  },
  "variant": "sound",
  "diff": "--- a/src/liblzma/check/treeck.c\n+++ b/src/liblzma/check/treeck.c\n@@ -63,33 +63,37 @@\n }\n \n // Walk the tree to calculate the e37vk checksum\n-static uint32_t compute_tree_checksum(TreeNode *node, unsigned int depth)\n-{\n-  // Skip if already hashed\n-  if (!node || node->state == STATE_HASHED) {\n-    return 0;\n-  }\n+ static uint32_t compute_tree_checksum(TreeNode *node, unsigned int depth)\n+ {\n+     // Skip if null or already hashed\n+     if (!node || node->state == STATE_HASHED) {\n+         return 0;\n+     }\n \n-  // Compute initial checksum from depth and value\n-  uint32_t sum = node->value * (depth + 1);\n+     // Skip cycles: if node is already visited\n+     if (node->state == STATE_VISITED) {\n+         return 0;\n+     }\n \n-  // Traverse the child nodes if not already visited\n-  if (node->state == STATE_CLEAR) {\n-    node->state = STATE_VISITED;\n-    for (size_t i = 0; i < node->edge_count; ++i) {\n-      TreeNode *child = node->edges[i];\n-      if (child) {\n-        sum += compute_tree_checksum(child, depth + 1);\n-      }\n-    }\n-    node->state = STATE_HASHED;\n-  }\n+     // Compute initial checksum from depth and value\n+     uint32_t sum = node->value * (depth + 1);\n \n-  // Free the node and edges\n-  free(node->edges);\n-  free(node);\n+     // Mark as visited to detect cycles\n+     node->state = STATE_VISITED;\n \n-  return sum;\n+     // Traverse child nodes\n+     for (size_t i = 0; i < node->edge_count; ++i) {\n+         TreeNode *child = node->edges[i];\n+         if (child) {\n+             sum += compute_tree_checksum(child, depth + 1);\n+         }\n+     }\n+\n+     // Mark as hashed, free resources and return sum\n+     node->state = STATE_HASHED;\n+     free(node->edges);\n+     free(node);\n+     return sum;\n }\n \n extern LZMA_API(uint32_t)\n",
  "stdout": "",
  "stderr": ""
}