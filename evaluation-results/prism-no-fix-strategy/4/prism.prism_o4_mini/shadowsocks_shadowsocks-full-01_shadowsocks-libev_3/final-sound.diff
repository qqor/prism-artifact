--- a/src/json.c
+++ b/src/json.c
@@ -630,9 +630,14 @@
 
                      case 'n':
 
-                        if ((end - state.ptr) < 3 || *(++ state.ptr) != 'u' ||
-                            *(++ state.ptr) != 'l' || *(++ state.ptr) != 'l')
-                        {
+                case 'u':
+                    /* Ensure at least four hex digits and safe pointer increments */
+                    if (end - state.ptr < 5 ||
+                        (uc_b1 = hex_value(*++state.ptr)) == 0xFF ||
+                        (uc_b2 = hex_value(*++state.ptr)) == 0xFF ||
+                        (uc_b3 = hex_value(*++state.ptr)) == 0xFF ||
+                        (uc_b4 = hex_value(*++state.ptr)) == 0xFF)
+                    {
                            goto e_unknown_value;
                         }
 
