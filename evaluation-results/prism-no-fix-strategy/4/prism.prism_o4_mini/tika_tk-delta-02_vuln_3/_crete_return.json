{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-delta-02_vuln_3",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.6675350000000002,
    "prompt_tokens": 508254,
    "completion_tokens": 24649
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-audiovideo-module/src/main/java/org/apache/tika/parser/m3/M3U8Parser.java\n@@ -167,10 +167,8 @@\n         EmbeddedDocumentExtractor ex = EmbeddedDocumentUtil.getEmbeddedDocumentExtractor(context);\n         Metadata m = new Metadata();\n         if (ex.shouldParseEmbedded(m)) {\n-            try (TikaInputStream tis = TikaInputStream.get(new URL(nextLine))) {\n-                ex.parseEmbedded(tis, new BodyContentHandler(new EmbeddedContentHandler(xhtml)), m,\n-                        true);\n-            }\n+            // Skip fetching external resources to avoid SSRF\n+            return;\n         }\n     }\n \n",
  "stdout": "",
  "stderr": ""
}