--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -233,15 +233,20 @@
     return mnote_apple_entry_get_value(&d->entries[i], val, maxlen);
 }
 
-int
-exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e) {
+int exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e)
+{
     int variant;
-
-    if (!strcmp((const char *) e->data, "Apple iOS")) {
+    static const char apple_ident[] = "Apple iOS";
+
+    /* ensure data pointer is valid and buffer is large enough */
+    if (!e || !e->data || e->size < sizeof(apple_ident))
+        return 0;
+
+    /* compare only the prefix, avoid OOB read */
+    if (memcmp((const char *) e->data, apple_ident, sizeof(apple_ident) - 1) == 0)
         variant = 1;
-    } else {
+    else
         variant = 0;
-    }
 
     return variant;
 }
