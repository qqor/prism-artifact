{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-delta-02_vuln_002",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 0.08879970000000001,
    "prompt_tokens": 52615,
    "completion_tokens": 7028
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/crypto/x509_utils.c\n+++ b/libfreerdp/crypto/x509_utils.c\n@@ -447,16 +447,16 @@\n     for (i = 0; i < count; i++) {\n         GENERAL_NAME *gen_name = sk_GENERAL_NAME_value(san_names, i);\n \n-        if (gen_name->type == GEN_DNS) {\n-\t\t\t// Allocate string length + 1 for security\n-\t\t\tdns_name = malloc( strlen((char *)ASN1_STRING_get0_data(gen_name->d.dNSName)) + 1);\n-\n-\t\t\tif (dns_name == NULL)\n-\t\t\t\tgoto end;\n-\t\t\t\n-\t\t\tmemcpy(dns_name, (char *)ASN1_STRING_get0_data(gen_name->d.dNSName),  \n-\t\t\t\tASN1_STRING_length(gen_name->d.dNSName)) ;\n-\t\t\t\n+       if (gen_name->type == GEN_DNS)\n+       {\n+           size_t len = ASN1_STRING_length(gen_name->d.dNSName);\n+           // Allocate string length + 1 for null terminator\n+           dns_name = malloc(len + 1);\n+           if (dns_name == NULL)\n+               goto end;\n+\n+           memcpy(dns_name, ASN1_STRING_get0_data(gen_name->d.dNSName), len);\n+           dns_name[len] = '\\0';\n             if (!verify_san(dns_name)) {\n \t\t\t\tfree(dns_name);\n \t\t\t\tresult = FALSE;\n",
  "stdout": "",
  "stderr": ""
}