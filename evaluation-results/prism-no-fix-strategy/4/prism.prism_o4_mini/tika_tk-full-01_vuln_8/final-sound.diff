--- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
+++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java
@@ -68,9 +68,15 @@
             input.mark(SNIFF_LENGTH);
             byte[] bytes = IOUtils.readFully(input, SNIFF_LENGTH);
             String firstBytes = new String(bytes, StandardCharsets.UTF_8);
-            if (firstBytes.startsWith("#!/") || firstBytes.startsWith("#!\\ ") ||
-                    firstBytes.startsWith("#!\t")) {
-                isShell = true;
+            if (firstBytes.startsWith("#!/")) {
+                int newlineIdx = firstBytes.indexOf('\n');
+                String shebangLine = newlineIdx >= 0
+                        ? firstBytes.substring(0, newlineIdx)
+                        : firstBytes;
+                String[] parts = shebangLine.substring(2).trim().split("\\s+");
+                if (parts.length == 1) {
+                    isShell = true;
+                }
             }
         } catch (EOFException e) {
             return isShell(false);
@@ -85,29 +91,8 @@
             return isShell(isShell);
         }
         //now test for no-arg shell script
-        TikaInputStream tis = TikaInputStream.get(CloseShieldInputStream.wrap(input));
-        fileName = FilenameUtils.getName(fileName);
-        fileName = fileName.replaceAll("[^-_0-9A-Za-z.]+", "");
-        fileName = fileName.replaceAll("\\.\\.", "");
-
-        if (fileName.length() > MAX_LENGTH) {
-            fileName = fileName.substring(fileName.length() - MAX_LENGTH);
-        }
-        Path cwd = Paths.get(".").toAbsolutePath().normalize();
-        Path tmpDir = Files.createTempDirectory(cwd, "tika-shell-detect-");
-        Path tmpFile = tmpDir.resolve(fileName);
-        Files.copy(tis.getPath(), tmpFile, StandardCopyOption.REPLACE_EXISTING);
-        ProcessBuilder pb = new ProcessBuilder(fileName);
-        pb.directory(tmpDir.toFile());
-        try {
-            FileProcessResult result = ProcessUtils.execute(pb, 20000, 100000, 100000);
-            if (result.getExitValue() == 0) {
-                metadata.set(SHELL_NO_ARGS, true);
-            }
-        } finally {
-            FileUtils.deleteDirectory(tmpDir.toFile());
-        }
-        return SHELL_SCRIPT;
+        // skip external execution and return based on shebang or extension
+        return isShell ? SHELL_SCRIPT : MediaType.OCTET_STREAM;
     }
 
     private MediaType isShell(boolean isShell) {
