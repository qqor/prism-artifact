{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_7",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.6600726,
    "prompt_tokens": 553094,
    "completion_tokens": 11743
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/TextAndCSVParser.java\n@@ -19,6 +19,8 @@\n import java.io.BufferedReader;\n import java.io.IOException;\n import java.io.InputStream;\n+import java.util.Locale;\n+import org.apache.tika.metadata.TikaCoreProperties;\n import java.io.InputStreamReader;\n import java.io.Reader;\n import java.io.UncheckedIOException;\n@@ -272,12 +274,18 @@\n         Metadata metadata = new Metadata();\n         metadata.set(TikaCoreProperties.RESOURCE_NAME_KEY, name);\n         try {\n-            URL url = new URL(urlString);\n-            URLConnection connection = url.openConnection();\n-            connection.setConnectTimeout(5000);\n-            try (TikaInputStream tis = TikaInputStream.get(connection.getInputStream())) {\n-                ex.parseEmbedded(tis, xhtml, metadata, false);\n-            }\n+           String lower = urlString.toLowerCase(Locale.ROOT);\n+           if (lower.startsWith(\"http://\") || lower.startsWith(\"https://\")) {\n+               parentMetadata.set(TikaCoreProperties.EMBEDDED_EXCEPTION,\n+                       \"Network access disabled for URL: \" + urlString);\n+               return;\n+           }\n+           URL url = new URL(urlString);\n+           URLConnection connection = url.openConnection();\n+           connection.setConnectTimeout(5000);\n+           try (TikaInputStream tis = TikaInputStream.get(connection.getInputStream())) {\n+               ex.parseEmbedded(tis, xhtml, metadata, false);\n+           }\n         } catch (Exception e) {\n             parentMetadata.set(TikaCoreProperties.EMBEDDED_EXCEPTION,\n                     ExceptionUtils.getStackTrace(e));\n",
  "stdout": "",
  "stderr": ""
}