--- a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
@@ -21,7 +21,7 @@
 import java.nio.file.Files;
 import java.nio.file.Path;
 import java.nio.file.Paths;
-
+import java.nio.file.StandardCopyOption;
 import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
 import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
 
@@ -36,18 +36,21 @@
         try (InputStream is = Files.newInputStream(inputFile);
                 TarArchiveInputStream tais = new TarArchiveInputStream(is)) {
 
-            TarArchiveEntry tae = tais.getNextEntry();
-
-            while (tae != null) {
-                if (tae.isFile()) {
-                    Path target = extractDir.resolve(tae.getName()).normalize();
-                    if (!Files.isDirectory(target.getParent())) {
-                        Files.createDirectories(target.getParent());
+                    TarArchiveEntry tae;
+                    while ((tae = tais.getNextEntry()) != null) {
+                        if (!tae.isFile()) {
+                            continue;
+                        }
+                        Path target = extractDir.resolve(tae.getName()).normalize().toAbsolutePath();
+                        Path destDir = extractDir.toAbsolutePath().normalize();
+                        if (!target.startsWith(destDir)) {
+                            continue;
+                        }
+                        if (!Files.isDirectory(target.getParent())) {
+                            Files.createDirectories(target.getParent());
+                        }
+                        Files.copy(tais, target, StandardCopyOption.REPLACE_EXISTING);
                     }
-                    Files.write(target, tais.readAllBytes());
-                }
-                tae = tais.getNextEntry();
-            }
         }
     }
 }
