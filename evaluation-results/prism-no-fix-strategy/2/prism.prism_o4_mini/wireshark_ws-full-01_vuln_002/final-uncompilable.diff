--- a/epan/dissectors/packet-telnet.c
+++ b/epan/dissectors/packet-telnet.c
@@ -636,8 +636,8 @@
 dissect_linemode_subopt(packet_info *pinfo, const char *optname _U_, tvbuff_t *tvb _U_, int offset _U_,
                     int len _U_, proto_tree *tree _U_, proto_item *item _U_)
 {
-  if ( hf_telnet_naws_subopt_set )
-    wmem_free(pinfo->pool, hf_naws_data);
+  /* hf_naws_data is managed by the packet pool; do not free manually */
+
 
   return;
 }
@@ -649,9 +649,10 @@
   hf_telnet_width = tvb_get_uint16(tvb, offset, ENC_BIG_ENDIAN);
   hf_telnet_height = tvb_get_uint16(tvb, offset + 2, ENC_BIG_ENDIAN);
 
-  hf_naws_data = (uint8_t *)wmem_alloc(pinfo->pool, hf_telnet_width * hf_telnet_height);
-
-  if ( hf_naws_data )
+  /* allocate NAWS data from the packet pool; autoâ€freed with the pool */
+  hf_naws_data = (uint8_t *)wmem_alloc(pinfo->pool,
+                                       hf_telnet_width * hf_telnet_height);
+  if (hf_naws_data)
     hf_telnet_naws_subopt_set = 1;
   else
     hf_telnet_naws_subopt_set = 0;
