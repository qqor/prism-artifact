{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-full-01_vuln_7",
  "source_directory": "/home/user/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.9316824,
    "prompt_tokens": 780396,
    "completion_tokens": 16647
  },
  "variant": "sound",
  "diff": "--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java\n@@ -21,6 +21,7 @@\n import java.util.Iterator;\n import java.util.Queue;\n import org.apache.pdfbox.cos.COSArray;\n+import java.util.ArrayList;\n import org.apache.pdfbox.cos.COSBase;\n import org.apache.pdfbox.cos.COSDictionary;\n import org.apache.pdfbox.cos.COSInteger;\n@@ -203,26 +204,40 @@\n          * @param node\n          * @return\n          */\n-        private List<COSDictionary> enqueueKids(COSDictionary node)\n-        {\n-            if (isPageTreeNode(node))\n-            {\n-                return getKids(node);\n-            }\n-            else\n-            {\n-                if (node != null && COSName.PAGE.equals(node.getCOSName(COSName.TYPE)))\n+    private List<COSDictionary> enqueueKids(COSDictionary node)\n+    {\n+        List<COSDictionary> result = new ArrayList<>();\n+        if (isPageTreeNode(node))\n+        {\n+            List<COSDictionary> kids = getKids(node);\n+            for (COSDictionary kid : kids)\n+            {\n+                if (pageSet.add(kid))\n+                {\n+                    queue.add(kid);\n+                    result.add(kid);\n+                }\n+            }\n+            return result;\n+        }\n+        else\n+        {\n+            if (node != null && COSName.PAGE.equals(node.getCOSName(COSName.TYPE)))\n+            {\n+                if (pageSet.add(node))\n                 {\n                     queue.add(node);\n+                    result.add(node);\n                 }\n-                else\n-                {\n-                    LOG.error(\"Page skipped due to an invalid or missing type {}\",\n-                            () -> (node == null ? \"(null)\" : node.getCOSName(COSName.TYPE)));\n-                }\n-            }\n-            return Collections.EMPTY_LIST;\n-        }\n+            }\n+            else\n+            {\n+                LOG.error(\"Page skipped due to invalid or missing type {}\",\n+                          () -> (node == null ? \"(null)\" : node.getCOSName(COSName.TYPE)));\n+            }\n+        }\n+        return result;\n+    }\n \n         @Override\n         public boolean hasNext()\n",
  "stdout": "",
  "stderr": ""
}