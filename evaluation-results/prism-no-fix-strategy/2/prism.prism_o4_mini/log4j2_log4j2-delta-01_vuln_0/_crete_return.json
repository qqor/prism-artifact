{
  "project_name": "log4j2",
  "vulnerability_identifier": "log4j2_log4j2-delta-01_vuln_0",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-logging-log4j2",
  "llm_usage": {
    "total_cost": 3.2243904000000008,
    "prompt_tokens": 2462060,
    "completion_tokens": 117301
  },
  "variant": "wrong",
  "diff": "--- a/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java\n+++ b/core/src/main/java/org/apache/logging/log4j/core/lookup/JndiLookup.java\n@@ -28,12 +28,27 @@\n @Plugin(name = \"jndi\", category = \"Lookup\")\n public class JndiLookup implements StrLookup {\n \n-    private static boolean ENABLE_JNDI = true;\n+    private static boolean ENABLE_JNDI = false;\n+\n+    /**\n+     * Enables or disables JNDI lookups.\n+     * When disabled (the default), remote JNDI lookups are suppressed.\n+     */\n+    public static void setEnableJndi(final boolean enable) {\n+        ENABLE_JNDI = enable;\n+    }\n+\n+    /**\n+     * Checks if JNDI lookups are enabled.\n+     *\n+     * @return true if JNDI lookups are enabled.\n+     */\n+    public static boolean isEnableJndi() {\n+        return ENABLE_JNDI;\n+    }\n \n     /** JNDI resourcce path prefix used in a J2EE container */\n     static final String CONTAINER_JNDI_RESOURCE_PATH_PREFIX = \"java:comp/env/\";\n-\n-    /**\n      * Get the value of the JNDI resource.\n      * @param key  the JNDI resource name to be looked up, may be null\n      * @return The value of the JNDI resource.\n@@ -51,7 +66,7 @@\n      */\n     @Override\n     public String lookup(final LogEvent event, final String key) {\n-        if (key == null || ! ENABLE_JNDI) {\n+        if (!isEnableJndi() || key == null) {\n             return null;\n         }\n \n\n--- a/core/pom.xml\n+++ b/core/pom.xml\n@@ -113,7 +113,14 @@\n       <groupId>org.mockejb</groupId>\n       <artifactId>mockejb</artifactId>\n       <scope>test</scope>\n-    </dependency>\n+      </dependency>\n+      <!-- MockEJB JNDI dependency for tests -->\n+      <dependency>\n+        <groupId>org.mockejb</groupId>\n+        <artifactId>mockejb-jndi</artifactId>\n+        <version>2.0.0</version>\n+        <scope>test</scope>\n+      </dependency>\n     <dependency>\n       <groupId>ch.qos.logback</groupId>\n       <artifactId>logback-core</artifactId>\n\n--- a/core/src/test/java/org/apache/logging/log4j/core/lookup/JndiLookupTest.java\n+++ b/core/src/test/java/org/apache/logging/log4j/core/lookup/JndiLookupTest.java\n@@ -27,7 +27,9 @@\n import org.junit.Before;\n import org.junit.Test;\n import org.mockejb.jndi.MockContextFactory;\n-\n+import org.apache.logging.log4j.core.lookup.JndiLookup;\n+import static org.apache.logging.log4j.core.lookup.JndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX;\n+import org.apache.logging.log4j.core.LogEvent;\n /**\n  * JndiLookupTest\n  */\n@@ -38,9 +40,10 @@\n \n     @Before\n     public void before() throws NamingException {\n+        JndiLookup.setEnableJndi(true);\n         MockContextFactory.setAsInitial();\n         Context context = new InitialContext();\n-        context.bind(JndiLookup.CONTAINER_JNDI_RESOURCE_PATH_PREFIX + TEST_CONTEXT_RESOURCE_NAME, TEST_CONTEXT_NAME);\n+        context.bind(CONTAINER_JNDI_RESOURCE_PATH_PREFIX + TEST_CONTEXT_RESOURCE_NAME, TEST_CONTEXT_NAME);\n     }\n \n     @After\n@@ -64,4 +67,12 @@\n         String nonExistingResource = lookup.lookup(\"logging/non-existing-resource\");\n         assertNull(nonExistingResource);\n     }\n+\n+    @Test\n+    public void testDisabledByDefault() {\n+        // Default JNDI lookups are disabled\n+        final JndiLookup lookup = new JndiLookup();\n+        assertNull(lookup.lookup(\"someResource\"));\n+        assertNull(lookup.lookup((LogEvent) null, TEST_CONTEXT_RESOURCE_NAME));\n+    }\n }\n",
  "stdout": "",
  "stderr": "Permission denied: '/home/qqor/aixcc/crete/.cache/official-afc-logging-log4j2/core/pom.xml' cannot be modified because it is not a valid language file"
}