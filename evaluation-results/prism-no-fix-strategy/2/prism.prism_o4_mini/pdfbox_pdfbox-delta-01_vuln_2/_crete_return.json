{
  "project_name": "pdfbox",
  "vulnerability_identifier": "pdfbox_pdfbox-delta-01_vuln_2",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-pdfbox",
  "llm_usage": {
    "total_cost": 0.24176350000000002,
    "prompt_tokens": 170097,
    "completion_tokens": 12422
  },
  "variant": "sound",
  "diff": "--- a/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java\n+++ b/pdfbox/src/main/java/org/apache/pdfbox/ocr/OCRStreamEngine.java\n@@ -178,9 +178,18 @@\n     private void doOCR(String actualTesseractPath, Path input, Path output)\n             throws IOException {\n \n+        // Validate the Tesseract executable path to prevent injection\n+        Path tessPath = Paths.get(actualTesseractPath).toAbsolutePath().normalize();\n+        if (!Files.exists(tessPath) || !Files.isRegularFile(tessPath) || !Files.isExecutable(tessPath)) {\n+            throw new IOException(\"Invalid Tesseract executable: \" + tessPath);\n+        }\n         ArrayList<String> cmd = new ArrayList<>(\n-                Arrays.asList(actualTesseractPath, input.toAbsolutePath().toString(),\n-                        output.toAbsolutePath().toString()));\n+            Arrays.asList(\n+                tessPath.toString(),\n+                input.toAbsolutePath().toString(),\n+                output.toAbsolutePath().toString()\n+            )\n+        );\n \n         ProcessBuilder pb = new ProcessBuilder(cmd);\n \n",
  "stdout": "",
  "stderr": ""
}