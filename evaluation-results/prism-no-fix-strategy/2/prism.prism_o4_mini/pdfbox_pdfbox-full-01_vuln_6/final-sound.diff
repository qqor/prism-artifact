--- a/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java
+++ b/fontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.java
@@ -159,6 +159,10 @@
             size += in.read() << 24;
             LOG.debug("record type: {}, segment size: {}", recordType, size);
             long newTotal = total + size;
+            // Prevent excessively large segments to avoid OutOfMemory
+            if (size < 0 || size > MAX_LENGTH) {
+                throw new IOException("segment size would be invalid or too large: " + size);
+            }
             if (newTotal > MAX_LENGTH) {
                 throw new IOException("record size would be too large: " + newTotal);
             }
