--- a/libfreerdp/codec/rfx.c
+++ b/libfreerdp/codec/rfx.c
@@ -731,7 +731,14 @@
 		WLog_Print(context->priv->log, WLOG_ERROR, "invalid magic number 0x%08" PRIX32 "", magic);
 		return FALSE;
 	}
-	*(UINT64*)metadataBlock = metadataData;
+	/* Skip metadata block data to avoid wild write */
+	if (Stream_GetRemainingLength(s) >= 16)
+	{
+		UINT64 blockOffset;
+		UINT64 metadataDataLocal;
+		Stream_Read_UINT64(s, blockOffset);
+		Stream_Read_UINT64(s, metadataDataLocal);
+	}
 	return TRUE;
 }
 
