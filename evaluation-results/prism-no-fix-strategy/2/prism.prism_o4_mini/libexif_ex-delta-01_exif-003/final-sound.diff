--- a/libexif/apple/exif-mnote-data-apple.c
+++ b/libexif/apple/exif-mnote-data-apple.c
@@ -233,14 +233,22 @@
     return mnote_apple_entry_get_value(&d->entries[i], val, maxlen);
 }
 
-int
-exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e) {
+int exif_mnote_data_apple_identify(const ExifData *ed, const ExifEntry *e)
+{
     int variant;
 
-    if (!strcmp((const char *) e->data, "Apple iOS")) {
-        variant = 1;
-    } else {
-        variant = 0;
+    /* Compare only when data is long enough to match "Apple iOS" */
+    {
+        const char apple_str[] = "Apple iOS";
+        size_t len = sizeof(apple_str) - 1;
+        if ((size_t)e->size >= len && memcmp(e->data, apple_str, len) == 0)
+        {
+            variant = 1;
+        }
+        else
+        {
+            variant = 0;
+        }
     }
 
     return variant;
