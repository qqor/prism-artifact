{
  "project_name": "curl",
  "vulnerability_identifier": "curl_cu-delta-05_curl-002",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-curl",
  "llm_usage": {
    "total_cost": 0.1915617,
    "prompt_tokens": 127471,
    "completion_tokens": 11669
  },
  "variant": "sound",
  "diff": "--- a/lib/ftp.c\n+++ b/lib/ftp.c\n@@ -2093,18 +2093,24 @@\n         result = Curl_gmtime(filetime, &buffer);\n         if(result)\n           return result;\n+        /* clamp seconds index to avoid out-of-bounds in Curl_seconds */\n+        int sec_idx = tm->tm_sec;\n+        if(sec_idx < 0)\n+          sec_idx = 0;\n+        else if(sec_idx > 59)\n+          sec_idx = 59;\n \n         /* format: \"Tue, 15 Nov 1994 12:45 and twenty-six seconds\" */\n         headerbuflen =\n           msnprintf(headerbuf, sizeof(headerbuf),\n             \"Last-Modified: %s, %02d %s %4d %02d:%02d and %s seconds GMT\\r\\n\",\n-                    Curl_wkday[tm->tm_wday ? tm->tm_wday-1 : 6],\n-                    tm->tm_mday,\n-                    Curl_month[tm->tm_mon],\n-                    tm->tm_year + 1900,\n-                    tm->tm_hour,\n-                    tm->tm_min,\n-                    Curl_seconds[tm->tm_sec]);\n+            Curl_wkday[tm->tm_wday ? tm->tm_wday - 1 : 6],\n+            tm->tm_mday,\n+            Curl_month[tm->tm_mon],\n+            tm->tm_year + 1900,\n+            tm->tm_hour,\n+            tm->tm_min,\n+            Curl_seconds[sec_idx]);\n         result = client_write_header(data, headerbuf, headerbuflen);\n         if(result)\n           return result;\n",
  "stdout": "",
  "stderr": ""
}