--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java
+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java
@@ -601,7 +601,17 @@
         while(true)
         {
             String currentLine = parser.readLine();
-            String[] splitString = currentLine.split("\\s");
+            if (currentLine.length() >= 4096)
+            {
+                throw new IOException("Xref table line exceeds limit of 4096");
+            }
+            java.util.StringTokenizer st = new java.util.StringTokenizer(currentLine);
+            int tokCount = st.countTokens();
+            String[] splitString = new String[tokCount];
+            for (int idx = 0; idx < tokCount; idx++)
+            {
+                splitString[idx] = st.nextToken();
+            }
             if (splitString.length != 2)
             {
                 LOG.warn("Unexpected XRefTable Entry: {}", currentLine);
@@ -645,7 +655,17 @@
                 }
                 //Ignore table contents
                 currentLine = parser.readLine();
-                splitString = currentLine.split("\\s");
+                if (currentLine.length() >= 4096)
+                {
+                    throw new IOException("Xref table line exceeds limit of 4096");
+                }
+                java.util.StringTokenizer st = new java.util.StringTokenizer(currentLine);
+                int tokCount = st.countTokens();
+                splitString = new String[tokCount];
+                for (int idx = 0; idx < tokCount; idx++)
+                {
+                    splitString[idx] = st.nextToken();
+                }
                 if (splitString.length < 3)
                 {
                     LOG.warn("invalid xref line: {}", currentLine);
