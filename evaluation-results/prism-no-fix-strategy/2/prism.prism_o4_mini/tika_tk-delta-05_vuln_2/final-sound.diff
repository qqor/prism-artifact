--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java
@@ -1154,10 +1154,13 @@
             }
             try {
                 normalizedName = URLDecoder.decode(normalizedName, UTF_8);
-            } catch (IllegalArgumentException e) {
-                LOG.warn("couldn't url decode name {}", normalizedName);
-            }
-            File outputFile = new File(extractDir, normalizedName);
+        } catch (IllegalArgumentException e) {
+            LOG.warn("couldn't url decode name {}",
+                    normalizedName);
+        }
+        // Prevent path traversal by stripping any directory components
+        String safeName = new File(normalizedName).getName();
+        File outputFile = new File(extractDir, safeName);
             //if file already exists, prepend uuid
             if (outputFile.exists()) {
                 String fileName = FilenameUtils.getName(normalizedName);
