{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-delta-05_vuln_2",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 0.3663517,
    "prompt_tokens": 303783,
    "completion_tokens": 7316
  },
  "variant": "sound",
  "diff": "--- a/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java\n+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaCLI.java\n@@ -1154,10 +1154,13 @@\n             }\n             try {\n                 normalizedName = URLDecoder.decode(normalizedName, UTF_8);\n-            } catch (IllegalArgumentException e) {\n-                LOG.warn(\"couldn't url decode name {}\", normalizedName);\n-            }\n-            File outputFile = new File(extractDir, normalizedName);\n+        } catch (IllegalArgumentException e) {\n+            LOG.warn(\"couldn't url decode name {}\",\n+                    normalizedName);\n+        }\n+        // Prevent path traversal by stripping any directory components\n+        String safeName = new File(normalizedName).getName();\n+        File outputFile = new File(extractDir, safeName);\n             //if file already exists, prepend uuid\n             if (outputFile.exists()) {\n                 String fileName = FilenameUtils.getName(normalizedName);\n",
  "stdout": "",
  "stderr": ""
}