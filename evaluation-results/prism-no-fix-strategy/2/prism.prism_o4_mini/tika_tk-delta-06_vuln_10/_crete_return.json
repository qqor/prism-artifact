{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-delta-06_vuln_10",
  "source_directory": "/home/qqor/aixcc/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 2.5141302999999993,
    "prompt_tokens": 2030069,
    "completion_tokens": 63876
  },
  "variant": "sound",
  "diff": "--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/CellFormatter.java\n+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/csv/CellFormatter.java\n@@ -37,13 +37,18 @@\n             \"&fraction_format=\\\"(?:(#{1,20}) )?(#{1,20})/(#{1,20})\\\"\");\n \n     private final Matcher fractionFormatMatcher = FRACTION_FORMAT.matcher(\"\");\n+    private static final int MAX_FRACTION_PARSE_LENGTH = 20;\n     String format(String cell) {\n         if (cell == null) {\n             cell = \"\";\n         }\n         String trimmedCell = cell.trim();\n         fractionFormatMatcher.reset(trimmedCell);\n-        if (! fractionFormatMatcher.matches()) {\n+        // Skip expensive fraction parsing on very long inputs\n+        if (trimmedCell.length() > MAX_FRACTION_PARSE_LENGTH) {\n+            return cell;\n+        }\n+        if (!fractionFormatMatcher.matches()) {\n             return cell;\n         }\n         String sign = fractionFormatMatcher.group(1);\n",
  "stdout": "",
  "stderr": ""
}