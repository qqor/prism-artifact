--- a/libexif/fuji/exif-mnote-data-fuji.c
+++ b/libexif/fuji/exif-mnote-data-fuji.c
@@ -172,7 +172,15 @@
 
 	n->order = EXIF_BYTE_ORDER_INTEL;
 
-	datao += exif_get_long (buf + datao + 8, EXIF_BYTE_ORDER_INTEL);
+	/* ensure we can read 4-byte offset at buf + datao + 8 */
+	if (CHECKOVERFLOW(datao + 8, buf_size, 4)) {
+		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
+			  "ExifMnoteDataFuji", "Short MakerNote");
+		return;
+	}
+	datao += exif_get_long (buf + datao + 8, n->order);
+
+	/* ensure we can read 2-byte tag count at buf + datao */
 	if (CHECKOVERFLOW(datao, buf_size, 2)) {
 		exif_log (en->log, EXIF_LOG_CODE_CORRUPT_DATA,
 			  "ExifMnoteDataFuji", "Short MakerNote");
