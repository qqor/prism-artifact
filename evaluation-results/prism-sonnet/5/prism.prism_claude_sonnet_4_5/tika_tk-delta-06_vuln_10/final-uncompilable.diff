--- a/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pkg-module/src/main/java/org/apache/tika/parser/pkg/PackageParser.java
+++ b/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pkg-module/src/main/java/org/apache/tika/parser/pkg/PackageParser.java
@@ -30,6 +30,8 @@
 import java.io.IOException;
 import java.io.InputStream;
 import java.nio.charset.Charset;
+import java.nio.charset.StandardCharsets;
+import java.util.Arrays;
 import java.util.Collections;
 import java.util.Date;
 import java.util.HashSet;
@@ -109,6 +111,16 @@
     private static final int MARK_LIMIT = 100 * 1024 * 1024; // 100M
     // The number of bytes of entry name to detect charset properly
     private static final int MIN_BYTES_FOR_DETECTING_CHARSET = 100;
+    // Maximum number of entries to parse from an archive to prevent DoS attacks
+    private static final int DEFAULT_MAX_ENTRIES = 50;
+    // Maximum number of charset detections to perform to prevent DoS attacks
+    private static final int DEFAULT_MAX_CHARSET_DETECTIONS = 5;
+    // Minimum length for charset detection (skip very short names that are likely ASCII)
+    private static final int MIN_NAME_LENGTH_FOR_CHARSET_DETECTION = 3;
+    // Maximum processing time for parsing an archive (milliseconds)
+    private static final long DEFAULT_MAX_PROCESSING_TIME_MILLIS = 30000;
+    // Maximum embedded documents to parse per archive
+    private static final int DEFAULT_MAX_EMBEDDED_DOCS_PER_ARCHIVE = 10;
 
 
     static final Set<MediaType> loadPackageSpecializations() {
@@ -233,6 +245,10 @@
     }
 
     private boolean detectCharsetsInEntryNames = true;
+    private int maxEntries = DEFAULT_MAX_ENTRIES;
+    private int maxCharsetDetections = DEFAULT_MAX_CHARSET_DETECTIONS;
+    private long maxProcessingTimeMillis = DEFAULT_MAX_PROCESSING_TIME_MILLIS;
+    private int maxEmbeddedDocsPerArchive = DEFAULT_MAX_EMBEDDED_DOCS_PER_ARCHIVE;
 
     public PackageParser() {
         super();
@@ -370,8 +386,21 @@
                               boolean shouldUseDataDescriptor, AtomicInteger entryCnt)
             throws TikaException, IOException, SAXException {
         try {
+            long startTime = System.currentTimeMillis();
+            int processedEntries = 0;
+            AtomicInteger charsetDetections = new AtomicInteger(0);
+            AtomicInteger embeddedDocsCount = new AtomicInteger(0);
+            
             ArchiveEntry entry = ais.getNextEntry();
             while (entry != null) {
+                long elapsed = System.currentTimeMillis() - startTime;
+                if (elapsed > maxProcessingTimeMillis) {
+                    throw new TikaException(
+                        "Archive processing exceeded maximum time limit (" + 
+                        maxProcessingTimeMillis + "ms). Processed " + processedEntries + 
+                        " entries in " + elapsed + "ms. This may be a denial of service attack.");
+                }
+                
                 if (shouldUseDataDescriptor && entryCnt.get() > 0) {
                     // With shouldUseDataDescriptor being true, we are reading
                     // the zip once again. The number of entryCnt entries have
@@ -382,8 +411,18 @@
                     continue;
                 }
 
+                if (processedEntries >= maxEntries) {
+                    throw new TikaException(
+                        "Archive contains more than the maximum allowed entries (" + 
+                        maxEntries + "). This may be a denial of service attack. " +
+                        "You can increase the limit using setMaxEntries() if this is a legitimate archive.");
+                }
+                
+                processedEntries++;
+
                 if (!entry.isDirectory()) {
-                    parseEntry(ais, entry, extractor, metadata, xhtml);
+                    parseEntry(ais, entry, extractor, metadata, xhtml, 
+                              charsetDetections, embeddedDocsCount);
                 }
 
                 if (!shouldUseDataDescriptor) {
