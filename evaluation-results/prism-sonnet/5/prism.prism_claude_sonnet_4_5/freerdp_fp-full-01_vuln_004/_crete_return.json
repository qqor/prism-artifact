{
  "project_name": "freerdp",
  "vulnerability_identifier": "freerdp_fp-full-01_vuln_004",
  "source_directory": "/home/qqor/crete/.cache/official-afc-freerdp",
  "llm_usage": {
    "total_cost": 1.735338,
    "prompt_tokens": 495736,
    "completion_tokens": 16542
  },
  "variant": "sound",
  "diff": "--- a/libfreerdp/core/gcc.c\n+++ b/libfreerdp/core/gcc.c\n@@ -1854,16 +1854,23 @@\n \tif (blockLength < 4)\n \t\treturn FALSE;\n \n-\tStream_Read_UINT8(s, mcs->channelCount); /* channelCount */\n-\n-\tif (blockLength < 4 + (UINT8)mcs->channelCount * 12)\n-\t\treturn FALSE;\n-\n-\tif (mcs->channelCount > CHANNEL_MAX_COUNT)\n+\tUINT32 channelCount = 0;\n+\tStream_Read_UINT32(s, channelCount); /* channelCount */\n+\n+\tif (blockLength < 4 + channelCount * 12)\n+\t\treturn FALSE;\n+\n+\tif (channelCount > CHANNEL_MAX_COUNT)\n+\t{\n+\t\tWLog_ERR(TAG, \"requested %\" PRIu32 \" channels > CHANNEL_MAX_COUNT(31)\", channelCount);\n+\t\treturn FALSE;\n+\t}\n+\n+\tif (!Stream_CheckAndLogRequiredLengthOfSize(TAG, s, channelCount, 12ull))\n \t\treturn FALSE;\n \n \t/* channelDefArray */\n-\tfor (UINT32 i = 0; i < mcs->channelCount; i++)\n+\tfor (UINT32 i = 0; i < channelCount; i++)\n \t{\n \t\t/**\n \t\t * CHANNEL_DEF\n@@ -1886,6 +1893,7 @@\n \t\tchannel->ChannelId = mcs->baseChannelId++;\n \t}\n \n+\tmcs->channelCount = (INT8)channelCount;\n \treturn TRUE;\n }\n \n",
  "stdout": "",
  "stderr": ""
}