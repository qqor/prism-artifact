[2;36m[01/13/26 03:39:33][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=904065;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=103348;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpq30rksez[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/mongoose_mg-delta-02_mongoose[0m [2m               [0m
[2;36m                    [0m         [35m_2/[0m[95magent-output-1768275573.5975485[0m                                                   [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/mongoose_mg-delta-02_mongoose_2.toml                [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-mongoose[0m         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Building Cached for CLEAN environment[1m)[0m          ]8;id=636728;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=665849;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/13/26 03:39:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Building Cached for CLEAN environment[1m)[0m Took    ]8;id=560137;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=209797;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m8.08[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                 [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running tests for Cached for CLEAN environment[1m)[0m ]8;id=213096;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=136808;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running tests for Cached for CLEAN             ]8;id=277825;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=165906;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=187826;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=984773;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m8[0m[1m)[0m                                                           [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=284350;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=520975;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:39:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.96[0m seconds;              ]8;id=664311;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=936805;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 03:39:43][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=277902;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=308126;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=246427;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=584173;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=559333;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=423699;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=762881;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=202833;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:39:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.96[0m seconds;              ]8;id=103572;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=739517;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=715447;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=194780;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:39:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.91[0m seconds;              ]8;id=914153;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=947946;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 03:39:47][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=87514;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=46765;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         fuzz -[33mruns[0m=[1;36m100[0m.                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 03:40:09][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=498663;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=40233;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 03:46:52][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=713478;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=223698;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 03:47:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=784654;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=498002;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=971664;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=257480;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:47:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.98[0m seconds;              ]8;id=863329;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=94367;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 03:47:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=771662;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=689545;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmph18rcqbt[0m                                                 ]8;id=437829;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=429170;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 03:47:46][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.87[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=171712;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=61895;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=655464;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=126405;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:47:51][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.35[0m seconds;             ]8;id=632588;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=88868;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=383034;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=187414;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:47:53][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=185483;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=502843;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3677533441[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750d708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55850750eaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750eaa8[0m[39m,[0m[1;36m0x558507522448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x558507493c02[0m[39m bp [0m[1;36m0x7ffe403268e0[0m[39m sp [0m[1;36m0x7ffe403268d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558507493c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850747bd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585074908b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5585072df7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55850740811f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850749079d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpvs44eo98[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=895336;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=913290;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3677533441[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750d708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55850750eaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750eaa8[0m[39m,[0m[1;36m0x558507522448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x558507493c02[0m[39m bp [0m[1;36m0x7ffe403268e0[0m[39m sp [0m[1;36m0x7ffe403268d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558507493c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850747bd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585074908b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5585072df7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55850740811f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850749079d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpvs44eo98[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3677533441[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750d708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55850750eaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750eaa8[0m[39m,[0m[1;36m0x558507522448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x558507493c02[0m[39m bp [0m[1;36m0x7ffe403268e0[0m[39m sp [0m[1;36m0x7ffe403268d8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558507493c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850747bd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585074908b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5585072df7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55850740811f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850749079d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpvs44eo98[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.50[0m seconds;                ]8;id=622510;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=261972;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=168832;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=469513;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:47:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.89[0m seconds;              ]8;id=51905;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=351313;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 03:47:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=961062;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=214042;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:47:56][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.97[0m seconds;              ]8;id=212594;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=516441;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=211371;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=229838;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-147[0m,[1;36m8[0m +[1;36m147[0m,[1;36m12[0m @@                                                                [2m                [0m
[2;36m                    [0m          static void [1;35msend_syn[0m[1m([0mstruct mg_connection *c[1m)[0m;                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mmkpay[0m[1m([0mstruct pkt *pkt, void *p[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         -  pkt->pay =                                                                       [2m                [0m
[2;36m                    [0m         -      [1;35mmg_str_n[0m[1m([0m[1m([0mchar *[1m)[0m p, [1m([0msize_t[1m)[0m [1m([0m&pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m - [1m([0mchar *[1m)[0m p[1m)[0m[1m)[0m;   [2m                [0m
[2;36m                    [0m         +  if [1m([0m[1m([0mchar *[1m)[0m p >= &pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m[1m)[0m [1m{[0m                                 [2m                [0m
[2;36m                    [0m         +    pkt->pay = [1;35mmg_str_n[0m[1m([0mNULL, [1;36m0[0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         +  [1m}[0m else [1m{[0m                                                                         [2m                [0m
[2;36m                    [0m         +    pkt->pay =                                                                     [2m                [0m
[2;36m                    [0m         +        [1;35mmg_str_n[0m[1m([0m[1m([0mchar *[1m)[0m p, [1m([0msize_t[1m)[0m [1m([0m&pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m - [1m([0mchar *[1m)[0m p[1m)[0m[1m)[0m; [2m                [0m
[2;36m                    [0m         +  [1m}[0m                                                                                [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static uint32_t [1;35mcsumup[0m[1m([0muint32_t sum, const void *buf, size_t len[1m)[0m [1m{[0m                [2m                [0m
[2;36m                    [0m         @@ [1;36m-800[0m,[1;36m11[0m +[1;36m804[0m,[1;36m13[0m @@                                                               [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m              pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         +    if [1m([0m[1m([0mchar *[1m)[0m[1m([0mpkt->icmp + [1;36m1[0m[1m)[0m > &pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m[1m)[0m return;             [2m                [0m
[2;36m                    [0m              if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m return;[0m              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-823[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m829[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m     pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m return;[0m              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-839[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m846[0m[39m,[0m[1;36m13[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m     pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m return;[0m             [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m     pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m return;[0m              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m897[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hdr_len = [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hdr_len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt.ip + ip_hdr_len > pkt.raw.buf + pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mHeader exceeds buffer[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3677533441[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750d708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55850750eaa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750eaa8[0m[39m,[0m[1;36m0x558507522448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558507493c02[0m[39m bp [0m[1;36m0x7ffe403268e0[0m[39m sp [0m[1;36m0x7ffe403268d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558507493c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850747bd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585074908b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5585072df7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55850740811f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850749079d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpvs44eo98[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in the Mongoose networking [0m  [2m                [0m
[2;36m                    [0m         [39mlibrary's built-in TCP/IP stack. The AddressSanitizer identified a [0m[1;36m1[0m[39m-byte read [0m     [2m                [0m
[2;36m                    [0m         [39moverflow occurring in the `rx_icmp` function at line [0m[1;36m385[0m[39m of `net_builtin.c`. The [0m   [2m                [0m
[2;36m                    [0m         [39mvulnerability was discovered through fuzzing and has a SCARINESS score of [0m[1;36m12[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mindicating a [0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as a heap-buffer-overflow error when processing ICMP packets in[0m [2m                [0m
[2;36m                    [0m         [39mthe Mongoose library's built-in network stack. Specifically:[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Vulnerability Type**: Heap-buffer-overflow [0m[1;39m([0m[39mREAD operation[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m- **Location**: `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m` in the `rx_icmp` function[0m  [2m                [0m
[2;36m                    [0m         [39m- **Memory Access**: Attempting to read [0m[1;36m1[0m[39m byte at address `[0m[1;36m0x504000000172[0m[39m`[0m          [2m                [0m
[2;36m                    [0m         [39m- **Buffer Allocation**: The overflow occurs immediately after a [0m[1;36m34[0m[39m-byte allocated [0m [2m                [0m
[2;36m                    [0m         [39mregion [0m[1;39m([0m[39m`[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m`[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m- **Access Pattern**: The code is attempting to read exactly at the boundary of the[0m [2m                [0m
[2;36m                    [0m         [39mallocated buffer [0m[1;39m([0m[1;36m0[0m[39m bytes after the valid region[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Call Stack Analysis[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is triggered through the following execution path:[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `LLVMFuzzerTestOneInput` [0m[1;39m([0m[39mfuzzer entry point at `fuzz.[0m[1;92mc:106:5[0m[39m`[0m[1;39m)[0m[39m receives and [0m    [2m                [0m
[2;36m                    [0m         [39mprocesses fuzzed input[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `mg_tcpip_rx` [0m[1;39m([0m[39mat `net_builtin.[0m[1;92mc:897:5[0m[39m`[0m[1;39m)[0m[39m processes the received TCP/IP packet[0m    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `rx_icmp` [0m[1;39m([0m[39mat `net_builtin.[0m[1;92mc:385:18[0m[39m`[0m[1;39m)[0m[39m handles ICMP packet processing where the [0m  [2m                [0m
[2;36m                    [0m         [39moverflow occurs[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe [0m[1;36m34[0m[39m-byte buffer was allocated in the fuzzer harness at `fuzz.[0m[1;92mc:95:17[0m[39m`, and the [0m  [2m                [0m
[2;36m                    [0m         [39moverflow happens during subsequent packet processing.[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Technical Observations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Buffer Boundaries**: The shadow memory dump shows the allocation pattern:[0m      [2m                [0m
[2;36m                    [0m         [39m   - Address `[0m[1;36m0x504000000150[0m[39m-[0m[1;36m0x504000000171[0m[39m`: Valid [0m[1;36m34[0m[39m-byte allocation[0m              [2m                [0m
[2;36m                    [0m         [39m   - Address `[0m[1;36m0x504000000172[0m[39m`: First byte beyond allocation [0m[1;39m([0m[39mwhere overflow occurs[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m   - The shadow byte `[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39m` indicates [0m[1;36m2[0m[39m bytes are partially addressable at this [0m    [2m                [0m
[2;36m                    [0m         [39mlocation[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Memory Layout**: The shadow memory legend indicates the region is surrounded [0m  [2m                [0m
[2;36m                    [0m         [39mby heap red zones [0m[1;39m([0m[39m`fa`[0m[1;39m)[0m[39m, which are safety markers placed by AddressSanitizer to [0m   [2m                [0m
[2;36m                    [0m         [39mdetect out-of-bounds access.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Engine Configuration**: The fuzzer was running with:[0m                           [2m                [0m
[2;36m                    [0m         [39m   - LibFuzzer as the fuzzing engine[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - Entropic power schedule[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;36m100[0m[39m iterations per input[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;36m2560[0m[39m MB RSS limit[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;36m25[0m[39m-second timeout[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic understanding of this vulnerability, the following code [0m       [2m                [0m
[2;36m                    [0m         [39msections should be examined:[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Primary Focus - `src/net_builtin.c`**:[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m385[0m[39m in the `rx_icmp` function where the overflow occurs[0m                   [2m                [0m
[2;36m                    [0m         [39m   - The entire `rx_icmp` function implementation to understand ICMP packet [0m        [2m                [0m
[2;36m                    [0m         [39mstructure expectations[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m897[0m[39m in `mg_tcpip_rx` to understand how packets are dispatched to protocol[0m [2m                [0m
[2;36m                    [0m         [39mhandlers[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **ICMP Packet Handling**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Validation logic for ICMP packet sizes and structure[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Buffer size calculations before accessing packet data[0m                          [2m                [0m
[2;36m                    [0m         [39m   - Boundary checking mechanisms [0m[1;39m([0m[39mor lack thereof[0m[1;39m)[0m[39m in ICMP processing[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Packet Structure Definitions**:[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - The `pkt` structure definition used in `[0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m`[0m           [2m                [0m
[2;36m                    [0m         [39m   - Any related data structures for ICMP packet representation[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Size and length fields within these structures[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Input Validation**:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - How packet lengths are validated before passing to `rx_icmp`[0m                   [2m                [0m
[2;36m                    [0m         [39m   - Whether minimum/maximum size checks exist for ICMP packets[0m                     [2m                [0m
[2;36m                    [0m         [39m   - The relationship between allocated buffer sizes and expected packet sizes[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Related Protocol Handlers**:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Other protocol handling functions [0m[1;39m([0m[39mTCP, UDP, ARP, etc.[0m[1;39m)[0m[39m in the same file to [0m   [2m                [0m
[2;36m                    [0m         [39midentify if similar patterns exist[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Common packet processing utilities that might be shared across handlers[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability suggests insufficient bounds checking when accessing ICMP packet [0m [2m                [0m
[2;36m                    [0m         [39mdata, where the code attempts to read beyond the actual packet buffer, potentially [0m [2m                [0m
[2;36m                    [0m         [39mreading into adjacent memory regions.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m143[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:41[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m901[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"Unknown eth type %x"[0m[39m, [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt.eth->type[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    if [0m[1;39m([0m[39mmg_log_level >= MG_LL_VERBOSE[0m[1;39m)[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len >= [0m[1;36m32[0m[39m ? [0m[1;36m32[0m[39m : len[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:886[0m[39m-[0m[1;36m888[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:884[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:85[0m[39m-[0m[1;36m107[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  if [0m[1;39m([0m[39msize > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    struct mg_tcpip_if mif = [0m[1;39m{[0m[39m.ip = [0m[1;36m0x01020304[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                              .mask = [0m[1;36m255[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                              .gw = [0m[1;36m0x01010101[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                              .driver = &mg_tcpip_driver_mock[0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    struct mg_mgr mgr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;35mmg_mgr_init[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;35mmg_tcpip_init[0m[1;39m([0m[39m&mgr, &mif[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make a copy of the random data, in order to modify it[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:498[0m[39m-[0m[1;36m518[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:static void [0m[1;35mrx_udp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:  struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, true[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:  if [0m[1;39m([0m[39mc == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:    [0m[35m/[0m[35m/[0m[39m No UDP listener on this port. Should send ICMP, but keep silent.[0m         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    c->rem.port = pkt->udp->sport;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mc->rem.ip, &pkt->ip->src, [0m[1;35msizeof[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    struct connstate *s = [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39ms->mac, pkt->eth->src, [0m[1;35msizeof[0m[1;39m([0m[39ms->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:    if [0m[1;39m([0m[39mc->recv.len >= MG_MAX_RECV_SIZE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"max_recv_buf_size reached"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc->recv.size - c->recv.len < pkt->pay.len &&[0m                     [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:               ![0m[1;35mmg_iobuf_resize[0m[1;39m([0m[39m&c->recv, c->recv.len + pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"oom"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&c->recv.buf[0m[1;39m[[0m[39mc->recv.len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:      c->recv.len += pkt->pay.len;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:      [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_READ, &pkt->pay.len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:744[0m[39m-[0m[1;36m792[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:static void [0m[1;35mrx_tcp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:  struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:  struct connstate *s = c == NULL ? NULL : [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:#if [0m[1;36m0[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:  [0m[1;35mMG_INFO[0m[1;39m([0m[1;39m([0m[32m"%lu %hhu %d"[0m[39m, c ? c->id : [0m[1;36m0[0m[39m, pkt->tcp->flags, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:  if [0m[1;39m([0m[39mc != NULL && c->is_connecting && pkt->tcp->flags == [0m[1;39m([0m[39mTH_SYN | TH_ACK[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:    s->seq = [0m[1;35mmg_ntohl[0m[1;39m([0m[39mpkt->tcp->ack[0m[1;39m)[0m[39m, s->ack = [0m[1;35mmg_ntohl[0m[1;39m([0m[39mpkt->tcp->seq[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:    c->is_connecting = [0m[1;36m0[0m[39m;  [0m[35m/[0m[35m/[0m[39m Client connected[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:    [0m[1;35msettmout[0m[1;39m([0m[39mc, MIP_TTYPE_KEEPALIVE[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:    [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_CONNECT, NULL[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Let user know[0m                          [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:    if [0m[1;39m([0m[39mc->is_tls_hs[0m[1;39m)[0m[39m [0m[1;35mmg_tls_handshake[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc != NULL && c->is_connecting && pkt->tcp->flags != TH_ACK[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mpkt->raw.buf, pkt->raw.len[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_RST | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc != NULL && pkt->tcp->flags & TH_RST[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:    [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"peer RST"[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m RFC-[0m[1;36m1122[0m[39m [0m[1;92m4.2.2.13[0m                              [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:#if [0m[1;36m0[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"%lu %d %M:%hu -> %M:%hu"[0m[39m, c->id, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->raw.len,[0m             [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:              mg_print_ip4, &pkt->ip->src, [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:              mg_print_ip4, &pkt->ip->dst, [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:    [0m[1;35mmg_hexdump[0m[1;39m([0m[39mpkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:    s->tmiss = [0m[1;36m0[0m[39m;                         [0m[35m/[0m[35m/[0m[39m Reset missed keep-alive counter[0m    [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:    if [0m[1;39m([0m[39ms->ttype == MIP_TTYPE_KEEPALIVE[0m[1;39m)[0m[39m  [0m[35m/[0m[35m/[0m[39m Advance keep-alive timer[0m           [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:      [0m[1;35msettmout[0m[1;39m([0m[39mc,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:               MIP_TTYPE_KEEPALIVE[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m unless a former ACK timeout is pending[0m [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:    [0m[1;35mread_conn[0m[1;39m([0m[39mc, pkt[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Override timer with ACK timeout if needed[0m            [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, true[0m[1;39m)[0m[1;39m)[0m[39m == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_RST | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->tcp->flags & TH_RST[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:    if [0m[1;39m([0m[39mc->is_accepted[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"peer RST"[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m RFC-[0m[1;36m1122[0m[39m [0m[1;92m4.2.2.13[0m          [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:    [0m[35m/[0m[35m/[0m[39m ignore RST if not connected[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->tcp->flags & TH_SYN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:    [0m[35m/[0m[35m/[0m[39m Use peer's source port as ISN, in order to recognise the handshake[0m       [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:    uint32_t isn = [0m[1;35mmg_htonl[0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_SYN | TH_ACK, isn, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->tcp->flags & TH_FIN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_FIN | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mmg_htonl[0m[1;39m([0m[39mpkt->tcp->ack[0m[1;39m)[0m[39m == [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m + 1U[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:    [0m[1;35maccept_conn[0m[1;39m([0m[39mc, pkt[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m!c->is_accepted[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m no peer[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_RST | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"dropped silently.."[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:813[0m[39m-[0m[1;36m820[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m15[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#ifndef MIP_TCP_KEEPALIVE_MS[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#define MIP_TCP_KEEPALIVE_MS [0m[1;36m45000[0m[39m  [0m[35m/[0m[35m/[0m[39m TCP keep-alive period, ms[0m                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#endif[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#define MIP_TCP_ACK_MS [0m[1;36m150[0m[39m    [0m[35m/[0m[35m/[0m[39m Timeout for ACKing[0m                              [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#define MIP_ARP_RESP_MS [0m[1;36m100[0m[39m   [0m[35m/[0m[35m/[0m[39m Timeout for ARP response[0m                        [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#define MIP_TCP_SYN_MS [0m[1;36m15000[0m[39m  [0m[35m/[0m[35m/[0m[39m Timeout for connection establishment[0m            [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#define MIP_TCP_FIN_MS [0m[1;36m1000[0m[39m   [0m[35m/[0m[35m/[0m[39m Timeout for closing connection[0m                  [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#define MIP_TCP_WIN [0m[1;36m6000[0m[39m      [0m[35m/[0m[35m/[0m[39m TCP window size[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:840[0m[39m-[0m[1;36m844[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter thorough analysis of the code snippets and evaluation report, I've identified[0m [2m                [0m
[2;36m                    [0m         [39mthe root cause and scope of the vulnerability:[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mThe heap-buffer-overflow occurs due to unsigned integer wraparound when calculating[0m [2m                [0m
[2;36m                    [0m         [39mthe payload length. When the IP header's IHL [0m[1;39m([0m[39mInternet Header Length[0m[1;39m)[0m[39m field claims [0m [2m                [0m
[2;36m                    [0m         [39ma header size that extends beyond the actual buffer, the `mkpay` function performs [0m [2m                [0m
[2;36m                    [0m         [39mpointer arithmetic that results in a negative value. Since the size is calculated [0m  [2m                [0m
[2;36m                    [0m         [39musing unsigned `size_t`, the negative value wraps around to a huge positive number [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39me.g., `[0m[1;36m0xFFFFFFFFFFFFFFFC[0m[39m`[0m[1;39m)[0m[39m. This causes subsequent bounds checks to pass [0m         [2m                [0m
[2;36m                    [0m         [39mincorrectly, allowing out-of-bounds memory access.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Triggering Scenario:**[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. [0m[1;36m34[0m[39m-byte buffer: [0m[1;36m14[0m[39m bytes [0m[1;39m([0m[39mEthernet[0m[1;39m)[0m[39m + [0m[1;36m20[0m[39m bytes [0m[1;39m([0m[39mIP header[0m[1;39m)[0m[39m + [0m[1;36m0[0m[39m bytes remaining[0m   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. IP header's IHL field claims [0m[1;36m6[0m[39m [0m[1;39m([0m[1;36m24[0m[39m bytes with options[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `[0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, buf[0m[1;39m[[0m[1;36m14[0m[1;39m][0m[39m + [0m[1;36m24[0m[1;39m)[0m[39m` points to buf[0m[1;39m[[0m[1;36m38[0m[1;39m][0m[39m, which is [0m[1;36m4[0m[39m bytes past the buffer[0m  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Calculation: `buf[0m[1;39m[[0m[1;36m34[0m[1;39m][0m[39m - buf[0m[1;39m[[0m[1;36m38[0m[1;39m][0m[39m = [0m[1;36m-4[0m[39m` wraps to `[0m[1;36m0xFFFFFFFFFFFFFFFC[0m[39m`[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Check `if [0m[1;39m([0m[1;36m0xFFFFFFFFFFFFFFFC[0m[39m < [0m[1;36m4[0m[1;39m)[0m[39m` fails, allowing execution to continue[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. `rx_icmp` accesses `pkt->icmp->type` at byte [0m[1;36m34[0m[39m [0m[1;39m([0m[39mout of bounds[0m[1;39m)[0m[39m → **CRASH**[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Scope:**[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mAll protocol handlers in `rx_ip` are vulnerable: ICMP, UDP, TCP, and IPv6's ICMPv6.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must be applied at **two critical locations** in `src/net_builtin.c`:[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Primary Fix: Validate IP Header Length in `mg_tcpip_rx` [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m896[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Before calling `mkpay` in the IPv4 packet processing section.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Calculate the IP header length from the IHL field: `ip_hdr_len = [0m[1;39m([0m[39mpkt.ip->ver & [0m  [2m                [0m
[2;36m                    [0m         [1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m`[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- Validate that IHL is at least [0m[1;36m5[0m[39m [0m[1;39m([0m[39mminimum [0m[1;36m20[0m[39m bytes[0m[1;39m)[0m[39m: `if [0m[1;39m([0m[39mip_hdr_len < [0m            [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Validate that the claimed IP header doesn't exceed the actual buffer: `if [0m[1;39m([0m[1;39m([0m[39mchar [0m [2m                [0m
[2;36m                    [0m         [39m*[0m[1;39m)[0m[39mpkt.ip + ip_hdr_len > pkt.raw.buf + pkt.raw.len[0m[1;39m)[0m[39m return;`[0m                         [2m                [0m
[2;36m                    [0m         [39m- Use the validated `ip_hdr_len` for the `mkpay` call[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis prevents out-of-bounds pointer creation BEFORE the wraparound can occur.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Defense-in-Depth: Add Bounds Checks in `rx_ip` [0m[1;39m([0m[39mlines [0m[1;36m801[0m[39m-[0m[1;36m835[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** After setting each protocol pointer but before accessing its fields.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39mFor each protocol handler [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m:[0m                                         [2m                [0m
[2;36m                    [0m         [39m- After setting the protocol pointer [0m[1;39m([0m[39me.g., `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip +[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[1;39m)[0m[39m`[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m- Before the existing `pkt->pay.len` check[0m                                          [2m                [0m
[2;36m                    [0m         [39m- Add validation: `if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mreturn;`[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis follows the pattern already successfully used in DHCP handlers [0m[1;39m([0m[39mlines [0m[1;36m404[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m462[0m[1;39m)[0m[39m with the comment [0m[32m"// perform size check first, then access fields"[0m[39m.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Additional Safety: Modify `mkpay` to Prevent Wraparound [0m[1;39m([0m[39mlines [0m[1;36m149[0m[39m-[0m[1;36m152[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** In the `mkpay` function itself.[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Check if the pointer `p` is beyond the buffer end before calculating the size[0m     [2m                [0m
[2;36m                    [0m         [39m- If `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mp >= &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m`, set `pkt->pay.len = [0m[1;36m0[0m[39m` instead of [0m [2m                [0m
[2;36m                    [0m         [39mallowing wraparound[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- This prevents the unsigned underflow from ever occurring[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This is Optimal:**[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Follows Existing Patterns:** The DHCP handlers [0m[1;39m([0m[39mlines [0m[1;36m398[0m[39m-[0m[1;36m404[0m[39m, [0m[1;36m459[0m[39m-[0m[1;36m462[0m[1;39m)[0m[39m [0m       [2m                [0m
[2;36m                    [0m         [39malready demonstrate the correct approach with explicit bounds checking and the [0m     [2m                [0m
[2;36m                    [0m         [39mcomment [0m[32m"perform size check first, then access fields"[0m[39m. This fix extends that [0m      [2m                [0m
[2;36m                    [0m         [39mpattern consistently.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in Depth:** Three layers of protection:[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Primary validation at packet reception prevents malformed IP headers[0m           [2m                [0m
[2;36m                    [0m         [39m   - Protocol-specific checks catch any edge cases[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - `mkpay` safety prevents wraparound as a last resort[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Existing Logic:** [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - No changes to fuzzing harness or test code[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Maintains the same packet processing flow[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Supports legitimate IP options [0m[1;39m([0m[39mIHL > [0m[1;36m5[0m[1;39m)[0m[39m when buffer is adequate[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Minimal Performance Impact:** Simple pointer comparisons that short-circuit on[0m [2m                [0m
[2;36m                    [0m         [39mmalformed packets[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Addresses the Issue:**[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Prevents Unsigned Wraparound:** By validating pointers before subtraction in [0m   [2m                [0m
[2;36m                    [0m         [39m`mkpay`[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Stops Out-of-Bounds Access:** By checking buffer boundaries before [0m             [2m                [0m
[2;36m                    [0m         [39mdereferencing[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- **Handles All Affected Protocols:** ICMP, UDP, TCP, and ICMPv6 are all protected[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects & Mitigation:**[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Legitimate packets with IP options might be rejected:** If a packet claims [0m    [2m                [0m
[2;36m                    [0m         [39mvalid options but the buffer is truncated, it will be dropped. This is CORRECT [0m     [2m                [0m
[2;36m                    [0m         [39mbehavior—truncated packets should be rejected.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Similar issues in IPv6:** IPv6 has extension headers that could cause similar [0m [2m                [0m
[2;36m                    [0m         [39missues. The fix should be applied to `rx_ip6` [0m[1;39m([0m[39mlines [0m[1;36m838[0m[39m-[0m[1;36m852[0m[1;39m)[0m[39m with appropriate [0m     [2m                [0m
[2;36m                    [0m         [39mvalidation for IPv6 header chains.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Solutions in Codebase:**[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe DHCP handlers demonstrate this exact pattern is already trusted in the [0m         [2m                [0m
[2;36m                    [0m         [39mcodebase:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix simply extends this proven approach to all protocol handlers.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 03:48:24][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=138667;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=167460;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 03:53:18][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=324802;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=929350;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 03:54:19][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=733588;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=582018;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=266798;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=740189;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:54:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.00[0m seconds;              ]8;id=628703;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=107498;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 03:54:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=107345;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=50545;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpj3c_38wn[0m                                                 ]8;id=609473;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=999200;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 03:54:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.95[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=305784;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=833287;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=459869;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=272028;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:54:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.31[0m seconds;             ]8;id=700403;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=661773;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=236512;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=953396;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:54:34][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=759332;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=574017;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4078629902[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d68708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x560cf0d69aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d69aa8[0m[39m,[0m[1;36m0x560cf0d7d448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x560cf0ceec02[0m[39m bp [0m[1;36m0x7ffe37059c20[0m[39m sp [0m[1;36m0x7ffe37059c18[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0ceec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0cd6d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0ceb8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560cf0b3a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0c6311f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0ceb79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp9s0zbfdh[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=550813;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=312965;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4078629902[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d68708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x560cf0d69aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d69aa8[0m[39m,[0m[1;36m0x560cf0d7d448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x560cf0ceec02[0m[39m bp [0m[1;36m0x7ffe37059c20[0m[39m sp [0m[1;36m0x7ffe37059c18[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0ceec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0cd6d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0ceb8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560cf0b3a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0c6311f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0ceb79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp9s0zbfdh[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4078629902[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d68708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x560cf0d69aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d69aa8[0m[39m,[0m[1;36m0x560cf0d7d448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x560cf0ceec02[0m[39m bp [0m[1;36m0x7ffe37059c20[0m[39m sp [0m[1;36m0x7ffe37059c18[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0ceec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0cd6d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0ceb8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560cf0b3a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0c6311f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0ceb79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp9s0zbfdh[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.42[0m seconds;                ]8;id=78476;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=566939;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=732644;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=376711;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:54:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.85[0m seconds;              ]8;id=575017;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=322336;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 03:54:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=705604;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=663271;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.88[0m seconds;              ]8;id=248784;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=652875;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 03:54:37][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=93005;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=708020;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-147[0m,[1;36m6[0m +[1;36m147[0m,[1;36m10[0m @@                                                                [2m                [0m
[2;36m                    [0m          static void [1;35msend_syn[0m[1m([0mstruct mg_connection *c[1m)[0m;                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mmkpay[0m[1m([0mstruct pkt *pkt, void *p[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         +  if [1m([0m[1m([0mchar *[1m)[0mp > &pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m[1m)[0m [1m{[0m                                   [2m                [0m
[2;36m                    [0m         +    pkt->pay = [1;35mmg_str_n[0m[1m([0mNULL, [1;36m0[0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         +    return;                                                                        [2m                [0m
[2;36m                    [0m         +  [1m}[0m                                                                                [2m                [0m
[2;36m                    [0m            pkt->pay =                                                                       [2m                [0m
[2;36m                    [0m                [1;35mmg_str_n[0m[1m([0m[1m([0mchar *[1m)[0m p, [1m([0msize_t[1m)[0m [1m([0m&pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m - [1m([0mchar *[1m)[0m p[1m)[0m[1m)[0m;   [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-794[0m,[1;36m39[0m +[1;36m798[0m,[1;36m40[0m @@                                                               [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m pkt->pay.buf;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m pkt->pay.buf;               [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         +    pkt->icmp = [1m([0mstruct icmp *[1m)[0m pkt->pay.buf;                                      [2m                [0m
[2;36m                    [0m              if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [39m-      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                    [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [39m-      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                    [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t ip_hdr_len = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hdr_len + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-838[0m[39m,[0m[1;36m12[0m[39m +[0m[1;36m843[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [39m   [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m-    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                      [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m893[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hdr_len = [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hdr_len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt.ip + ip_hdr_len > pkt.raw.buf + pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mHeader exceeds buffer[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4078629902[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d68708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560cf0d69aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d69aa8[0m[39m,[0m[1;36m0x560cf0d7d448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560cf0ceec02[0m[39m bp [0m[1;36m0x7ffe37059c20[0m[39m sp [0m[1;36m0x7ffe37059c18[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0ceec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0cd6d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0ceb8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560cf0b3a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0c6311f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0ceb79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp9s0zbfdh[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue is a heap-buffer-overflow vulnerability detected by [0m              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer during fuzzing of the Mongoose networking library. The crash [0m      [2m                [0m
[2;36m                    [0m         [39moccurs in the `rx_icmp` function at line [0m[1;36m385[0m[39m of `src/net_builtin.c`, where a [0m[1;36m1[0m[39m-byte[0m [2m                [0m
[2;36m                    [0m         [39mread occurs [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte allocated heap region. [0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA patch was attempted that added multiple bounds checks before accessing protocol [0m  [2m                [0m
[2;36m                    [0m         [39mheaders [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m and modified the payload calculation logic in the `mkpay` [0m [2m                [0m
[2;36m                    [0m         [39mfunction. However, after applying the patch, the same heap-buffer-overflow still [0m   [2m                [0m
[2;36m                    [0m         [39moccurs at the exact same location [0m[1;39m([0m[39m`rx_icmp` at line [0m[1;36m385[0m[1;39m)[0m[39m, indicating that the [0m     [2m                [0m
[2;36m                    [0m         [39mpatch did not successfully address the root cause of the vulnerability.[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe AddressSanitizer report reveals a heap-buffer-overflow with the following [0m      [2m                [0m
[2;36m                    [0m         [39mcharacteristics:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Location**: The overflow occurs in `[0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m` at [0m           [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Type**: READ of size [0m[1;36m1[0m[39m at address `[0m[1;36m0x504000000172[0m[39m`[0m                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Memory Context**: The address is located [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte region [0m       [2m                [0m
[2;36m                    [0m         [39m`[0m[1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m[39m` allocated in `LLVMFuzzerTestOneInput` at line [0m[1;36m95[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mof `test/fuzz.c`[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Call Stack**: The overflow is triggered through: `LLVMFuzzerTestOneInput` → [0m   [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx` [0m[1;39m([0m[39mline [0m[1;36m897[0m[1;39m)[0m[39m → `rx_icmp` [0m[1;39m([0m[39mline [0m[1;36m385[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Scariness Score**: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe shadow bytes indicate that the allocated region ends exactly where the read [0m    [2m                [0m
[2;36m                    [0m         [39mattempt occurs, suggesting an off-by-one error or insufficient bounds checking when[0m [2m                [0m
[2;36m                    [0m         [39maccessing packet data.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch modified `src/net_builtin.c` with the following changes:[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Modified `mkpay` function [0m[1;39m([0m[39mlines [0m[1;36m149[0m[39m-[0m[1;36m156[0m[1;39m)[0m[39m**:[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Added a bounds check: `if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p >= &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m`[0m         [2m                [0m
[2;36m                    [0m         [39m   - Returns an empty string [0m[1;39m([0m[39m`[0m[1;35mmg_str_n[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m if the pointer is beyond the [0m    [2m                [0m
[2;36m                    [0m         [39mbuffer[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Otherwise proceeds with the original payload calculation[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Added bounds checks before calling `mkpay` for ICMP over IPv4 [0m[1;39m([0m[39mline [0m[1;36m807[0m[1;39m)[0m[39m**:[0m    [2m                [0m
[2;36m                    [0m         [39m   - Check: `if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m return;`[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Added bounds checks before calling `mkpay` for UDP over IPv4 [0m[1;39m([0m[39mline [0m[1;36m813[0m[1;39m)[0m[39m**:[0m     [2m                [0m
[2;36m                    [0m         [39m   - Check: `if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m return;`[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Added bounds checks before calling `mkpay` for TCP over IPv4 [0m[1;39m([0m[39mline [0m[1;36m832[0m[1;39m)[0m[39m**:[0m     [2m                [0m
[2;36m                    [0m         [39m   - Check: `if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m return;`[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Added bounds checks before calling `mkpay` for ICMP over IPv6 [0m[1;39m([0m[39mline [0m[1;36m849[0m[1;39m)[0m[39m**:[0m    [2m                [0m
[2;36m                    [0m         [39m   - Check: `if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m return;`[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Added bounds checks before calling `mkpay` for UDP over IPv6 [0m[1;39m([0m[39mline [0m[1;36m855[0m[1;39m)[0m[39m**:[0m     [2m                [0m
[2;36m                    [0m         [39m   - Check: `if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m return;`[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Modified IPv4 header processing [0m[1;39m([0m[39mlines [0m[1;36m900[0m[39m-[0m[1;36m902[0m[1;39m)[0m[39m**:[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Changed from conditional IPv4 options handling to unified approach[0m             [2m                [0m
[2;36m                    [0m         [39m   - Added validation: `if [0m[1;39m([0m[39mip_hdr_len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                  [2m                [0m
[2;36m                    [0m         [39m   - Added bounds check: `if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mpkt.ip + ip_hdr_len > pkt.raw.buf + [0m          [2m                [0m
[2;36m                    [0m         [39mpkt.raw.len[0m[1;39m)[0m[39m return;`[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Results[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the fuzzer produces an identical error:[0m                   [2m                [0m
[2;36m                    [0m         [39m- Same crash location: `rx_icmp` at line [0m[1;36m385[0m                                        [2m                [0m
[2;36m                    [0m         [39m- Same address: `[0m[1;36m0x504000000172[0m[39m`[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Same memory region: [0m[1;36m34[0m[39m-byte region `[0m[1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m[39m`[0m              [2m                [0m
[2;36m                    [0m         [39m- Same call stack and DEDUP_TOKEN[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Same scariness score and error characteristics[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates that the buffer overflow in `rx_icmp` at line [0m[1;36m385[0m[39m is not prevented [0m  [2m                [0m
[2;36m                    [0m         [39mby the added bounds checks. The fact that the line number remains [0m[1;36m385[0m[39m [0m[1;39m([0m[39mdespite code[0m [2m                [0m
[2;36m                    [0m         [39madditions[0m[1;39m)[0m[39m suggests the crash occurs within the `rx_icmp` function body itself, not[0m [2m                [0m
[2;36m                    [0m         [39min the calling path that was modified by the patch.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Further Investigation[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `rx_icmp` function implementation**: The crash consistently occurs at line[0m [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m within this function. The function body needs to be examined to understand what[0m [2m                [0m
[2;36m                    [0m         [39moperation at that line causes the read beyond the allocated buffer.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **ICMP packet structure and payload parsing**: Since the crash occurs [0m           [2m                [0m
[2;36m                    [0m         [39mspecifically when processing ICMP packets, the handling of ICMP packet fields and [0m  [2m                [0m
[2;36m                    [0m         [39mpayload extraction within `rx_icmp` should be scrutinized.[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **The relationship between `pkt->pay` and actual buffer boundaries**: While the [0m [2m                [0m
[2;36m                    [0m         [39mpatch adds checks before calling `mkpay`, the issue might be with how the payload [0m  [2m                [0m
[2;36m                    [0m         [39mis subsequently used within `rx_icmp`.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **The fuzzer input that triggers the crash**: The [0m[1;36m34[0m[39m-byte allocation suggests a [0m [2m                [0m
[2;36m                    [0m         [39mminimal test case. Understanding the structure of this input could reveal which [0m    [2m                [0m
[2;36m                    [0m         [39mspecific parsing path leads to the overflow.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Other callers of `rx_icmp`**: While the current stack trace shows the path [0m    [2m                [0m
[2;36m                    [0m         [39mthrough `mg_tcpip_rx`, there may be other code paths that call `rx_icmp` that also [0m [2m                [0m
[2;36m                    [0m         [39mneed protection.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Payload length validation**: The existing checks `if [0m[1;39m([0m[39mpkt->pay.len < [0m          [2m                [0m
[2;36m                    [0m         [1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;` verify minimum size, but there may be insufficient [0m    [2m                [0m
[2;36m                    [0m         [39mvalidation of maximum payload boundaries within `rx_icmp` itself.[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3677533441[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750d708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55850750eaa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55850750eaa8[0m[39m,[0m[1;36m0x558507522448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x558507493c02[0m[39m bp [0m[1;36m0x7ffe403268e0[0m[39m sp [0m[1;36m0x7ffe403268d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x558507493c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850747bd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585074908b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5585072df7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55850740811f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55850749079d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5585072fc350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5585072e75c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5585072ed05f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x558507318302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fb53bfc6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpvs44eo98[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m143[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:77[0m[39m-[0m[1;36m83[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:struct arp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  uint16_t fmt;    [0m[35m/[0m[35m/[0m[39m Format of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:  uint16_t pro;    [0m[35m/[0m[35m/[0m[39m Format of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:  uint8_t hlen;    [0m[35m/[0m[35m/[0m[39m Length of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:  uint8_t plen;    [0m[35m/[0m[35m/[0m[39m Length of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:  uint16_t op;     [0m[35m/[0m[35m/[0m[39m Operation[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:62[0m[39m-[0m[1;36m70[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct ip6 [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  uint8_t ver;      [0m[35m/[0m[35m/[0m[39m Version[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  uint8_t opts[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Options[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  uint16_t len;     [0m[35m/[0m[35m/[0m[39m Length[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  uint8_t proto;    [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  uint8_t ttl;      [0m[35m/[0m[35m/[0m[39m Time to live[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:62[0m[39m-[0m[1;36m70[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct ip6 [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  uint8_t ver;      [0m[35m/[0m[35m/[0m[39m Version[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  uint8_t opts[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Options[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  uint16_t len;     [0m[35m/[0m[35m/[0m[39m Length[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  uint8_t proto;    [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  uint8_t ttl;      [0m[35m/[0m[35m/[0m[39m Time to live[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:41[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m5[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:85[0m[39m-[0m[1;36m107[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  if [0m[1;39m([0m[39msize > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    struct mg_tcpip_if mif = [0m[1;39m{[0m[39m.ip = [0m[1;36m0x01020304[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                              .mask = [0m[1;36m255[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                              .gw = [0m[1;36m0x01010101[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                              .driver = &mg_tcpip_driver_mock[0m[1;39m}[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    struct mg_mgr mgr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;35mmg_mgr_init[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;35mmg_tcpip_init[0m[1;39m([0m[39m&mgr, &mif[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make a copy of the random data, in order to modify it[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m901[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"Unknown eth type %x"[0m[39m, [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt.eth->type[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    if [0m[1;39m([0m[39mmg_log_level >= MG_LL_VERBOSE[0m[1;39m)[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len >= [0m[1;36m32[0m[39m ? [0m[1;36m32[0m[39m : len[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m901[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:813[0m[39m-[0m[1;36m820[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m5[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m5[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:813[0m[39m-[0m[1;36m820[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:41[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:62[0m[39m-[0m[1;36m70[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:struct ip6 [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  uint8_t ver;      [0m[35m/[0m[35m/[0m[39m Version[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:  uint8_t opts[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Options[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:  uint16_t len;     [0m[35m/[0m[35m/[0m[39m Length[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:  uint8_t proto;    [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:  uint8_t ttl;      [0m[35m/[0m[35m/[0m[39m Time to live[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m16[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:77[0m[39m-[0m[1;36m83[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:struct arp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:  uint16_t fmt;    [0m[35m/[0m[35m/[0m[39m Format of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:  uint16_t pro;    [0m[35m/[0m[35m/[0m[39m Format of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:  uint8_t hlen;    [0m[35m/[0m[35m/[0m[39m Length of hardware address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:  uint8_t plen;    [0m[35m/[0m[35m/[0m[39m Length of protocol address[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:  uint16_t op;     [0m[35m/[0m[35m/[0m[39m Operation[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:85[0m[39m-[0m[1;36m100[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:  uint32_t spa;    [0m[35m/[0m[35m/[0m[39m Sender protocol address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:  uint8_t tha[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Target hardware address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:  uint32_t tpa;    [0m[35m/[0m[35m/[0m[39m Target protocol address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:102[0m[39m-[0m[1;36m106[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:  uint16_t win;   [0m[35m/[0m[35m/[0m[39m Window[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:498[0m[39m-[0m[1;36m518[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:static void [0m[1;35mrx_udp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:  struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, true[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:  if [0m[1;39m([0m[39mc == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:    [0m[35m/[0m[35m/[0m[39m No UDP listener on this port. Should send ICMP, but keep silent.[0m         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    c->rem.port = pkt->udp->sport;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mc->rem.ip, &pkt->ip->src, [0m[1;35msizeof[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    struct connstate *s = [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39ms->mac, pkt->eth->src, [0m[1;35msizeof[0m[1;39m([0m[39ms->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:    if [0m[1;39m([0m[39mc->recv.len >= MG_MAX_RECV_SIZE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"max_recv_buf_size reached"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc->recv.size - c->recv.len < pkt->pay.len &&[0m                     [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:               ![0m[1;35mmg_iobuf_resize[0m[1;39m([0m[39m&c->recv, c->recv.len + pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"oom"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&c->recv.buf[0m[1;39m[[0m[39mc->recv.len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:      c->recv.len += pkt->pay.len;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:      [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_READ, &pkt->pay.len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:744[0m[39m-[0m[1;36m792[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:static void [0m[1;35mrx_tcp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:  struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:  struct connstate *s = c == NULL ? NULL : [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:#if [0m[1;36m0[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:  [0m[1;35mMG_INFO[0m[1;39m([0m[1;39m([0m[32m"%lu %hhu %d"[0m[39m, c ? c->id : [0m[1;36m0[0m[39m, pkt->tcp->flags, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:  if [0m[1;39m([0m[39mc != NULL && c->is_connecting && pkt->tcp->flags == [0m[1;39m([0m[39mTH_SYN | TH_ACK[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:    s->seq = [0m[1;35mmg_ntohl[0m[1;39m([0m[39mpkt->tcp->ack[0m[1;39m)[0m[39m, s->ack = [0m[1;35mmg_ntohl[0m[1;39m([0m[39mpkt->tcp->seq[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:    c->is_connecting = [0m[1;36m0[0m[39m;  [0m[35m/[0m[35m/[0m[39m Client connected[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:    [0m[1;35msettmout[0m[1;39m([0m[39mc, MIP_TTYPE_KEEPALIVE[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:    [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_CONNECT, NULL[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Let user know[0m                          [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:    if [0m[1;39m([0m[39mc->is_tls_hs[0m[1;39m)[0m[39m [0m[1;35mmg_tls_handshake[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc != NULL && c->is_connecting && pkt->tcp->flags != TH_ACK[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mpkt->raw.buf, pkt->raw.len[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_RST | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc != NULL && pkt->tcp->flags & TH_RST[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:    [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"peer RST"[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m RFC-[0m[1;36m1122[0m[39m [0m[1;92m4.2.2.13[0m                              [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:#if [0m[1;36m0[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"%lu %d %M:%hu -> %M:%hu"[0m[39m, c->id, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->raw.len,[0m             [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:              mg_print_ip4, &pkt->ip->src, [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m,[0m           [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:              mg_print_ip4, &pkt->ip->dst, [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:    [0m[1;35mmg_hexdump[0m[1;39m([0m[39mpkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:#endif[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:    s->tmiss = [0m[1;36m0[0m[39m;                         [0m[35m/[0m[35m/[0m[39m Reset missed keep-alive counter[0m    [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:    if [0m[1;39m([0m[39ms->ttype == MIP_TTYPE_KEEPALIVE[0m[1;39m)[0m[39m  [0m[35m/[0m[35m/[0m[39m Advance keep-alive timer[0m           [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:      [0m[1;35msettmout[0m[1;39m([0m[39mc,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:               MIP_TTYPE_KEEPALIVE[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m unless a former ACK timeout is pending[0m [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:    [0m[1;35mread_conn[0m[1;39m([0m[39mc, pkt[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Override timer with ACK timeout if needed[0m            [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, true[0m[1;39m)[0m[1;39m)[0m[39m == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_RST | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->tcp->flags & TH_RST[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:    if [0m[1;39m([0m[39mc->is_accepted[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"peer RST"[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m RFC-[0m[1;36m1122[0m[39m [0m[1;92m4.2.2.13[0m          [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:    [0m[35m/[0m[35m/[0m[39m ignore RST if not connected[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->tcp->flags & TH_SYN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:    [0m[35m/[0m[35m/[0m[39m Use peer's source port as ISN, in order to recognise the handshake[0m       [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:    uint32_t isn = [0m[1;35mmg_htonl[0m[1;39m([0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_SYN | TH_ACK, isn, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->tcp->flags & TH_FIN[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_FIN | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mmg_htonl[0m[1;39m([0m[39mpkt->tcp->ack[0m[1;39m)[0m[39m == [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m + 1U[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:    [0m[1;35maccept_conn[0m[1;39m([0m[39mc, pkt[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m!c->is_accepted[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m  [0m[35m/[0m[35m/[0m[39m no peer[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:    [0m[1;35mtx_tcp_pkt[0m[1;39m([0m[39mifp, pkt, TH_RST | TH_ACK, pkt->tcp->ack, NULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"dropped silently.."[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Issue[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the evaluation report and code snippets, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the heap-buffer-overflow:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe crash occurs due to **two critical issues working in combination**:[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Insufficient validation of IPv4 header length**: When IPv4 packets have [0m       [2m                [0m
[2;36m                    [0m         [39moptions [0m[1;39m([0m[39mIHL > [0m[1;36m5[0m[1;39m)[0m[39m, the code calculates the IP header length as `[0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m    [2m                [0m
[2;36m                    [0m         [1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m` but doesn't validate this fits within the packet buffer before calling [0m  [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m892[0m[39m.[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Incorrect protocol header pointer assignments**: In `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`, protocol [0m       [2m                [0m
[2;36m                    [0m         [39mheaders [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m are set to `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m`, which assumes the protocol [0m    [2m                [0m
[2;36m                    [0m         [39mdata starts immediately after the [0m[1;36m20[0m[39m-byte base IP header. This is **incorrect when [0m [2m                [0m
[2;36m                    [0m         [39mIPv4 options are present**, causing pointers to reference the wrong memory [0m         [2m                [0m
[2;36m                    [0m         [39mlocations.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why the Previous Patch Failed[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch attempted to:[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Add bounds checks before calling `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` in `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`[0m                           [2m                [0m
[2;36m                    [0m         [39m- Add a defensive check inside `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m`[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mHowever, these checks occurred **too late** in the execution flow. The real problem[0m [2m                [0m
[2;36m                    [0m         [39mhappens earlier in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m892[0m[39m, where `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` is called with an [0m  [2m                [0m
[2;36m                    [0m         [39munvalidated pointer that can extend beyond the buffer. When this pointer exceeds [0m   [2m                [0m
[2;36m                    [0m         [39mthe buffer end, the subtraction in `[0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m` wraps around to create a huge positive[0m [2m                [0m
[2;36m                    [0m         [39m`size_t` value, bypassing all subsequent length checks.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Attack Scenario[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith a [0m[1;36m34[0m[39m-byte packet and malicious [0m[33mIHL[0m[39m=[0m[1;36m6[0m[39m:[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `[0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar*[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;36m24[0m[1;39m)[0m[39m` is called, pointing to byte [0m[1;36m38[0m               [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Since buffer ends at byte [0m[1;36m34[0m[39m, the calculation `[0m[1;36m34[0m[39m - [0m[1;36m38[0m[39m` underflows to ~4GB[0m       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` points to byte [0m[1;36m34[0m[39m [0m[1;39m([0m[39mout of bounds[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Check `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m` compares `4GB < [0m[1;36m4[0m[39m`, which is [0m     [2m                [0m
[2;36m                    [0m         [39mfalse[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. `[0m[1;35mrx_icmp[0m[1;39m([0m[1;39m)[0m[39m` accesses `pkt->icmp->type` at byte [0m[1;36m34[0m[39m → **heap-buffer-overflow**[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix [0m[1;36m1[0m[39m: Validate IPv4 Header Length Before Calling [0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mPrimary Fix[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `src/net_builtin.c`, lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m in `[0m[1;35mmg_tcpip_rx[0m[1;39m([0m[1;39m)[0m[39m`[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Before line [0m[1;36m891[0m[39m, extract and validate the IP header length[0m                        [2m                [0m
[2;36m                    [0m         [39m- Check that `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len` does not exceed `pkt.raw.len`[0m          [2m                [0m
[2;36m                    [0m         [39m- Use a consistent variable for the IP header length instead of recalculating[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39msize_t ip_hdr_len = [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mip_hdr_len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Header exceeds packet[0m  [2m                [0m
[2;36m                    [0m         [1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mRemove the conditional branches at lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m and replace with the unified [0m      [2m                [0m
[2;36m                    [0m         [39mapproach above.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix [0m[1;36m2[0m[39m: Correct Protocol Header Pointer Assignments in [0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `src/net_builtin.c`, function `[0m[1;35mrx_ip[0m[1;39m([0m[1;39m)[0m[39m`, lines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[39m, [0m[1;36m802[0m[39m, [0m[1;36m807[0m[39m, [0m[1;36m825[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mChange all protocol header assignments from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to `pkt->pay.buf`, [0m     [2m                [0m
[2;36m                    [0m         [39mwhich correctly points to the start of protocol data after accounting for IPv4 [0m     [2m                [0m
[2;36m                    [0m         [39moptions.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Specific line changes**:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m797[0m[39m: `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                               [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m798[0m[39m: `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                               [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m802[0m[39m: `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                             [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m807[0m[39m: `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                               [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m825[0m[39m: `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix [0m[1;36m3[0m[39m: Update DHCP Pointer Assignments[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `src/net_builtin.c`, lines [0m[1;36m814[0m[39m and [0m[1;36m818[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39mAfter `[0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m` is called at line [0m[1;36m809[0m[39m, `pkt->pay.buf` points to [0m   [2m                [0m
[2;36m                    [0m         [39mthe location after the UDP header, which is where DHCP data begins.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Specific changes**:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m814[0m[39m: `pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                             [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m818[0m[39m: `pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix [0m[1;36m4[0m[39m: Correct TCP Payload Calculation[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `src/net_builtin.c`, line [0m[1;36m829[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39mThe TCP payload recalculation uses `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` which is always [0m[1;36m20[0m[39m bytes, [0m    [2m                [0m
[2;36m                    [0m         [39mignoring IPv4 options. Update it to use the actual IP header length.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t ip_hdr_len = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hdr_len + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix [0m[1;36m5[0m[39m: Add Defensive Bounds Check in [0m[1;35mmkpay[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mDefense in Depth[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `src/net_builtin.c`, lines [0m[1;36m149[0m[39m-[0m[1;36m152[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39mAdd a validation check to prevent pointer arithmetic underflow when the pointer is [0m [2m                [0m
[2;36m                    [0m         [39mbeyond the buffer.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mstatic void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mp > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m    pkt->pay = [0m[1;35mmg_str_n[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m    return;[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m  [0m[1;39m}[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m  pkt->pay = [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Approach is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses Root Cause**: Fix [0m[1;36m1[0m[39m prevents the underflow at its source by [0m         [2m                [0m
[2;36m                    [0m         [39mvalidating the IHL field before using it.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Corrects Fundamental Design Flaw**: Fix [0m[1;36m2[0m[39m corrects the incorrect assumption [0m   [2m                [0m
[2;36m                    [0m         [39mthat protocol data starts at `ip + [0m[1;36m1[0m[39m`, which has been wrong all along when IPv4 [0m    [2m                [0m
[2;36m                    [0m         [39moptions are present.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Comprehensive Coverage**: Fixes [0m[1;36m3[0m[39m-[0m[1;36m5[0m[39m address derivative issues and add defense [0m [2m                [0m
[2;36m                    [0m         [39min depth, ensuring robustness even if edge cases are encountered.[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves Existing Logic**: The fixes don't change the overall packet [0m         [2m                [0m
[2;36m                    [0m         [39mprocessing flow, only correct the pointer calculations and add necessary [0m           [2m                [0m
[2;36m                    [0m         [39mvalidations.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Minimal Performance Impact**: The added checks are simple integer comparisons [0m [2m                [0m
[2;36m                    [0m         [39mthat execute in the fast path only when needed.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Functionality[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Normal packets without IPv4 options** [0m[1;39m([0m[33mIHL[0m[39m=[0m[1;36m5[0m[1;39m)[0m[39m: Continue to work exactly as [0m    [2m                [0m
[2;36m                    [0m         [39mbefore since `[0m[1;39m([0m[39mchar*[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;36m20[0m[39m` equals `pkt.ip + [0m[1;36m1[0m[39m`.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Valid packets with IPv4 options**: Now correctly handled by using the actual [0m  [2m                [0m
[2;36m                    [0m         [39mheader length and correct protocol pointers.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Protocol handlers** [0m[1;39m([0m[39m`rx_icmp`, `rx_udp`, `rx_tcp`[0m[1;39m)[0m[39m: No changes needed; they [0m  [2m                [0m
[2;36m                    [0m         [39mreceive correctly positioned pointers.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fragmentation handling**: Also benefits from correct pointer assignments.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **DHCP processing**: Already has additional bounds checks, now also gets correct[0m [2m                [0m
[2;36m                    [0m         [39mpointers.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects**:[0m                                                         [2m                [0m
[2;36m                    [0m         [39m- Packets with malformed IHL fields will be dropped earlier, which is the correct [0m  [2m                [0m
[2;36m                    [0m         [39msecurity behavior[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Very slightly increased validation overhead for all IPv4 packets [0m[1;39m([0m[39mnegligible[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation**:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- The early return on invalid packets prevents wasted processing and is actually a [0m [2m                [0m
[2;36m                    [0m         [39mperformance improvement for malicious traffic[0m                                       [2m                [0m
[2;36m                    [0m         [39m- All validation checks are simple integer comparisons with minimal overhead[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe DHCP handlers [0m[1;39m([0m[39m`rx_dhcp_client` at line [0m[1;36m404[0m[39m, `rx_dhcp_server` at line [0m[1;36m462[0m[1;39m)[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39malready demonstrate the correct pattern of validating pointers before use:[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mOur fixes apply this same principle more systematically throughout the packet [0m      [2m                [0m
[2;36m                    [0m         [39mprocessing pipeline.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix strategy validates IPv4 header length before using it, corrects all [0m        [2m                [0m
[2;36m                    [0m         [39mprotocol header pointer assignments to account for IPv4 options, and adds defensive[0m [2m                [0m
[2;36m                    [0m         [39mchecks against pointer arithmetic underflow. This comprehensive approach eliminates[0m [2m                [0m
[2;36m                    [0m         [39mthe heap-buffer-overflow vulnerability while maintaining compatibility with [0m        [2m                [0m
[2;36m                    [0m         [39mexisting functionality.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 03:55:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=599281;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=227682;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 03:59:29][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=127886;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=545551;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 04:00:52][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=401508;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=700005;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=103459;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=158439;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:00:53][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.93[0m seconds;              ]8;id=350945;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=469018;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=256053;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=240138;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpm31eczx8[0m                                                 ]8;id=235893;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=771552;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 04:01:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.93[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=2930;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=933023;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=621657;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=774392;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:01:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.26[0m seconds;             ]8;id=141971;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=584282;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=464516;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=722551;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:01:06][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=830526;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=163533;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m175604417[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a29708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55a257a2aaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a2aaa8[0m[39m,[0m[1;36m0x55a257a3e448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55a2579afc02[0m[39m bp [0m[1;36m0x7fffc2b27ba0[0m[39m sp [0m[1;36m0x7fffc2b27b98[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a2579afc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a257997d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a2579ac8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55a2577fb7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a25792411f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a2579ac79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmph3om5yul[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=688933;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=478859;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m175604417[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a29708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55a257a2aaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a2aaa8[0m[39m,[0m[1;36m0x55a257a3e448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55a2579afc02[0m[39m bp [0m[1;36m0x7fffc2b27ba0[0m[39m sp [0m[1;36m0x7fffc2b27b98[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a2579afc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a257997d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a2579ac8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55a2577fb7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a25792411f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a2579ac79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmph3om5yul[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m175604417[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a29708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55a257a2aaa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a2aaa8[0m[39m,[0m[1;36m0x55a257a3e448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55a2579afc02[0m[39m bp [0m[1;36m0x7fffc2b27ba0[0m[39m sp [0m[1;36m0x7fffc2b27b98[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a2579afc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a257997d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a2579ac8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55a2577fb7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a25792411f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a2579ac79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmph3om5yul[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.26[0m seconds;                ]8;id=359626;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=471227;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=750825;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=439792;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:01:07][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.00[0m seconds;              ]8;id=289678;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=396371;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:01:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=987803;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=884549;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.96[0m seconds;              ]8;id=304217;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=457347;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:01:09][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=660218;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=525856;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-147[0m,[1;36m6[0m +[1;36m147[0m,[1;36m10[0m @@                                                                [2m                [0m
[2;36m                    [0m          static void [1;35msend_syn[0m[1m([0mstruct mg_connection *c[1m)[0m;                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mmkpay[0m[1m([0mstruct pkt *pkt, void *p[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         +  if [1m([0m[1m([0mchar *[1m)[0mp > &pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m[1m)[0m [1m{[0m                                   [2m                [0m
[2;36m                    [0m         +    pkt->pay = [1;35mmg_str_n[0m[1m([0mNULL, [1;36m0[0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         +    return;                                                                        [2m                [0m
[2;36m                    [0m         +  [1m}[0m                                                                                [2m                [0m
[2;36m                    [0m            pkt->pay =                                                                       [2m                [0m
[2;36m                    [0m                [1;35mmg_str_n[0m[1m([0m[1m([0mchar *[1m)[0m p, [1m([0msize_t[1m)[0m [1m([0m&pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m - [1m([0mchar *[1m)[0m p[1m)[0m[1m)[0m;   [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-794[0m,[1;36m17[0m +[1;36m798[0m,[1;36m17[0m @@                                                               [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m pkt->pay.buf;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m pkt->pay.buf;               [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         +    pkt->icmp = [1m([0mstruct icmp *[1m)[0m pkt->pay.buf;                                      [2m                [0m
[2;36m                    [0m              if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m826[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t ip_hdr_len = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hdr_len + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m893[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hdr_len = [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hdr_len < [0m[1;36m20[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IP header exceeds[0m [2m                [0m
[2;36m                    [0m         [39mbuffer[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m175604417[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a29708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55a257a2aaa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a2aaa8[0m[39m,[0m[1;36m0x55a257a3e448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55a2579afc02[0m[39m bp [0m[1;36m0x7fffc2b27ba0[0m[39m sp [0m[1;36m0x7fffc2b27b98[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a2579afc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a257997d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a2579ac8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55a2577fb7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a25792411f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a2579ac79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmph3om5yul[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue is a heap-buffer-overflow vulnerability detected by [0m              [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer during fuzzing. The overflow occurs in the `rx_icmp` function at [0m  [2m                [0m
[2;36m                    [0m         [39mline [0m[1;36m385[0m[39m of `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m`, where a [0m[1;36m1[0m[39m-byte read access occurs [0m   [2m                [0m
[2;36m                    [0m         [39mbeyond the bounds of a [0m[1;36m34[0m[39m-byte allocated buffer. The patch attempt aimed to add [0m    [2m                [0m
[2;36m                    [0m         [39mboundary checks and refactor pointer arithmetic related to IP header processing, [0m   [2m                [0m
[2;36m                    [0m         [39mparticularly focusing on the `mkpay` function and various protocol handlers. [0m       [2m                [0m
[2;36m                    [0m         [39mHowever, after applying the patch, the exact same heap-buffer-overflow error [0m       [2m                [0m
[2;36m                    [0m         [39mpersists at the same location with identical characteristics.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue reveals a heap-buffer-overflow with the following key [0m            [2m                [0m
[2;36m                    [0m         [39mcharacteristics:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Error Details:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Type: READ of size [0m[1;36m1[0m[39m at address `[0m[1;36m0x504000000172[0m[39m`[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Location: `[0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m` function at line [0m[1;36m385[0m[39m in `net_builtin.c`[0m   [2m                [0m
[2;36m                    [0m         [39m- Buffer: [0m[1;36m34[0m[39m-byte region allocated at `[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m`[0m            [2m                [0m
[2;36m                    [0m         [39m- The read occurs exactly at the boundary [0m[1;39m([0m[1;36m0[0m[39m bytes after the [0m[1;36m34[0m[39m-byte region[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Call Stack:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer entry point `LLVMFuzzerTestOneInput` at `fuzz.[0m[1;92mc:106[0m[39m`[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `mg_tcpip_rx` function at `net_builtin.[0m[1;92mc:897[0m[39m`[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `rx_icmp` function at `net_builtin.[0m[1;92mc:385[0m[39m` [0m[1;39m([0m[39mwhere the overflow occurs[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Memory Allocation:**[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThe problematic buffer was allocated in `LLVMFuzzerTestOneInput` at `fuzz.[0m[1;92mc:95[0m[39m`, [0m   [2m                [0m
[2;36m                    [0m         [39msuggesting the input data from the fuzzer is being allocated and then processed [0m    [2m                [0m
[2;36m                    [0m         [39mthrough the network stack.[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch made several modifications to `net_builtin.c`:[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **mkpay Function Enhancement [0m[1;39m([0m[39mlines [0m[1;36m149[0m[39m-[0m[1;36m153[0m[1;39m)[0m[39m:**[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - Added a boundary check before constructing the payload[0m                         [2m                [0m
[2;36m                    [0m         [39m   - If pointer `p` exceeds the buffer boundary, sets payload to NULL with zero [0m    [2m                [0m
[2;36m                    [0m         [39mlength[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Returns early to prevent buffer overrun[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **IP Header Processing Refactoring [0m[1;39m([0m[39mlines [0m[1;36m893[0m[39m-[0m[1;36m899[0m[1;39m)[0m[39m:**[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Extracted IP header length calculation into a separate variable `ip_hdr_len`[0m   [2m                [0m
[2;36m                    [0m         [39m   - Added validation to ensure IHL [0m[1;39m([0m[39mInternet Header Length[0m[1;39m)[0m[39m is at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m [0m     [2m                [0m
[2;36m                    [0m         [39mbytes[0m[1;39m)[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Added check to ensure IP header doesn't exceed the raw buffer length[0m           [2m                [0m
[2;36m                    [0m         [39m   - Unified the IP header options handling into a single code path[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Protocol Handler Pointer Updates [0m[1;39m([0m[39mlines [0m[1;36m798[0m[39m-[0m[1;36m843[0m[1;39m)[0m[39m:**[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Changed protocol structure assignments from pointer arithmetic with IP [0m        [2m                [0m
[2;36m                    [0m         [39mstructures to using `pkt->pay.buf`[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Updated for ICMP, UDP, DHCP, and TCP handlers[0m                                  [2m                [0m
[2;36m                    [0m         [39m   - Modified both `rx_ip` and `rx_ip6` functions[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **TCP Offset Calculation [0m[1;39m([0m[39mlines [0m[1;36m832[0m[39m-[0m[1;36m833[0m[1;39m)[0m[39m:**[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Changed from using `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` to calculated `ip_hdr_len`[0m               [2m                [0m
[2;36m                    [0m         [39m   - This accounts for variable-length IP headers with options[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Results[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the identical error persists:[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Unchanged Error Characteristics:**[0m                                                [2m                [0m
[2;36m                    [0m         [39m- Same address location: `[0m[1;36m0x504000000172[0m[39m`[0m                                           [2m                [0m
[2;36m                    [0m         [39m- Same buffer region: `[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m` [0m[1;39m([0m[1;36m34[0m[39m bytes[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [39m- Same function: `rx_icmp` at line [0m[1;36m385[0m                                              [2m                [0m
[2;36m                    [0m         [39m- Same call stack pattern[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- Same DEDUP_TOKEN values[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates that:[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The patch does not address the root cause of the overflow in `rx_icmp`[0m           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The boundary checks added in `mkpay` are either not being reached or are [0m        [2m                [0m
[2;36m                    [0m         [39minsufficient[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The pointer refactoring in protocol handlers didn't prevent the out-of-bounds [0m   [2m                [0m
[2;36m                    [0m         [39maccess[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Critical Investigation Points:**[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **rx_icmp Function [0m[1;39m([0m[39mline [0m[1;36m385[0m[1;39m)[0m[39m:**[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - This is where the actual overflow occurs[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - The specific line [0m[1;36m385[0m[39m needs examination to understand what memory access is [0m   [2m                [0m
[2;36m                    [0m         [39mhappening[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - The function's handling of ICMP packet structures and payload parsing requires[0m [2m                [0m
[2;36m                    [0m         [39mscrutiny[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Packet Payload Setup Chain:**[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - The sequence from `mg_tcpip_rx` → protocol detection → `mkpay` → `rx_icmp`[0m     [2m                [0m
[2;36m                    [0m         [39m   - How `pkt->pay` length and buffer pointers are calculated and propagated[0m        [2m                [0m
[2;36m                    [0m         [39m   - Whether the [0m[1;36m34[0m[39m-byte buffer is correctly reflecting the actual payload size[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **ICMP Packet Structure Access:**[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - How `pkt->icmp` pointer is set and validated[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - The relationship between `pkt->icmp`, `pkt->pay`, and the underlying buffer[0m    [2m                [0m
[2;36m                    [0m         [39m   - Access patterns in `rx_icmp` that could read beyond the ICMP structure[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Buffer Size Calculation:**[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Why the allocated buffer is exactly [0m[1;36m34[0m[39m bytes[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Whether this represents a minimal valid packet or a truncated packet[0m           [2m                [0m
[2;36m                    [0m         [39m   - How the fuzzer input translates to this buffer size[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Interaction Between Changes:**[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - The patch changes pointer assignments from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to `pkt->pay.buf`[0m   [2m                [0m
[2;36m                    [0m         [39m   - This assumes `pkt->pay.buf` correctly points to the protocol header[0m            [2m                [0m
[2;36m                    [0m         [39m   - The timing and correctness of `mkpay` calls relative to these assignments[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Fuzzer Input Processing:**[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - The `LLVMFuzzerTestOneInput` function at `fuzz.[0m[1;92mc:95[0m[39m` allocates the buffer[0m      [2m                [0m
[2;36m                    [0m         [39m   - How the fuzzer input is parsed and what constraints exist on packet structure[0m  [2m                [0m
[2;36m                    [0m         [39m   - Whether minimum size validation occurs before processing[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe persistence of the exact same error after the patch suggests the root cause [0m    [2m                [0m
[2;36m                    [0m         [39mlies in logic that was not modified by the patch, specifically within the `rx_icmp`[0m [2m                [0m
[2;36m                    [0m         [39mfunction itself or in how payload boundaries are established before `rx_icmp` is [0m   [2m                [0m
[2;36m                    [0m         [39mcalled.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m4078629902[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d68708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x560cf0d69aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x560cf0d69aa8[0m[39m,[0m[1;36m0x560cf0d7d448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x560cf0ceec02[0m[39m bp [0m[1;36m0x7ffe37059c20[0m[39m sp [0m[1;36m0x7ffe37059c18[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0ceec01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0cd6d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0ceb8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x560cf0b3a7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x560cf0c6311f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x560cf0ceb79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x560cf0b57350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x560cf0b425c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x560cf0b4805f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x560cf0b73302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fca92d3a082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp9s0zbfdh[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m5[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m143[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m823[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:392[0m[39m-[0m[1;36m392[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:498[0m[39m-[0m[1;36m518[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:static void [0m[1;35mrx_udp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:  struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, true[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:  if [0m[1;39m([0m[39mc == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:    [0m[35m/[0m[35m/[0m[39m No UDP listener on this port. Should send ICMP, but keep silent.[0m         [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    c->rem.port = pkt->udp->sport;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mc->rem.ip, &pkt->ip->src, [0m[1;35msizeof[0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    struct connstate *s = [0m[1;39m([0m[39mstruct connstate *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mc + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39ms->mac, pkt->eth->src, [0m[1;35msizeof[0m[1;39m([0m[39ms->mac[0m[1;39m)[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:    if [0m[1;39m([0m[39mc->recv.len >= MG_MAX_RECV_SIZE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"max_recv_buf_size reached"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc->recv.size - c->recv.len < pkt->pay.len &&[0m                     [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:               ![0m[1;35mmg_iobuf_resize[0m[1;39m([0m[39m&c->recv, c->recv.len + pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:      [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"oom"[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&c->recv.buf[0m[1;39m[[0m[39mc->recv.len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:      c->recv.len += pkt->pay.len;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:      [0m[1;35mmg_call[0m[1;39m([0m[39mc, MG_EV_READ, &pkt->pay.len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:513[0m[39m-[0m[1;36m513[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&c->recv.buf[0m[1;39m[[0m[39mc->recv.len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:707[0m[39m-[0m[1;36m717[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[35m/[0m[35m/[0m[39m Copy TCP payload into the IO buffer. If the connection is plain text,[0m    [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:    [0m[35m/[0m[35m/[0m[39m we copy to c->recv. If the connection is TLS, this data is encrypted,[0m    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:    [0m[35m/[0m[35m/[0m[39m therefore we copy that encrypted data to the c->rtls iobuffer instead,[0m   [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:    [0m[35m/[0m[35m/[0m[39m and then call [0m[1;35mmg_tls_recv[0m[1;39m([0m[1;39m)[0m[39m to decrypt it. NOTE: [0m[1;35mmg_tls_recv[0m[1;39m([0m[1;39m)[0m[39m will[0m      [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:    [0m[35m/[0m[35m/[0m[39m call back [0m[1;35mmg_io_recv[0m[1;39m([0m[1;39m)[0m[39m which grabs raw data from c->rtls[0m                 [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39m&io->buf[0m[1;39m[[0m[39mio->len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:    io->len += pkt->pay.len;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"%lu SEQ %x -> %x"[0m[39m, c->id, [0m[1;35mmg_htonl[0m[1;39m([0m[39mpkt->tcp->seq[0m[1;39m)[0m[39m, s->ack[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:    [0m[35m/[0m[35m/[0m[39m Advance ACK counter[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:    s->ack = [0m[1;39m([0m[39muint32_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35mmg_htonl[0m[1;39m([0m[39mpkt->tcp->seq[0m[1;39m)[0m[39m + pkt->pay.len[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m827[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:90[0m[39m-[0m[1;36m106[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:  uint16_t win;   [0m[35m/[0m[35m/[0m[39m Window[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:108[0m[39m-[0m[1;36m114[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:598[0m[39m-[0m[1;36m600[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m598[0m[39m:  size_t eth_h_len = [0m[1;36m14[0m[39m, ip_max_h_len = [0m[1;36m24[0m[39m, tcp_max_h_len = [0m[1;36m60[0m[39m, udp_h_len = [0m[1;36m8[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m599[0m[39m:  size_t max_headers_len =[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m600[0m[39m:      eth_h_len + ip_max_h_len + [0m[1;39m([0m[39mc->is_udp ? udp_h_len : tcp_max_h_len[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:110[0m[39m-[0m[1;36m115[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:117[0m[39m-[0m[1;36m125[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:struct dhcp [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:  uint8_t op, htype, hlen, hops;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:  uint32_t xid;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:  uint16_t secs, flags;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:  uint32_t ciaddr, yiaddr, siaddr, giaddr;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:  uint8_t hwaddr[0m[1;39m[[0m[1;36m208[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:  uint32_t magic;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:  uint8_t options[0m[1;39m[[0m[1;36m32[0m[1;39m][0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m5[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:41[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Code Snippets[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and the evaluation report, I've identified the [0m   [2m                [0m
[2;36m                    [0m         [39mroot cause of the heap-buffer-overflow issue:[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue occurs because protocol handlers in the `rx_ip` function incorrectly [0m     [2m                [0m
[2;36m                    [0m         [39mcalculate protocol header pointers by assuming a fixed [0m[1;36m20[0m[39m-byte IP header size, when[0m [2m                [0m
[2;36m                    [0m         [39mIPv4 headers can be [0m[1;36m20[0m[39m-[0m[1;36m60[0m[39m bytes due to IP options [0m[1;39m([0m[39mcontrolled by the IHL field[0m[1;39m)[0m[39m.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**The critical flow:**[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. In `mg_tcpip_rx` [0m[1;39m([0m[39mlines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m[39m, the code correctly handles IP options:[0m         [2m                [0m
[2;36m                    [0m         [39m   - It calculates the actual IP header length: `[0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m`[0m           [2m                [0m
[2;36m                    [0m         [39m   - It calls `[0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[33m...[0m[1;39m)[0m[39m` with the correct offset past IP options[0m            [2m                [0m
[2;36m                    [0m         [39m   - After this, `pkt->pay.buf` correctly points to the start of the protocol [0m      [2m                [0m
[2;36m                    [0m         [39mpayload [0m[1;39m([0m[39mICMP/UDP/TCP header[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. However, in `rx_ip`, the code INCORRECTLY recalculates protocol pointers:[0m        [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m802[0m[39m: `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` - assumes [0m[1;36m20[0m[39m-byte IP [0m   [2m                [0m
[2;36m                    [0m         [39mheader[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m807[0m[39m: `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` - assumes [0m[1;36m20[0m[39m-byte IP [0m     [2m                [0m
[2;36m                    [0m         [39mheader  [0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m825[0m[39m: `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` - assumes [0m[1;36m20[0m[39m-byte IP [0m     [2m                [0m
[2;36m                    [0m         [39mheader[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Lines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[39m: Same issue for fragmented packets[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. When IP options are present [0m[1;39m([0m[39me.g., [0m[1;36m14[0m[39m bytes[0m[1;39m)[0m[39m, the protocol pointers end up [0m      [2m                [0m
[2;36m                    [0m         [39mpointing into the middle of the IP options instead of the actual protocol header.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. In the [0m[1;36m34[0m[39m-byte fuzzer test case:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;36m14[0m[39m bytes: Ethernet header[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;36m20[0m[39m+ bytes: IP header [0m[1;39m([0m[39mpossibly with options[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - When `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` is used, it points to offset [0m  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m [0m[1;39m([0m[1;36m14[0m[39m eth + [0m[1;36m20[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - Accessing `pkt->icmp->type` reads at offset [0m[1;36m34[0m[39m, which is exactly at the buffer[0m [2m                [0m
[2;36m                    [0m         [39mboundary[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - This triggers the heap-buffer-overflow at address [0m[1;36m0x504000000172[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why the Previous Patch Failed[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch attempted to change the pointer assignments from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39mto `pkt->pay.buf`, but this change was made in the DIFF format, not understanding [0m  [2m                [0m
[2;36m                    [0m         [39mthat the actual issue is that these lines were using pointer arithmetic that [0m       [2m                [0m
[2;36m                    [0m         [39mdoesn't account for IP options. The patch was on the right track but may have had [0m  [2m                [0m
[2;36m                    [0m         [39missues with how it was applied or the changes weren't comprehensive enough.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Fix Protocol Pointer Assignments in rx_ip[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace all protocol pointer assignments that use `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` with [0m             [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.buf`, which already correctly points past any IP options:[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Lines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[39m [0m[1;39m([0m[39mFragmented packets[0m[1;39m)[0m[39m:**[0m                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current [0m[1;39m([0m[39mwrong[0m[1;39m)[0m[39m:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Fixed:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                   [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Line [0m[1;36m802[0m[39m [0m[1;39m([0m[39mICMP[0m[1;39m)[0m[39m:**[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current [0m[1;39m([0m[39mwrong[0m[1;39m)[0m[39m:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39mpkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Fixed:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mpkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Line [0m[1;36m807[0m[39m [0m[1;39m([0m[39mUDP[0m[1;39m)[0m[39m:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current [0m[1;39m([0m[39mwrong[0m[1;39m)[0m[39m:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39mpkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Fixed:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mpkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Line [0m[1;36m825[0m[39m [0m[1;39m([0m[39mTCP[0m[1;39m)[0m[39m:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current [0m[1;39m([0m[39mwrong[0m[1;39m)[0m[39m:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39mpkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Fixed:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mpkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Fix TCP Offset Calculation[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe TCP handler at line [0m[1;36m829[0m[39m also incorrectly uses `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39minstead of the actual IP header length when calculating the TCP data offset:[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Lines [0m[1;36m828[0m[39m-[0m[1;36m830[0m[39m:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Current [0m[1;39m([0m[39mwrong[0m[1;39m)[0m[39m:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39muint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Fixed:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39muint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39muint16_t ip_hlen = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m Actual IP header length[0m            [2m                [0m
[2;36m                    [0m         [39muint16_t tcp_hlen = [0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U;  [0m[35m/[0m[35m/[0m[39m TCP header length[0m                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hlen + tcp_hlen[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Remove Redundant Boundary Check in mkpay[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch added a boundary check in `mkpay` at lines [0m[1;36m149[0m[39m-[0m[1;36m153[0m[39m. However, [0m    [2m                [0m
[2;36m                    [0m         [39mthis check is redundant because:[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The `mg_tcpip_rx` function already validates that the IP header fits within the [0m [2m                [0m
[2;36m                    [0m         [39mbuffer[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. After the Step [0m[1;36m1[0m[39m fixes, all protocol pointers will be set from `pkt->pay.buf`, [0m  [2m                [0m
[2;36m                    [0m         [39mwhich is guaranteed to be within bounds[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The check should be removed to keep the code clean[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Fix Is Optimal[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**[0m[1;36m1[0m[39m. Preserves Existing Logic:**[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- The fix doesn't change how `mg_tcpip_rx` calculates IP payload location[0m           [2m                [0m
[2;36m                    [0m         [39m- The fix doesn't modify how `mkpay` calculates payload lengths[0m                     [2m                [0m
[2;36m                    [0m         [39m- It simply ensures protocol handlers use the already-correct `pkt->pay.buf` value[0m  [2m                [0m
[2;36m                    [0m         [39m- No changes to protocol-specific handlers [0m[1;39m([0m[39mrx_icmp, rx_udp, rx_tcp[0m[1;39m)[0m[39m are needed[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**[0m[1;36m2[0m[39m. Addresses Root Cause:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- The issue is that protocol pointers don't account for IP options[0m                  [2m                [0m
[2;36m                    [0m         [39m- By using `pkt->pay.buf` [0m[1;39m([0m[39mwhich already accounts for options[0m[1;39m)[0m[39m, we fix this [0m        [2m                [0m
[2;36m                    [0m         [39mdirectly[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- This is the minimal change that addresses the actual problem[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**[0m[1;36m3[0m[39m. Maintains Consistency:**[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- IPv6 handling already uses `[0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m` which is correct because IPv6 headers[0m [2m                [0m
[2;36m                    [0m         [39mare fixed-size[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- IPv4 handling now uses `pkt->pay.buf` which accounts for variable-size headers[0m    [2m                [0m
[2;36m                    [0m         [39m- Both approaches result in protocol pointers pointing to the correct location[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**[0m[1;36m4[0m[39m. No Side Effects:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- The fix only changes how pointers are calculated, not what they point to[0m          [2m                [0m
[2;36m                    [0m         [39m- All existing protocol handler code continues to work unchanged[0m                    [2m                [0m
[2;36m                    [0m         [39m- The fix doesn't affect non-IP protocols [0m[1;39m([0m[39mARP, etc.[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m- Test cases should continue to pass because correct packets will still be [0m         [2m                [0m
[2;36m                    [0m         [39mprocessed correctly[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**[0m[1;36m5[0m[39m. Comprehensive Coverage:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- Fixes ICMP, UDP, TCP, and fragmented packet handling[0m                              [2m                [0m
[2;36m                    [0m         [39m- Fixes both pointer assignment and TCP offset calculation issues[0m                   [2m                [0m
[2;36m                    [0m         [39m- Covers all code paths where `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` was used[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe IPv6 handling at lines [0m[1;36m841[0m[39m and [0m[1;36m846[0m[39m shows the pattern we're following:[0m           [2m                [0m
[2;36m                    [0m         [39m- `mg_tcpip_rx` calls `[0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m` to set payload[0m                     [2m                [0m
[2;36m                    [0m         [39m- `rx_ip6` uses `[0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m` for protocol pointers[0m                              [2m                [0m
[2;36m                    [0m         [39m- This works because IPv6 headers are fixed-size, so `pkt->pay.buf == [0m[1;39m([0m[39mchar [0m        [2m                [0m
[2;36m                    [0m         [39m*[0m[1;39m)[0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m`[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFor IPv4 with options:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- `mg_tcpip_rx` calls `[0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m`[0m     [2m                [0m
[2;36m                    [0m         [39m- `rx_ip` should use `pkt->pay.buf` for protocol pointers[0m                           [2m                [0m
[2;36m                    [0m         [39m- This ensures `pkt->pay.buf` correctly points past any IP options[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe existing code at lines [0m[1;36m891[0m[39m-[0m[1;36m892[0m[39m already demonstrates the correct way to handle [0m  [2m                [0m
[2;36m                    [0m         [39mIP options, and our fix applies this same logic to the protocol pointer [0m            [2m                [0m
[2;36m                    [0m         [39massignments.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 04:01:35][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=865122;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=176609;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 04:05:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=516790;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=488463;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 04:06:56][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=26071;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=966930;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=909319;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=646047;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:06:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.90[0m seconds;              ]8;id=126133;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=845932;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=542068;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=715195;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmplfzyl8ls[0m                                                 ]8;id=917022;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=985163;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 04:07:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.90[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=167641;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=164484;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=728044;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=921;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:07:08][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.28[0m seconds;             ]8;id=814211;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=994240;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=661296;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=701635;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:07:11][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=233654;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=235787;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m540144169[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad61708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55735ad62aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad62aa8[0m[39m,[0m[1;36m0x55735ad76448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55735ace7c02[0m[39m bp [0m[1;36m0x7fff2404de00[0m[39m sp [0m[1;36m0x7fff2404ddf8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ace7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735accfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ace48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55735ab337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ac5c11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735ace479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp3jt_xj04[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=78174;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=989561;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m540144169[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad61708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55735ad62aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad62aa8[0m[39m,[0m[1;36m0x55735ad76448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55735ace7c02[0m[39m bp [0m[1;36m0x7fff2404de00[0m[39m sp [0m[1;36m0x7fff2404ddf8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ace7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735accfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ace48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55735ab337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ac5c11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735ace479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp3jt_xj04[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m540144169[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad61708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x55735ad62aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad62aa8[0m[39m,[0m[1;36m0x55735ad76448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x55735ace7c02[0m[39m bp [0m[1;36m0x7fff2404de00[0m[39m sp [0m[1;36m0x7fff2404ddf8[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ace7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735accfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ace48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55735ab337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ac5c11f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735ace479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp3jt_xj04[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.30[0m seconds;                ]8;id=878804;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=169038;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=132429;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=844413;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:07:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.86[0m seconds;              ]8;id=629755;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=215619;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=661375;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=70588;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:07:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m1.04[0m seconds;              ]8;id=889039;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=794327;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=633915;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=843401;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-147[0m,[1;36m6[0m +[1;36m147[0m,[1;36m10[0m @@                                                                [2m                [0m
[2;36m                    [0m          static void [1;35msend_syn[0m[1m([0mstruct mg_connection *c[1m)[0m;                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mmkpay[0m[1m([0mstruct pkt *pkt, void *p[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         +  if [1m([0m[1m([0mchar *[1m)[0mp > &pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m[1m)[0m [1m{[0m                                   [2m                [0m
[2;36m                    [0m         +    pkt->pay = [1;35mmg_str_n[0m[1m([0mNULL, [1;36m0[0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         +    return;                                                                        [2m                [0m
[2;36m                    [0m         +  [1m}[0m                                                                                [2m                [0m
[2;36m                    [0m            pkt->pay =                                                                       [2m                [0m
[2;36m                    [0m                [1;35mmg_str_n[0m[1m([0m[1m([0mchar *[1m)[0m p, [1m([0msize_t[1m)[0m [1m([0m&pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m - [1m([0mchar *[1m)[0m p[1m)[0m[1m)[0m;   [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m         @@ [1;36m-794[0m,[1;36m17[0m +[1;36m798[0m,[1;36m21[0m @@                                                               [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m pkt->pay.buf;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m pkt->pay.buf;               [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         +    pkt->icmp = [1m([0mstruct icmp *[1m)[0m pkt->pay.buf;                                      [2m                [0m
[2;36m                    [0m         +    uint8_t *end = [1m([0muint8_t *[1m)[0m &pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m;                        [2m                [0m
[2;36m                    [0m         +    if [1m([0mend [1m<[0m[39m [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m+    uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m830[0m[39m,[0m[1;36m14[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m+    uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t ip_hdr_len = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hdr_len + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m899[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hdr_len = [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hdr_len < [0m[1;36m20[0m[1;39m)[0m[39m return;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len > pkt.raw.len[0m[1;39m)[0m[39m return;[0m                       [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m540144169[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad61708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55735ad62aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad62aa8[0m[39m,[0m[1;36m0x55735ad76448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55735ace7c02[0m[39m bp [0m[1;36m0x7fff2404de00[0m[39m sp [0m[1;36m0x7fff2404ddf8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ace7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735accfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ace48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55735ab337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ac5c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735ace479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp3jt_xj04[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue involves a heap-buffer-overflow vulnerability detected by [0m        [2m                [0m
[2;36m                    [0m         [39mAddressSanitizer in the `rx_icmp` function at line [0m[1;36m385[0m[39m of [0m                          [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m`. The error occurs when attempting a [0m[1;36m1[0m[39m-byte read [0m  [2m                [0m
[2;36m                    [0m         [39mfrom address `[0m[1;36m0x504000000172[0m[39m`, which is located [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte allocated [0m  [2m                [0m
[2;36m                    [0m         [39mregion. A patch was applied that attempted to fix the issue by adding boundary [0m     [2m                [0m
[2;36m                    [0m         [39mchecks in the `mkpay` function and modifying how protocol headers are accessed in [0m  [2m                [0m
[2;36m                    [0m         [39mthe `rx_ip` function, as well as adding validation for IP header length. However, [0m  [2m                [0m
[2;36m                    [0m         [39mafter applying the patch, the exact same heap-buffer-overflow error persists at the[0m [2m                [0m
[2;36m                    [0m         [39msame location with identical characteristics.[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe AddressSanitizer reports a heap-buffer-overflow with the following [0m             [2m                [0m
[2;36m                    [0m         [39mcharacteristics:[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- **Error Type**: READ of size [0m[1;36m1[0m[39m at address `[0m[1;36m0x504000000172[0m[39m`[0m                        [2m                [0m
[2;36m                    [0m         [39m- **Location**: `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m` in the `rx_icmp` function[0m  [2m                [0m
[2;36m                    [0m         [39m- **SCARINESS Score**: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [39m- **Call Stack**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m1[0m[39m. `[0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m` at net_builtin.[0m[1;92mc:385[0m                             [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m2[0m[39m. `mg_tcpip_rx` at net_builtin.[0m[1;92mc:897[0m                                             [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m3[0m[39m. `LLVMFuzzerTestOneInput` at fuzz.[0m[1;92mc:106[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe memory allocation shows a [0m[1;36m34[0m[39m-byte region `[0m[1;39m[[0m[1;36m0x504000000150[0m[39m, [0m[1;36m0x504000000172[0m[1;39m)[0m[39m` was[0m [2m                [0m
[2;36m                    [0m         [39mallocated in the fuzzer test harness [0m[1;39m([0m[39m`fuzz.[0m[1;92mc:95[0m[39m`[0m[1;39m)[0m[39m, and the overflow occurs exactly[0m [2m                [0m
[2;36m                    [0m         [39mat the boundary [0m[1;39m([0m[1;36m0[0m[39m bytes after the allocated region[0m[1;39m)[0m[39m. The shadow bytes indicate the[0m [2m                [0m
[2;36m                    [0m         [39mmemory at the overflow location is marked as partially addressable [0m[1;39m([0m[39m`[0m[1;36m02[0m[39m`[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39msuggesting the buffer boundary is being exceeded.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch made several modifications to `src/net_builtin.c`:[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Added boundary check in `mkpay` function** [0m[1;39m([0m[39mlines [0m[1;36m150[0m[39m-[0m[1;36m153[0m[1;39m)[0m[39m:[0m                    [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mp > &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [39m     pkt->pay = [0m[1;35mmg_str_n[0m[1;39m([0m[39mNULL, [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m     return;[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   This check attempts to prevent `mkpay` from creating a payload pointer that [0m     [2m                [0m
[2;36m                    [0m         [39mexceeds the raw buffer bounds.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Changed protocol header pointer assignment in `rx_ip` function** [0m[1;39m([0m[39mlines [0m       [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m-[0m[1;36m829[0m[1;39m)[0m[39m:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Changed from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to `pkt->pay.buf` for accessing UDP, TCP, and [0m    [2m                [0m
[2;36m                    [0m         [39mICMP headers[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - Modified lines for:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     - UDP header access [0m[1;39m([0m[39mline [0m[1;36m801[0m[39m and [0m[1;36m811[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m     - TCP header access [0m[1;39m([0m[39mline [0m[1;36m799[0m[39m and [0m[1;36m829[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [39m     - ICMP header access [0m[1;39m([0m[39mline [0m[1;36m806[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Modified TCP offset calculation** [0m[1;39m([0m[39mlines [0m[1;36m832[0m[39m-[0m[1;36m833[0m[1;39m)[0m[39m:[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Introduced `ip_hdr_len` variable calculated as `[0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m`[0m      [2m                [0m
[2;36m                    [0m         [39m   - Changed offset calculation to use `ip_hdr_len` instead of `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m`[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Added IP header validation in `mg_tcpip_rx` function** [0m[1;39m([0m[39mlines [0m[1;36m896[0m[39m-[0m[1;36m899[0m[1;39m)[0m[39m:[0m        [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   size_t ip_hdr_len = [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mip_hdr_len < [0m[1;36m20[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IHL must be at least [0m[1;36m5[0m[39m [0m[1;39m([0m[1;36m20[0m[39m bytes[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m IP header exceeds [0m  [2m                [0m
[2;36m                    [0m         [39mbuffer[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   This validates the IP header length before processing.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Result[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying the patch, the exact same error occurs:[0m                              [2m                [0m
[2;36m                    [0m         [39m- Same error location: `rx_icmp` at line [0m[1;36m385[0m                                        [2m                [0m
[2;36m                    [0m         [39m- Same memory address: `[0m[1;36m0x504000000172[0m[39m`[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Same [0m[1;36m34[0m[39m-byte allocated region[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Identical call stack[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Same SCARINESS score of [0m[1;36m12[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe shadow bytes pattern remains identical, indicating the patch did not address [0m   [2m                [0m
[2;36m                    [0m         [39mthe root cause of the buffer overflow in the `rx_icmp` function.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `rx_icmp` function at line [0m[1;36m385[0m[39m**: This is where the actual overflow [0m       [2m                [0m
[2;36m                    [0m         [39moccurs. The code at this specific line needs examination to understand what [0m[1;36m1[0m[39m-byte [0m [2m                [0m
[2;36m                    [0m         [39mread operation is being performed and why it exceeds the buffer.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **ICMP packet structure handling**: The relationship between how ICMP packets [0m   [2m                [0m
[2;36m                    [0m         [39mare parsed, how `pkt->icmp` is set, and how subsequent accesses to ICMP data are [0m   [2m                [0m
[2;36m                    [0m         [39mperformed in `rx_icmp`.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **The `mkpay` function logic**: While a boundary check was added, it may not be [0m [2m                [0m
[2;36m                    [0m         [39msufficient or may not cover all cases. The calculation `&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m [2m                [0m
[2;36m                    [0m         [39m- [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p` needs verification for correctness when dealing with protocol headers[0m [2m                [0m
[2;36m                    [0m         [39mof varying sizes.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Packet payload calculation chain**: The sequence of operations from initial [0m   [2m                [0m
[2;36m                    [0m         [39mpacket reception through `mg_tcpip_rx`, to `rx_ip`, and finally to `rx_icmp`, [0m      [2m                [0m
[2;36m                    [0m         [39mtracking how `pkt->pay` is set and modified at each stage.[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **ICMP-specific processing**: The `rx_icmp` function's internal logic, [0m          [2m                [0m
[2;36m                    [0m         [39mparticularly any operations that read beyond the ICMP header [0m[1;39m([0m[39mindicated by [0m         [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp + [0m[1;36m1[0m[39m` in the original code at line [0m[1;36m807[0m[1;39m)[0m[39m.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Input data characteristics**: The test case that triggers this overflow is [0m[1;36m34[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mbytes, which appears to be a carefully crafted minimal input that exposes the [0m      [2m                [0m
[2;36m                    [0m         [39mboundary condition issue.[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m175604417[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a29708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55a257a2aaa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55a257a2aaa8[0m[39m,[0m[1;36m0x55a257a3e448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55a2579afc02[0m[39m bp [0m[1;36m0x7fffc2b27ba0[0m[39m sp [0m[1;36m0x7fffc2b27b98[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a2579afc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a257997d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a2579ac8b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55a2577fb7ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55a25792411f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55a2579ac79d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55a257818350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55a2578035c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55a25780905f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55a257834302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7fc8b4a77082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmph3om5yul[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m143[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:392[0m[39m-[0m[1;36m392[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:513[0m[39m-[0m[1;36m513[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&c->recv.buf[0m[1;39m[[0m[39mc->recv.len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:712[0m[39m-[0m[1;36m712[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39m&io->buf[0m[1;39m[[0m[39mio->len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:323[0m[39m-[0m[1;36m336[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:static struct mg_connection *[0m[1;35mgetpeer[0m[1;39m([0m[39mstruct mg_mgr *mgr, struct pkt *pkt,[0m       [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:                                     bool lsn[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:  struct mg_connection *c = NULL;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:  for [0m[1;39m([0m[39mc = mgr->conns; c != NULL; c = c->next[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:    if [0m[1;39m([0m[39mc->is_arplooking && pkt->arp &&[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:        [0m[1;35mmemcmp[0m[1;39m([0m[39m&pkt->arp->spa, c->rem.ip, [0m[1;35msizeof[0m[1;39m([0m[39mpkt->arp->spa[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:      break;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:    if [0m[1;39m([0m[39mc->is_udp && pkt->udp && c->loc.port == pkt->udp->dport[0m[1;39m)[0m[39m break;[0m         [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:    if [0m[1;39m([0m[39m!c->is_udp && pkt->tcp && c->loc.port == pkt->tcp->dport &&[0m             [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:        lsn == c->is_listening && [0m[1;39m([0m[39mlsn || c->rem.port == pkt->tcp->sport[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:      break;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:  return c;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:854[0m[39m-[0m[1;36m900[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:void [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, void *buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:  struct pkt pkt;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39m&pkt, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39mpkt[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:  pkt.raw.buf = [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m buf;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:  pkt.raw.len = len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:  pkt.eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m buf;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len > [0m[1;36m16[0m[39m ? [0m[1;36m16[0m[39m: len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:  if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated - runt?[0m             [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:  if [0m[1;39m([0m[39mifp->enable_mac_check &&[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[39m &&[0m              [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:      [0m[1;35mmemcmp[0m[1;39m([0m[39mpkt.eth->dst, broadcast, [0m[1;35msizeof[0m[1;39m([0m[39mpkt.eth->dst[0m[1;39m)[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:    return;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:  if [0m[1;39m([0m[39mifp->enable_crc32_check && len > [0m[1;36m4[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:    len -= [0m[1;36m4[0m[39m;  [0m[35m/[0m[35m/[0m[39m [0m[1;35mTODO[0m[1;39m([0m[39mscaprile[0m[1;39m)[0m[39m: check on bigendian[0m                            [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:    uint32_t crc = [0m[1;35mmg_crc32[0m[1;39m([0m[1;36m0[0m[39m, [0m[1;39m([0m[39mconst char *[0m[1;39m)[0m[39m buf, len[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    if [0m[1;39m([0m[1;35mmemcmp[0m[1;39m([0m[1;39m([0m[39mvoid *[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m buf + len[0m[1;39m)[0m[39m, &crc, [0m[1;35msizeof[0m[1;39m([0m[39mcrc[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m return;[0m       [2m                [0m
[2;36m                    [0m         [1;36m870[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m871[0m[39m:  if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x806[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m872[0m[39m:    pkt.arp = [0m[1;39m([0m[39mstruct arp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m873[0m[39m:    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.arp[0m[1;39m)[0m[39m > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m874[0m[39m:    [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mifp, MG_TCPIP_EV_ARP, &pkt.raw[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m875[0m[39m:    [0m[1;35mrx_arp[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m876[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x86dd[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m877[0m[39m:    pkt.ip6 = [0m[1;39m([0m[39mstruct ip6 *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m878[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip6[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mTruncated[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m879[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip6->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m0x6[0m[1;39m)[0m[39m return;                         [0m[35m/[0m[35m/[0m[39m Not IP[0m   [2m                [0m
[2;36m                    [0m         [1;36m880[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m881[0m[39m:    [0m[1;35mrx_ip6[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m897[0m[39m:  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m898[0m[39m:    [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"Unknown eth type %x"[0m[39m, [0m[1;35mmg_htons[0m[1;39m([0m[39mpkt.eth->type[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m899[0m[39m:    if [0m[1;39m([0m[39mmg_log_level >= MG_LL_VERBOSE[0m[1;39m)[0m[39m [0m[1;35mmg_hexdump[0m[1;39m([0m[39mbuf, len >= [0m[1;36m32[0m[39m ? [0m[1;36m32[0m[39m : len[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m900[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m894[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m5[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m894[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:41[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:90[0m[39m-[0m[1;36m106[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:  uint16_t win;   [0m[35m/[0m[35m/[0m[39m Window[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:110[0m[39m-[0m[1;36m115[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m894[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m809[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m830[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Issue[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch failed because it did not address the root cause of the [0m         [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow. The crash occurs at line [0m[1;36m385[0m[39m in `rx_icmp` when accessing [0m     [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp->type`, and the analysis of code snippets reveals the systematic bug:[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mIn `rx_ip` function, all protocol header pointers [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m are set using [0m   [2m                [0m
[2;36m                    [0m         [39m`[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m`, which assumes the protocol header immediately follows the [0m[1;36m20[0m[39m-byte [0m [2m                [0m
[2;36m                    [0m         [39mfixed IP header structure. However, when the IP header contains options [0m[1;39m([0m[39mIHL > [0m[1;36m5[0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mthe actual protocol headers are located further in the packet. The correct location[0m [2m                [0m
[2;36m                    [0m         [39mwas already calculated in `mg_tcpip_rx` and stored in `pkt->pay.buf`, but `rx_ip` [0m  [2m                [0m
[2;36m                    [0m         [39mignores this and recalculates incorrectly.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Previous Patch Failed:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39mThe previous patch correctly modified `mg_tcpip_rx` to handle IP options and added [0m [2m                [0m
[2;36m                    [0m         [39mvalidation there. However, it failed to fix the fundamental issue in `rx_ip` where [0m [2m                [0m
[2;36m                    [0m         [39mprotocol header pointers are still being set from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` instead of using [0m [2m                [0m
[2;36m                    [0m         [39mthe correctly positioned `pkt->pay.buf`.[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Fix Protocol Header Pointer Assignment in `rx_ip`[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `src/net_builtin.c`, function `rx_ip` [0m[1;39m([0m[39mlines [0m[1;36m794[0m[39m-[0m[1;36m836[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace all instances where protocol headers are set from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` with [0m     [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.buf`:[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Line [0m[1;36m797[0m[39m [0m[1;39m([0m[39mFragmentation - UDP[0m[1;39m)[0m[39m:** Change `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[1;39m)[0m[39m;` to `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                   [2m                [0m
[2;36m                    [0m         [39m- **Line [0m[1;36m798[0m[39m [0m[1;39m([0m[39mFragmentation - TCP[0m[1;39m)[0m[39m:** Change `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[1;39m)[0m[39m;` to `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                   [2m                [0m
[2;36m                    [0m         [39m- **Line [0m[1;36m802[0m[39m [0m[1;39m([0m[39mICMP[0m[1;39m)[0m[39m:** Change `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to [0m      [2m                [0m
[2;36m                    [0m         [39m`pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                         [2m                [0m
[2;36m                    [0m         [39m- **Line [0m[1;36m807[0m[39m [0m[1;39m([0m[39mUDP[0m[1;39m)[0m[39m:** Change `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to [0m         [2m                [0m
[2;36m                    [0m         [39m`pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                           [2m                [0m
[2;36m                    [0m         [39m- **Line [0m[1;36m825[0m[39m [0m[1;39m([0m[39mTCP[0m[1;39m)[0m[39m:** Change `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to [0m         [2m                [0m
[2;36m                    [0m         [39m`pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification:** The `pkt->pay.buf` pointer was correctly calculated in [0m          [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx` to account for IP header options. Using this pointer ensures protocol[0m [2m                [0m
[2;36m                    [0m         [39mheaders are accessed at their actual locations.[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Add Boundary Validation Before Accessing Protocol Headers[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `src/net_builtin.c`, function `rx_ip`[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFollowing the pattern used in DHCP handlers [0m[1;39m([0m[39mlines [0m[1;36m402[0m[39m-[0m[1;36m404[0m[39m, [0m[1;36m460[0m[39m-[0m[1;36m462[0m[1;39m)[0m[39m, add boundary [0m [2m                [0m
[2;36m                    [0m         [39mchecks immediately after setting each protocol header pointer and BEFORE calling [0m   [2m                [0m
[2;36m                    [0m         [39m`mkpay`:[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->protocol_header + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For ICMP [0m[1;39m([0m[39mafter line [0m[1;36m802[0m[1;39m)[0m[39m:**[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- Add: `uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;`[0m                    [2m                [0m
[2;36m                    [0m         [39m- Add: `if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                             [2m                [0m
[2;36m                    [0m         [39m- Keep existing: `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For UDP [0m[1;39m([0m[39mafter line [0m[1;36m807[0m[1;39m)[0m[39m:**[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Add: `uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;`[0m                    [2m                [0m
[2;36m                    [0m         [39m- Add: `if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                              [2m                [0m
[2;36m                    [0m         [39m- Keep existing: `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**For TCP [0m[1;39m([0m[39mafter line [0m[1;36m825[0m[1;39m)[0m[39m:**[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Add: `uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;`[0m                    [2m                [0m
[2;36m                    [0m         [39m- Add: `if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                              [2m                [0m
[2;36m                    [0m         [39m- Keep existing: `if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification:** This validates that the entire protocol header structure is [0m     [2m                [0m
[2;36m                    [0m         [39mwithin the buffer before any field access, preventing out-of-bounds reads.[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Fix TCP Payload Length Calculation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `src/net_builtin.c`, line [0m[1;36m829[0m[39m in `rx_ip`[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe TCP payload length calculation incorrectly uses `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` [0m[1;39m([0m[39malways [0m[1;36m20[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39minstead of the actual IP header length:[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current [0m[1;39m([0m[39mline [0m[1;36m829[0m[1;39m)[0m[39m:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Replace with:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t ip_hdr_len = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39muint16_t tcp_hdr_len = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39muint16_t off = ip_hdr_len + tcp_hdr_len;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification:** When IP headers have options, using the fixed [0m[1;36m20[0m[39m-byte size [0m      [2m                [0m
[2;36m                    [0m         [39mcauses incorrect payload length calculation. Extracting the actual IP header length[0m [2m                [0m
[2;36m                    [0m         [39mfrom the IHL field ensures accurate calculation.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Remove or Update Previous Patch Modifications[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `src/net_builtin.c`, lines [0m[1;36m150[0m[39m-[0m[1;36m153[0m[39m and [0m[1;36m896[0m[39m-[0m[1;36m899[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch added modifications that should be reviewed:[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Lines [0m[1;36m150[0m[39m-[0m[1;36m153[0m[39m [0m[1;39m([0m[39mmkpay boundary check[0m[1;39m)[0m[39m:** Keep this check as it provides [0m         [2m                [0m
[2;36m                    [0m         [39mdefense-in-depth, but note that with proper protocol header validation, this should[0m [2m                [0m
[2;36m                    [0m         [39mnever trigger.[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m  [0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m- **Lines [0m[1;36m896[0m[39m-[0m[1;36m899[0m[39m [0m[1;39m([0m[39mIP header validation in mg_tcpip_rx[0m[1;39m)[0m[39m:** Keep these validations [0m  [2m                [0m
[2;36m                    [0m         [39mas they are correct and provide necessary checks before calling `rx_ip`.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Do NOT revert** the changes to lines [0m[1;36m799[0m[39m, [0m[1;36m801[0m[39m, [0m[1;36m806[0m[39m, [0m[1;36m811[0m[39m, [0m[1;36m829[0m[39m, [0m[1;36m832[0m[39m-[0m[1;36m833[0m[39m, and [0m       [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m-[0m[1;36m899[0m[39m from the previous patch, as they attempted to use `pkt->pay.buf` in some [0m   [2m                [0m
[2;36m                    [0m         [39mplaces. Instead, ensure consistency by applying the fix strategy above to ALL [0m      [2m                [0m
[2;36m                    [0m         [39mprotocol header assignments.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Preserve Existing Functionality[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Critical points to maintain:**[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- The `mkpay` function logic remains unchanged in its core calculation[0m              [2m                [0m
[2;36m                    [0m         [39m- All protocol-specific handlers [0m[1;39m([0m[39m`rx_icmp`, `rx_tcp`, `rx_udp`, etc.[0m[1;39m)[0m[39m remain [0m      [2m                [0m
[2;36m                    [0m         [39munchanged[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- The sequence of operations [0m[1;39m([0m[39mset header pointer → validate → update payload → call[0m [2m                [0m
[2;36m                    [0m         [39mhandler[0m[1;39m)[0m[39m is preserved[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- IPv6 handling in `rx_ip6` is NOT modified [0m[1;39m([0m[39mdifferent header structure[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m- DHCP handling chains [0m[1;39m([0m[39mUDP → DHCP[0m[1;39m)[0m[39m remain intact[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Implementation Steps[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **First:** In `rx_ip`, replace all `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` assignments with [0m             [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.buf` for ICMP, UDP, and TCP protocol headers [0m[1;39m([0m[1;36m5[0m[39m locations: lines [0m[1;36m797[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m, [0m[1;36m802[0m[39m, [0m[1;36m807[0m[39m, [0m[1;36m825[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Second:** After each protocol header assignment, add boundary validation using[0m [2m                [0m
[2;36m                    [0m         [39mthe DHCP pattern [0m[1;39m([0m[1;36m3[0m[39m locations after ICMP, UDP, TCP non-fragmented paths[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Third:** Fix the TCP payload length calculation to use actual IP header length[0m [2m                [0m
[2;36m                    [0m         [39minstead of `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m829[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fourth:** Verify that the previous patch's IP header validation in [0m            [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx` [0m[1;39m([0m[39mlines [0m[1;36m896[0m[39m-[0m[1;36m899[0m[1;39m)[0m[39m is retained[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Why This Fix is Optimal[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses Root Cause:** Directly fixes the incorrect pointer arithmetic that [0m  [2m                [0m
[2;36m                    [0m         [39mcauses the heap-buffer-overflow[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Changes:** Only modifies the specific lines causing the issue without [0m [2m                [0m
[2;36m                    [0m         [39mrestructuring the codebase[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Consistent Pattern:** Uses the same boundary checking pattern already [0m         [2m                [0m
[2;36m                    [0m         [39mestablished in DHCP handlers[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves Logic:** Maintains the existing packet processing flow and doesn't [0m  [2m                [0m
[2;36m                    [0m         [39mbreak protocol handlers[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Defense in Depth:** Combines correct pointer positioning with explicit [0m        [2m                [0m
[2;36m                    [0m         [39mboundary validation[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Comprehensive:** Fixes the issue for all protocols [0m[1;39m([0m[39mICMP, UDP, TCP[0m[1;39m)[0m[39m and all [0m   [2m                [0m
[2;36m                    [0m         [39mcode paths [0m[1;39m([0m[39mnormal and fragmented[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Potential Side Effects and Mitigation[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m1[0m[39m:** TCP with IP options might now be processed correctly where it [0m   [2m                [0m
[2;36m                    [0m         [39mpreviously failed[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** This is the intended behavior; existing tests should validate TCP[0m [2m                [0m
[2;36m                    [0m         [39mfunctionality[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m2[0m[39m:** Additional boundary checks might reject more malformed packets[0m   [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** This is a security improvement; fuzzing should verify no [0m         [2m                [0m
[2;36m                    [0m         [39mlegitimate packets are rejected[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m3[0m[39m:** Performance impact from additional boundary checks[0m               [2m                [0m
[2;36m                    [0m         [39m- **Mitigation:** Negligible - checks are simple pointer comparisons performed once[0m [2m                [0m
[2;36m                    [0m         [39mper packet[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relationship to Similar Solutions[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe DHCP handlers [0m[1;39m([0m[39mlines [0m[1;36m398[0m[39m-[0m[1;36m404[0m[39m, [0m[1;36m459[0m[39m-[0m[1;36m462[0m[1;39m)[0m[39m already implement the correct boundary [0m  [2m                [0m
[2;36m                    [0m         [39mchecking pattern. This fix extends that proven pattern to all protocol handlers in [0m [2m                [0m
[2;36m                    [0m         [39m`rx_ip`, ensuring consistent and safe buffer access throughout the codebase.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 04:07:42][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=698887;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=354113;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 04:14:05][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=930905;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=634871;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 04:15:27][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=201538;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=99262;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m5[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=539288;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=671763;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:15:28][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.94[0m seconds;              ]8;id=45695;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=34878;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 04:15:29][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Started[33m...[0m                            ]8;id=504975;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=726919;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpwu2095u3[0m                                                 ]8;id=759979;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=916047;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 04:15:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Patching[1m)[0m Took [1;36m6.99[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=452673;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=752564;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Started[33m...[0m                      ]8;id=932013;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=107119;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:15:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Checking build[1m)[0m Took [1;36m4.33[0m seconds;             ]8;id=856996;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=429305;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Started[33m...[0m                         ]8;id=515290;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=322174;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:15:42][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=16415;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=389710;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1051524705[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x5614b15d5708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x5614b15d6aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x5614b15d6aa8[0m[39m,[0m[1;36m0x5614b15ea448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x5614b155bc02[0m[39m bp [0m[1;36m0x7ffd245ffd40[0m[39m sp [0m[1;36m0x7ffd245ffd38[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5614b155bc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5614b1543d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5614b15588b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5614b13c4350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5614b13af5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5614b13b505f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5614b13e0302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7ff1dab6c082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5614b13a77ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5614b14d011f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5614b155879d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5614b13c4350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5614b13af5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5614b13b505f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5614b13e0302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7ff1dab6c082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi0ri5qwh[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=659639;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=837083;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1051524705[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x5614b15d5708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x5614b15d6aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x5614b15d6aa8[0m[39m,[0m[1;36m0x5614b15ea448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x5614b155bc02[0m[39m bp [0m[1;36m0x7ffd245ffd40[0m[39m sp [0m[1;36m0x7ffd245ffd38[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5614b155bc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5614b1543d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5614b15588b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5614b13c4350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5614b13af5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5614b13b505f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5614b13e0302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7ff1dab6c082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5614b13a77ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5614b14d011f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5614b155879d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5614b13c4350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5614b13af5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5614b13b505f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5614b13e0302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7ff1dab6c082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi0ri5qwh[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m                                                                        [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                                [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                            [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1051524705[0m                                                               [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x5614b15d5708[0m[39m, [0m        [2m               [0m
[2;36m                    [0m         [1;36m0x5614b15d6aa2[0m[1;39m)[0m[39m, [0m                                                                    [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x5614b15d6aa8[0m[39m,[0m[1;36m0x5614b15ea448[0m[1;39m)[0m[39m, [0m          [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                        [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x5614b155bc02[0m[39m bp [0m[1;36m0x7ffd245ffd40[0m[39m sp [0m[1;36m0x7ffd245ffd38[0m                                   [2m               [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                           [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                     [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5614b155bc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                                [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                               [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5614b1543d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m           [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5614b15588b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5614b13c4350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5614b13af5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5614b13b505f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5614b13e0302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7ff1dab6c082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5614b13a77ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m        [2m               [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5614b14d011f[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5614b155879d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5614b13c4350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5614b13af5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5614b13b505f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5614b13e0302[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7ff1dab6c082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m                [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x504000000100[0m: fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m02[0m fa fa fa [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m02[0m[1m][0mfa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x504000000380[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m:[35m/[0m[95mout[0m -v       [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi0ri5qwh[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce fuzz [2m               [0m
[2;36m                    [0m         -[33mruns[0m=[1;36m100[0m.                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Running PoV[1m)[0m Took [1;36m2.30[0m seconds;                ]8;id=419190;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=841239;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=495140;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=564421;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:15:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.85[0m seconds;              ]8;id=273793;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=823083;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Started[33m...[0m                       ]8;id=227295;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=893012;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 04:15:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mmongoose Setting owner[1m)[0m Took [1;36m0.93[0m seconds;              ]8;id=115668;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=880946;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=985263;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=184186;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         +++ b/src/net_builtin.c                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-147[0m,[1;36m8[0m +[1;36m147[0m,[1;36m12[0m @@                                                                [2m                [0m
[2;36m                    [0m          static void [1;35msend_syn[0m[1m([0mstruct mg_connection *c[1m)[0m;                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static void [1;35mmkpay[0m[1m([0mstruct pkt *pkt, void *p[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         -  pkt->pay =                                                                       [2m                [0m
[2;36m                    [0m         -      [1;35mmg_str_n[0m[1m([0m[1m([0mchar *[1m)[0m p, [1m([0msize_t[1m)[0m [1m([0m&pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m - [1m([0mchar *[1m)[0m p[1m)[0m[1m)[0m;   [2m                [0m
[2;36m                    [0m         +  char *end = &pkt->raw.buf[1m[[0mpkt->raw.len[1m][0m;                                         [2m                [0m
[2;36m                    [0m         +  if [1m([0m[1m([0mchar *[1m)[0mp >= end[1m)[0m [1m{[0m                                                          [2m                [0m
[2;36m                    [0m         +    pkt->pay = [1;35mmg_str_n[0m[1m([0mend, [1;36m0[0m[1m)[0m;                                                   [2m                [0m
[2;36m                    [0m         +  [1m}[0m else [1m{[0m                                                                         [2m                [0m
[2;36m                    [0m         +    pkt->pay = [1;35mmg_str_n[0m[1m([0m[1m([0mchar *[1m)[0m p, [1m([0msize_t[1m)[0m [1m([0mend - [1m([0mchar *[1m)[0m p[1m)[0m[1m)[0m;                  [2m                [0m
[2;36m                    [0m         +  [1m}[0m                                                                                [2m                [0m
[2;36m                    [0m          [1m}[0m                                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          static uint32_t [1;35mcsumup[0m[1m([0muint32_t sum, const void *buf, size_t len[1m)[0m [1m{[0m                [2m                [0m
[2;36m                    [0m         @@ [1;36m-794[0m,[1;36m18[0m +[1;36m798[0m,[1;36m18[0m @@                                                               [2m                [0m
[2;36m                    [0m          static void [1;35mrx_ip[0m[1m([0mstruct mg_tcpip_if *ifp, struct pkt *pkt[1m)[0m [1m{[0m                      [2m                [0m
[2;36m                    [0m            uint16_t frag = [1;35mmg_ntohs[0m[1m([0mpkt->ip->frag[1m)[0m;                                         [2m                [0m
[2;36m                    [0m            if [1m([0mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[1m)[0m [1m{[0m                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;             [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m17[0m[1m)[0m pkt->udp = [1m([0mstruct udp *[1m)[0m pkt->pay.buf;              [2m                [0m
[2;36m                    [0m         +    if [1m([0mpkt->ip->proto == [1;36m6[0m[1m)[0m pkt->tcp = [1m([0mstruct tcp *[1m)[0m pkt->pay.buf;               [2m                [0m
[2;36m                    [0m              struct mg_connection *c = [1;35mgetpeer[0m[1m([0mifp->mgr, pkt, false[1m)[0m;                       [2m                [0m
[2;36m                    [0m              if [1m([0mc[1m)[0m [1;35mmg_error[0m[1m([0mc, [32m"Received fragmented packet"[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m            [1m}[0m else if [1m([0mpkt->ip->proto == [1;36m1[0m[1m)[0m [1m{[0m                                                [2m                [0m
[2;36m                    [0m         -    pkt->icmp = [1m([0mstruct icmp *[1m)[0m [1m([0mpkt->ip + [1;36m1[0m[1m)[0m;                                     [2m                [0m
[2;36m                    [0m         -    if [1m([0mpkt->pay.len [1m<[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [39m-    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-822[0m[39m,[0m[1;36m11[0m[39m +[0m[1;36m826[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39mstruct tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                        [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m-    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m+    uint16_t ip_hdr_len = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m+    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hdr_len + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m        [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-888[0m[39m,[0m[1;36m10[0m[39m +[0m[1;36m893[0m[39m,[0m[1;36m10[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m    [2m                [0m
[2;36m                    [0m         [39m     if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m       [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle IPv4 [0m [2m                [0m
[2;36m                    [0m         [39moptions[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m-    else[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    size_t ip_hdr_len = [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39mip_hdr_len < [0m[1;36m20[0m[1;39m)[0m[39m return;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len > pkt.raw.len[0m[1;39m)[0m[39m return;[0m                       [2m                [0m
[2;36m                    [0m         [39m+    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m1051524705[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x5614b15d5708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x5614b15d6aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x5614b15d6aa8[0m[39m,[0m[1;36m0x5614b15ea448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x5614b155bc02[0m[39m bp [0m[1;36m0x7ffd245ffd40[0m[39m sp [0m[1;36m0x7ffd245ffd38[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5614b155bc01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5614b1543d1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5614b15588b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5614b13c4350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5614b13af5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5614b13b505f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x5614b13e0302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7ff1dab6c082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x5614b13a77ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x5614b14d011f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x5614b155879d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x5614b13c4350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x5614b13af5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x5614b13b505f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x5614b13e0302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7ff1dab6c082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpi0ri5qwh[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mThe initial issue is a heap-buffer-overflow detected by AddressSanitizer during [0m    [2m                [0m
[2;36m                    [0m         [39mfuzzing of the mongoose networking library. The error occurs in the `rx_icmp` [0m      [2m                [0m
[2;36m                    [0m         [39mfunction at line [0m[1;36m385[0m[39m of `src/net_builtin.c`, where a [0m[1;36m1[0m[39m-byte read operation accesses[0m [2m                [0m
[2;36m                    [0m         [39mmemory [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte allocated heap region. A patch was attempted that [0m   [2m                [0m
[2;36m                    [0m         [39madded multiple boundary checks and modified how protocol headers are accessed in [0m   [2m                [0m
[2;36m                    [0m         [39mthe IP packet processing code. However, after applying the patch, the identical [0m    [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow error persists at the same location with the same [0m             [2m                [0m
[2;36m                    [0m         [39mcharacteristics.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m         [39mThe AddressSanitizer report reveals a heap-buffer-overflow occurring during packet [0m [2m                [0m
[2;36m                    [0m         [39mprocessing:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m- **Location**: `rx_icmp` function in `[0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m`[0m      [2m                [0m
[2;36m                    [0m         [39m- **Error Type**: READ of size [0m[1;36m1[0m[39m at address `[0m[1;36m0x504000000172[0m[39m`[0m                        [2m                [0m
[2;36m                    [0m         [39m- **Memory Layout**: The accessed address is located [0m[1;36m0[0m[39m bytes after a [0m[1;36m34[0m[39m-byte [0m       [2m                [0m
[2;36m                    [0m         [39mallocated region [0m[1;39m([0m[39m`[0m[1;36m0x504000000150[0m[39m` to `[0m[1;36m0x504000000172[0m[39m`[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m- **Call Stack**: The error originates from `LLVMFuzzerTestOneInput` → [0m             [2m                [0m
[2;36m                    [0m         [39m`mg_tcpip_rx` → `rx_icmp`[0m                                                           [2m                [0m
[2;36m                    [0m         [39m- **Allocation**: The problematic memory was allocated in the fuzzer test harness [0m  [2m                [0m
[2;36m                    [0m         [39mat `test/fuzz.[0m[1;92mc:95:17[0m[39m`[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe shadow bytes indicate that the memory access occurs at the boundary of a valid [0m [2m                [0m
[2;36m                    [0m         [39mheap region [0m[1;39m([0m[39mmarked as `[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39m`[0m[1;39m)[0m[39m, suggesting an off-by-one or boundary condition [0m     [2m                [0m
[2;36m                    [0m         [39merror in buffer access validation.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m         [39mThe patch attempted to address the issue through multiple modifications to [0m         [2m                [0m
[2;36m                    [0m         [39m`src/net_builtin.c`:[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Modified `mkpay` function** [0m[1;39m([0m[39mlines [0m[1;36m149[0m[39m-[0m[1;36m153[0m[1;39m)[0m[39m:[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Added a boundary check before setting the payload: `if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mp > [0m           [2m                [0m
[2;36m                    [0m         [39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[1;39m)[0m[39m`[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - Returns early with a null/zero-length payload if the check fails[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Modified protocol header assignments in `rx_ip` function**:[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Changed from pointer arithmetic based on `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to using [0m             [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.buf`[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - For ICMP [0m[1;39m([0m[39mline [0m[1;36m806[0m[1;39m)[0m[39m: `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m pkt->pay.buf`[0m                [2m                [0m
[2;36m                    [0m         [39m   - For UDP [0m[1;39m([0m[39mlines [0m[1;36m813[0m[39m, [0m[1;36m801[0m[1;39m)[0m[39m: `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf`[0m             [2m                [0m
[2;36m                    [0m         [39m   - For TCP [0m[1;39m([0m[39mline [0m[1;36m833[0m[1;39m)[0m[39m: `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf`[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Added boundary checks** before processing each protocol:[0m                       [2m                [0m
[2;36m                    [0m         [39m   - ICMP [0m[1;39m([0m[39mline [0m[1;36m807[0m[1;39m)[0m[39m: `if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m              [2m                [0m
[2;36m                    [0m         [39m   - UDP [0m[1;39m([0m[39mline [0m[1;36m814[0m[1;39m)[0m[39m: `if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                [2m                [0m
[2;36m                    [0m         [39m   - TCP [0m[1;39m([0m[39mline [0m[1;36m835[0m[1;39m)[0m[39m: `if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;`[0m                [2m                [0m
[2;36m                    [0m         [39m   - Where `end` is calculated as: `uint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m                     [2m                [0m
[2;36m                    [0m         [39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;`[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Modified TCP header offset calculation** [0m[1;39m([0m[39mlines [0m[1;36m839[0m[39m-[0m[1;36m840[0m[1;39m)[0m[39m:[0m                      [2m                [0m
[2;36m                    [0m         [39m   - Changed from using hardcoded `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m` to dynamically calculated [0m     [2m                [0m
[2;36m                    [0m         [39m`ip_hdr_len`[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m   - Calculation: `uint16_t ip_hdr_len = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;`[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Modified IP header validation in `mg_tcpip_rx` function** [0m[1;39m([0m[39mlines [0m[1;36m902[0m[39m-[0m[1;36m904[0m[1;39m)[0m[39m:[0m     [2m                [0m
[2;36m                    [0m         [39m   - Added IP header length calculation and validation[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Added check: `if [0m[1;39m([0m[39mip_hdr_len < [0m[1;36m20[0m[1;39m)[0m[39m return;`[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - Added check: `if [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len > pkt.raw.len[0m[1;39m)[0m[39m return;`[0m        [2m                [0m
[2;36m                    [0m         [39m   - Changed payload calculation to use dynamic header length[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Post-Patch Results[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThe patch application resulted in the identical error:[0m                              [2m                [0m
[2;36m                    [0m         [39m- Same error location: `rx_icmp` at line [0m[1;36m385[0m                                        [2m                [0m
[2;36m                    [0m         [39m- Same memory address: `[0m[1;36m0x504000000172[0m[39m`[0m                                             [2m                [0m
[2;36m                    [0m         [39m- Same [0m[1;36m34[0m[39m-byte allocation region[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Same call stack and error characteristics[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Same SCARINESS score: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates that the patch did not successfully address the root cause of the [0m   [2m                [0m
[2;36m                    [0m         [39mbuffer overflow. The error still occurs within the `rx_icmp` function at line [0m[1;36m385[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39msuggesting that the boundary checks added earlier in the call chain are either not [0m [2m                [0m
[2;36m                    [0m         [39mbeing triggered or are insufficient to prevent the problematic memory access.[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **The `rx_icmp` function** [0m[1;39m([0m[39mparticularly around line [0m[1;36m385[0m[1;39m)[0m[39m: This is where the [0m    [2m                [0m
[2;36m                    [0m         [39mactual overflow occurs. The function's logic for accessing ICMP packet data needs [0m  [2m                [0m
[2;36m                    [0m         [39mdetailed examination to understand what memory access is causing the overflow.[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **The `mkpay` function**: While a check was added, the logic for calculating and[0m [2m                [0m
[2;36m                    [0m         [39msetting the payload boundaries may have additional edge cases not covered by the [0m   [2m                [0m
[2;36m                    [0m         [39mcurrent validation.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Payload calculation chain**: The relationship between `pkt->pay.buf`, [0m         [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.len`, and the actual protocol header structures needs to be verified. The[0m [2m                [0m
[2;36m                    [0m         [39mchange from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to `pkt->pay.buf` may have introduced or exposed issues[0m [2m                [0m
[2;36m                    [0m         [39mwith payload alignment or length calculations.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **ICMP packet structure parsing**: The specific code at line [0m[1;36m385[0m[39m that reads the [0m [2m                [0m
[2;36m                    [0m         [39mICMP data should be examined to understand what field or operation is accessing [0m    [2m                [0m
[2;36m                    [0m         [39mmemory beyond the allocated buffer.[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Fuzzer input characteristics**: The testcase that triggers this issue is [0m[1;36m34[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39mbytes, which is relatively small. Understanding the minimum valid packet size and [0m  [2m                [0m
[2;36m                    [0m         [39mhow edge cases in packet size are handled throughout the processing pipeline is [0m    [2m                [0m
[2;36m                    [0m         [39mcrucial.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **The interaction between IP header options and payload calculation**: The [0m      [2m                [0m
[2;36m                    [0m         [39mmodifications to handle variable IP header lengths may not be correctly updating [0m   [2m                [0m
[2;36m                    [0m         [39mall dependent calculations, particularly for the ICMP protocol path.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3191600574[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba361708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba362aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55eeba362aa8[0m[39m,[0m[1;36m0x55eeba376448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55eeba2e7c02[0m[39m bp [0m[1;36m0x7ffc6d9672e0[0m[39m sp [0m[1;36m0x7ffc6d9672d8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba2e7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2cfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba2e48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55eeba1337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55eeba25c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55eeba2e479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55eeba150350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55eeba13b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55eeba14105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55eeba16c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f1dd309f082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpiztdief0[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m [2m                [0m
[2;36m                    [0m         [35m/dev/[0m[95mnull[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m540144169[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m5018[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad61708[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [1;36m0x55735ad62aa2[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m5018[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m5018[0m[39m [0m[1;39m[[0m[1;36m0x55735ad62aa8[0m[39m,[0m[1;36m0x55735ad76448[0m[1;39m)[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x504000000172[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55735ace7c02[0m[39m bp [0m[1;36m0x7fff2404de00[0m[39m sp [0m[1;36m0x7fff2404ddf8[0m                                  [2m                [0m
[2;36m                    [0m         [39mREAD of size [0m[1;36m1[0m[39m at [0m[1;36m0x504000000172[0m[39m thread T0[0m                                          [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m12[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-read-heap-buffer-overflow[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ace7c01[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m [0m                               [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735accfd1a[0m[39m in mg_tcpip_rx [0m[35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m897:5[0m          [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ace48b7[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m106:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55735ab337ad[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz+0x617ad[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m[39m--mg_tcpip_rx--LLVMFuzzerTestOneInput[0m       [2m                [0m
[2;36m                    [0m         [1;36m0x504000000172[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m34[0m[39m-byte region [0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x504000000150[0m[39m,[0m[1;36m0x504000000172[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55735ac5c11f[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55735ace479d[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/mongoose/test/[0m[95mfuzz.c[0m[39m:[0m[1;92m95:17[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55735ab50350[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55735ab3b5c5[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55735ab4105f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55735ab6c302[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f335ec83082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/src/mongoose/src/[0m[95mnet_builtin.c[0m[39m:[0m[1;92m385:18[0m[39m in [0m[1;35mrx_icmp[0m[1;39m([0m[39mmg_tcpip_if*, pkt*[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x503fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m03[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000080[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x504000000100[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m02[0m[39m fa fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m02[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x504000000380[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m     [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp3jt_xj04[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:41[0m[39m-[0m[1;36m45[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:struct eth [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:  uint8_t dst[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Destination MAC address[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:  uint8_t src[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;  [0m[35m/[0m[35m/[0m[39m Source MAC address[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:  uint16_t type;   [0m[35m/[0m[35m/[0m[39m Ethernet type[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m143[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:806[0m[39m-[0m[1;36m823[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:392[0m[39m-[0m[1;36m392[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:513[0m[39m-[0m[1;36m513[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39m&c->recv.buf[0m[1;39m[[0m[39mc->recv.len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:712[0m[39m-[0m[1;36m712[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39m&io->buf[0m[1;39m[[0m[39mio->len[0m[1;39m][0m[39m, pkt->pay.buf, pkt->pay.len[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:398[0m[39m-[0m[1;36m404[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:static void [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:  uint32_t ip = [0m[1;36m0[0m[39m, gw = [0m[1;36m0[0m[39m, mask = [0m[1;36m0[0m[39m, lease = [0m[1;36m0[0m[39m, dns = [0m[1;36m0[0m[39m, sntp = [0m[1;36m0[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:  uint8_t msgtype = [0m[1;36m0[0m[39m, state = ifp->state;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:  [0m[35m/[0m[35m/[0m[39m perform size check first, then access fields[0m                               [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:  uint8_t *p = pkt->dhcp->options,[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:459[0m[39m-[0m[1;36m462[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:static void [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:  uint8_t op = [0m[1;36m0[0m[39m, *p = pkt->dhcp->options,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:          *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:  if [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:794[0m[39m-[0m[1;36m800[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:static void [0m[1;35mrx_ip[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:  uint16_t frag = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->frag[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:  if [0m[1;39m([0m[39mfrag & IP_MORE_FRAGS_MSK || frag & IP_FRAG_OFFSET_MSK[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:    if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:    struct mg_connection *c = [0m[1;35mgetpeer[0m[1;39m([0m[39mifp->mgr, pkt, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:    if [0m[1;39m([0m[39mc[0m[1;39m)[0m[39m [0m[1;35mmg_error[0m[1;39m([0m[39mc, [0m[32m"Received fragmented packet"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:226[0m[39m-[0m[1;36m236[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:  struct ip *ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39meth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mac_dst, [0m[1;35msizeof[0m[1;39m([0m[39meth->dst[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:  [0m[1;35mmemcpy[0m[1;39m([0m[39meth->src, ifp->mac, [0m[1;35msizeof[0m[1;39m([0m[39meth->src[0m[1;39m)[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Use our MAC[0m                 [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:  eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:  [0m[1;35mmemset[0m[1;39m([0m[39mip, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*ip[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:  ip->ver = [0m[1;36m0x45[0m[39m;               [0m[35m/[0m[35m/[0m[39m Version [0m[1;36m4[0m[39m, header length [0m[1;36m5[0m[39m words[0m             [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:  ip->frag = [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x4000[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Don't fragment[0m                               [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:  ip->len = [0m[1;35mmg_htons[0m[1;39m([0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*ip[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:  ip->ttl = [0m[1;36m64[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:  ip->proto = proto;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:  ip->src = ip_src;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtest/fuzz.[0m[1;92mc:90[0m[39m-[0m[1;36m110[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    struct mg_mgr mgr;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;35mmg_mgr_init[0m[1;39m([0m[39m&mgr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    [0m[1;35mmg_tcpip_init[0m[1;39m([0m[39m&mgr, &mif[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[35m/[0m[39m Make a copy of the random data, in order to modify it[0m                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    void *pkt = [0m[1;35mmalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    struct eth *eth = [0m[1;39m([0m[39mstruct eth *[0m[1;39m)[0m[39m pkt;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mpkt, data, size[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    if [0m[1;39m([0m[39msize > [0m[1;35msizeof[0m[1;39m([0m[39m*eth[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:      static size_t i;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:      uint16_t eth_types[0m[1;39m[[0m[1;39m][0m[39m = [0m[1;39m{[0m[1;36m0x800[0m[39m, [0m[1;36m0x800[0m[39m, [0m[1;36m0x806[0m[39m, [0m[1;36m0x86dd[0m[1;39m}[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:      [0m[1;35mmemcpy[0m[1;39m([0m[39meth->dst, mif.mac, [0m[1;36m6[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Set valid destination MAC[0m               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:      eth->type = [0m[1;35mmg_htons[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[39mi++[0m[1;39m][0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:      if [0m[1;39m([0m[39mi >= [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m)[0m[39m [0m[35m/[0m[39m [0m[1;35msizeof[0m[1;39m([0m[39meth_types[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m[39m i = [0m[1;36m0[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;35mmg_tcpip_rx[0m[1;39m([0m[39m&mif, pkt, size[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[35m/[0m[35m/[0m[39m Test HTTP serving[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    const char *url = [0m[32m"http://localhost:12345"[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    struct mg_connection *c = [0m[1;35mmg_http_connect[0m[1;39m([0m[39m&mgr, url, fn, NULL[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m384[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:129[0m[39m-[0m[1;36m143[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:struct pkt [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:  struct mg_str raw;  [0m[35m/[0m[35m/[0m[39m Raw packet data[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:  struct mg_str pay;  [0m[35m/[0m[35m/[0m[39m Payload data[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:  struct eth *eth;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:  struct llc *llc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:  struct arp *arp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:  struct ip *ip;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:  struct ip6 *ip6;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:  struct icmp *icmp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:  struct tcp *tcp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:  struct udp *udp;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:  struct dhcp *dhcp;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:static void [0m[1;35mmg_tcpip_call[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, int ev, void *ev_data[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/str.[0m[1;92mc:8[0m[39m-[0m[1;36m11[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:struct mg_str [0m[1;35mmg_str_n[0m[1;39m([0m[39mconst char *s, size_t n[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:  struct mg_str str = [0m[1;39m{[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m s, n[0m[1;39m}[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:  return str;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:838[0m[39m-[0m[1;36m852[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:static void [0m[1;35mrx_ip6[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"IP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:  if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m1[0m[39m || pkt->ip6->proto == [0m[1;36m58[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip6->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip6 + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"  UDP %u %u -> %u"[0m[39m, len, [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->sport[0m[1;39m)[0m[39m,[0m                [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;35mmg_htons[0m[1;39m([0m[39mudp->dport[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m805[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:1[0m[39m-[0m[1;36m5[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#include [0m[32m"net_builtin.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#if [0m[1;35mdefined[0m[1;39m([0m[39mMG_ENABLE_TCPIP[0m[1;39m)[0m[39m && MG_ENABLE_TCPIP[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#define MG_EPHEMERAL_PORT_BASE [0m[1;36m32768[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#define [0m[1;35mPDIFF[0m[1;39m([0m[39ma, b[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mb[0m[1;39m)[0m[1;39m)[0m[39m - [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m[1;39m([0m[39ma[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:824[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:382[0m[39m-[0m[1;36m396[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:static void [0m[1;35mrx_icmp[0m[1;39m([0m[39mstruct mg_tcpip_if *ifp, struct pkt *pkt[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:  [0m[35m/[0m[35m/[0m[39m [0m[1;35mMG_DEBUG[0m[1;39m([0m[1;39m([0m[32m"ICMP %d"[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:  if [0m[1;39m([0m[39mpkt->icmp->type == [0m[1;36m8[0m[39m && pkt->ip != NULL && pkt->ip->dst == ifp->ip[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    size_t hlen = [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct ip[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    size_t space = ifp->tx.len - hlen, plen = pkt->pay.len;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:    if [0m[1;39m([0m[39mplen > space[0m[1;39m)[0m[39m plen = space;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:    struct ip *ip = [0m[1;35mtx_ip[0m[1;39m([0m[39mifp, pkt->eth->src, [0m[1;36m1[0m[39m, ifp->ip, pkt->ip->src,[0m         [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                          [0m[1;35msizeof[0m[1;39m([0m[39mstruct icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    struct icmp *icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:    [0m[1;35mmemset[0m[1;39m([0m[39micmp, [0m[1;36m0[0m[39m, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[1;39m)[0m[39m;        [0m[35m/[0m[35m/[0m[39m Set csum to [0m[1;36m0[0m                     [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39micmp + [0m[1;36m1[0m[39m, pkt->pay.buf, plen[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Copy RX payload to TX[0m             [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:    icmp->csum = [0m[1;35mipcsum[0m[1;39m([0m[39micmp, [0m[1;35msizeof[0m[1;39m([0m[39m*icmp[0m[1;39m)[0m[39m + plen[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    [0m[1;35mether_output[0m[1;39m([0m[39mifp, hlen + plen[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:72[0m[39m-[0m[1;36m76[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:struct icmp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:  uint8_t type;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:  uint8_t code;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:  uint16_t csum;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:90[0m[39m-[0m[1;36m115[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:struct tcp [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:  uint32_t seq;    [0m[35m/[0m[35m/[0m[39m Sequence number[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:  uint32_t ack;    [0m[35m/[0m[35m/[0m[39m Acknowledgement number[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:  uint8_t off;     [0m[35m/[0m[35m/[0m[39m Data offset[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:  uint8_t flags;   [0m[35m/[0m[35m/[0m[39m TCP flags[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:#define TH_FIN [0m[1;36m0x01[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:#define TH_SYN [0m[1;36m0x02[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:#define TH_RST [0m[1;36m0x04[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:#define TH_PUSH [0m[1;36m0x08[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:#define TH_ACK [0m[1;36m0x10[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:#define TH_URG [0m[1;36m0x20[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:#define TH_ECE [0m[1;36m0x40[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:#define TH_CWR [0m[1;36m0x80[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:  uint16_t win;   [0m[35m/[0m[35m/[0m[39m Window[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:  uint16_t urp;   [0m[35m/[0m[35m/[0m[39m Urgent pointer[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:struct udp [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:  uint16_t sport;  [0m[35m/[0m[35m/[0m[39m Source port[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:  uint16_t dport;  [0m[35m/[0m[35m/[0m[39m Destination port[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:  uint16_t len;    [0m[35m/[0m[35m/[0m[39m UDP length[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:  uint16_t csum;   [0m[35m/[0m[35m/[0m[39m UDP checksum[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:47[0m[39m-[0m[1;36m60[0m                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:struct ip [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  uint8_t ver;    [0m[35m/[0m[35m/[0m[39m Version[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:  uint8_t tos;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:  uint16_t len;   [0m[35m/[0m[35m/[0m[39m Length[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:  uint16_t id;    [0m[35m/[0m[35m/[0m[39m Unused[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:  uint16_t frag;  [0m[35m/[0m[35m/[0m[39m Fragmentation[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:#define IP_FRAG_OFFSET_MSK [0m[1;36m0x1fff[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:#define IP_MORE_FRAGS_MSK [0m[1;36m0x2000[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:  uint8_t ttl;    [0m[35m/[0m[35m/[0m[39m Time to live[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:  uint8_t proto;  [0m[35m/[0m[35m/[0m[39m Upper level protocol[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:  uint16_t csum;  [0m[35m/[0m[35m/[0m[39m Checksum[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:  uint32_t src;   [0m[35m/[0m[35m/[0m[39m Source IP[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:  uint32_t dst;   [0m[35m/[0m[35m/[0m[39m Destination IP[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:882[0m[39m-[0m[1;36m896[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m882[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt.eth->type == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m0x800[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m883[0m[39m:    pkt.ip = [0m[1;39m([0m[39mstruct ip *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt.eth + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m884[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m885[0m[39m:    [0m[35m/[0m[35m/[0m[39m Truncate frame to what IP header tells us[0m                                [2m                [0m
[2;36m                    [0m         [1;36m886[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m < pkt.raw.len[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m887[0m[39m:      pkt.raw.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt.ip->len[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39mstruct eth[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m888[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m889[0m[39m:    if [0m[1;39m([0m[39mpkt.raw.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + [0m[1;35msizeof[0m[1;39m([0m[39m*pkt.ip[0m[1;39m)[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Truncated[0m [2m                [0m
[2;36m                    [0m         [1;36m890[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver >> [0m[1;36m4[0m[1;39m)[0m[39m != [0m[1;36m4[0m[1;39m)[0m[39m return;                           [0m[35m/[0m[35m/[0m[39m Not IP[0m    [2m                [0m
[2;36m                    [0m         [1;36m891[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m[39m                                   [0m[35m/[0m[35m/[0m[39m Handle [0m   [2m                [0m
[2;36m                    [0m         [39mIPv4 options[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m892[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m893[0m[39m:    else[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m894[0m[39m:        [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m895[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m896[0m[39m:    [0m[1;35mrx_ip[0m[1;39m([0m[39mifp, &pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:801[0m[39m-[0m[1;36m836[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:    pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->icmp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->icmp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:    [0m[1;35mrx_icmp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m17[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:    pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->udp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"UDP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->udp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    if [0m[1;39m([0m[39mifp->enable_dhcp_client && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m68[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:      [0m[1;35mrx_dhcp_client[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:    [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mifp->enable_dhcp_server && pkt->udp->dport == [0m[1;35mmg_htons[0m[1;39m([0m[1;36m67[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:      pkt->dhcp = [0m[1;39m([0m[39mstruct dhcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:      [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:      [0m[1;35mrx_dhcp_server[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:      [0m[1;35mrx_udp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:  [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mpkt->ip->proto == [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:    pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:    if [0m[1;39m([0m[39mpkt->pay.len < [0m[1;35msizeof[0m[1;39m([0m[39m*pkt->tcp[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:    [0m[1;35mmkpay[0m[1;39m([0m[39mpkt, pkt->tcp + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:    uint16_t iplen = [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->ip->len[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:    uint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:    if [0m[1;39m([0m[39miplen >= off[0m[1;39m)[0m[39m pkt->pay.len = [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39miplen - off[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:    [0m[1;35mMG_VERBOSE[0m[1;39m([0m[1;39m([0m[32m"TCP %M:%hu -> %M:%hu len %u"[0m[39m, mg_print_ip4, &pkt->ip->src,[0m     [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->sport[0m[1;39m)[0m[39m, mg_print_ip4, &pkt->ip->dst,[0m         [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:                [0m[1;35mmg_ntohs[0m[1;39m([0m[39mpkt->tcp->dport[0m[1;39m)[0m[39m, [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m pkt->pay.len[0m[1;39m)[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:    [0m[1;35mrx_tcp[0m[1;39m([0m[39mifp, pkt[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:  [0m[1;39m}[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:static void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:  pkt->pay =[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:      [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39m&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mp[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Issue[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the persistent heap-buffer-overflow:[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability stems from a combination of issues:[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Missing IHL validation**: When IP options exist [0m[1;39m([0m[39mIHL > [0m[1;36m5[0m[1;39m)[0m[39m, the code calculates[0m [2m                [0m
[2;36m                    [0m         [39mthe IP header end as `[0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[39mIHL * [0m[1;36m4[0m[1;39m)[0m[39m` without validating that this [0m   [2m                [0m
[2;36m                    [0m         [39mpointer is within the packet bounds before passing it to `mkpay`.[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Integer underflow in `mkpay`**: When the pointer `p` passed to `mkpay` exceeds[0m [2m                [0m
[2;36m                    [0m         [39m`&pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m`, the subtraction produces a negative value that wraps[0m [2m                [0m
[2;36m                    [0m         [39mto a huge positive number when cast to `size_t`, causing subsequent size checks to [0m [2m                [0m
[2;36m                    [0m         [39mincorrectly pass.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Incorrect protocol header assignment**: The failed patch attempted to change [0m  [2m                [0m
[2;36m                    [0m         [39mprotocol header assignments from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to `pkt->pay.buf`, but this change[0m [2m                [0m
[2;36m                    [0m         [39mwas incomplete or reverted. The protocol headers must be assigned using [0m            [2m                [0m
[2;36m                    [0m         [39m`pkt->pay.buf` to correctly account for IP options.[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Attack Scenario [0m[1;39m([0m[1;36m34[0m[39m-byte packet[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith a malformed [0m[1;36m34[0m[39m-byte packet where [0m[33mIHL[0m[39m=[0m[1;36m6[0m[39m [0m[1;39m([0m[39mclaiming [0m[1;36m24[0m[39m-byte IP header[0m[1;39m)[0m[39m:[0m           [2m                [0m
[2;36m                    [0m         [39m- [0m[1;36m14[0m[39m bytes Ethernet + [0m[1;36m20[0m[39m bytes actual IP data [0m[1;39m([0m[39mbut IHL claims [0m[1;36m24[0m[39m bytes[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m- At line [0m[1;36m892[0m[39m: `[0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, byte [0m[1;36m38[0m[1;39m)[0m[39m` where buffer is only [0m[1;36m34[0m[39m bytes[0m                 [2m                [0m
[2;36m                    [0m         [39m- `mkpay` calculates: `[0m[1;36m34[0m[39m - [0m[1;36m38[0m[39m = [0m[1;36m-4[0m[39m`, which wraps to `SIZE_MAX - [0m[1;36m3[0m[39m`[0m                 [2m                [0m
[2;36m                    [0m         [39m- `pkt->pay.len` becomes a huge number[0m                                              [2m                [0m
[2;36m                    [0m         [39m- At line [0m[1;36m802[0m[39m: `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` points to byte [0m[1;36m34[0m[39m [0m[1;39m([0m[39mjust [0m [2m                [0m
[2;36m                    [0m         [39mpast buffer[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Check at line [0m[1;36m803[0m[39m: `huge_number < [0m[1;36m4[0m[39m` fails, continues execution[0m                   [2m                [0m
[2;36m                    [0m         [39m- At line [0m[1;36m384[0m[39m: Accesses `pkt->icmp->type` at byte [0m[1;36m34[0m[39m, triggering [0m                   [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Comprehensive Fix Strategy[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Fix `mkpay` to Prevent Integer Underflow [0m[1;39m([0m[39mLine [0m[1;36m149[0m[39m-[0m[1;36m152[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Objective**: Prevent integer underflow when the pointer exceeds buffer bounds.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Before calculating the payload length, check if `p` is within valid bounds[0m        [2m                [0m
[2;36m                    [0m         [39m- If `p` points beyond the buffer end, set payload to empty [0m[1;39m([0m[39mlength [0m[1;36m0[0m[39m, pointer to [0m  [2m                [0m
[2;36m                    [0m         [39mend[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m- This prevents the negative subtraction that causes underflow[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Code location**: `src/net_builtin.[0m[1;92mc:149[0m[39m-[0m[1;36m152[0m[39m`[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mstatic void [0m[1;35mmkpay[0m[1;39m([0m[39mstruct pkt *pkt, void *p[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m  char *end = &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [39m  if [0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39mp >= end[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    pkt->pay = [0m[1;35mmg_str_n[0m[1;39m([0m[39mend, [0m[1;36m0[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m Empty payload if pointer is out of bounds[0m      [2m                [0m
[2;36m                    [0m         [39m  [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m    pkt->pay = [0m[1;35mmg_str_n[0m[1;39m([0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p, [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mend - [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[39m p[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;39m}[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Add IP Header Length Validation in `mg_tcpip_rx` [0m[1;39m([0m[39mLines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Objective**: Validate that the IP header length claimed by IHL doesn't exceed the[0m [2m                [0m
[2;36m                    [0m         [39mpacket size before using it.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Calculate IP header length as `ip_hdr_len = [0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m`[0m              [2m                [0m
[2;36m                    [0m         [39m- Validate that `ip_hdr_len >= [0m[1;36m20[0m[39m` [0m[1;39m([0m[39mminimum IP header size[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [39m- Validate that `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len <= pkt.raw.len`[0m                      [2m                [0m
[2;36m                    [0m         [39m- Only then call `mkpay` with the calculated pointer[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Code location**: `src/net_builtin.[0m[1;92mc:891[0m[39m-[0m[1;36m894[0m[39m`[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39mReplace the existing lines [0m[1;36m891[0m[39m-[0m[1;36m894[0m[39m:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m > [0m[1;36m5[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m*[0m[1;36m4[0m[1;39m)[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39melse[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mmkpay[0m[1;39m([0m[39m&pkt, pkt.ip + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39msize_t ip_hdr_len = [0m[1;39m([0m[1;39m([0m[39mpkt.ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mip_hdr_len < [0m[1;36m20[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Invalid IHL[0m                                        [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt.eth[0m[1;39m)[0m[39m + ip_hdr_len > pkt.raw.len[0m[1;39m)[0m[39m return;  [0m[35m/[0m[35m/[0m[39m Header exceeds packet[0m  [2m                [0m
[2;36m                    [0m         [1;35mmkpay[0m[1;39m([0m[39m&pkt, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;39m([0m[39mpkt.ip[0m[1;39m)[0m[39m + ip_hdr_len[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis consolidates both branches and always uses the calculated IP header length.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Fix Protocol Header Assignments to Use `pkt->pay.buf` [0m[1;39m([0m[39mLines [0m[1;36m802[0m[39m, [0m[1;36m807[0m[39m, [0m[1;36m825[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Objective**: Ensure protocol headers point to the correct location after IP [0m      [2m                [0m
[2;36m                    [0m         [39moptions, not assuming a fixed [0m[1;36m20[0m[39m-byte IP header.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Change all protocol header assignments from `[0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m` to `pkt->pay.buf`[0m     [2m                [0m
[2;36m                    [0m         [39m- This is the fundamental fix that was attempted but needs to be applied correctly[0m  [2m                [0m
[2;36m                    [0m         [39m- After `mkpay` is called in `mg_tcpip_rx`, `pkt->pay.buf` correctly points to the [0m [2m                [0m
[2;36m                    [0m         [39mstart of the protocol data, accounting for IP options[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Code location**: [0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- `src/net_builtin.[0m[1;92mc:802[0m[39m` [0m[1;39m([0m[39mICMP[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- `src/net_builtin.[0m[1;92mc:807[0m[39m` [0m[1;39m([0m[39mUDP[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- `src/net_builtin.[0m[1;92mc:825[0m[39m` [0m[1;39m([0m[39mTCP[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m802[0m[39m: Change `pkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->icmp = [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m807[0m[39m: Change `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->udp = [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m825[0m[39m: Change `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->tcp = [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Add Explicit Bounds Checks Before Protocol Handler Calls [0m[1;39m([0m[39mLines [0m[1;36m803[0m[39m, [0m[1;36m808[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [1;36m826[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Objective**: Add an additional safety check to ensure the protocol header pointer[0m [2m                [0m
[2;36m                    [0m         [39mitself is within bounds.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Calculate the end of the buffer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Check if the protocol header structure would extend beyond the buffer[0m             [2m                [0m
[2;36m                    [0m         [39m- This catches any remaining edge cases[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Code location**: After protocol header assignments at lines [0m[1;36m802[0m[39m, [0m[1;36m807[0m[39m, [0m[1;36m825[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39mAdd after line [0m[1;36m802[0m[39m [0m[1;39m([0m[39mICMP[0m[1;39m)[0m[39m:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->icmp = [0m[1;39m([0m[39mstruct icmp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                           [2m                [0m
[2;36m                    [0m         [39muint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->icmp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd after line [0m[1;36m807[0m[39m [0m[1;39m([0m[39mUDP[0m[1;39m)[0m[39m:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                             [2m                [0m
[2;36m                    [0m         [39muint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->udp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd after line [0m[1;36m825[0m[39m [0m[1;39m([0m[39mTCP[0m[1;39m)[0m[39m:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mpkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;[0m                                             [2m                [0m
[2;36m                    [0m         [39muint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->tcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Fix TCP Offset Calculation to Use Dynamic IP Header Length [0m[1;39m([0m[39mLine [0m[1;36m829[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Objective**: Correct TCP payload calculation to account for variable IP header [0m   [2m                [0m
[2;36m                    [0m         [39mlength.[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Calculate IP header length from IHL[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Use this in the TCP offset calculation instead of `[0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m`[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Code location**: `src/net_builtin.[0m[1;92mc:829[0m[39m`[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39mBefore line [0m[1;36m829[0m[39m, add:[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t ip_hdr_len = [0m[1;39m([0m[39mpkt->ip->ver & [0m[1;36m0xF[0m[1;39m)[0m[39m * [0m[1;36m4[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThen modify line [0m[1;36m829[0m[39m from:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*pkt->ip[0m[1;39m)[0m[39m + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint16_t off = [0m[1;39m([0m[39muint16_t[0m[1;39m)[0m[39m [0m[1;39m([0m[39mip_hdr_len + [0m[1;39m([0m[1;39m([0m[39mpkt->tcp->off >> [0m[1;36m4[0m[1;39m)[0m[39m * 4U[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m6[0m[39m. Update Fragmented Packet Handling [0m[1;39m([0m[39mLines [0m[1;36m797[0m[39m-[0m[1;36m798[0m[1;39m)[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Objective**: Ensure fragmented packet protocol headers also use `pkt->pay.buf` [0m   [2m                [0m
[2;36m                    [0m         [39mfor consistency.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation**:[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Change protocol header assignments in the fragmentation handling section[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Code location**: `src/net_builtin.[0m[1;92mc:797[0m[39m-[0m[1;36m798[0m[39m`[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m797[0m[39m: Change `pkt->udp = [0m[1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->udp = [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstruct udp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                                       [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m798[0m[39m: Change `pkt->tcp = [0m[1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->ip + [0m[1;36m1[0m[1;39m)[0m[39m;` to `pkt->tcp = [0m       [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mstruct tcp *[0m[1;39m)[0m[39m pkt->pay.buf;`[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNote: Since fragmented packets trigger an error and don't proceed to actual [0m        [2m                [0m
[2;36m                    [0m         [39mprocessing, this change is primarily for consistency and to prevent potential [0m      [2m                [0m
[2;36m                    [0m         [39mfuture issues.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification and Impact Analysis[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Approach is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses the root cause**: The fix prevents integer underflow in `mkpay` and [0m [2m                [0m
[2;36m                    [0m         [39mvalidates IHL before use, eliminating the primary attack vector.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Maintains correct protocol parsing**: Using `pkt->pay.buf` for protocol [0m       [2m                [0m
[2;36m                    [0m         [39mheaders ensures they point to the correct location regardless of IP options.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Defense in depth**: Multiple layers of validation [0m[1;39m([0m[39mIHL check, mkpay bounds [0m    [2m                [0m
[2;36m                    [0m         [39mcheck, explicit protocol header bounds check[0m[1;39m)[0m[39m ensure robustness.[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserves existing logic**: The fix doesn't change the fundamental packet [0m     [2m                [0m
[2;36m                    [0m         [39mprocessing flow, only adds necessary validations.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Minimal performance impact**: The additional checks are simple comparisons [0m    [2m                [0m
[2;36m                    [0m         [39mthat execute once per packet.[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Preserves Existing Functionality[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The packet processing pipeline remains unchanged[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Valid packets with or without IP options are handled correctly[0m                    [2m                [0m
[2;36m                    [0m         [39m- Only malformed packets with invalid IHL or insufficient size are rejected[0m         [2m                [0m
[2;36m                    [0m         [39m- All existing protocol handlers [0m[1;39m([0m[39mICMP, UDP, TCP, DHCP[0m[1;39m)[0m[39m continue to work[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Evaluation Report Issues[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Fixes the crash at line [0m[1;36m385[0m[39m**: By preventing `pkt->icmp` from pointing out of [0m [2m                [0m
[2;36m                    [0m         [39mbounds[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Resolves the integer underflow**: The `mkpay` bounds check prevents negative [0m  [2m                [0m
[2;36m                    [0m         [39mlength calculations[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Handles IP options correctly**: Protocol headers now use `pkt->pay.buf` which [0m [2m                [0m
[2;36m                    [0m         [39maccounts for options[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Validates IHL field**: Prevents using malformed IHL values that exceed packet [0m [2m                [0m
[2;36m                    [0m         [39msize[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m1[0m[39m**: Slightly stricter validation may reject some previously accepted[0m [2m                [0m
[2;36m                    [0m         [39mmalformed packets.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: This is intended behavior - malformed packets should be rejected [0m [2m                [0m
[2;36m                    [0m         [39mfor security.[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m2[0m[39m**: Performance overhead from additional checks.[0m                     [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: Minimal - only simple comparisons added, no significant [0m          [2m                [0m
[2;36m                    [0m         [39mperformance impact.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effect [0m[1;36m3[0m[39m**: Changes to protocol header assignment could affect other code [0m   [2m                [0m
[2;36m                    [0m         [39mthat assumes `pkt->ip + [0m[1;36m1[0m[39m` pattern.[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- **Mitigation**: The codebase analysis shows this pattern is isolated to `rx_ip` [0m  [2m                [0m
[2;36m                    [0m         [39mfunction. The fix ensures `pkt->pay.buf` is correctly set before protocol handlers [0m [2m                [0m
[2;36m                    [0m         [39mare called.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in the Codebase[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe DHCP handlers [0m[1;39m([0m[39m`rx_dhcp_client` at line [0m[1;36m404[0m[39m and `rx_dhcp_server` at line [0m[1;36m462[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39malready implement similar bounds checking:[0m                                          [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39muint8_t *end = [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m &pkt->raw.buf[0m[1;39m[[0m[39mpkt->raw.len[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mend < [0m[1;39m([0m[39muint8_t *[0m[1;39m)[0m[39m [0m[1;39m([0m[39mpkt->dhcp + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m return;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix extends this pattern to all protocol handlers for consistency and safety.[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 04:16:11][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=903493;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=714417;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m6[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=58497;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=611843;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpq30rksez[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/mongoose_mg-delta-02_mongoose[0m [2m               [0m
[2;36m                    [0m         [35m_2/[0m[95magent-output-1768277771.8837538[0m                                                   [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/mongoose_mg-delta-02_mongoose_2.toml                [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-mongoose[0m         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 04:16:14][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mmongoose[0m       ]8;id=43256;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=612815;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=144086;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=138758;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mmongoose[0m              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=54276;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=526222;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mmongoose[0m               [2m               [0m
