[2;36m[01/13/26 11:32:56][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=901456;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=66678;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp_gm3z90z[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-full-01_vuln_8/[0m[95magent-[0m [2m               [0m
[2;36m                    [0m         [95moutput-1768303976.1027613[0m                                                            [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-full-01_vuln_8.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=77846;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=6780;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:34:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m97.21[0m  ]8;id=529866;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=681433;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=487195;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=551084;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=604786;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=579205;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=641907;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=472065;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m97[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=871126;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=719158;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:34:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.93[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=609389;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=464511;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:34:36][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=344577;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=264520;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=222467;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=907858;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=543972;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=389560;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=493847;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=185045;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:34:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.32[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=23611;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=746817;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:34:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=303958;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=808223;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:34:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.96[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=944634;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=360647;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:34:51][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=594915;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=203221;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1m([0mProcessUtils.jav[1;92ma:94[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1m([0mShellCodeDetector.jav[1;92ma:103[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1m([0mCompositeDetector.jav[1;92ma:84[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1056[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:485[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:237[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: d7514645016ef7a8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1m([0mProcessUtils.jav[1;92ma:94[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1m([0mShellCodeDetector.jav[1;92ma:103[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1m([0mCompositeDetector.jav[1;92ma:84[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1056[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:485[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:237[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: d7514645016ef7a8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 11:35:11][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=144071;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=279777;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 11:38:38][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=967149;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=418751;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 11:39:34][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=424225;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=273378;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=280108;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=600157;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:39:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.93[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=206000;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=416685;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:39:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=137517;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=378778;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpx23v7cgd[0m                                                 ]8;id=827136;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=92068;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 11:40:49][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m73.43[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=654913;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=790324;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=65501;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=222925;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:41:22][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m33.25[0m seconds;                ]8;id=26966;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=369580;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=152507;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=32203;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:41:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m11.79[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=520739;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=360918;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=606139;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=958386;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=511315;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=630045;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=109867;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=376661;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:41:35][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=592171;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=249347;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:41:36][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=457153;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=547711;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:41:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.01[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=764940;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=436431;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:41:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=404820;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=128309;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 11:41:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.98[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=198235;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=638118;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 11:41:40][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=386855;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=982541;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java         [2m                [0m
[2;36m                    [0m         +++ b/tika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java         [2m                [0m
[2;36m                    [0m         @@ [1;36m-20[0m,[1;36m25[0m +[1;36m20[0m,[1;36m14[0m @@                                                                 [2m                [0m
[2;36m                    [0m          import java.io.IOException;                                                        [2m                [0m
[2;36m                    [0m          import java.io.InputStream;                                                        [2m                [0m
[2;36m                    [0m          import java.nio.charset.StandardCharsets;                                          [2m                [0m
[2;36m                    [0m         -import java.nio.file.Files;                                                        [2m                [0m
[2;36m                    [0m         -import java.nio.file.Path;                                                         [2m                [0m
[2;36m                    [0m         -import java.nio.file.Paths;                                                        [2m                [0m
[2;36m                    [0m         -import java.nio.file.StandardCopyOption;                                           [2m                [0m
[2;36m                    [0m          import java.util.Locale;                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -import org.apache.commons.io.FileUtils;                                            [2m                [0m
[2;36m                    [0m         -import org.apache.commons.io.FilenameUtils;                                        [2m                [0m
[2;36m                    [0m          import org.apache.commons.io.IOUtils;                                              [2m                [0m
[2;36m                    [0m         -import org.apache.commons.io.input.CloseShieldInputStream;                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -import org.apache.tika.io.TikaInputStream;                                         [2m                [0m
[2;36m                    [0m          import org.apache.tika.metadata.Metadata;                                          [2m                [0m
[2;36m                    [0m          import org.apache.tika.metadata.Property;                                          [2m                [0m
[2;36m                    [0m          import org.apache.tika.metadata.TikaCoreProperties;                                [2m                [0m
[2;36m                    [0m          import org.apache.tika.mime.MediaType;                                             [2m                [0m
[2;36m                    [0m         -import org.apache.tika.utils.FileProcessResult;                                    [2m                [0m
[2;36m                    [0m         -import org.apache.tika.utils.ProcessUtils;                                         [2m                [0m
[2;36m                    [0m         -import org.apache.tika.utils.StringUtils;                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m          [35m/[0m**                                                                                [2m                [0m
[2;36m                    [0m           * Simple detector to determine if a shell script is no-arg shell script.          [2m                [0m
[2;36m                    [0m         @@ [1;36m-77[0m,[1;36m37[0m +[1;36m66[0m,[1;36m7[0m @@                                                                  [2m                [0m
[2;36m                    [0m                  [1m}[0m finally [1m{[0m                                                                [2m                [0m
[2;36m                    [0m                      [1;35minput.reset[0m[1m([0m[1m)[0m;                                                         [2m                [0m
[2;36m                    [0m                  [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        if [1m([0m! isShell[1m)[0m [1m{[0m                                                           [2m                [0m
[2;36m                    [0m         -            return MediaType.OCTET_STREAM;                                         [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        String fileName = [1;35mmetadata.get[0m[1m([0mTikaCoreProperties.RESOURCE_NAME_KEY[1m)[0m;      [2m                [0m
[2;36m                    [0m         -        if [1m([0m[1;35mStringUtils.isBlank[0m[1m([0mfileName[1m)[0m[1m)[0m [1m{[0m                                       [2m                [0m
[2;36m                    [0m         -            return [1;35misShell[0m[1m([0misShell[1m)[0m;                                               [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        [35m/[0m[35m/[0m[95mnow[0m test for no-arg shell script                                         [2m                [0m
[2;36m                    [0m         -        TikaInputStream tis =                                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1m([0m[1;35mCloseShieldInputStream.wrap[0m[1m([0minput[1m)[0m[1m)[0m;                            [2m                [0m
[2;36m                    [0m         -        fileName = [1;35mFilenameUtils.getName[0m[1m([0mfileName[1m)[0m;                                [2m                [0m
[2;36m                    [0m         -        fileName = [1;35mfileName.replaceAll[0m[1m([0m[32m"[0m[32m[[0m[32m^-_0-9A-Za-z.[0m[32m][0m[32m+"[0m, [32m""[0m[1m)[0m;                    [2m                [0m
[2;36m                    [0m         -        fileName = [1;35mfileName.replaceAll[0m[1m([0m[32m"\\.\\."[0m, [32m""[0m[1m)[0m;                              [2m                [0m
[2;36m                    [0m         -                                                                                   [2m                [0m
[2;36m                    [0m         -        if [1m([0m[1;35mfileName.length[0m[1m([0m[1m)[0m > MAX_LENGTH[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         -            fileName = [1;35mfileName.substring[0m[1m([0m[1;35mfileName.length[0m[1m([0m[1m)[0m - MAX_LENGTH[1m)[0m;         [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        Path cwd = [1;35mPaths.get[0m[1m([0m[32m"."[0m[1m)[0m[1;35m.toAbsolutePath[0m[1m([0m[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;                    [2m                [0m
[2;36m                    [0m         -        Path tmpDir = [1;35mFiles.createTempDirectory[0m[1m([0mcwd, [32m"tika-shell-detect-"[0m[1m)[0m;        [2m                [0m
[2;36m                    [0m         -        Path tmpFile = [1;35mtmpDir.resolve[0m[1m([0mfileName[1m)[0m;                                   [2m                [0m
[2;36m                    [0m         -        [1;35mFiles.copy[0m[1m([0m[1;35mtis.getPath[0m[1m([0m[1m)[0m, tmpFile, StandardCopyOption.REPLACE_EXISTING[1m)[0m;   [2m                [0m
[2;36m                    [0m         -        ProcessBuilder pb = new [1;35mProcessBuilder[0m[1m([0mfileName[1m)[0m;                          [2m                [0m
[2;36m                    [0m         -        [1;35mpb.directory[0m[1m([0m[1;35mtmpDir.toFile[0m[1m([0m[1m)[0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         -        try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            FileProcessResult result = [1;35mProcessUtils.execute[0m[1m([0mpb, [1;36m20000[0m, [1;36m100000[0m,     [2m                [0m
[2;36m                    [0m         [1;36m100000[0m[1m)[0m;                                                                            [2m                [0m
[2;36m                    [0m         -            if [1m([0m[1;35mresult.getExitValue[0m[1m([0m[1m)[0m == [1;36m0[0m[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m         -                [1;35mmetadata.set[0m[1m([0mSHELL_NO_ARGS, true[1m)[0m;                                 [2m                [0m
[2;36m                    [0m         -            [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m         -        [1m}[0m finally [1m{[0m                                                                [2m                [0m
[2;36m                    [0m         -            [1;35mFileUtils.deleteDirectory[0m[1m([0m[1;35mtmpDir.toFile[0m[1m([0m[1m)[0m[1m)[0m;                            [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         -        return SHELL_SCRIPT;                                                       [2m                [0m
[2;36m                    [0m         +        return [1;35misShell[0m[1m([0misShell[1m)[0m;                                                   [2m                [0m
[2;36m                    [0m              [1m}[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m              private MediaType [1;35misShell[0m[1m([0mboolean isShell[1m)[0m [1m{[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1m([0mProcessUtils.jav[1;92ma:94[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1m([0mShellCodeDetector.jav[1;92ma:103[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1m([0mCompositeDetector.jav[1;92ma:84[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.cli.TikaCLI$[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mTikaCLI.jav [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1m([0mPackageParser.jav[1;92ma:481[0m[1m)[0m         [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1m([0mPackageParser.jav[1;92ma:386[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1m([0mPackageParser.jav[1;92ma:336[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1m([0mPackageParser.jav[1;92ma:259[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at org.apache.tika.cli.TikaCLI$[1;35mOutputType.process[0m[1m([0mTikaCLI.jav[1;92ma:1056[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.process[0m[1m([0mTikaCLI.jav[1;92ma:485[0m[1m)[0m                    [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.cli.TikaCLI.main[0m[1m([0mTikaCLI.jav[1;92ma:237[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:74[0m[1m)[0m           [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1m([0mTikaAppUnpackerFuzzer.jav[1;92ma:54[0m[1m)[0m [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: d7514645016ef7a8                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A critical security vulnerability has been detected in Apache Tika involving OS     [2m                [0m
[2;36m                    [0m         Command Injection. The issue occurs when the ShellCodeDetector attempts to execute  [2m                [0m
[2;36m                    [0m         system commands with potentially attacker-controlled data during the detection and  [2m                [0m
[2;36m                    [0m         parsing of embedded documents within package files. This vulnerability could lead   [2m                [0m
[2;36m                    [0m         to remote code execution.                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Vulnerability Type                                                              [2m                [0m
[2;36m                    [0m         This is an **OS Command Injection** vulnerability, classified as a critical         [2m                [0m
[2;36m                    [0m         security issue. OS Command Injection occurs when an application executes operating  [2m                [0m
[2;36m                    [0m         system commands using data that can be controlled by an attacker, potentially       [2m                [0m
[2;36m                    [0m         allowing arbitrary command execution on the host system.                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Issue Details                                                                   [2m                [0m
[2;36m                    [0m         The vulnerability is triggered during the following execution flow:                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. The TikaCLI processes input through its AutoDetectParser                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m. The CompositeParser delegates parsing to the PackageParser for handling          [2m                [0m
[2;36m                    [0m         package-type files                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m. When parsing package entries, the PackageParser encounters embedded documents    [2m                [0m
[2;36m                    [0m         [1;36m4[0m. The FileEmbeddedDocumentExtractor attempts to parse these embedded files         [2m                [0m
[2;36m                    [0m         [1;36m5[0m. During the detection phase, the CompositeDetector invokes the ShellCodeDetector  [2m                [0m
[2;36m                    [0m         [1;36m6[0m. The [1;35mShellCodeDetector.detect[0m[1m([0m[1m)[0m method calls [1;35mProcessUtils.execute[0m[1m([0m[1m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m7[0m. [1;35mProcessUtils.execute[0m[1m([0m[1m)[0m initiates a ProcessBuilder to execute system commands     [2m                [0m
[2;36m                    [0m         [1;36m8[0m. The command execution occurs with data that appears to be derived from the input [2m                [0m
[2;36m                    [0m         file content                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The stack trace indicates the injection point occurs at:                            [2m                [0m
[2;36m                    [0m         - `[1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1m([0mShellCodeDetector.jav[1;92ma:103[0m[1m)[0m`     [2m                [0m
[2;36m                    [0m         - `[1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1m([0mProcessUtils.jav[1;92ma:94[0m[1m)[0m`                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Key Observations                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Entry Point**: The fuzzer enters through TikaAppUnpackerFuzzer, which appears  [2m                [0m
[2;36m                    [0m         to be testing Tika's unpacking functionality with various inputs                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Vulnerable Component**: The ShellCodeDetector component is responsible for     [2m                [0m
[2;36m                    [0m         detecting shell code, but it does so by executing system commands                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Attack Vector**: The vulnerability can be triggered by crafting malicious      [2m                [0m
[2;36m                    [0m         package files [1m([0msuch as ZIP, TAR, or other archive formats[1m)[0m containing embedded      [2m                [0m
[2;36m                    [0m         documents with specially crafted content                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Detection Phase**: The vulnerability occurs during the file type detection     [2m                [0m
[2;36m                    [0m         phase, not during actual content extraction, which means it could be triggered even [2m                [0m
[2;36m                    [0m         before full parsing begins                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ### Areas for Investigation                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         To gain a comprehensive understanding of this vulnerability, the following          [2m                [0m
[2;36m                    [0m         components should be investigated:                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **org.apache.tika.detect.ShellCodeDetector**:                                    [2m                [0m
[2;36m                    [0m            - Examine how this detector constructs and executes system commands              [2m                [0m
[2;36m                    [0m            - Identify what input data is used in command construction                       [2m                [0m
[2;36m                    [0m            - Review the detection logic at line [1;36m103[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **org.apache.tika.utils.ProcessUtils**:                                          [2m                [0m
[2;36m                    [0m            - Analyze the [1;35mexecute[0m[1m([0m[1m)[0m method at line [1;36m94[0m                                        [2m                [0m
[2;36m                    [0m            - Determine what validation or sanitization is performed on command parameters   [2m                [0m
[2;36m                    [0m            - Review how commands and arguments are constructed                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **org.apache.tika.parser.pkg.PackageParser**:                                    [2m                [0m
[2;36m                    [0m            - Understand how embedded documents are extracted and processed                  [2m                [0m
[2;36m                    [0m            - Review the [1;35mparseEntry[0m[1m([0m[1m)[0m and [1;35mparseEntries[0m[1m([0m[1m)[0m methods                             [2m                [0m
[2;36m                    [0m            - Examine how file metadata from archives is handled                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **org.apache.tika.detect.CompositeDetector**:                                    [2m                [0m
[2;36m                    [0m            - Review how detectors are chained and invoked                                   [2m                [0m
[2;36m                    [0m            - Determine under what conditions the ShellCodeDetector is activated             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Configuration and Detector Registry**:                                         [2m                [0m
[2;36m                    [0m            - Investigate whether ShellCodeDetector can be disabled or is mandatory          [2m                [0m
[2;36m                    [0m            - Review the default detector configuration in Tika                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m. **Input Validation**:                                                            [2m                [0m
[2;36m                    [0m            - Examine what validation exists [1m([0mif any[1m)[0m for filenames, metadata, and content   [2m                [0m
[2;36m                    [0m         from embedded files before they reach the detection phase                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         This vulnerability represents a critical security risk as it could allow an         [2m                [0m
[2;36m                    [0m         attacker to achieve remote code execution by providing a specially crafted archive  [2m                [0m
[2;36m                    [0m         file containing malicious embedded document metadata or content.                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.utils.ProcessUtils.execute[0m[1;39m([0m[39mProcessUtils.jav[0m[1;92ma:94[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.ShellCodeDetector.detect[0m[1;39m([0m[39mShellCodeDetector.jav[0m[1;92ma:103[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.detect.CompositeDetector.detect[0m[1;39m([0m[39mCompositeDetector.jav[0m[1;92ma:84[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.cli.TikaCLI$[0m[1;35mFileEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mTikaCLI.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1092[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntry[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:481[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.pkg.PackageParser.parseEntries[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:386[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.pkg.PackageParser._parse[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:336[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.pkg.PackageParser.parse[0m[1;39m([0m[39mPackageParser.jav[0m[1;92ma:259[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat org.apache.tika.cli.TikaCLI$[0m[1;35mOutputType.process[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:1056[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.cli.TikaCLI.process[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:485[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.cli.TikaCLI.main[0m[1;39m([0m[39mTikaCLI.jav[0m[1;92ma:237[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.parseOne[0m[1;39m([0m[39mTikaAppUnpackerFuzzer.jav[0m[1;92ma:74[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.TikaAppUnpackerFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mTikaAppUnpackerFuzzer.jav[0m[1;92ma:54[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: d7514645016ef7a8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:1[0m[39m-[0m[1;36m42[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.detect;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.EOFException;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.StandardCopyOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.commons.io.FileUtils;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.utils.FileProcessResult;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.utils.ProcessUtils;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:54[0m[39m-[0m[1;36m111[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public MediaType [0m[1;35mdetect[0m[1;39m([0m[39mInputStream input, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        boolean isShell = false;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            name = [0m[1;35mname.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            if [0m[1;39m([0m[1;35mname.endsWith[0m[1;39m([0m[32m".sh"[0m[1;39m)[0m[39m || [0m[1;35mname.endsWith[0m[1;39m([0m[32m".bash"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                isShell = true;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        if [0m[1;39m([0m[39minput == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            return [0m[1;35misShell[0m[1;39m([0m[39misShell[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            [0m[1;35minput.mark[0m[1;39m([0m[39mSNIFF_LENGTH[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[1;35mIOUtils.readFully[0m[1;39m([0m[39minput, SNIFF_LENGTH[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:            String firstBytes = new [0m[1;35mString[0m[1;39m([0m[39mbytes, StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            if [0m[1;39m([0m[1;35mfirstBytes.startsWith[0m[1;39m([0m[32m"#!/"[0m[1;39m)[0m[39m || [0m[1;35mfirstBytes.startsWith[0m[1;39m([0m[32m"#!\\ "[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39m||[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                    [0m[1;35mfirstBytes.startsWith[0m[1;39m([0m[32m"#!\t"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                isShell = true;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEOFException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            return [0m[1;35misShell[0m[1;39m([0m[39mfalse[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;35minput.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        if [0m[1;39m([0m[39m! isShell[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            return MediaType.OCTET_STREAM;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        String fileName = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            return [0m[1;35misShell[0m[1;39m([0m[39misShell[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m test for no-arg shell script[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        TikaInputStream tis = [0m                                                   [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39minput[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        fileName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m^-_0-9A-Za-z.[0m[32m][0m[32m+"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"\\.\\."[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        if [0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            fileName = [0m[1;35mfileName.substring[0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m - MAX_LENGTH[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        Path cwd = [0m[1;35mPaths.get[0m[1;39m([0m[32m"."[0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        Path tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[39mcwd, [0m[32m"tika-shell-detect-"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        Path tmpFile = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mFiles.copy[0m[1;39m([0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m, tmpFile, StandardCopyOption.REPLACE_EXISTING[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[1;35mpb.directory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mpb, [0m[1;36m20000[0m[39m, [0m[1;36m100000[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [1;36m100000[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            if [0m[1;39m([0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;35mFileUtils.deleteDirectory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        return SHELL_SCRIPT;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/ProcessUtils.jav[0m[1;92ma:20[0m[39m-[0m[1;36m26[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.UUID;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.concurrent.ConcurrentHashMap;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/ProcessUtils.jav[0m[1;92ma:87[0m[39m-[0m[1;36m153[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    public static FileProcessResult [0m[1;35mexecute[0m[1;39m([0m[39mProcessBuilder pb,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                                            long timeoutMillis,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                                            int maxStdoutBuffer, int [0m            [2m                [0m
[2;36m                    [0m         [39mmaxStdErrBuffer[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        Process p = null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        String id = null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            p = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            id = [0m[1;35mregister[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:            long elapsed = [0m[1;36m-1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            long start = [0m[1;35mSystem.currentTimeMillis[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            StreamGobbler outGobbler = new [0m[1;35mStreamGobbler[0m[1;39m([0m[1;35mp.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mmaxStdoutBuffer[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            StreamGobbler errGobbler = new [0m[1;35mStreamGobbler[0m[1;39m([0m[1;35mp.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mmaxStdErrBuffer[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            Thread outThread = new [0m[1;35mThread[0m[1;39m([0m[39moutGobbler[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:            [0m[1;35moutThread.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            Thread errThread = new [0m[1;35mThread[0m[1;39m([0m[39merrGobbler[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;35merrThread.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            int exitValue = [0m[1;36m-1[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            boolean complete = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                complete = [0m[1;35mp.waitFor[0m[1;39m([0m[39mtimeoutMillis, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:                elapsed = [0m[1;35mSystem.currentTimeMillis[0m[1;39m([0m[1;39m)[0m[39m - start;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                if [0m[1;39m([0m[39mcomplete[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                    exitValue = [0m[1;35mp.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                    [0m[1;35moutThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    [0m[1;35merrThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                    [0m[1;35mp.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                    [0m[1;35moutThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                    [0m[1;35merrThread.join[0m[1;39m([0m[1;36m1000[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    boolean completed = [0m[1;35mp.waitFor[0m[1;39m([0m[1;36m500[0m[39m, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                    if [0m[1;39m([0m[39mcompleted[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                        try [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                            exitValue = [0m[1;35mp.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalThreadStateException e[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                            [0m[35m/[0m[35m/[0m[95mnot[0m[39m finished![0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInterruptedException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                exitValue = [0m[1;36m-1000[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                [0m[1;35moutThread.interrupt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                [0m[1;35merrThread.interrupt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:            FileProcessResult result = new [0m[1;35mFileProcessResult[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:            result.processTimeMillis = elapsed;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            result.stderrLength = [0m[1;35merrGobbler.getStreamLength[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            result.stdoutLength = [0m[1;35moutGobbler.getStreamLength[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            result.isTimeout = ! complete;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            result.exitValue = exitValue;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            result.stdout = [0m[1;35mStringUtils.joinWith[0m[1;39m([0m[32m"\n"[0m[39m, [0m[1;35moutGobbler.getLines[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:            result.stderr = [0m[1;35mStringUtils.joinWith[0m[1;39m([0m[32m"\n"[0m[39m, [0m[1;35merrGobbler.getLines[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            result.stdoutTruncated = [0m[1;35moutGobbler.getIsTruncated[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            result.stderrTruncated = [0m[1;35merrGobbler.getIsTruncated[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:            return result;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            if [0m[1;39m([0m[39mp != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                [0m[1;35mp.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            if [0m[1;39m([0m[39mid != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                [0m[1;35mrelease[0m[1;39m([0m[39mid[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/CompositeDetector.jav[0m[1;92ma:19[0m[39m-[0m[1;36m31[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Collection;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.mime.MediaTypeRegistry;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/CompositeDetector.jav[0m[1;92ma:36[0m[39m-[0m[1;36m90[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:public class CompositeDetector implements Detector [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private static final long serialVersionUID = 5980683158436430252L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private final MediaTypeRegistry registry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private final List<Detector> detectors;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public [0m[1;35mCompositeDetector[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Detector> [0m         [2m                [0m
[2;36m                    [0m         [39mdetectors,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                             Collection<Class<? extends Detector>> [0m              [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        if [0m[1;39m([0m[39mexcludeDetectors == null || [0m[1;35mexcludeDetectors.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            this.detectors = detectors;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            this.detectors = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            for [0m[1;39m([0m[39mDetector d : detectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35misExcluded[0m[1;39m([0m[39mexcludeDetectors, [0m[1;35md.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                    [0m[1;35mthis.detectors.add[0m[1;39m([0m[39md[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.registry = registry;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mCompositeDetector[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Detector> [0m         [2m                [0m
[2;36m                    [0m         [39mdetectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, detectors, null[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public [0m[1;35mCompositeDetector[0m[1;39m([0m[39mList<Detector> detectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m, detectors[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    public [0m[1;35mCompositeDetector[0m[1;39m([0m[39mDetector[0m[33m...[0m[39m detectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[39mdetectors[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public MediaType [0m[1;35mdetect[0m[1;39m([0m[39mInputStream input, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        MediaType override = [0m[1;35mdetectOverrides[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        if [0m[1;39m([0m[39moverride != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            return override;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        MediaType type = MediaType.OCTET_STREAM;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[35m/[0m[95mwe[0m[39m have to iterate through all detectors because the override detector[0m [2m                [0m
[2;36m                    [0m         [39mmay[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[35m/[0m[35m/[0m[95mbe[0m[39m within a CompositeDetector[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        for [0m[1;39m([0m[39mDetector detector : [0m[1;35mgetDetectors[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            MediaType detected = [0m[1;35mdetector.detect[0m[1;39m([0m[39minput, metadata[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            if [0m[1;39m([0m[1;35mregistry.isSpecializationOf[0m[1;39m([0m[39mdetected, type[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                type = detected;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        return type;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pkg-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/pkg/PackageParser.jav[0m[1;92ma:440[0m[39m-[0m[1;36m485[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:    private void [0m[1;35mparseEntry[0m[1;39m([0m[39mArchiveInputStream archive, ArchiveEntry entry,[0m     [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:                            EmbeddedDocumentExtractor extractor, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mparentMetadata,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:                            XHTMLContentHandler xhtml[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:            throws SAXException, IOException, TikaException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:        String name = [0m[1;35mentry.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:        [0m[35m/[0m[35m/[0m[95mTry[0m[39m to detect charset of archive entry in case of non-unicode [0m        [2m                [0m
[2;36m                    [0m         [39mfilename is used[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:        if [0m[1;39m([0m[39mdetectCharsetsInEntryNames && entry instanceof ZipArchiveEntry[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:            [0m[35m/[0m[35m/[0m[39m Extend short entry name to improve accuracy of charset detection[0m [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m entryName = [0m[1;39m([0m[1;39m([0m[39mZipArchiveEntry[0m[1;39m)[0m[39m entry[0m[1;39m)[0m[1;35m.getRawName[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m extendedEntryName = entryName;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:            if [0m[1;39m([0m[1;36m0[0m[39m < entryName.length && entryName.length < [0m                     [2m                [0m
[2;36m                    [0m         [39mMIN_BYTES_FOR_DETECTING_CHARSET[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:                int len = entryName.length * [0m[1;39m([0m[39mMIN_BYTES_FOR_DETECTING_CHARSET [0m[35m/[0m [2m                [0m
[2;36m                    [0m         [39mentryName.length[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:                extendedEntryName = new byte[0m[1;39m[[0m[39mlen[0m[1;39m][0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < len; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:                    extendedEntryName[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = entryName[0m[1;39m[[0m[39mi % entryName.length[0m[1;39m][0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:            Charset candidate =[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:                    [0m[1;35mgetEncodingDetector[0m[1;39m([0m[1;39m)[0m[1;35m.detect[0m[1;39m([0m                               [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mUnsynchronizedByteArrayInputStream.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setByteArray[0m[1;39m([0m[39mextendedEntryName[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:                            parentMetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:            if [0m[1;39m([0m[39mcandidate != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:                name = new [0m[1;35mString[0m[1;39m([0m[1;39m([0m[1;39m([0m[39mZipArchiveEntry[0m[1;39m)[0m[39m entry[0m[1;39m)[0m[1;35m.getRawName[0m[1;39m([0m[1;39m)[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mcandidate[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m467[0m[39m:        [0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m468[0m[39m:        if [0m[1;39m([0m[1;35marchive.canReadEntryData[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:            [0m[35m/[0m[35m/[0m[39m Fetch the metadata on the entry contained in the archive[0m         [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:            Metadata entrydata =[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:                    [0m[1;35mhandleEntryMetadata[0m[1;39m([0m[39mname, null, [0m                            [2m                [0m
[2;36m                    [0m         [1;35mentry.getLastModifiedDate[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mentry.getSize[0m[1;39m([0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:                            xhtml[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:            [0m[35m/[0m[35m/[0m[39m Recurse into the entry if desired[0m                                [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:            if [0m[1;39m([0m[1;35mextractor.shouldParseEmbedded[0m[1;39m([0m[39mentrydata[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:                [0m[35m/[0m[35m/[0m[39m For detectors to work, we need a mark/reset supporting[0m       [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:                [0m[35m/[0m[35m/[0m[39m InputStream, which ArchiveInputStream isn't, so wrap[0m         [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                TemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                try [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                    TikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39marchive, tmp, [0m    [2m                [0m
[2;36m                    [0m         [39mentrydata[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                    [0m[1;35mextractor.parseEmbedded[0m[1;39m([0m[39mtis, xhtml, entrydata, true[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                    [0m[1;35mtmp.dispose[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pkg-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/main/java/org/apache/tika/parser/pkg/PackageParser.jav[0m[1;92ma:208[0m[39m-[0m[1;36m233[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:    protected static Metadata [0m[1;35mhandleEntryMetadata[0m[1;39m([0m[39mString name, Date createAt, [0m  [2m                [0m
[2;36m                    [0m         [39mDate modifiedAt,[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                                                  Long size, [0m                   [2m                [0m
[2;36m                    [0m         [39mXHTMLContentHandler xhtml[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:            throws SAXException, IOException, TikaException [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:        Metadata entrydata = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        if [0m[1;39m([0m[39mcreateAt != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m[1;35mentrydata.set[0m[1;39m([0m[39mTikaCoreProperties.CREATED, createAt[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        if [0m[1;39m([0m[39mmodifiedAt != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            [0m[1;35mentrydata.set[0m[1;39m([0m[39mTikaCoreProperties.MODIFIED, modifiedAt[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        if [0m[1;39m([0m[39msize != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:            [0m[1;35mentrydata.set[0m[1;39m([0m[39mMetadata.CONTENT_LENGTH, [0m[1;35mLong.toString[0m[1;39m([0m[39msize[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        if [0m[1;39m([0m[39mname != null && [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:            name = [0m[1;35mname.replace[0m[1;39m([0m[32m"\\", "[0m[35m/[0m[39m"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;35mentrydata.set[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY, name[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            AttributesImpl attributes = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            [0m[1;35mattributes.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"CDATA"[0m[39m, [0m[32m"embedded"[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            [0m[1;35mattributes.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"id"[0m[39m, [0m[32m"id"[0m[39m, [0m[32m"CDATA"[0m[39m, name[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:            [0m[1;35mxhtml.startElement[0m[1;39m([0m[32m"div"[0m[39m, attributes[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;35mxhtml.endElement[0m[1;39m([0m[32m"div"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            [0m[1;35mentrydata.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RELATIONSHIP_ID, name[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:        return entrydata;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-app/src/main/java/org/apache/tika/cli/TikaCLI.jav[0m[1;92ma:1079[0m[39m-[0m[1;36m1125[0m                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:    private class FileEmbeddedDocumentExtractor implements [0m                    [2m                [0m
[2;36m                    [0m         [39mEmbeddedDocumentExtractor [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:        private final TikaConfig config = [0m[1;35mTikaConfig.getDefaultConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:        private final EmbeddedStreamTranslator embeddedStreamTranslator = new [0m [2m                [0m
[2;36m                    [0m         [1;35mDefaultEmbeddedStreamTranslator[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:        private int count = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:        public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:            return true;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1089[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1090[0m[39m:        public void [0m[1;35mparseEmbedded[0m[1;39m([0m[39mTikaInputStream tis, ContentHandler [0m         [2m                [0m
[2;36m                    [0m         [39mcontentHandler, Metadata metadata, boolean outputHtml[0m[1;39m)[0m[39m throws SAXException, [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1091[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1092[0m[39m:            MediaType contentType = [0m[1;35mdetector.detect[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1093[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1094[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m1095[0m[39m:            File outputFile = null;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1096[0m[39m:            if [0m[1;39m([0m[39mname == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1097[0m[39m:                name = [0m[32m"file"[0m[39m + count++;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1098[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1099[0m[39m:            outputFile = [0m[1;35mgetOutputFile[0m[1;39m([0m[39mname, metadata, contentType[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m1100[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1101[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1102[0m[39m:            File parent = [0m[1;35moutputFile.getParentFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1103[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mparent.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1104[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mparent.mkdirs[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1105[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"unable to create directory \""[0m[39m + [0m   [2m                [0m
[2;36m                    [0m         [39mparent + [0m[32m"\""[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1106[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1107[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1108[0m[39m:            [0m[1;35mSystem.out.println[0m[1;39m([0m[32m"Extracting '"[0m[39m + name + [0m[32m"' [0m[32m([0m[32m"[0m[39m + contentType + [0m  [2m                [0m
[2;36m                    [0m         [32m"[0m[32m)[0m[32m to "[0m[39m + outputFile[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1109[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1110[0m[39m:            try [0m[1;39m([0m[39mFileOutputStream os = new [0m[1;35mFileOutputStream[0m[1;39m([0m[39moutputFile[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m1111[0m[39m:                if [0m[1;39m([0m[1;35membeddedStreamTranslator.shouldTranslate[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m1112[0m[39m:                    try [0m[1;39m([0m[39mInputStream translated = [0m                             [2m                [0m
[2;36m                    [0m         [1;35membeddedStreamTranslator.translate[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1113[0m[39m:                        [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mtranslated, os[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1114[0m[39m:                    [0m[1;39m}[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1115[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1116[0m[39m:                    [0m[1;35mIOUtils.copy[0m[1;39m([0m[39mtis, os[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1117[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1118[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1119[0m[39m:                [0m[35m/[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1120[0m[39m:                [0m[35m/[0m[35m/[0m[39m being a CLI program messages should go to the stderr too[0m    [2m                [0m
[2;36m                    [0m         [1;36m1121[0m[39m:                [0m[35m/[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1122[0m[39m:                String msg = [0m[1;35mString.format[0m[1;39m([0m[39mLocale.ROOT, [0m[32m"Ignoring unexpected [0m  [2m                [0m
[2;36m                    [0m         [32mexception trying to save embedded file %s [0m[32m([0m[32m%s[0m[32m)[0m[32m"[0m[39m, name, [0m[1;35me.getMessage[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1123[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[39mmsg, e[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1124[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1125[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-app/src/main/java/org/apache/tika/cli/TikaCLI.jav[0m[1;92ma:19[0m[39m-[0m[1;36m109[0m                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.FileOutputStream;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.OutputStreamWriter;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.io.PrintStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.PrintWriter;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.io.UnsupportedEncodingException;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.io.Writer;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.lang.reflect.Field;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.net.URI;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.Comparator;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import java.util.Map.Entry;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import java.util.TreeSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import java.util.UUID;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import javax.xml.transform.OutputKeys;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import javax.xml.transform.TransformerConfigurationException;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import javax.xml.transform.sax.SAXTransformerFactory;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import javax.xml.transform.sax.TransformerHandler;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import javax.xml.transform.stream.StreamResult;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import org.apache.commons.io.FilenameUtils;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import org.apache.commons.io.input.CloseShieldInputStream;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.logging.log4j.Level;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:import org.xml.sax.helpers.DefaultHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:import org.apache.tika.Tika;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:import org.apache.tika.async.cli.TikaAsyncCLI;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:import org.apache.tika.config.TikaConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:import org.apache.tika.config.TikaConfigSerializer;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:import org.apache.tika.detect.CompositeDetector;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:import org.apache.tika.detect.Detector;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:import org.apache.tika.extractor.DefaultEmbeddedStreamTranslator;[0m                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:import org.apache.tika.extractor.EmbeddedStreamTranslator;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:import org.apache.tika.fork.ForkParser;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:import org.apache.tika.gui.TikaGUI;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:import org.apache.tika.language.detect.LanguageHandler;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:import org.apache.tika.mime.MediaTypeRegistry;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:import org.apache.tika.mime.MimeType;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:import org.apache.tika.mime.MimeTypeException;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:import org.apache.tika.mime.MimeTypes;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:import org.apache.tika.parser.AutoDetectParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:import org.apache.tika.parser.CompositeParser;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:import org.apache.tika.parser.DigestingParser;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:import org.apache.tika.parser.NetworkParser;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:import org.apache.tika.parser.ParserDecorator;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:import org.apache.tika.parser.PasswordProvider;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:import org.apache.tika.parser.RecursiveParserWrapper;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:import org.apache.tika.parser.digestutils.CommonsDigester;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:import org.apache.tika.parser.pdf.PDFParserConfig;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:import org.apache.tika.sax.BasicContentHandlerFactory;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:import org.apache.tika.sax.BodyContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:import org.apache.tika.sax.ContentHandlerFactory;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:import org.apache.tika.sax.ExpandedTitleContentHandler;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:import org.apache.tika.sax.RecursiveParserWrapperHandler;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:import org.apache.tika.sax.WriteOutContentHandler;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:import org.apache.tika.sax.boilerpipe.BoilerpipeContentHandler;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:import org.apache.tika.serialization.JsonMetadata;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:import org.apache.tika.serialization.JsonMetadataList;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:import org.apache.tika.xmp.XMPMetadata;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/CompositeDetector.jav[0m[1;92ma:43[0m[39m-[0m[1;36m90[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private final MediaTypeRegistry registry;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private final List<Detector> detectors;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public [0m[1;35mCompositeDetector[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Detector> [0m         [2m                [0m
[2;36m                    [0m         [39mdetectors,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                             Collection<Class<? extends Detector>> [0m              [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        if [0m[1;39m([0m[39mexcludeDetectors == null || [0m[1;35mexcludeDetectors.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            this.detectors = detectors;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            this.detectors = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            for [0m[1;39m([0m[39mDetector d : detectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35misExcluded[0m[1;39m([0m[39mexcludeDetectors, [0m[1;35md.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                    [0m[1;35mthis.detectors.add[0m[1;39m([0m[39md[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.registry = registry;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mCompositeDetector[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Detector> [0m         [2m                [0m
[2;36m                    [0m         [39mdetectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, detectors, null[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public [0m[1;35mCompositeDetector[0m[1;39m([0m[39mList<Detector> detectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m, detectors[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    public [0m[1;35mCompositeDetector[0m[1;39m([0m[39mDetector[0m[33m...[0m[39m detectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mArrays.asList[0m[1;39m([0m[39mdetectors[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public MediaType [0m[1;35mdetect[0m[1;39m([0m[39mInputStream input, Metadata metadata[0m[1;39m)[0m[39m throws [0m        [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        MediaType override = [0m[1;35mdetectOverrides[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        if [0m[1;39m([0m[39moverride != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            return override;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        MediaType type = MediaType.OCTET_STREAM;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        [0m[35m/[0m[35m/[0m[95mwe[0m[39m have to iterate through all detectors because the override detector[0m [2m                [0m
[2;36m                    [0m         [39mmay[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[35m/[0m[35m/[0m[95mbe[0m[39m within a CompositeDetector[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        for [0m[1;39m([0m[39mDetector detector : [0m[1;35mgetDetectors[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            MediaType detected = [0m[1;35mdetector.detect[0m[1;39m([0m[39minput, metadata[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            if [0m[1;39m([0m[1;35mregistry.isSpecializationOf[0m[1;39m([0m[39mdetected, type[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                type = detected;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        return type;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/DefaultDetector.jav[0m[1;92ma:44[0m[39m-[0m[1;36m95[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private static final long serialVersionUID = -8170114575326908027L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private transient final ServiceLoader loader;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public [0m[1;35mDefaultDetector[0m[1;39m([0m[39mMimeTypes types, ServiceLoader loader,[0m                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                           Collection<Class<? extends Detector>> [0m                [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[1;35mtypes.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mgetDefaultDetectors[0m[1;39m([0m[39mtypes, loader, [0m  [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        this.loader = loader;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public [0m[1;35mDefaultDetector[0m[1;39m([0m[39mMimeTypes types, ServiceLoader loader[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mtypes, loader, Collections.EMPTY_SET[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public [0m[1;35mDefaultDetector[0m[1;39m([0m[39mMimeTypes types, ClassLoader loader[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mtypes, new [0m[1;35mServiceLoader[0m[1;39m([0m[39mloader[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mDefaultDetector[0m[1;39m([0m[39mClassLoader loader[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mMimeTypes.getDefaultMimeTypes[0m[1;39m([0m[1;39m)[0m[39m, loader[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public [0m[1;35mDefaultDetector[0m[1;39m([0m[39mMimeTypes types[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mtypes, new [0m[1;35mServiceLoader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    public [0m[1;35mDefaultDetector[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mMimeTypes.getDefaultMimeTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * Finds all statically loadable detectors and sort the list by name,[0m        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * rather than discovery order. Detectors are used in the given order,[0m       [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * so put the Tika parsers last so that non-Tika [0m[1;39m([0m[39muser supplied[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * parsers can take precedence.[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * If an [0m[1;39m{[0m[39m@link OverrideDetector[0m[1;39m}[0m[39m is loaded, it takes precedence over[0m        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * all other detectors.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * @param loader service loader[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * @return ordered list of statically loadable detectors[0m                     [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    private static List<Detector> [0m[1;35mgetDefaultDetectors[0m[1;39m([0m[39mMimeTypes types, [0m          [2m                [0m
[2;36m                    [0m         [39mServiceLoader loader,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                                                      Collection<Class<? extends[0m [2m                [0m
[2;36m                    [0m         [39mDetector>>[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                                                              excludeDetectors[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        List<Detector> detectors =[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;35mloader.loadStaticServiceProviders[0m[1;39m([0m[39mDetector.class, [0m               [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        [0m[1;35mServiceLoaderUtils.sortLoadedClasses[0m[1;39m([0m[39mdetectors[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[35m/[0m[35m/[0m[95mlook[0m[39m for the override index and put that first[0m                         [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        int overrideIndex = [0m[1;36m-1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        int i = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/resources/META-INF/services/org.apache.tika.detect.Detector:[0m[1;36m1[0m[39m-[0m[1;36m16[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:#  Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:#  contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#  this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:#  The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#  [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#  the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#       [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#  Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#  distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#  See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#  limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:org.apache.tika.detect.ShellCodeDetector[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/MagicDetector.jav[0m[1;92ma:336[0m[39m-[0m[1;36m422[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:     * @param input    document input stream, or <code>null<[0m[35m/[0m[95mcode[0m[39m>[0m              [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:     * @param metadata ignored[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:    public MediaType [0m[1;35mdetect[0m[1;39m([0m[39mInputStream input, Metadata metadata[0m[1;39m)[0m[39m throws [0m       [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:        if [0m[1;39m([0m[39minput == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:            return MediaType.OCTET_STREAM;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:        [0m[1;35minput.mark[0m[1;39m([0m[39moffsetRangeEnd + length[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:            int offset = [0m[1;36m0[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:            [0m[35m/[0m[35m/[0m[39m Skip bytes at the beginning, using [0m[1;35mskip[0m[1;39m([0m[1;39m)[0m[39m or [0m[1;35mread[0m[1;39m([0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            while [0m[1;39m([0m[39moffset < offsetRangeBegin[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:                long n = [0m[1;35minput.skip[0m[1;39m([0m[39moffsetRangeBegin - offset[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:                if [0m[1;39m([0m[39mn > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:                    offset += n;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35minput.read[0m[1;39m([0m[1;39m)[0m[39m != [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:                    offset += [0m[1;36m1[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:                    return MediaType.OCTET_STREAM;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:            [0m[35m/[0m[35m/[0m[39m Fill in the comparison window[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:            byte[0m[1;39m[[0m[1;39m][0m[39m buffer = new byte[0m[1;39m[[0m[39mlength + [0m[1;39m([0m[39moffsetRangeEnd - [0m                [2m                [0m
[2;36m                    [0m         [39moffsetRangeBegin[0m[1;39m)[0m[1;39m][0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:            int n = [0m[1;35minput.read[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            if [0m[1;39m([0m[39mn > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:                offset += n;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:            while [0m[1;39m([0m[39mn != [0m[1;36m-1[0m[39m && offset < offsetRangeEnd + length[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:                int bufferOffset = offset - offsetRangeBegin;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                n = [0m[1;35minput.read[0m[1;39m([0m[39mbuffer, bufferOffset, buffer.length - [0m           [2m                [0m
[2;36m                    [0m         [39mbufferOffset[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:                [0m[35m/[0m[35m/[0m[39m increment offset - in case not all read [0m[1;39m([0m[39msee [0m                [2m                [0m
[2;36m                    [0m         [39mtestDetectStreamReadProblems[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:                if [0m[1;39m([0m[39mn > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:                    offset += n;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            if [0m[1;39m([0m[39mthis.isRegex[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                int flags = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:                if [0m[1;39m([0m[39mthis.isStringIgnoreCase[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                    flags = Pattern.CASE_INSENSITIVE;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:                Pattern p = [0m[1;35mPattern.compile[0m[1;39m([0m[39mnew [0m[1;35mString[0m[1;39m([0m[39mthis.pattern, UTF_8[0m[1;39m)[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39mflags[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:                ByteBuffer bb = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:                CharBuffer result = [0m[1;35mISO_8859_1.decode[0m[1;39m([0m[39mbb[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:                Matcher m = [0m[1;35mp.matcher[0m[1;39m([0m[39mresult[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:                boolean match = false;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:                [0m[35m/[0m[35m/[0m[39m Loop until we've covered the entire offset range[0m             [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i <= offsetRangeEnd - offsetRangeBegin; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:                    [0m[1;35mm.region[0m[1;39m([0m[39mi, length + i[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:                    match = [0m[1;35mm.lookingAt[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m match regex from start of region[0m  [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:                    if [0m[1;39m([0m[39mmatch[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:                        return type;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:                if [0m[1;39m([0m[39moffset < offsetRangeBegin + length[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:                    return MediaType.OCTET_STREAM;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:                [0m[35m/[0m[35m/[0m[39m Loop until we've covered the entire offset range[0m             [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i <= offsetRangeEnd - offsetRangeBegin; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:                    boolean match = true;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:                    int masked;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:                    for [0m[1;39m([0m[39mint j = [0m[1;36m0[0m[39m; match && j < length; j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                        masked = [0m[1;39m([0m[39mbuffer[0m[1;39m[[0m[39mi + j[0m[1;39m][0m[39m & mask[0m[1;39m[[0m[39mj[0m[1;39m][0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:                        if [0m[1;39m([0m[39mthis.isStringIgnoreCase[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:                            masked = [0m[1;35mCharacter.toLowerCase[0m[1;39m([0m[39mmasked[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:                        match = [0m[1;39m([0m[39mmasked == pattern[0m[1;39m[[0m[39mj[0m[1;39m][0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:                    if [0m[1;39m([0m[39mmatch[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:                        return type;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            return MediaType.OCTET_STREAM;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:            [0m[1;35minput.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/config/TikaConfig.jav[0m[1;92ma:200[0m[39m-[0m[1;36m300[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:     * Creates a Tika configuration from the built-in media type rules[0m          [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:     * and all the [0m[1;39m{[0m[39m@link Parser[0m[1;39m}[0m[39m implementations available through the[0m         [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:     * [0m[1;39m{[0m[39m@link ServiceRegistry service provider mechanism[0m[1;39m}[0m[39m in the given[0m          [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:     * class loader.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:     * @param loader the class loader through which parser implementations[0m      [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:     *               are loaded, or <code>null<[0m[35m/[0m[95mcode[0m[39m> for no parsers[0m            [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:     * @throws MimeTypeException if the built-in media type rules are broken[0m    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:     * @throws IOException       if the built-in media type rules can not be [0m   [2m                [0m
[2;36m                    [0m         [39mread[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:     * @since Apache Tika [0m[1;36m0.8[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    public [0m[1;35mTikaConfig[0m[1;39m([0m[39mClassLoader loader[0m[1;39m)[0m[39m throws MimeTypeException, IOException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        this.serviceLoader = new [0m[1;35mServiceLoader[0m[1;39m([0m[39mloader[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        this.mimeTypes = [0m[1;35mgetDefaultMimeTypes[0m[1;39m([0m[39mloader[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        this.detector = [0m[1;35mgetDefaultDetector[0m[1;39m([0m[39mmimeTypes, serviceLoader[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        this.encodingDetector = [0m[1;35mgetDefaultEncodingDetector[0m[1;39m([0m[39mserviceLoader[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:        this.renderer = [0m[1;35mgetDefaultRenderer[0m[1;39m([0m[39mserviceLoader[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:        this.parser = [0m[1;35mgetDefaultParser[0m[1;39m([0m[39mmimeTypes, serviceLoader, [0m               [2m                [0m
[2;36m                    [0m         [39mencodingDetector, renderer[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:        this.translator = [0m[1;35mgetDefaultTranslator[0m[1;39m([0m[39mserviceLoader[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:        this.executorService = [0m[1;35mgetDefaultExecutorService[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:        this.metadataFilter = new [0m[1;35mNoOpFilter[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:        this.metadataListFilter = new [0m[1;35mNoOpListFilter[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:        this.autoDetectParserConfig = AutoDetectParserConfig.DEFAULT;[0m           [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;35mTIMES_INSTANTIATED.incrementAndGet[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:     * Creates a default Tika configuration.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:     * First checks whether an XML config file is specified, either in[0m          [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:     * <ol>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:     * <li>System property [0m[32m"tika.config"[0m[39m, or<[0m[35m/[0m[95mli[0m[39m>[0m                               [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:     * <li>Environment variable TIKA_CONFIG<[0m[35m/[0m[95mli[0m[39m>[0m                                [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:     * <[0m[35m/[0m[95mol[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:     * <p>If one of these have a value, try to resolve it relative to file[0m      [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:     * system or classpath.<[0m[35m/[0m[95mp[0m[39m>[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:     * <p>If XML config is not specified, initialize from the built-in media[0m    [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:     * type rules and all the [0m[1;39m{[0m[39m@link Parser[0m[1;39m}[0m[39m implementations available through[0m  [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:     * the [0m[1;39m{[0m[39m@link ServiceRegistry service provider mechanism[0m[1;39m}[0m[39m in the context[0m    [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:     * class loader of the current thread.<[0m[35m/[0m[95mp[0m[39m>[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:     * @throws IOException   if the configuration can not be read[0m               [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:     * @throws TikaException if problem with MimeTypes or parsing XML config[0m    [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:    public [0m[1;35mTikaConfig[0m[1;39m([0m[1;39m)[0m[39m throws TikaException, IOException [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        String config = [0m[1;35mSystem.getProperty[0m[1;39m([0m[32m"tika.config"[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"loading tika config from system property [0m                [2m                [0m
[2;36m                    [0m         [32m'tika.config'"[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            config = [0m[1;35mSystem.getenv[0m[1;39m([0m[32m"TIKA_CONFIG"[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"loading tika config from environment variable [0m       [2m                [0m
[2;36m                    [0m         [32m'TIKA_CONFIG'"[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"loading tika config from defaults; no config file [0m       [2m                [0m
[2;36m                    [0m         [32mspecified"[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:            this.serviceLoader = new [0m[1;35mServiceLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:            this.mimeTypes = [0m[1;35mgetDefaultMimeTypes[0m[1;39m([0m[1;35mgetContextClassLoader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            this.encodingDetector = [0m[1;35mgetDefaultEncodingDetector[0m[1;39m([0m[39mserviceLoader[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:            this.renderer = [0m[1;35mgetDefaultRenderer[0m[1;39m([0m[39mserviceLoader[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:            this.parser = [0m[1;35mgetDefaultParser[0m[1;39m([0m[39mmimeTypes, serviceLoader, [0m           [2m                [0m
[2;36m                    [0m         [39mencodingDetector, renderer[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:            this.detector = [0m[1;35mgetDefaultDetector[0m[1;39m([0m[39mmimeTypes, serviceLoader[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m267[0m[39m:            this.translator = [0m[1;35mgetDefaultTranslator[0m[1;39m([0m[39mserviceLoader[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:            this.executorService = [0m[1;35mgetDefaultExecutorService[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:            this.metadataFilter = new [0m[1;35mNoOpFilter[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:            this.metadataListFilter = new [0m[1;35mNoOpListFilter[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:            this.autoDetectParserConfig = AutoDetectParserConfig.DEFAULT;[0m       [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:            ServiceLoader tmpServiceLoader = new [0m[1;35mServiceLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"loading tika config from: "[0m[39m + config[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:            try [0m[1;39m([0m[39mInputStream stream = [0m[1;35mgetConfigInputStream[0m[1;39m([0m[39mconfig, [0m             [2m                [0m
[2;36m                    [0m         [39mtmpServiceLoader[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:                Element element = [0m                                              [2m                [0m
[2;36m                    [0m         [1;35mXMLReaderUtils.buildDOM[0m[1;39m([0m[39mstream[0m[1;39m)[0m[1;35m.getDocumentElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:                [0m[1;35mupdateXMLReaderUtils[0m[1;39m([0m[39melement[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:                serviceLoader = [0m[1;35mserviceLoaderFromDomElement[0m[1;39m([0m[39melement, [0m           [2m                [0m
[2;36m                    [0m         [1;35mtmpServiceLoader.getLoader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:                DetectorXmlLoader detectorLoader = new [0m[1;35mDetectorXmlLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:                EncodingDetectorXmlLoader encodingDetectorLoader = new [0m         [2m                [0m
[2;36m                    [0m         [1;35mEncodingDetectorXmlLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                RendererXmlLoader rendererLoader = new [0m[1;35mRendererXmlLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:                TranslatorXmlLoader translatorLoader = new [0m                     [2m                [0m
[2;36m                    [0m         [1;35mTranslatorXmlLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:                ExecutorServiceXmlLoader executorLoader = new [0m                  [2m                [0m
[2;36m                    [0m         [1;35mExecutorServiceXmlLoader[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:                this.mimeTypes = [0m[1;35mtypesFromDomElement[0m[1;39m([0m[39melement[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:                this.encodingDetector =[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:                        [0m[1;35mencodingDetectorLoader.loadOverall[0m[1;39m([0m[39melement, mimeTypes, [0m [2m                [0m
[2;36m                    [0m         [39mserviceLoader[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:                this.renderer = [0m[1;35mrendererLoader.loadOverall[0m[1;39m([0m[39melement, mimeTypes, [0m [2m                [0m
[2;36m                    [0m         [39mserviceLoader[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:                ParserXmlLoader parserLoader = new [0m                             [2m                [0m
[2;36m                    [0m         [1;35mParserXmlLoader[0m[1;39m([0m[39mencodingDetector, renderer[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:                this.parser = [0m[1;35mparserLoader.loadOverall[0m[1;39m([0m[39melement, mimeTypes, [0m     [2m                [0m
[2;36m                    [0m         [39mserviceLoader[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:                this.detector = [0m[1;35mdetectorLoader.loadOverall[0m[1;39m([0m[39melement, mimeTypes, [0m [2m                [0m
[2;36m                    [0m         [39mserviceLoader[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:                this.translator = [0m[1;35mtranslatorLoader.loadOverall[0m[1;39m([0m[39melement, [0m        [2m                [0m
[2;36m                    [0m         [39mmimeTypes, serviceLoader[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:                this.executorService =[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:                        [0m[1;35mexecutorLoader.loadOverall[0m[1;39m([0m[39melement, mimeTypes, [0m         [2m                [0m
[2;36m                    [0m         [39mserviceLoader[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:                this.metadataFilter = [0m[1;35mMetadataFilter.load[0m[1;39m([0m[39melement, true[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                this.metadataListFilter = [0m[1;35mMetadataListFilter.load[0m[1;39m([0m[39melement, [0m     [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                this.autoDetectParserConfig = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mAutoDetectParserConfig.load[0m[1;39m([0m[39melement[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:                [0m[1;35msetMaxJsonStringFieldLength[0m[1;39m([0m[39melement[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/config/TikaConfig.jav[0m[1;92ma:1105[0m[39m-[0m[1;36m1136[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1105[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1106[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1107[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1108[0m[39m:        Detector [0m[1;35mcreateComposite[0m[1;39m([0m[39mClass<? extends Detector> detectorClass,[0m      [2m                [0m
[2;36m                    [0m         [1;36m1109[0m[39m:                                 List<Detector> childDetectors,[0m                [2m                [0m
[2;36m                    [0m         [1;36m1110[0m[39m:                                 Set<Class<? extends Detector>> [0m               [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1111[0m[39m:                                 Map<String, Param> params, MimeTypes [0m         [2m                [0m
[2;36m                    [0m         [39mmimeTypes,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1112[0m[39m:                                 ServiceLoader loader[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1113[0m[39m:                throws InvocationTargetException, IllegalAccessException, [0m     [2m                [0m
[2;36m                    [0m         [39mInstantiationException [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1114[0m[39m:            Detector detector = null;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1115[0m[39m:            Constructor<? extends Detector> c;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1116[0m[39m:            MediaTypeRegistry registry = [0m[1;35mmimeTypes.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m1117[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1118[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try the possible default and composite detector constructors[0m    [2m                [0m
[2;36m                    [0m         [1;36m1119[0m[39m:            if [0m[1;39m([0m[39mdetector == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1120[0m[39m:                try [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1121[0m[39m:                    c = detectorClass[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1122[0m[39m:                            [0m[1;35m.getConstructor[0m[1;39m([0m[39mMimeTypes.class, [0m                  [2m                [0m
[2;36m                    [0m         [39mServiceLoader.class, Collection.class[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1123[0m[39m:                    detector = [0m[1;35mc.newInstance[0m[1;39m([0m[39mmimeTypes, loader, [0m               [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1124[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNoSuchMethodException me[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1125[0m[39m:                    [0m[35m/[0m[35m/[0m[95mswallow[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1126[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1127[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1128[0m[39m:            if [0m[1;39m([0m[39mdetector == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1129[0m[39m:                try [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1130[0m[39m:                    c = detectorClass[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1131[0m[39m:                            [0m[1;35m.getConstructor[0m[1;39m([0m[39mMediaTypeRegistry.class, [0m          [2m                [0m
[2;36m                    [0m         [39mList.class, Collection.class[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1132[0m[39m:                    detector = [0m[1;35mc.newInstance[0m[1;39m([0m[39mregistry, childDetectors, [0m        [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1133[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNoSuchMethodException me[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1134[0m[39m:                    [0m[35m/[0m[35m/[0m[95mswallow[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1135[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1136[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/config/TikaConfig.jav[0m[1;92ma:1055[0m[39m-[0m[1;36m1161[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1055[0m[39m:    private static class DetectorXmlLoader extends [0m                            [2m                [0m
[2;36m                    [0m         [39mXmlLoader<CompositeDetector, Detector> [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1056[0m[39m:        boolean [0m[1;35msupportsComposite[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1057[0m[39m:            return true;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1058[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1059[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1060[0m[39m:        String [0m[1;35mgetParentTagName[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1061[0m[39m:            return [0m[32m"detectors"[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1062[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1063[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1064[0m[39m:        String [0m[1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1065[0m[39m:            return [0m[32m"detector"[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1066[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1067[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1068[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1069[0m[39m:        Class<? extends Detector> [0m[1;35mgetLoaderClass[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1070[0m[39m:            return Detector.class;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1071[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1072[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1073[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1074[0m[39m:        Detector [0m[1;35mpreLoadOne[0m[1;39m([0m[39mClass<? extends Detector> loadedClass, String [0m     [2m                [0m
[2;36m                    [0m         [39mclassname,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1075[0m[39m:                            MimeTypes mimeTypes[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1076[0m[39m:            [0m[35m/[0m[35m/[0m[39m If they asked for the mime types as a detector, give[0m            [2m                [0m
[2;36m                    [0m         [1;36m1077[0m[39m:            [0m[35m/[0m[35m/[0m[39m  them the one we've already created. TIKA-[0m[1;36m1708[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1078[0m[39m:            if [0m[1;39m([0m[1;35mMimeTypes.class.equals[0m[1;39m([0m[39mloadedClass[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1079[0m[39m:                return mimeTypes;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1080[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1081[0m[39m:            [0m[35m/[0m[35m/[0m[39m Continue with normal loading[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1082[0m[39m:            return null;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1083[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1084[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1085[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1086[0m[39m:        boolean [0m[1;35misComposite[0m[1;39m([0m[39mDetector loaded[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1087[0m[39m:            return loaded instanceof CompositeDetector;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1088[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1089[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1090[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1091[0m[39m:        boolean [0m[1;35misComposite[0m[1;39m([0m[39mClass<? extends Detector> loadedClass[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m1092[0m[39m:            return [0m[1;35mCompositeDetector.class.isAssignableFrom[0m[1;39m([0m[39mloadedClass[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m1093[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1094[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1095[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1096[0m[39m:        CompositeDetector [0m[1;35mcreateDefault[0m[1;39m([0m[39mMimeTypes mimeTypes, ServiceLoader [0m    [2m                [0m
[2;36m                    [0m         [39mloader[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m1097[0m[39m:            return [0m[1;35mgetDefaultDetector[0m[1;39m([0m[39mmimeTypes, loader[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1098[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1099[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1100[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1101[0m[39m:        CompositeDetector [0m[1;35mcreateComposite[0m[1;39m([0m[39mList<Detector> detectors, MimeTypes [0m [2m                [0m
[2;36m                    [0m         [39mmimeTypes,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1102[0m[39m:                                          ServiceLoader loader[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m1103[0m[39m:            MediaTypeRegistry registry = [0m[1;35mmimeTypes.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m1104[0m[39m:            return new [0m[1;35mCompositeDetector[0m[1;39m([0m[39mregistry, detectors[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1105[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1106[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1107[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1108[0m[39m:        Detector [0m[1;35mcreateComposite[0m[1;39m([0m[39mClass<? extends Detector> detectorClass,[0m      [2m                [0m
[2;36m                    [0m         [1;36m1109[0m[39m:                                 List<Detector> childDetectors,[0m                [2m                [0m
[2;36m                    [0m         [1;36m1110[0m[39m:                                 Set<Class<? extends Detector>> [0m               [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1111[0m[39m:                                 Map<String, Param> params, MimeTypes [0m         [2m                [0m
[2;36m                    [0m         [39mmimeTypes,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1112[0m[39m:                                 ServiceLoader loader[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1113[0m[39m:                throws InvocationTargetException, IllegalAccessException, [0m     [2m                [0m
[2;36m                    [0m         [39mInstantiationException [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1114[0m[39m:            Detector detector = null;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1115[0m[39m:            Constructor<? extends Detector> c;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1116[0m[39m:            MediaTypeRegistry registry = [0m[1;35mmimeTypes.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m1117[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1118[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try the possible default and composite detector constructors[0m    [2m                [0m
[2;36m                    [0m         [1;36m1119[0m[39m:            if [0m[1;39m([0m[39mdetector == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1120[0m[39m:                try [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1121[0m[39m:                    c = detectorClass[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1122[0m[39m:                            [0m[1;35m.getConstructor[0m[1;39m([0m[39mMimeTypes.class, [0m                  [2m                [0m
[2;36m                    [0m         [39mServiceLoader.class, Collection.class[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1123[0m[39m:                    detector = [0m[1;35mc.newInstance[0m[1;39m([0m[39mmimeTypes, loader, [0m               [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1124[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNoSuchMethodException me[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1125[0m[39m:                    [0m[35m/[0m[35m/[0m[95mswallow[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1126[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1127[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1128[0m[39m:            if [0m[1;39m([0m[39mdetector == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1129[0m[39m:                try [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1130[0m[39m:                    c = detectorClass[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1131[0m[39m:                            [0m[1;35m.getConstructor[0m[1;39m([0m[39mMediaTypeRegistry.class, [0m          [2m                [0m
[2;36m                    [0m         [39mList.class, Collection.class[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1132[0m[39m:                    detector = [0m[1;35mc.newInstance[0m[1;39m([0m[39mregistry, childDetectors, [0m        [2m                [0m
[2;36m                    [0m         [39mexcludeDetectors[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1133[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNoSuchMethodException me[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1134[0m[39m:                    [0m[35m/[0m[35m/[0m[95mswallow[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1135[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1136[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1137[0m[39m:            if [0m[1;39m([0m[39mdetector == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1138[0m[39m:                try [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1139[0m[39m:                    c = [0m[1;35mdetectorClass.getConstructor[0m[1;39m([0m[39mMediaTypeRegistry.class, [0m [2m                [0m
[2;36m                    [0m         [39mList.class[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:                    detector = [0m[1;35mc.newInstance[0m[1;39m([0m[39mregistry, childDetectors[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNoSuchMethodException me[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:                    [0m[35m/[0m[35m/[0m[95mswallow[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:            if [0m[1;39m([0m[39mdetector == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:                try [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:                    c = [0m[1;35mdetectorClass.getConstructor[0m[1;39m([0m[39mList.class[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:                    detector = [0m[1;35mc.newInstance[0m[1;39m([0m[39mchildDetectors[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNoSuchMethodException me[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:                    [0m[35m/[0m[35m/[0m[95mswallow[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:            return detector;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:        Detector [0m[1;35mdecorate[0m[1;39m([0m[39mDetector created, Element element[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:            return created; [0m[35m/[0m[35m/[0m[39m No decoration of Detectors[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/config/TikaConfig.jav[0m[1;92ma:654[0m[39m-[0m[1;36m869[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m654[0m[39m:    private static abstract class XmlLoader<CT, T> [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m655[0m[39m:        protected static final String PARAMS_TAG_NAME = [0m[32m"params"[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m656[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m657[0m[39m:        abstract boolean [0m[1;35msupportsComposite[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m658[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m659[0m[39m:        abstract String [0m[1;35mgetParentTagName[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m eg parsers[0m                       [2m                [0m
[2;36m                    [0m         [1;36m660[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m661[0m[39m:        abstract String [0m[1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m eg parser[0m                        [2m                [0m
[2;36m                    [0m         [1;36m662[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m663[0m[39m:        abstract Class<? extends T> [0m[1;35mgetLoaderClass[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m Generics workaround[0m    [2m                [0m
[2;36m                    [0m         [1;36m664[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m665[0m[39m:        abstract boolean [0m[1;35misComposite[0m[1;39m([0m[39mT loaded[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m666[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m667[0m[39m:        abstract boolean [0m[1;35misComposite[0m[1;39m([0m[39mClass<? extends T> loadedClass[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m668[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m669[0m[39m:        abstract T [0m[1;35mpreLoadOne[0m[1;39m([0m[39mClass<? extends T> loadedClass, String classname,[0m [2m                [0m
[2;36m                    [0m         [39mMimeTypes mimeTypes[0m[1;39m)[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m670[0m[39m:                throws TikaException;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m671[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m672[0m[39m:        abstract CT [0m[1;35mcreateDefault[0m[1;39m([0m[39mMimeTypes mimeTypes, ServiceLoader loader[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m673[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m674[0m[39m:        abstract CT [0m[1;35mcreateComposite[0m[1;39m([0m[39mList<T> loaded, MimeTypes mimeTypes, [0m       [2m                [0m
[2;36m                    [0m         [39mServiceLoader loader[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m675[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m676[0m[39m:        abstract T [0m[1;35mcreateComposite[0m[1;39m([0m[39mClass<? extends T> compositeClass, List<T> [0m  [2m                [0m
[2;36m                    [0m         [39mchildren,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m677[0m[39m:                                   Set<Class<? extends T>> excludeChildren,[0m     [2m                [0m
[2;36m                    [0m         [1;36m678[0m[39m:                                   Map<String, Param> params, MimeTypes [0m        [2m                [0m
[2;36m                    [0m         [39mmimeTypes,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m679[0m[39m:                                   ServiceLoader loader[0m[1;39m)[0m                        [2m                [0m
[2;36m                    [0m         [1;36m680[0m[39m:                throws InvocationTargetException, IllegalAccessException, [0m      [2m                [0m
[2;36m                    [0m         [39mInstantiationException;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m681[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m682[0m[39m:        abstract T [0m[1;35mdecorate[0m[1;39m([0m[39mT created, Element element[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m683[0m[39m:                throws IOException, TikaException; [0m[35m/[0m[35m/[0m[39m eg explicit mime types[0m    [2m                [0m
[2;36m                    [0m         [1;36m684[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m685[0m[39m:        @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m686[0m[39m:        CT [0m[1;35mloadOverall[0m[1;39m([0m[39mElement element, MimeTypes mimeTypes, ServiceLoader [0m     [2m                [0m
[2;36m                    [0m         [39mloader[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m687[0m[39m:                throws TikaException, IOException [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m688[0m[39m:            List<T> loaded = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m689[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m690[0m[39m:            [0m[35m/[0m[35m/[0m[39m Find the children of the parent tag, if any[0m                      [2m                [0m
[2;36m                    [0m         [1;36m691[0m[39m:            for [0m[1;39m([0m[39mElement le : [0m[1;35mgetTopLevelElementChildren[0m[1;39m([0m[39melement, [0m              [2m                [0m
[2;36m                    [0m         [1;35mgetParentTagName[0m[1;39m([0m[1;39m)[0m[39m,[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m692[0m[39m:                    [0m[1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m693[0m[39m:                T loadedChild = [0m[1;35mloadOne[0m[1;39m([0m[39mle, mimeTypes, loader[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m694[0m[39m:                if [0m[1;39m([0m[39mloadedChild != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m695[0m[39m:                    [0m[1;35mloaded.add[0m[1;39m([0m[39mloadedChild[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m696[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m697[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m698[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m699[0m[39m:            [0m[35m/[0m[35m/[0m[39m Build the classes, and wrap as needed[0m                            [2m                [0m
[2;36m                    [0m         [1;36m700[0m[39m:            if [0m[1;39m([0m[1;35mloaded.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m701[0m[39m:                [0m[35m/[0m[35m/[0m[39m Nothing defined, create a Default[0m                            [2m                [0m
[2;36m                    [0m         [1;36m702[0m[39m:                return [0m[1;35mcreateDefault[0m[1;39m([0m[39mmimeTypes, loader[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m703[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mloaded.size[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m704[0m[39m:                T single = [0m[1;35mloaded.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m705[0m[39m:                if [0m[1;39m([0m[1;35misComposite[0m[1;39m([0m[39msingle[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Single Composite defined, use that[0m                       [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:                    return [0m[1;39m([0m[39mCT[0m[1;39m)[0m[39m single;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m![0m[1;35msupportsComposite[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:                throw new [0m[1;35mTikaConfigException[0m[1;39m([0m                                  [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:                        [0m[32m"Composite not supported for "[0m[39m + [0m[1;35mgetParentTagName[0m[1;39m([0m[1;39m)[0m[39m +[0m   [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:                                [0m[32m". Must specify only one child!"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:            [0m[35m/[0m[35m/[0m[39m Wrap the defined parsers/detectors up in a Composite[0m             [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:            return [0m[1;35mcreateComposite[0m[1;39m([0m[39mloaded, mimeTypes, loader[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:        T [0m[1;35mloadOne[0m[1;39m([0m[39mElement element, MimeTypes mimeTypes, ServiceLoader loader[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:                throws TikaException, IOException [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            String name = [0m[1;35melement.getAttribute[0m[1;39m([0m[32m"class"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:            if [0m[1;39m([0m[1;35mname.isBlank[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:                throw new [0m[1;35mTikaConfigException[0m[1;39m([0m[32m"class attribute must not be [0m     [2m                [0m
[2;36m                    [0m         [32mempty: "[0m[39m + element[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:            String initProbHandler = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35melement.getAttribute[0m[1;39m([0m[32m"initializableProblemHandler"[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:            InitializableProblemHandler initializableProblemHandler;[0m            [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:            if [0m[1;39m([0m[1;35minitProbHandler.isBlank[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:                initializableProblemHandler = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mloader.getInitializableProblemHandler[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:                initializableProblemHandler = [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mgetInitializableProblemHandler[0m[1;39m([0m[39minitProbHandler[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:            T loaded;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:                Class<? extends T> loadedClass = [0m                               [2m                [0m
[2;36m                    [0m         [1;35mloader.getServiceClass[0m[1;39m([0m[1;35mgetLoaderClass[0m[1;39m([0m[1;39m)[0m[39m, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:                [0m[35m/[0m[35m/[0m[39m Do pre-load checks and short-circuits[0m                        [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[35m/[0m[35m/[0m[95mTODO[0m[39m : allow duplicate instances with different [0m              [2m                [0m
[2;36m                    [0m         [39mconfigurations[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:                loaded = [0m[1;35mpreLoadOne[0m[1;39m([0m[39mloadedClass, name, mimeTypes[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:                if [0m[1;39m([0m[39mloaded != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:                    return loaded;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:                [0m[35m/[0m[35m/[0m[39m Get any parameters [0m[35m/[0m[39m settings for the parser[0m                 [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:                Map<String, Param> params = null;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:                try [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:                    params = [0m[1;35mgetParams[0m[1;39m([0m[39melement[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:                    throw new [0m[1;35mTikaConfigException[0m[1;39m([0m[1;35me.getMessage[0m[1;39m([0m[1;39m)[0m[39m, e[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:                [0m[35m/[0m[35m/[0m[39m Is this a composite or decorated class? If so, support [0m      [2m                [0m
[2;36m                    [0m         [39mrecursion[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:                if [0m[1;39m([0m[1;35misComposite[0m[1;39m([0m[39mloadedClass[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Get the child objects for it[0m                             [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:                    List<T> children = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:                    NodeList childNodes = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35melement.getElementsByTagName[0m[1;39m([0m[1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:                    if [0m[1;39m([0m[1;35mchildNodes.getLength[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:                        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mchildNodes.getLength[0m[1;39m([0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:                            T loadedChild =[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:                                    [0m[1;35mloadOne[0m[1;39m([0m[1;39m([0m[39mElement[0m[1;39m)[0m[39m [0m[1;35mchildNodes.item[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mmimeTypes, loader[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:                            if [0m[1;39m([0m[39mloadedChild != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:                                [0m[1;35mchildren.add[0m[1;39m([0m[39mloadedChild[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Get the list of children to exclude[0m                      [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:                    Set<Class<? extends T>> excludeChildren = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:                    NodeList excludeChildNodes =[0m                                [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:                            [0m[1;35melement.getElementsByTagName[0m[1;39m([0m[1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [32m"-exclude"[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:                    if [0m[1;39m([0m[1;35mexcludeChildNodes.getLength[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:                        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mexcludeChildNodes.getLength[0m[1;39m([0m[1;39m)[0m[39m; i++[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:                            Element excl = [0m[1;39m([0m[39mElement[0m[1;39m)[0m[39m [0m[1;35mexcludeChildNodes.item[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:                            String exclName = [0m[1;35mexcl.getAttribute[0m[1;39m([0m[32m"class"[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:                            try [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:                                excludeChildren[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:                                        [0m                                        [2m                [0m
[2;36m                    [0m         [1;35m.add[0m[1;39m([0m[1;35mloader.getServiceClass[0m[1;39m([0m[1;35mgetLoaderClass[0m[1;39m([0m[1;39m)[0m[39m, exclName[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:                            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mClassNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:                                [0m[35m/[0m[35m/[0m[95mTIKA-3268[0m[39m -- This should stop the world.[0m      [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:                                throw new [0m[1;35mTikaConfigException[0m[1;39m([0m                  [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:                                        [0m[32m"Class not found in -exclude list: "[0m[39m + [0m [2m                [0m
[2;36m                    [0m         [39mexclName[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Create the Composite[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:                    loaded = [0m[1;35mcreateComposite[0m[1;39m([0m[39mloadedClass, children, [0m            [2m                [0m
[2;36m                    [0m         [39mexcludeChildren, params,[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:                            mimeTypes, loader[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Default constructor fallback[0m                             [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:                    if [0m[1;39m([0m[39mloaded == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:                        loaded = [0m[1;35mnewInstance[0m[1;39m([0m[39mloadedClass[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Regular class, create as-is[0m                              [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:                    loaded = [0m[1;35mnewInstance[0m[1;39m([0m[39mloadedClass[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:                    [0m[35m/[0m[35m/[0m[39m TODO Support arguments, needed for Translators etc[0m       [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:                    [0m[35m/[0m[35m/[0m[39m See the thread [0m[32m"Configuring parsers and translators"[0m[39m for[0m [2m                [0m
[2;36m                    [0m         [39mdetails[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:                [0m[35m/[0m[35m/[0m[95mAssigning[0m[39m the params to bean fields/setters[0m                   [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:                [0m[1;35mAnnotationUtils.assignFieldParams[0m[1;39m([0m[39mloaded, params[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:                if [0m[1;39m([0m[39mloaded instanceof Initializable[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:                    [0m[1;39m([0m[1;39m([0m[39mInitializable[0m[1;39m)[0m[39m loaded[0m[1;39m)[0m[1;35m.initialize[0m[1;39m([0m[39mparams[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:                    [0m[1;39m([0m[1;39m([0m[39mInitializable[0m[1;39m)[0m[39m [0m                                           [2m                [0m
[2;36m                    [0m         [39mloaded[0m[1;39m)[0m[1;35m.checkInitialization[0m[1;39m([0m[39minitializableProblemHandler[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:                [0m[35m/[0m[35m/[0m[39m Have any decoration performed, eg explicit mimetypes[0m         [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:                loaded = [0m[1;35mdecorate[0m[1;39m([0m[39mloaded, element[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:                [0m[35m/[0m[35m/[0m[39m All done with setup[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:                return loaded;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mClassNotFoundException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:                if [0m[1;39m([0m[1;35mloader.getLoadErrorHandler[0m[1;39m([0m[1;39m)[0m[39m == LoadErrorHandler.THROW[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:                    [0m[35m/[0m[35m/[0m[39m Use a different exception signature here[0m                 [2m                [0m
[2;36m                    [0m         [1;36m814[0m[39m:                    throw new [0m[1;35mTikaConfigException[0m[1;39m([0m                              [2m                [0m
[2;36m                    [0m         [1;36m815[0m[39m:                            [0m[32m"Unable to find a "[0m[39m + [0m[1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" class:[0m [2m                [0m
[2;36m                    [0m         [32m"[0m[39m + name, e[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m816[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m817[0m[39m:                [0m[35m/[0m[35m/[0m[39m Report the problem[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m818[0m[39m:                [0m[1;35mloader.getLoadErrorHandler[0m[1;39m([0m[1;39m)[0m[1;35m.handleLoadError[0m[1;39m([0m[39mname, e[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m819[0m[39m:                return null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m820[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalAccessException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m821[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m                                        [2m                [0m
[2;36m                    [0m         [1;36m822[0m[39m:                        [0m[32m"Unable to access a "[0m[39m + [0m[1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" class: "[0m [2m                [0m
[2;36m                    [0m         [39m+ name, e[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m823[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInvocationTargetException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m824[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m                                        [2m                [0m
[2;36m                    [0m         [1;36m825[0m[39m:                        [0m[32m"Unable to create a "[0m[39m + [0m[1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" class: "[0m [2m                [0m
[2;36m                    [0m         [39m+ name, e[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m826[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mInstantiationException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m827[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m                                        [2m                [0m
[2;36m                    [0m         [1;36m828[0m[39m:                        [0m[32m"Unable to instantiate a "[0m[39m + [0m[1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m" [0m    [2m                [0m
[2;36m                    [0m         [32mclass: "[0m[39m + name, e[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m829[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNoSuchMethodException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m830[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m                                        [2m                [0m
[2;36m                    [0m         [1;36m831[0m[39m:                        [0m[32m"Unable to find the right constructor for "[0m[39m + [0m          [2m                [0m
[2;36m                    [0m         [1;35mgetLoaderTagName[0m[1;39m([0m[1;39m)[0m[39m +[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m832[0m[39m:                                [0m[32m" class: "[0m[39m + name, e[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m833[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m834[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m835[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m836[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m837[0m[39m:        T [0m[1;35mnewInstance[0m[1;39m([0m[39mClass<? extends T> loadedClass[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m838[0m[39m:                throws IllegalAccessException, InstantiationException, [0m         [2m                [0m
[2;36m                    [0m         [39mNoSuchMethodException,[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m839[0m[39m:                InvocationTargetException [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m840[0m[39m:            return [0m[1;35mloadedClass.getDeclaredConstructor[0m[1;39m([0m[1;39m)[0m[1;35m.newInstance[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m841[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m842[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m843[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m844[0m[39m:         * Gets parameters from a given[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m845[0m[39m:         *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m846[0m[39m:         * @param el xml node which has [0m[1;39m{[0m[39m@link #PARAMS_TAG_NAME[0m[1;39m}[0m[39m child[0m          [2m                [0m
[2;36m                    [0m         [1;36m847[0m[39m:         * @return Map of key values read from xml[0m                              [2m                [0m
[2;36m                    [0m         [1;36m848[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m849[0m[39m:        Map<String, Param> [0m[1;35mgetParams[0m[1;39m([0m[39mElement el[0m[1;39m)[0m[39m throws TikaException [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m850[0m[39m:            Map<String, Param> params = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m851[0m[39m:            for [0m[1;39m([0m[39mNode child = [0m[1;35mel.getFirstChild[0m[1;39m([0m[1;39m)[0m[39m; child != null; child = [0m       [2m                [0m
[2;36m                    [0m         [1;35mchild.getNextSibling[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m852[0m[39m:                if [0m[1;39m([0m[1;35mPARAMS_TAG_NAME.equals[0m[1;39m([0m[1;35mchild.getNodeName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[95mfound[0m[39m the [0m [2m                [0m
[2;36m                    [0m         [39mnode[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m853[0m[39m:                    if [0m[1;39m([0m[1;35mchild.hasChildNodes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m[39m [0m[35m/[0m[35m/[0m[95mit[0m[39m has children[0m              [2m                [0m
[2;36m                    [0m         [1;36m854[0m[39m:                        NodeList childNodes = [0m[1;35mchild.getChildNodes[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m855[0m[39m:                        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < [0m[1;35mchildNodes.getLength[0m[1;39m([0m[1;39m)[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m856[0m[39m:                            Node item = [0m[1;35mchildNodes.item[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m857[0m[39m:                            if [0m[1;39m([0m[1;35mitem.getNodeType[0m[1;39m([0m[1;39m)[0m[39m == Node.ELEMENT_NODE[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m858[0m[39m:                                Param<?> param = [0m[1;35mParam.load[0m[1;39m([0m[39mitem[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m859[0m[39m:                                [0m[1;35mparams.put[0m[1;39m([0m[1;35mparam.getName[0m[1;39m([0m[1;39m)[0m[39m, param[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m860[0m[39m:                            [0m[1;39m}[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m861[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m862[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m863[0m[39m:                    break; [0m[35m/[0m[35m/[0m[95monly[0m[39m the first one is used[0m                         [2m                [0m
[2;36m                    [0m         [1;36m864[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m865[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m866[0m[39m:            return params;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m867[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m868[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m869[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/resources[0m [2m                [0m
[2;36m                    [0m         [39m/org/apache/tika/config/TIKA-[0m[1;36m1702[0m[39m-detector-exclude.xml:[0m[1;36m17[0m[39m-[0m[1;36m30[0m                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:-->[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:<properties>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  <!-- Explicitly request default parsers -->[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:  <parsers/>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  <detectors>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    <!-- All detectors except built-in container ones -->[0m                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:    <detector [0m[33mclass[0m[39m=[0m[32m"org[0m[32m.apache.tika.detect.DefaultDetector"[0m[39m>[0m                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:      <detector-exclude [0m                                                         [2m                [0m
[2;36m                    [0m         [33mclass[0m[39m=[0m[32m"org[0m[32m.apache.tika.detect.zip.DefaultZipContainerDetector"[0m[35m/[0m[39m>[0m                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:      <detector-exclude [0m                                                         [2m                [0m
[2;36m                    [0m         [33mclass[0m[39m=[0m[32m"org[0m[32m.apache.tika.detect.microsoft.POIFSContainerDetector"[0m[35m/[0m[39m>[0m                   [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    <[0m[35m/[0m[95mdetector[0m[39m>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    <!-- One other detector, to check ordering -->[0m                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    <detector [0m[33mclass[0m[39m=[0m[32m"org[0m[32m.apache.tika.detect.EmptyDetector"[0m[39m>[0m                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    <[0m[35m/[0m[95mdetector[0m[39m>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:  <[0m[35m/[0m[95mdetectors[0m[39m>[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/resources[0m [2m                [0m
[2;36m                    [0m         [39m/org/apache/tika/config/TIKA-[0m[1;36m1702[0m[39m-detector-exclude.xml:[0m[1;36m1[0m[39m-[0m[1;36m31[0m                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:<?xml [0m[33mversion[0m[39m=[0m[32m"1[0m[32m.0"[0m[39m [0m[33mencoding[0m[39m=[0m[32m"UTF[0m[32m-8"[0m[39m?>[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:<!--[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:  Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:  contributor license agreements.  See the NOTICE file distributed with[0m           [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:  this work for additional information regarding copyright ownership.[0m             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:  The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m         [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:  [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:  the License.  You may obtain a copy of the License at[0m                           [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:  [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:  Unless required by applicable law or agreed to in writing, software[0m            [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:  distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m              [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:  See the License for the specific language governing permissions and[0m            [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:  limitations under the License.[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:-->[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:<properties>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:  <!-- Explicitly request default parsers -->[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:  <parsers/>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:  <detectors>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:    <!-- All detectors except built-in container ones -->[0m                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:    <detector [0m[33mclass[0m[39m=[0m[32m"org[0m[32m.apache.tika.detect.DefaultDetector"[0m[39m>[0m                    [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:      <detector-exclude [0m                                                         [2m                [0m
[2;36m                    [0m         [33mclass[0m[39m=[0m[32m"org[0m[32m.apache.tika.detect.zip.DefaultZipContainerDetector"[0m[35m/[0m[39m>[0m                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:      <detector-exclude [0m                                                         [2m                [0m
[2;36m                    [0m         [33mclass[0m[39m=[0m[32m"org[0m[32m.apache.tika.detect.microsoft.POIFSContainerDetector"[0m[35m/[0m[39m>[0m                   [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:    <[0m[35m/[0m[95mdetector[0m[39m>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    <!-- One other detector, to check ordering -->[0m                               [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    <detector [0m[33mclass[0m[39m=[0m[32m"org[0m[32m.apache.tika.detect.EmptyDetector"[0m[39m>[0m                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    <[0m[35m/[0m[95mdetector[0m[39m>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:  <[0m[35m/[0m[95mdetectors[0m[39m>[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:<[0m[35m/[0m[95mproperties[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-package/src/test/java/org/[0m [2m                [0m
[2;36m                    [0m         [39mapache/tika/config/TikaDetectorConfigTest.jav[0m[1;92ma:40[0m[39m-[0m[1;36m72[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class TikaDetectorConfigTest extends AbstractTikaConfigTest [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    @Test[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    public void [0m[1;35mtestDetectorExcludeFromDefault[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:        TikaConfig config = [0m[1;35mgetConfig[0m[1;39m([0m[32m"TIKA-1702-detector-exclude.xml"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[1;35mconfig.getParser[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[1;35mconfig.getDetector[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        CompositeDetector detector = [0m[1;39m([0m[39mCompositeDetector[0m[1;39m)[0m[39m [0m[1;35mconfig.getDetector[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[35m/[0m[35m/[0m[39m Should be wrapping two detectors[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m2[0m[39m, [0m[1;35mdetector.getDetectors[0m[1;39m([0m[1;39m)[0m[1;35m.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        [0m[35m/[0m[35m/[0m[39m First should be DefaultDetector, second Empty, that order[0m             [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mDefaultDetector.class, [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mdetector.getDetectors[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[1;35m.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[39mEmptyDetector.class, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdetector.getDetectors[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[1;35m.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[35m/[0m[35m/[0m[39m Get the DefaultDetector from the config[0m                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        DefaultDetector confDetector = [0m[1;39m([0m[39mDefaultDetector[0m[1;39m)[0m[39m [0m                        [2m                [0m
[2;36m                    [0m         [1;35mdetector.getDetectors[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[35m/[0m[35m/[0m[39m Get a fresh [0m[32m"default"[0m[39m DefaultParser[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        DefaultDetector normDetector = new [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mDefaultDetector[0m[1;39m([0m[1;35mconfig.getMimeRepository[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[35m/[0m[35m/[0m[39m The default one will offer the Zip and POIFS detectors[0m                [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35massertDetectors[0m[1;39m([0m[39mnormDetector, true, true[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[35m/[0m[35m/[0m[39m The one from the config won't, as we excluded those[0m                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35massertDetectors[0m[1;39m([0m[39mconfDetector, false, false[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-micros[0m [2m                [0m
[2;36m                    [0m         [39moft-module/src/main/java/org/apache/tika/parser/microsoft/libpst/LibPstParser.jav[0m[1;92ma:[0m [2m                [0m
[2;36m                    [0m         [1;92m132[0m[39m-[0m[1;36m161[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    private ProcessBuilder [0m[1;35mgetProcessBuilder[0m[1;39m([0m[39mPath pst, LibPstParserConfig [0m      [2m                [0m
[2;36m                    [0m         [39mconfig, Path outDir, Path debugFile[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:            throws TikaConfigException [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        List commands = new ArrayList<String>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:        [0m[1;35mcommands.add[0m[1;39m([0m[1;35mgetFullReadPstCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:        if [0m[1;39m([0m[1;35mconfig.isDebug[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mcommands.add[0m[1;39m([0m[32m"-d"[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mcommands.add[0m[1;39m([0m[1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[39mdebugFile[0m               [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                    [0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                    [0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        if [0m[1;39m([0m[1;35mconfig.isIncludeDeleted[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mcommands.add[0m[1;39m([0m[32m"-D"[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:        if [0m[1;39m([0m[1;35mconfig.isProcessEmailAsMsg[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            [0m[1;35mcommands.add[0m[1;39m([0m[32m"-m"[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[35m/[0m[35m/[0m[95minclude[0m[39m .eml and include extensions[0m                               [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            [0m[1;35mcommands.add[0m[1;39m([0m[32m"-e"[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        [0m[1;35mcommands.add[0m[1;39m([0m[32m"-o"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:        [0m[1;35mcommands.add[0m[1;39m([0m[1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[39moutDir[0m                      [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                [0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                [0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        [0m[1;35mcommands.add[0m[1;39m([0m[1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[39mpst[0m                         [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:                [0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                [0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        [0m[1;35mLOGGER.debug[0m[1;39m([0m[32m"command arguments: "[0m[39m + commands[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        return new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcommands[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.jav[0m[1;92ma:87[0m[39m-[0m[1;36m110[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m test for no-arg shell script[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        TikaInputStream tis = [0m                                                   [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mCloseShieldInputStream.wrap[0m[1;39m([0m[39minput[0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        fileName = [0m[1;35mFilenameUtils.getName[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"[0m[32m[[0m[32m^-_0-9A-Za-z.[0m[32m][0m[32m+"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        fileName = [0m[1;35mfileName.replaceAll[0m[1;39m([0m[32m"\\.\\."[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        if [0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m > MAX_LENGTH[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            fileName = [0m[1;35mfileName.substring[0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m - MAX_LENGTH[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        Path cwd = [0m[1;35mPaths.get[0m[1;39m([0m[32m"."[0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        Path tmpDir = [0m[1;35mFiles.createTempDirectory[0m[1;39m([0m[39mcwd, [0m[32m"tika-shell-detect-"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        Path tmpFile = [0m[1;35mtmpDir.resolve[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mFiles.copy[0m[1;39m([0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m, tmpFile, StandardCopyOption.REPLACE_EXISTING[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[1;35mpb.directory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            FileProcessResult result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mpb, [0m[1;36m20000[0m[39m, [0m[1;36m100000[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [1;36m100000[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            if [0m[1;39m([0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mSHELL_NO_ARGS, true[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;35mFileUtils.deleteDirectory[0m[1;39m([0m[1;35mtmpDir.toFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        return SHELL_SCRIPT;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the evaluation report and code snippets, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the OS Command Injection vulnerability in Apache Tika:[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mThe `[0m[1;35mShellCodeDetector.detect[0m[1;39m([0m[1;39m)[0m[39m` method attempts to determine if a shell script can[0m [2m                [0m
[2;36m                    [0m         [39mrun without arguments by:[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Taking a filename from metadata [0m[1;39m([0m[39mwhich comes from untrusted archive entries[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Sanitizing the filename [0m[1;39m([0m[39mlines [0m[1;36m89[0m[39m-[0m[1;36m95[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Creating a ProcessBuilder with the sanitized filename [0m[1;39m([0m[39mline [0m[1;36m100[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Executing it as a system command [0m[1;39m([0m[39mline [0m[1;36m103[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**The Critical Flaw:**[0m                                                              [2m                [0m
[2;36m                    [0m         [39mAt line [0m[1;36m100[0m[39m, `new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[39m` uses the filename as a command name. [0m   [2m                [0m
[2;36m                    [0m         [39mEven after sanitization, simple alphanumeric strings like [0m[32m"ls"[0m[39m, [0m[32m"cat"[0m[39m, [0m[32m"id"[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [32m"whoami"[0m[39m pass through the filters. The ProcessBuilder searches the system PATH for [0m [2m                [0m
[2;36m                    [0m         [39mexecutables matching this name, allowing execution of arbitrary system commands [0m    [2m                [0m
[2;36m                    [0m         [39mwhen an attacker crafts archive files with entries named after common system [0m       [2m                [0m
[2;36m                    [0m         [39mutilities.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why Previous Sanitization is Insufficient:**[0m                                      [2m                [0m
[2;36m                    [0m         [39mThe regex `[0m[1;39m[[0m[39m^-_0-9A-Za-z.[0m[1;39m][0m[39m+` on line [0m[1;36m90[0m[39m allows all alphanumeric characters, dots, [0m  [2m                [0m
[2;36m                    [0m         [39mhyphens, and underscores - which includes virtually all common Unix command names. [0m [2m                [0m
[2;36m                    [0m         [39mThe intent was likely to execute the extracted file itself, but ProcessBuilder [0m     [2m                [0m
[2;36m                    [0m         [39msearches PATH first, making this a critical security vulnerability.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Design Problem:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39mThe fundamental issue is that ShellCodeDetector, as a **detector**, should only [0m    [2m                [0m
[2;36m                    [0m         [39manalyze file content to determine file types - it should never execute files or [0m    [2m                [0m
[2;36m                    [0m         [39msystem commands. This violates the principle that detectors should be [0m              [2m                [0m
[2;36m                    [0m         [39mside-effect-free content analyzers. The feature it attempts to provide [0m[1;39m([0m[39mdetecting [0m  [2m                [0m
[2;36m                    [0m         [39mif shell scripts run without arguments[0m[1;39m)[0m[39m is inappropriate for a detector and creates[0m [2m                [0m
[2;36m                    [0m         [39man unacceptable security risk.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Disable Command Execution in ShellCodeDetector[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Approach:**[0m                                                                       [2m                [0m
[2;36m                    [0m         [39mRemove the command execution functionality entirely from the `[0m[1;35mdetect[0m[1;39m([0m[1;39m)[0m[39m` method [0m     [2m                [0m
[2;36m                    [0m         [39mwhile preserving the basic shell script detection capability. The detector should [0m  [2m                [0m
[2;36m                    [0m         [39monly identify shell scripts based on:[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. File extension analysis [0m[1;39m([0m[39m.sh, .bash[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Shebang line detection [0m[1;39m([0m[39m#![0m[35m/[0m[95m...[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis maintains the detector's core purpose [0m[1;39m([0m[39midentifying shell scripts[0m[1;39m)[0m[39m while [0m       [2m                [0m
[2;36m                    [0m         [39meliminating the security vulnerability.[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Implementation Steps:**[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Modify `[0m[1;35mShellCodeDetector.detect[0m[1;39m([0m[1;39m)[0m[39m` method** [0m                                  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mtika-core/src/main/java/org/apache/tika/detect/ShellCodeDetector.java[0m[1;39m)[0m[39m:[0m            [2m                [0m
[2;36m                    [0m         [39m   - Keep lines [0m[1;36m54[0m[39m-[0m[1;36m86[0m[39m which perform safe detection:[0m                                 [2m                [0m
[2;36m                    [0m         [39m     - Extension checking for .sh/.bash files[0m                                       [2m                [0m
[2;36m                    [0m         [39m     - Shebang line detection by reading file header[0m                                [2m                [0m
[2;36m                    [0m         [39m   - Remove lines [0m[1;36m87[0m[39m-[0m[1;36m110[0m[39m completely [0m[1;39m([0m[39mthe entire command execution block[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m   - After determining `isShell` status from safe checks, return the appropriate [0m   [2m                [0m
[2;36m                    [0m         [39mMediaType[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - Remove the SHELL_NO_ARGS metadata field logic since it requires execution[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Update the return logic**:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - After line [0m[1;36m82[0m[39m, if `isShell` is true, return `SHELL_SCRIPT` directly[0m            [2m                [0m
[2;36m                    [0m         [39m   - If `isShell` is false, return `MediaType.OCTET_STREAM`[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Remove the dependency on fileName being present for the return value[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Remove unused imports and fields**:[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Remove imports related to file operations that are no longer needed:[0m           [2m                [0m
[2;36m                    [0m         [39m     - `java.nio.file.StandardCopyOption`[0m                                           [2m                [0m
[2;36m                    [0m         [39m     - `org.apache.commons.io.FileUtils`[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Remove the `SHELL_NO_ARGS` Property field if it's defined in this class[0m        [2m                [0m
[2;36m                    [0m         [39m   - Keep all imports needed for the safe detection logic [0m[1;39m([0m[39mIOUtils, [0m                [2m                [0m
[2;36m                    [0m         [39mTikaInputStream, etc.[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Preserve existing detection logic**:[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Keep the extension-based detection [0m[1;39m([0m[39mlines [0m[1;36m56[0m[39m-[0m[1;36m62[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m   - Keep the shebang detection [0m[1;39m([0m[39mlines [0m[1;36m67[0m[39m-[0m[1;36m79[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Keep the mark/reset stream handling [0m[1;39m([0m[39mlines [0m[1;36m68[0m[39m, [0m[1;36m78[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Keep proper exception handling for EOFException [0m[1;39m([0m[39mlines [0m[1;36m75[0m[39m-[0m[1;36m76[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Rationale[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this is the optimal approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Security First**: Completely eliminates the command injection vulnerability by[0m [2m                [0m
[2;36m                    [0m         [39mremoving all command execution code.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserves Core Functionality**: The detector can still identify shell scripts [0m [2m                [0m
[2;36m                    [0m         [39mthrough:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - File extensions [0m[1;39m([0m[39m.sh, .bash[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - Content analysis [0m[1;39m([0m[39mshebang lines[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m   This covers the vast majority of legitimate shell script detection use cases.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **No Breaking Changes**: [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - The detector still returns `SHELL_SCRIPT` MediaType for shell scripts[0m          [2m                [0m
[2;36m                    [0m         [39m   - The detector interface remains unchanged[0m                                       [2m                [0m
[2;36m                    [0m         [39m   - Existing code using the detector continues to work[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Only the SHELL_NO_ARGS metadata field is lost, which is a minor feature[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Minimal Code Changes**: Only modifies the vulnerable ShellCodeDetector class, [0m [2m                [0m
[2;36m                    [0m         [39mno changes to:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - Parser infrastructure[0m                                                          [2m                [0m
[2;36m                    [0m         [39m   - Detector framework[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - Configuration system[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Service registration[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **No Configuration Required**: Unlike the workaround of excluding [0m               [2m                [0m
[2;36m                    [0m         [39mShellCodeDetector via XML config, this fix applies automatically to all [0m            [2m                [0m
[2;36m                    [0m         [39minstallations.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Follows Best Practices**: Detectors should analyze content, not execute it. [0m   [2m                [0m
[2;36m                    [0m         [39mThis aligns with how other safe detectors like MagicDetector work.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Alternative Approaches Considered and Rejected[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Improving Sanitization**: Cannot work because any alphanumeric string might [0m   [2m                [0m
[2;36m                    [0m         [39mmatch a system command. There's no safe way to execute arbitrary filenames as [0m      [2m                [0m
[2;36m                    [0m         [39mcommands.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Excluding from Default Configuration**: Would require all users to manually [0m   [2m                [0m
[2;36m                    [0m         [39mconfigure, leaving many installations vulnerable. Also doesn't address the [0m         [2m                [0m
[2;36m                    [0m         [39mfundamental design flaw.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Executing with Full Path**: Using `[0m[1;35mtmpDir.resolve[0m[1;39m([0m[39mfileName[0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[39m` in [0m    [2m                [0m
[2;36m                    [0m         [39mProcessBuilder would still execute the extracted file, which could contain [0m         [2m                [0m
[2;36m                    [0m         [39mmalicious shell code. This doesn't eliminate the security risk, it just changes the[0m [2m                [0m
[2;36m                    [0m         [39mattack vector.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Sandboxing Execution**: Would add significant complexity and platform [0m         [2m                [0m
[2;36m                    [0m         [39mdependencies, still introduces security risks, and is inappropriate for a detector.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Expected Side Effects and Mitigation[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Lost Functionality:**[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- The SHELL_NO_ARGS metadata field will no longer be set[0m                            [2m                [0m
[2;36m                    [0m         [39m- This is an obscure feature that likely has minimal usage[0m                          [2m                [0m
[2;36m                    [0m         [39m- The core functionality of detecting shell scripts is preserved[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- If users need to determine if shell scripts require arguments, this should be:[0m    [2m                [0m
[2;36m                    [0m         [39m  - Part of a parser, not a detector[0m                                                [2m                [0m
[2;36m                    [0m         [39m  - Explicitly opt-in due to security implications[0m                                  [2m                [0m
[2;36m                    [0m         [39m  - Properly sandboxed with appropriate warnings[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Testing Impact:**[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- Any tests specifically checking SHELL_NO_ARGS metadata will need updates[0m          [2m                [0m
[2;36m                    [0m         [39m- Tests for basic shell script detection should continue to pass[0m                    [2m                [0m
[2;36m                    [0m         [39m- The security vulnerability test [0m[1;39m([0m[39mfrom the fuzzer[0m[1;39m)[0m[39m will pass[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Patterns in Codebase[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe MagicDetector [0m[1;39m([0m[39manalyzed in code snippets[0m[1;39m)[0m[39m demonstrates the correct pattern for [0m [2m                [0m
[2;36m                    [0m         [39mdetectors:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- Only analyzes stream content[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- Uses mark/reset for stream preservation[0m                                           [2m                [0m
[2;36m                    [0m         [39m- No external process execution[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- No side effects beyond stream reading[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mShellCodeDetector should follow this same safe pattern.[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=934397;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=948533;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=706352;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=834896;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp_gm3z90z[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-full-01_vuln_8/[0m[95magent-[0m [2m               [0m
[2;36m                    [0m         [95moutput-1768304500.3251798[0m                                                            [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-full-01_vuln_8.toml  [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 11:41:42][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mtika[0m           ]8;id=674290;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=697386;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=278637;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=717431;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=170451;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=164185;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
