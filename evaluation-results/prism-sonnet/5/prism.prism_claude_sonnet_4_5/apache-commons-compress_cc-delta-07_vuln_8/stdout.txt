[2;36m[01/12/26 18:33:32][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=177119;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=688695;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp85o9txj6[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-07_vuln_8/[0m[95magent-output-1768242812.2224855[0m                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-delta-07_vuln_8.toml     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN        ]8;id=305777;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=821734;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Started[33m...[0m                                                        [2m                     [0m
[2;36m[01/12/26 18:34:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Building Cached for CLEAN       ]8;id=271230;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=815057;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         environment[1m)[0m Took [1;36m68.44[0m seconds; [33mexception[0m=[3;91mFalse[0m                              [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for     ]8;id=89855;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=765616;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Started[33m...[0m                                                  [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running tests for Cached for    ]8;id=185254;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=506294;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         CLEAN environment[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                         [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=40445;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=307167;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m68[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=938044;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=116926;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 18:34:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.84[0m        ]8;id=237761;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=1612;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/12/26 18:34:42][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=457451;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=211763;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=802735;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=781126;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=548131;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=602559;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=701119;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=51799;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 18:34:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m1.09[0m        ]8;id=428802;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=485860;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/12/26 18:34:44][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=811392;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=161358;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 18:34:45][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.87[0m        ]8;id=495737;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=780454;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/12/26 18:34:50][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=173677;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=467717;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp8837158020849378687/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.copyMismatchMvHook[0m[1m([0mFilePa [2m                [0m
[2;36m                    [0m         thTraversal.jav[1;92ma:211[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:502[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:412[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:336[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:216[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 7bb3f9683ba8f59b                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp8837158020849378687/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.copyMismatchMvHook[0m[1m([0mFilePa [2m                [0m
[2;36m                    [0m         thTraversal.jav[1;92ma:211[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:502[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:412[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:336[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:216[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 7bb3f9683ba8f59b                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/12/26 18:35:07][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=195228;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=467652;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 18:39:43][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=844734;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=748724;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/12/26 18:40:16][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=387660;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=650255;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=198334;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=168904;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 18:40:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.98[0m        ]8;id=818667;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=618794;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/12/26 18:40:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Started[33m...[0m             ]8;id=22968;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=113165;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpr_zy3lxx[0m                                                 ]8;id=404798;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=196314;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/12/26 18:40:52][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Patching[1m)[0m Took [1;36m34.04[0m seconds;   ]8;id=357789;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=889552;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Started[33m...[0m       ]8;id=501626;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=836104;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 18:41:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Checking build[1m)[0m Took [1;36m20.35[0m      ]8;id=778104;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=516232;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Started[33m...[0m          ]8;id=678573;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=689164;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 18:41:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Running PoV[1m)[0m Took [1;36m5.16[0m seconds; ]8;id=187341;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=759115;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Started[33m...[0m              ]8;id=849251;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=318617;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Testing[1m)[0m Took [1;36m0.00[0m seconds;     ]8;id=766996;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=357423;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=336929;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=662118;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 18:41:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.87[0m        ]8;id=630744;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=910601;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m[01/12/26 18:41:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=318231;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=854024;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 18:41:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.94[0m        ]8;id=13890;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=954679;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Started[33m...[0m        ]8;id=648228;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=109412;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/12/26 18:41:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mapache-commons-compress Setting owner[1m)[0m Took [1;36m0.95[0m        ]8;id=25030;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=364007;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=990728;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=35575;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/main/java/org/apache/commons/compress/archivers/examples/Expander.java    [2m                [0m
[2;36m                    [0m         +++ b/src/main/java/org/apache/commons/compress/archivers/examples/Expander.java    [2m                [0m
[2;36m                    [0m         @@ [1;36m-477[0m,[1;36m8[0m +[1;36m477[0m,[1;36m16[0m @@                                                                [2m                [0m
[2;36m                    [0m                      if [1m([0m[1;35mzae.isUnixSymlink[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                                             [2m                [0m
[2;36m                    [0m                          String targetName = [1;35mIOUtils.toString[0m[1m([0m[1;35marchive.getInputStream[0m[1m([0mzae[1m)[0m,  [2m                [0m
[2;36m                    [0m                                  StandardCharsets.UTF_8[1m)[0m;                                   [2m                [0m
[2;36m                    [0m         -                Path link = [1;35mtargetDirectory.resolve[0m[1m([0m[1;35mzae.getName[0m[1m([0m[1m)[0m[1m)[0m;                [2m                [0m
[2;36m                    [0m         -                Path target = [1;35mtargetDirectory.resolve[0m[1m([0mtargetName[1m)[0m;                 [2m                [0m
[2;36m                    [0m         +                Path link = [1;35mtargetDirectory.resolve[0m[1m([0m[1;35mzae.getName[0m[1m([0m[1m)[0m[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;    [2m                [0m
[2;36m                    [0m         +                if [1m([0m![1;35mlink.startsWith[0m[1m([0mtargetDirectory[1m)[0m[1m)[0m [1m{[0m                           [2m                [0m
[2;36m                    [0m         +                    throw new [1;35mIOException[0m[1m([0m[1;35mString.format[0m[1m([0m[32m"Zip slip '%s' + '%s' -> [0m  [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m,                                                                              [2m                [0m
[2;36m                    [0m         +                            targetDirectory, [1;35mzae.getName[0m[1m([0m[1m)[0m, link[1m)[0m[1m)[0m;                [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         +                Path target = [1;35mtargetDirectory.resolve[0m[1m([0mtargetName[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;     [2m                [0m
[2;36m                    [0m         +                if [1m([0m![1;35mtarget.startsWith[0m[1m([0mtargetDirectory[1m)[0m[1m)[0m [1m{[0m                         [2m                [0m
[2;36m                    [0m         +                    throw new [1;35mIOException[0m[1m([0m[1;35mString.format[0m[1m([0m[32m"Zip slip '%s' + '%s' -> [0m  [2m                [0m
[2;36m                    [0m         [32m'%s'"[0m,                                                                              [2m                [0m
[2;36m                    [0m         +                            targetDirectory, targetName, target[1m)[0m[1m)[0m;                 [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                          Path parent = [1;35mcreateParentDirectory[0m[1m([0mtargetDirectory, link[1m)[0m;        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                          if [1m([0m![1;35mFiles.isSameFile[0m[1m([0m[1;35mlink.getParent[0m[1m([0m[1m)[0m, parent[1m)[0m[1m)[0m [1m{[0m                 [2m                [0m
[2;36m                    [0m         @@ [1;36m-513[0m,[1;36m7[0m +[1;36m521[0m,[1;36m15[0m @@                                                                [2m                [0m
[2;36m                    [0m                  for [1m([0mPath p : relative[1m)[0m [1m{[0m                                                  [2m                [0m
[2;36m                    [0m                      current = [1;35mcurrent.resolve[0m[1m([0mp[1m)[0m;                                          [2m                [0m
[2;36m                    [0m                      if [1m([0m[1;35mFiles.isSymbolicLink[0m[1m([0mcurrent[1m)[0m[1m)[0m [1m{[0m                                   [2m                [0m
[2;36m                    [0m         -                current = [1;35mFiles.readSymbolicLink[0m[1m([0mcurrent[1m)[0m;                         [2m                [0m
[2;36m                    [0m         +                Path symlinkTarget = [1;35mFiles.readSymbolicLink[0m[1m([0mcurrent[1m)[0m;              [2m                [0m
[2;36m                    [0m         +                if [1m([0m![1;35msymlinkTarget.isAbsolute[0m[1m([0m[1m)[0m[1m)[0m [1m{[0m                                 [2m                [0m
[2;36m                    [0m         +                    current =                                                      [2m                [0m
[2;36m                    [0m         [1;35mcurrent.getParent[0m[1m([0m[1m)[0m[1;35m.resolve[0m[1m([0msymlinkTarget[1m)[0m[1;35m.normalize[0m[1m([0m[1m)[0m;                             [2m                [0m
[2;36m                    [0m         +                [1m}[0m else [1m{[0m                                                           [2m                [0m
[2;36m                    [0m         +                    current = [1;35msymlinkTarget.normalize[0m[1m([0m[1m)[0m;                           [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m         +                if [1m([0m![1;35mcurrent.normalize[0m[1m([0m[1m)[0m[1;35m.startsWith[0m[1m([0m[1;35mroot.normalize[0m[1m([0m[1m)[0m[1m)[0m[1m)[0m [1m{[0m           [2m                [0m
[2;36m                    [0m         +                    throw new [1;35mIOException[0m[1m([0m[1;35mString.format[0m[1m([0m[32m"Symlink points outside [0m   [2m                [0m
[2;36m                    [0m         [32mtarget directory: '%s'"[0m, current[1m)[0m[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                      if [1m([0m! [1;35mFiles.isDirectory[0m[1m([0mcurrent[1m)[0m[1m)[0m [1m{[0m                                    [2m                [0m
[2;36m                    [0m                          [1;35mFiles.createDirectory[0m[1m([0mcurrent[1m)[0m;                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical:    [2m                [0m
[2;36m                    [0m         File path traversal:                                                                [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp8837158020849378687/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1m([0mFilePathTraversal.j [2m                [0m
[2;36m                    [0m         av[1;92ma:346[0m[1m)[0m                                                                            [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1m([0mFilePathTravers [2m                [0m
[2;36m                    [0m         al.jav[1;92ma:293[0m[1m)[0m                                                                        [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.copyMismatchMvHook[0m[1m([0mFilePa [2m                [0m
[2;36m                    [0m         thTraversal.jav[1;92ma:211[0m[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:502[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:412[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:336[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1m([0mExpander.jav[1;92ma:216[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0mExpanderFuzzer.jav[1;92ma:52[0m[1m)[0m                [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 7bb3f9683ba8f59b                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m         # Evaluation Report                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Summary                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         A critical security vulnerability has been detected in the Apache Commons Compress  [2m                [0m
[2;36m                    [0m         library's `Expander` class. The fuzzer identified a file path traversal             [2m                [0m
[2;36m                    [0m         vulnerability where the code attempts to write files outside the intended directory [2m                [0m
[2;36m                    [0m         structure, specifically attempting to create or access a file at                    [2m                [0m
[2;36m                    [0m         `[35m/tmp/expander-tmp8837158020849378687/output/q/r/[0m[95mjazzer-traversal[0m`. This represents [2m                [0m
[2;36m                    [0m         a security issue that could allow an attacker to write files to arbitrary locations [2m                [0m
[2;36m                    [0m         on the filesystem through specially crafted archive files.                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Description                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         The issue manifests as a `FuzzerSecurityIssueCritical` exception thrown by the      [2m                [0m
[2;36m                    [0m         Jazzer fuzzing framework's security sanitizer specifically designed to detect file  [2m                [0m
[2;36m                    [0m         path traversal vulnerabilities. The exception indicates that the `Expander` class   [2m                [0m
[2;36m                    [0m         in Apache Commons Compress is attempting to perform file operations that would      [2m                [0m
[2;36m                    [0m         result in writing files outside the intended extraction directory.                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         **Vulnerability Type:** File Path Traversal [1m([0malso known as Directory Traversal or   [2m                [0m
[2;36m                    [0m         Path Traversal[1m)[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         **Key Observations:**                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Exception Origin**: The security issue was caught by Jazzer's                  [2m                [0m
[2;36m                    [0m         `FilePathTraversal` sanitizer at the point where it performs path validation checks [2m                [0m
[2;36m                    [0m         [1m([0m`[1;35mFilePathTraversal.check[0m[1m([0m[1m)[0m` and `[1;35mFilePathTraversal.checkPath[0m[1m([0m[1m)[0m`[1m)[0m.                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Call Stack Analysis**: The vulnerability is triggered through the following    [2m                [0m
[2;36m                    [0m         execution path:                                                                     [2m                [0m
[2;36m                    [0m            - `[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1m([0m[1m)[0m` - The fuzzing harness entry point        [2m                [0m
[2;36m                    [0m            - `[1;35mExpander.expand[0m[1m([0m[1m)[0m` - Multiple levels of expansion methods [1m([0mlines [1;36m216[0m, [1;36m336[0m,    [2m                [0m
[2;36m                    [0m         [1;36m412[0m, [1;36m502[0m[1m)[0m                                                                           [2m                [0m
[2;36m                    [0m            - The final trigger occurs at line [1;36m502[0m in `Expander.java` during a method that   [2m                [0m
[2;36m                    [0m         appears to be related to handling mismatched files [1m([0mas indicated by the hook name   [2m                [0m
[2;36m                    [0m         `copyMismatchMvHook`[1m)[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Problematic Path**: The detected traversal path                                [2m                [0m
[2;36m                    [0m         `[35m/tmp/expander-tmp8837158020849378687/output/q/r/[0m[95mjazzer-traversal[0m` suggests:        [2m                [0m
[2;36m                    [0m            - A temporary directory is being used for extraction                             [2m                [0m
[2;36m                    [0m            - The problematic path includes `q/r/jazzer-traversal` which appears to be       [2m                [0m
[2;36m                    [0m         constructed from archive entry data                                                 [2m                [0m
[2;36m                    [0m            - The path structure indicates potential manipulation of directory separators    [2m                [0m
[2;36m                    [0m         and path components                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Security Implications**: This vulnerability could allow malicious archive      [2m                [0m
[2;36m                    [0m         files to:                                                                           [2m                [0m
[2;36m                    [0m            - Write files outside the intended extraction directory                          [2m                [0m
[2;36m                    [0m            - Overwrite critical system files                                                [2m                [0m
[2;36m                    [0m            - Perform unauthorized file system operations                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         **Areas for Investigation:**                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m. **Expander.java [1m([0mline [1;36m502[0m[1m)[0m**: The exact location where the path traversal        [2m                [0m
[2;36m                    [0m         occurs, specifically investigating how archive entry paths are processed and        [2m                [0m
[2;36m                    [0m         validated before file operations.                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m. **Path Validation Logic**: Examine all path validation and sanitization          [2m                [0m
[2;36m                    [0m         mechanisms in the `Expander` class to understand where the security controls fail   [2m                [0m
[2;36m                    [0m         or are absent.                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m. **Archive Entry Handling**: Investigate how the `Expander` class extracts and    [2m                [0m
[2;36m                    [0m         processes file paths from archive entries across different archive formats [1m([0mZIP,    [2m                [0m
[2;36m                    [0m         TAR, etc.[1m)[0m.                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m. **Multiple [1;35mexpand[0m[1m([0m[1m)[0m method overloads**: Lines [1;36m216[0m, [1;36m336[0m, [1;36m412[0m, and [1;36m502[0m indicate    [2m                [0m
[2;36m                    [0m         multiple levels of the expand operation, suggesting that path validation might be   [2m                [0m
[2;36m                    [0m         missing at one or more levels of this call chain.                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m. **Temporary Directory Management**: Review how temporary directories are created [2m                [0m
[2;36m                    [0m         and how output paths are constructed relative to these temporary directories to     [2m                [0m
[2;36m                    [0m         understand the complete path resolution logic.                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ## Initial Issue Log                                                                [2m                [0m
[2;36m                    [0m         Here is the initial issue log of the codebase:                                      [2m                [0m
[2;36m                    [0m         [1m<[0m[1;95missue[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: [0m   [2m                [0m
[2;36m                    [0m         [39mFile path traversal: [0m                                                               [2m                [0m
[2;36m                    [0m         [35m/tmp/expander-tmp8837158020849378687/output/q/r/[0m[95mjazzer-traversal[0m                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.check[0m[1;39m([0m[39mFilePathTraversal.j[0m [2m                [0m
[2;36m                    [0m         [39mav[0m[1;92ma:346[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.checkPath[0m[1;39m([0m[39mFilePathTravers[0m [2m                [0m
[2;36m                    [0m         [39mal.jav[0m[1;92ma:293[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.FilePathTraversal.copyMismatchMvHook[0m[1;39m([0m[39mFilePa[0m [2m                [0m
[2;36m                    [0m         [39mthTraversal.jav[0m[1;92ma:211[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:502[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:412[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:336[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.commons.compress.archivers.examples.Expander.expand[0m[1;39m([0m[39mExpander.jav[0m[1;92ma:216[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mExpanderFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mExpanderFuzzer.jav[0m[1;92ma:52[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 7bb3f9683ba8f59b[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:1[0m[39m-[0m[1;36m47[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.channels.Channels;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.compress.archivers.ArchiveInputStream;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZFile;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.tar.TarArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.archivers.tar.TarFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.zip.ZipFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:68[0m[39m-[0m[1;36m94[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:214[0m[39m-[0m[1;36m218[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal Path archive, final Path targetDirectory[0m[1;39m)[0m[39m throws [0m  [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:        try [0m[1;39m([0m[39mInputStream inputStream = new [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mBufferedInputStream[0m[1;39m([0m[1;35mFiles.newInputStream[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            [0m[1;35mexpand[0m[1;39m([0m[1;35mArchiveStreamFactory.detect[0m[1;39m([0m[39minputStream[0m[1;39m)[0m[39m, archive, [0m          [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:333[0m[39m-[0m[1;36m343[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal String format, final Path archive, final Path [0m     [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m throws IOException, ArchiveException [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:        if [0m[1;39m([0m[1;35mprefersSeekableByteChannel[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:            try [0m[1;39m([0m[39mSeekableByteChannel channel = [0m[1;35mFileChannel.open[0m[1;39m([0m[39marchive, [0m       [2m                [0m
[2;36m                    [0m         [39mStandardOpenOption.READ[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                [0m[1;35mexpand[0m[1;39m([0m[39mformat, channel, targetDirectory, [0m                       [2m                [0m
[2;36m                    [0m         [39mCloseableConsumer.CLOSING_CONSUMER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:        try [0m[1;39m([0m[39mInputStream inputStream = new [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mBufferedInputStream[0m[1;39m([0m[1;35mFiles.newInputStream[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:            [0m[1;35mexpand[0m[1;39m([0m[39mformat, inputStream, targetDirectory, [0m                       [2m                [0m
[2;36m                    [0m         [39mCloseableConsumer.CLOSING_CONSUMER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:404[0m[39m-[0m[1;36m420[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal String format, final SeekableByteChannel archive, [0m [2m                [0m
[2;36m                    [0m         [39mfinal Path targetDirectory, final CloseableConsumer closeableConsumer[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:            throws IOException, ArchiveException [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:        try [0m[1;39m([0m[39mCloseableConsumerAdapter c = new [0m                                  [2m                [0m
[2;36m                    [0m         [1;35mCloseableConsumerAdapter[0m[1;39m([0m[39mcloseableConsumer[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:            if [0m[1;39m([0m[39m![0m[1;35mprefersSeekableByteChannel[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:                [0m[1;35mexpand[0m[1;39m([0m[39mformat, [0m[1;35mc.track[0m[1;39m([0m[1;35mChannels.newInputStream[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[39m, [0m      [2m                [0m
[2;36m                    [0m         [39mtargetDirectory, CloseableConsumer.NULL_CONSUMER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.TAR.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:                [0m[1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[39mnew [0m[1;35mTarFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;39m)[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.ZIP.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setSeekableByteChannel[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mArchiveStreamFactory.SEVEN_Z.equalsIgnoreCase[0m[1;39m([0m[39mformat[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mexpand[0m[1;39m([0m[1;35mc.track[0m[1;39m([0m[1;35mSevenZFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setSeekableByteChannel[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m, [0m        [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                [0m[35m/[0m[35m/[0m[39m never reached as prefersSeekableByteChannel only returns [0m    [2m                [0m
[2;36m                    [0m         [39mtrue for TAR, ZIP and 7z[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:                throw new [0m[1;35mArchiveException[0m[1;39m([0m[32m"Don't know how to handle format "[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [39mformat[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:21[0m[39m-[0m[1;36m23[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:75[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:96[0m[39m-[0m[1;36m105[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    private <T extends ArchiveEntry> boolean [0m[1;35misUnixSymlink[0m[1;39m([0m[39mT nextEntry[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;39m([0m[39mnextEntry instanceof ZipArchiveEntry[0m[1;39m)[0m[39m && ![0m[1;39m([0m[39mnextEntry instanceof [0m  [2m                [0m
[2;36m                    [0m         [39mTarArchiveEntry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            return false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        if [0m[1;39m([0m[39mnextEntry instanceof ZipArchiveEntry[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            return [0m[1;39m([0m[1;39m([0m[39mZipArchiveEntry[0m[1;39m)[0m[39mnextEntry[0m[1;39m)[0m[1;35m.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            return [0m[1;39m([0m[1;39m([0m[39mTarArchiveEntry[0m[1;39m)[0m[39mnextEntry[0m[1;39m)[0m[1;35m.isSymbolicLink[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:126[0m[39m-[0m[1;36m134[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveInputStream<?> archive, final Path [0m         [2m                [0m
[2;36m                    [0m         [39mtargetDirectory[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            ArchiveEntry next = [0m[1;35marchive.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            while [0m[1;39m([0m[39mnext != null && ![0m[1;35marchive.canReadEntryData[0m[1;39m([0m[39mnext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                next = [0m[1;35marchive.getNextEntry[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            return next;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;39m}[0m[39m, [0m[1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m[1;35mIOUtils.copy[0m[1;39m([0m[39marchive, out[0m[1;39m)[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:442[0m[39m-[0m[1;36m449[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal TarFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:        final Iterator<TarArchiveEntry> entryIterator = [0m                        [2m                [0m
[2;36m                    [0m         [1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[1;35m.iterator[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:        [0m[1;35mexpand[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;35mentryIterator.hasNext[0m[1;39m([0m[1;39m)[0m[39m ? [0m[1;35mentryIterator.next[0m[1;39m([0m[1;39m)[0m[39m : null, [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mentry, out[0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:            try [0m[1;39m([0m[39mInputStream in = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mentry[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                [0m[1;35mIOUtils.copy[0m[1;39m([0m[39min, out[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:        [0m[1;39m}[0m[39m, targetDirectory[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:21[0m[39m-[0m[1;36m5[0m [2m                [0m
[2;36m                    [0m         [1;36m6[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static org.junit.jupiter.api.Assertions.assertArrayEquals;[0m                [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static org.junit.jupiter.api.Assertions.assertFalse;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static org.junit.jupiter.api.Assertions.assertNotNull;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static org.junit.jupiter.api.Assertions.assertThrows;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import static org.junit.jupiter.api.Assumptions.assumeFalse;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import static org.junit.jupiter.api.Assumptions.assumeTrue;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.nio.file.Paths;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.compress.AbstractTest;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.commons.compress.archivers.ArchiveOutputStream;[0m                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.commons.compress.archivers.StreamingNotSupportedException;[0m     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZFile;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZOutputFile;[0m            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.commons.compress.archivers.tar.TarFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.commons.compress.archivers.zip.ZipFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.junit.jupiter.api.io.TempDir;[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:191[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m218[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, ArchiveException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../foo"[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:    void [0m[1;35mtestFileCantEscapeDoubleDotPathWithSimilarSibling[0m[1;39m([0m[1;39m)[0m[39m throws [0m            [2m                [0m
[2;36m                    [0m         [39mIOException, ArchiveException [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        final String sibling = [0m[1;35mtempResultDir.getName[0m[1;39m([0m[1;39m)[0m[39m + [0m[32m"x"[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:        final File s = new [0m[1;35mFile[0m[1;39m([0m[1;35mtempResultDir.getParentFile[0m[1;39m([0m[1;39m)[0m[39m, sibling[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:        [0m[1;35massumeFalse[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:        [0m[1;35ms.mkdirs[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        [0m[1;35massumeTrue[0m[1;39m([0m[1;35ms.exists[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"../"[0m[39m + sibling + [0m[32m"/a"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:    void [0m[1;35mtestFileCantEscapeViaAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m               [2m                [0m
[2;36m                    [0m         [39mArchiveException [0m[1;39m{[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:        [0m[1;35msetupZip[0m[1;39m([0m[32m"/tmp/foo"[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:        try [0m[1;39m([0m[39mZipFile f = [0m[1;35mZipFile.builder[0m[1;39m([0m[1;39m)[0m[1;35m.setFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[1;35massertThrows[0m[1;39m([0m[39mIOException.class, [0m[1;39m([0m[1;39m)[0m[39m -> new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39mf, [0m     [2m                [0m
[2;36m                    [0m         [39mtempResultDir[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:        [0m[1;35massertFalse[0m[1;39m([0m[39mnew [0m[1;35mFile[0m[1;39m([0m[39mtempResultDir, [0m[32m"tmp/foo"[0m[1;39m)[0m[1;35m.isFile[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:294[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m316[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    public void [0m[1;35mtestSymLinks[0m[1;39m([0m[39m@TempDir Path tmp[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        Path input = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testSymLinks.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[35m/[0m[35m/[0m[95mcheck[0m[39m that the test file is defined correctly.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        ZipFile zipFile = new [0m[1;35mZipFile[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        ZipArchiveEntry zae = [0m[1;35mzipFile.getEntry[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m contents = new byte[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[1;35mzipFile.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m, contents[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"b"[0m[39m, new [0m[1;35mString[0m[1;39m([0m[39mcontents[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:        zae = [0m[1;35mzipFile.getEntry[0m[1;39m([0m[32m"a/c/d/hello_world.txt"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m actually test that the file is written[0m                            [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        [0m[35m/[0m[35m/[0m[95mto[0m[39m the correct path[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, tmp[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:        Path target = [0m[1;35mtmp.resolve[0m[1;39m([0m[32m"b/c/d/hello_world.txt"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m13[0m[39m, [0m[1;35mFiles.size[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m489[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.jav[0m[1;92ma:21[0m[39m-[0m[1;36m56[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.UncheckedIOException;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.math.BigDecimal;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.nio.file.DirectoryStream;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.file.LinkOption;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.file.attribute.BasicFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.attribute.DosFileAttributes;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.attribute.FileTime;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.file.attribute.PosixFileAttributes;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.time.DateTimeException;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.time.Instant;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.Comparator;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.Date;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import java.util.Objects;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import java.util.stream.Collectors;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.commons.compress.archivers.EntryStreamOffsets;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.commons.compress.archivers.zip.ZipEncoding;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.commons.compress.utils.ArchiveUtils;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.commons.compress.utils.IOUtils;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.commons.compress.utils.ParsingUtils;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.commons.compress.utils.TimeUtils;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.apache.commons.io.file.attribute.FileTimes;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.commons.lang3.SystemProperties;[0m                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.jav[0m[1;92ma:230[0m[39m-[0m[1;36m26[0m [2m                [0m
[2;36m                    [0m         [1;36m6[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:    private static String [0m[1;35mnormalizeFileName[0m[1;39m([0m[39mString fileName, final boolean [0m     [2m                [0m
[2;36m                    [0m         [39mpreserveAbsolutePath[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:        if [0m[1;39m([0m[39m!preserveAbsolutePath[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:            final String property = [0m[1;35mSystemProperties.getOsName[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:            if [0m[1;39m([0m[39mproperty != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                final String osName = [0m[1;35mproperty.toLowerCase[0m[1;39m([0m[39mLocale.ROOT[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                [0m[35m/[0m[35m/[0m[39m Strip off drive letters![0m                                     [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                [0m[35m/[0m[35m/[0m[39m REVIEW Would a better check be [0m[32m"[0m[32m([0m[32mFile.separator == '\'[0m[32m)[0m[32m"[0m[39m?[0m    [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:                if [0m[1;39m([0m[1;35mosName.startsWith[0m[1;39m([0m[32m"windows"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                    if [0m[1;39m([0m[1;35mfileName.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                        final char ch1 = [0m[1;35mfileName.charAt[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        final char ch2 = [0m[1;35mfileName.charAt[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                        if [0m[1;39m([0m[39mch2 == [0m[32m':'[0m[39m && [0m[1;39m([0m[39mch1 >= [0m[32m'a'[0m[39m && ch1 <= [0m[32m'z'[0m[39m || ch1 >= [0m  [2m                [0m
[2;36m                    [0m         [32m'A'[0m[39m && ch1 <= [0m[32m'Z'[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:                            fileName = [0m[1;35mfileName.substring[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35mosName.contains[0m[1;39m([0m[32m"netware"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:                    final int colon = [0m[1;35mfileName.indexOf[0m[1;39m([0m[32m':'[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:                    if [0m[1;39m([0m[39mcolon != [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:                        fileName = [0m[1;35mfileName.substring[0m[1;39m([0m[39mcolon + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:        fileName = [0m[1;35mfileName.replace[0m[1;39m([0m[39mFile.separatorChar, [0m[32m'/'[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:        [0m[35m/[0m[35m/[0m[39m No absolute pathnames[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:        [0m[35m/[0m[35m/[0m[39m Windows [0m[1;39m([0m[39mand Posix?[0m[1;39m)[0m[39m paths can start with "\\NetworkDrive\",[0m         [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:        [0m[35m/[0m[35m/[0m[39m so we loop on starting [0m[35m/[0m[39m's.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:        while [0m[1;39m([0m[39m!preserveAbsolutePath && [0m[1;35mfileName.startsWith[0m[1;39m([0m[32m"/"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            fileName = [0m[1;35mfileName.substring[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        return fileName;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.jav[0m[1;92ma:1366[0m[39m-[0m[1;36m1[0m [2m                [0m
[2;36m                    [0m         [1;36m368[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:    public boolean [0m[1;35misSymbolicLink[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:        return linkFlag == LF_SYMLINK;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:68[0m[39m-[0m[1;36m94[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    private <T extends ArchiveEntry> void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ArchiveEntrySupplier<T> [0m  [2m                [0m
[2;36m                    [0m         [39msupplier, final ArchiveEntryBiConsumer<T> writer, final Path targetDirectory[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:            throws IOException [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        final boolean nullTarget = targetDirectory == null;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        final Path targetDirPath = nullTarget ? null : [0m                          [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        T nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        while [0m[1;39m([0m[39mnextEntry != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            final Path targetPath = nullTarget ? null : [0m                         [2m                [0m
[2;36m                    [0m         [1;35mnextEntry.resolveIn[0m[1;39m([0m[39mtargetDirPath[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            if [0m[1;39m([0m[1;35mnextEntry.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m && [0m            [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mtargetPath[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                final Path parent = nullTarget ? null : [0m[1;35mtargetPath.getParent[0m[1;39m([0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                if [0m[1;39m([0m[39m!nullTarget && ![0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m && [0m                [2m                [0m
[2;36m                    [0m         [1;35mFiles.createDirectories[0m[1;39m([0m[39mparent[0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Failed to create directory "[0m[39m + [0m       [2m                [0m
[2;36m                    [0m         [39mparent[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:                if [0m[1;39m([0m[39mnullTarget[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:                    [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, NullOutputStream.INSTANCE[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                    try [0m[1;39m([0m[39mOutputStream outputStream = [0m                            [2m                [0m
[2;36m                    [0m         [1;35mFiles.newOutputStream[0m[1;39m([0m[39mtargetPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:                        [0m[1;35mwriter.accept[0m[1;39m([0m[39mnextEntry, outputStream[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            nextEntry = [0m[1;35msupplier.get[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:75[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:491[0m[39m-[0m[1;36m495[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:477[0m[39m-[0m[1;36m489[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/examples/ExpanderTest.jav[0m[1;92ma:294[0m[39m-[0m [2m                [0m
[2;36m                    [0m         [1;36m316[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:    @Test[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:    public void [0m[1;35mtestSymLinks[0m[1;39m([0m[39m@TempDir Path tmp[0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        Path input = [0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mPaths.get[0m[1;39m([0m[1;35mExpanderTest.class.getResource[0m[1;39m([0m[32m"/testSymLinks.zip"[0m[1;39m)[0m[1;35m.toURI[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:        [0m[35m/[0m[35m/[0m[95mcheck[0m[39m that the test file is defined correctly.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        ZipFile zipFile = new [0m[1;35mZipFile[0m[1;39m([0m[39minput[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        ZipArchiveEntry zae = [0m[1;35mzipFile.getEntry[0m[1;39m([0m[32m"a"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m contents = new byte[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        [0m[1;35mIOUtils.readFully[0m[1;39m([0m[1;35mzipFile.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m, contents[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[32m"b"[0m[39m, new [0m[1;35mString[0m[1;39m([0m[39mcontents[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:        zae = [0m[1;35mzipFile.getEntry[0m[1;39m([0m[32m"a/c/d/hello_world.txt"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[1;35massertNotNull[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        [0m[35m/[0m[35m/[0m[95mnow[0m[39m actually test that the file is written[0m                            [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:        [0m[35m/[0m[35m/[0m[95mto[0m[39m the correct path[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:        new [0m[1;35mExpander[0m[1;39m([0m[1;39m)[0m[1;35m.expand[0m[1;39m([0m[39minput, tmp[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:        Path target = [0m[1;35mtmp.resolve[0m[1;39m([0m[32m"b/c/d/hello_world.txt"[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:        [0m[1;35massertTrue[0m[1;39m([0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:        [0m[1;35massertEquals[0m[1;39m([0m[1;36m13[0m[39m, [0m[1;35mFiles.size[0m[1;39m([0m[39mtarget[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:1[0m[39m-[0m[1;36m46[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * or more contributor license agreements.  See the NOTICE file[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * distributed with this work for additional information[0m                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * regarding copyright ownership.  The ASF licenses this file[0m                     [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * to you under the Apache License, Version [0m[1;36m2.0[0m[39m [0m[1;39m([0m[39mthe[0m                              [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance[0m                     [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: * with the License.  You may obtain a copy of the License at[0m                     [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *   [0m[4;94mhttps://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * Unless required by applicable law or agreed to in writing,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * software distributed under the License is distributed on an[0m                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * [0m[32m"AS IS"[0m[39m BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY[0m                        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * KIND, either express or implied.  See the License for the[0m                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: * specific language governing permissions and limitations[0m                       [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m: * under the License.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:package org.apache.commons.compress.archivers.examples;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedInputStream;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.nio.channels.Channels;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.nio.channels.FileChannel;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.nio.channels.SeekableByteChannel;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.nio.file.Files;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.nio.file.Path;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.nio.file.StandardOpenOption;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Enumeration;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Iterator;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.commons.compress.archivers.ArchiveEntry;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.commons.compress.archivers.ArchiveException;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.commons.compress.archivers.ArchiveInputStream;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.compress.archivers.ArchiveStreamFactory;[0m               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.compress.archivers.sevenz.SevenZFile;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.commons.compress.archivers.tar.TarArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.commons.compress.archivers.tar.TarFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;[0m                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.commons.compress.archivers.zip.ZipFile;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/test/java/org/apache/commons/compress/archivers/zip/ZipFileTest.jav[0m[1;92ma:966[0m[39m-[0m[1;36m988[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:    void [0m[1;35mtestUnixSymlinkSampleFile[0m[1;39m([0m[1;39m)[0m[39m throws Exception [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:        final String entryPrefix = [0m[32m"COMPRESS-214_unix_symlinks/"[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:        final TreeMap<String, String> expectedVals = new TreeMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:        [0m[35m/[0m[35m/[0m[39m I threw in some Japanese characters to keep things interesting.[0m      [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:        [0m[1;35mexpectedVals.put[0m[1;39m([0m[39mentryPrefix + [0m[32m"link1"[0m[39m, [0m                                [2m                [0m
[2;36m                    [0m         [32m"../COMPRESS-214_unix_symlinks/./a/b/c/../../../\uF999"[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:        [0m[1;35mexpectedVals.put[0m[1;39m([0m[39mentryPrefix + [0m[32m"link2"[0m[39m, [0m                                [2m                [0m
[2;36m                    [0m         [32m"../COMPRESS-214_unix_symlinks/./a/b/c/../../../g"[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:        [0m[1;35mexpectedVals.put[0m[1;39m([0m[39mentryPrefix + [0m[32m"link3"[0m[39m, [0m                                [2m                [0m
[2;36m                    [0m         [32m"../COMPRESS-214_unix_symlinks/././a/b/c/../../../\u76F4\u6A39"[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:        [0m[1;35mexpectedVals.put[0m[1;39m([0m[39mentryPrefix + [0m[32m"link4"[0m[39m, [0m[32m"\u82B1\u5B50/\u745B\u5B50"[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:        [0m[1;35mexpectedVals.put[0m[1;39m([0m[39mentryPrefix + [0m[32m"\uF999"[0m[39m, [0m                               [2m                [0m
[2;36m                    [0m         [32m"./\u82B1\u5B50/\u745B\u5B50/\u5897\u8C37/\uF999"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:        [0m[1;35mexpectedVals.put[0m[1;39m([0m[39mentryPrefix + [0m[32m"g"[0m[39m, [0m[32m"./a/b/c/d/e/f/g"[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:        [0m[1;35mexpectedVals.put[0m[1;39m([0m[39mentryPrefix + [0m[32m"\u76F4\u6A39"[0m[39m, [0m[32m"./g"[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:        [0m[35m/[0m[35m/[0m[39m Notice how a directory link might contain a trailing slash, or it [0m   [2m                [0m
[2;36m                    [0m         [39mmight not.[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:        [0m[35m/[0m[35m/[0m[39m Also note: symlinks are always stored as files, even if they link to[0m [2m                [0m
[2;36m                    [0m         [39mdirectories.[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:        [0m[1;35mexpectedVals.put[0m[1;39m([0m[39mentryPrefix + [0m[32m"link5"[0m[39m, [0m                                [2m                [0m
[2;36m                    [0m         [32m"../COMPRESS-214_unix_symlinks/././a/b"[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:        [0m[1;35mexpectedVals.put[0m[1;39m([0m[39mentryPrefix + [0m[32m"link6"[0m[39m, [0m                                [2m                [0m
[2;36m                    [0m         [32m"../COMPRESS-214_unix_symlinks/././a/b/"[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:        [0m[35m/[0m[35m/[0m[39m I looked into creating a test with hard links, but ZIP does not [0m     [2m                [0m
[2;36m                    [0m         [39mappear to[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:        [0m[35m/[0m[35m/[0m[39m support hard links, so nevermind.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:        final File archive = [0m[1;35mgetFile[0m[1;39m([0m[32m"COMPRESS-214_unix_symlinks.zip"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:        zf = new [0m[1;35mZipFile[0m[1;39m([0m[39marchive[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:        [0m[1;35mzf.stream[0m[1;39m([0m[1;39m)[0m[1;35m.forEach[0m[1;39m([0m[39mzae -> [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:            final String link = [0m[1;35mzf.getUnixSymlink[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:                final String name = [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:470[0m[39m-[0m[1;36m506[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    public void [0m[1;35mexpand[0m[1;39m([0m[39mfinal ZipFile archive, final Path targetDirectory[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39mthrows IOException [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:            [0m[1;35mFiles.createDirectories[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        final Enumeration<ZipArchiveEntry> entries = [0m[1;35marchive.getEntries[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        while [0m[1;39m([0m[1;35mentries.hasMoreElements[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            ZipArchiveEntry zae = [0m[1;35mentries.nextElement[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            if [0m[1;39m([0m[1;35mzae.isUnixSymlink[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                String targetName = [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mIOUtils.toString[0m[1;39m([0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:                        StandardCharsets.UTF_8[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:                Path link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:                Path target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, link[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isSameFile[0m[1;39m([0m[1;35mlink.getParent[0m[1;39m([0m[1;39m)[0m[39m, parent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:                    link = [0m[1;35mparent.relativize[0m[1;39m([0m[1;35mlink.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mFiles.isRegularFile[0m[1;39m([0m[39mlink[0m[1;39m)[0m[39m && ![0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mlink[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:                    [0m[1;35mFiles.createSymbolicLink[0m[1;39m([0m[39mlink, target[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39m! [0m[1;35mzae.isDirectory[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                Path target = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' [0m  [2m                [0m
[2;36m                    [0m         [32m-> '%s'"[0m[39m,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:                Path parent = [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mtargetDirectory, target[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:                if [0m[1;39m([0m[39m! [0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m   [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:                        [0m[1;35mparent.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:                    target = [0m[1;35mparent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[1;35mtarget.getFileName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:                try [0m[1;39m([0m[39mInputStream is = [0m[1;35marchive.getInputStream[0m[1;39m([0m[39mzae[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:                    [0m[1;35mFiles.copy[0m[1;39m([0m[39mis, target[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/examples/Expander.jav[0m[1;92ma:508[0m[39m-[0m[1;36m524[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:    private static Path [0m[1;35mcreateParentDirectory[0m[1;39m([0m[39mPath root, Path target[0m[1;39m)[0m[39m throws [0m   [2m                [0m
[2;36m                    [0m         [39mIOException [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:        Path relative =[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:                [0m[1;35mroot.relativize[0m[1;39m([0m[1;35mtarget.getParent[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:        Path current = [0m[1;35mroot.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        for [0m[1;39m([0m[39mPath p : relative[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:            current = [0m[1;35mcurrent.resolve[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:                current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            if [0m[1;39m([0m[39m! [0m[1;35mFiles.isDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:                [0m[1;35mFiles.createDirectory[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:        return current;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/main/java/org/apache/commons/compress/archivers/ArchiveEntry.jav[0m[1;92ma:75[0m[39m-[0m[1;36m82[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    default Path [0m[1;35mresolveIn[0m[1;39m([0m[39mfinal Path parentPath[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        final String name = [0m[1;35mgetName[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        final Path outputFile = [0m[1;35mparentPath.resolve[0m[1;39m([0m[39mname[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        if [0m[1;39m([0m[39m![0m[1;35moutputFile.startsWith[0m[1;39m([0m[39mparentPath[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mparentPath, name, outputFile[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        return outputFile;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Vulnerability[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mBased on the evaluation report and code analysis, the critical path traversal [0m      [2m                [0m
[2;36m                    [0m         [39mvulnerability exists in the `Expander` class's ZipFile-specific expand method [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlines [0m[1;36m470[0m[39m-[0m[1;36m506[0m[1;39m)[0m[39m. The fuzzer correctly identified three interconnected security [0m     [2m                [0m
[2;36m                    [0m         [39missues:[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Unix symlink name not validated [0m[1;39m([0m[39mline [0m[1;36m480[0m[1;39m)[0m[39m**: The symlink entry name from the [0m [2m                [0m
[2;36m                    [0m         [39marchive is resolved without validation that it stays within the target directory.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Unix symlink target not validated [0m[1;39m([0m[39mline [0m[1;36m481[0m[1;39m)[0m[39m**: The symlink target path read [0m  [2m                [0m
[2;36m                    [0m         [39mfrom the archive is resolved without validation.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **createParentDirectory follows symlinks unsafely [0m[1;39m([0m[39mlines [0m[1;36m508[0m[39m-[0m[1;36m524[0m[1;39m)[0m[39m**: This helper[0m [2m                [0m
[2;36m                    [0m         [39mmethod reads symlink targets without validating the resolved path stays within the [0m [2m                [0m
[2;36m                    [0m         [39mroot directory, allowing escape even when other validations exist.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe attack scenario that triggered the fuzzer:[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Archive contains symlink entry [0m[32m"q"[0m[39m pointing outside the target directory[0m          [2m                [0m
[2;36m                    [0m         [39m- Symlink is created without validation [0m[1;39m([0m[39mline [0m[1;36m488[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Archive contains regular file entry [0m[32m"q/r/jazzer-traversal"[0m                        [2m                [0m
[2;36m                    [0m         [39m- When processing the file, createParentDirectory follows the malicious symlink [0m[32m"q"[0m [2m                [0m
[2;36m                    [0m         [39mand escapes to an external location[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- File is written outside the intended directory at line [0m[1;36m502[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Critical Finding**: While other archive formats [0m[1;39m([0m[39mTarFile, SevenZFile, [0m            [2m                [0m
[2;36m                    [0m         [39mArchiveInputStream[0m[1;39m)[0m[39m use the safe generic [0m[1;35mexpand[0m[1;39m([0m[1;39m)[0m[39m method that calls `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m` [0m  [2m                [0m
[2;36m                    [0m         [39mfor validation, the ZipFile expand method has custom symlink-handling logic that [0m   [2m                [0m
[2;36m                    [0m         [39mcompletely bypasses this security mechanism.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Approach: Add Path Validation for Symlinks[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must be applied to the **ZipFile expand method** in [0m                        [2m                [0m
[2;36m                    [0m         [39m`src/main/java/org/apache/commons/compress/archivers/examples/Expander.java` at [0m    [2m                [0m
[2;36m                    [0m         [39mlines [0m[1;36m470[0m[39m-[0m[1;36m506[0m[39m.[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m1[0m[39m: Validate Symlink Entry Name [0m[1;39m([0m[39mLine [0m[1;36m480[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter line [0m[1;36m480[0m[39m where the symlink path is resolved, add validation using the same [0m   [2m                [0m
[2;36m                    [0m         [39mpattern as the existing `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m` method or the regular file validation:[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mPath link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mShould become:[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mPath link = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39m![0m[1;35mlink.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [39m            targetDirectory, [0m[1;35mzae.getName[0m[1;39m([0m[1;39m)[0m[39m, link[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis mirrors the existing validation for regular files at lines [0m[1;36m491[0m[39m-[0m[1;36m495[0m[39m and follows[0m [2m                [0m
[2;36m                    [0m         [39mthe pattern from `[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m`.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m2[0m[39m: Validate Symlink Target Path [0m[1;39m([0m[39mLine [0m[1;36m481[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter line [0m[1;36m481[0m[39m where the symlink target is resolved, add validation:[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mPath target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mShould become:[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mPath target = [0m[1;35mtargetDirectory.resolve[0m[1;39m([0m[39mtargetName[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39m![0m[1;35mtarget.startsWith[0m[1;39m([0m[39mtargetDirectory[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Zip slip '%s' + '%s' -> '%s'"[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [39m            targetDirectory, targetName, target[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures the symlink target also stays within the target directory, preventing [0m [2m                [0m
[2;36m                    [0m         [39mcreation of symlinks pointing outside.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m3[0m[39m: Fix createParentDirectory to Validate After Following Symlinks [0m[1;39m([0m[39mLines [0m [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m-[0m[1;36m524[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe `createParentDirectory` method must validate that paths remain within the root [0m [2m                [0m
[2;36m                    [0m         [39mdirectory after following symlinks. Modify the method to check after line [0m[1;36m516[0m[39m:[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m    current = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mShould have validation added:[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mFiles.isSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m    Path symlinkTarget = [0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[39mcurrent[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m If relative, resolve against current's parent; if absolute, use as-is[0m        [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39m![0m[1;35msymlinkTarget.isAbsolute[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m        current = [0m[1;35mcurrent.getParent[0m[1;39m([0m[1;39m)[0m[1;35m.resolve[0m[1;39m([0m[39msymlinkTarget[0m[1;39m)[0m[1;35m.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m        current = [0m[1;35msymlinkTarget.normalize[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Validate the resolved path stays within root[0m                                 [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39m![0m[1;35mcurrent.normalize[0m[1;39m([0m[1;39m)[0m[1;35m.startsWith[0m[1;39m([0m[1;35mroot.normalize[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[1;35mString.format[0m[1;39m([0m[32m"Symlink points outside target [0m         [2m                [0m
[2;36m                    [0m         [32mdirectory: '%s'"[0m[39m, current[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Important Note**: The symlink target returned by `[0m[1;35mFiles.readSymbolicLink[0m[1;39m([0m[1;39m)[0m[39m` can [0m  [2m                [0m
[2;36m                    [0m         [39mbe relative or absolute. When relative, it must be resolved against the symlink's [0m  [2m                [0m
[2;36m                    [0m         [39mparent directory. The validation must occur after this resolution to catch both [0m    [2m                [0m
[2;36m                    [0m         [39mdirect escapes and indirect escapes through symlink chains.[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Alternative Considerations[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why not use [0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m directly for symlinks?**[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe `[0m[1;35mresolveIn[0m[1;39m([0m[1;39m)[0m[39m` method from `ArchiveEntry` interface [0m[1;39m([0m[39mlines [0m[1;36m75[0m[39m-[0m[1;36m82[0m[39m in [0m             [2m                [0m
[2;36m                    [0m         [39mArchiveEntry.java[0m[1;39m)[0m[39m could be used for the symlink name validation. However:[0m          [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The symlink target validation requires reading from the archive stream first [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mline [0m[1;36m478[0m[39m-[0m[1;36m479[0m[1;39m)[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The symlink target is a String, not an ArchiveEntry, so we need manual [0m          [2m                [0m
[2;36m                    [0m         [39mvalidation[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The manual validation pattern is already established in the codebase at lines [0m   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m-[0m[1;36m495[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why not switch ZipFile to use the generic [0m[1;35mexpand[0m[1;39m([0m[1;39m)[0m[39m method?**[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe ZipFile expand method was intentionally designed to create actual filesystem [0m   [2m                [0m
[2;36m                    [0m         [39msymlinks [0m[1;39m([0m[39mas shown by the testSymLinks test at lines [0m[1;36m294[0m[39m-[0m[1;36m316[0m[1;39m)[0m[39m. Switching to the [0m    [2m                [0m
[2;36m                    [0m         [39mgeneric [0m[1;35mexpand[0m[1;39m([0m[1;39m)[0m[39m method would:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- Break existing functionality [0m[1;39m([0m[39msymlinks would not be created[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [39m- Fail the testSymLinks test[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Remove a legitimate feature[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTherefore, we must fix the existing implementation rather than remove it.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Preservation of Existing Logic[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**What must be preserved:**[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The ability to create Unix symlinks from ZIP archives [0m[1;39m([0m[39mlines [0m[1;36m477[0m[39m-[0m[1;36m489[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The existing regular file extraction with validation [0m[1;39m([0m[39mlines [0m[1;36m490[0m[39m-[0m[1;36m505[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The createParentDirectory functionality for both symlinks and regular files [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlines [0m[1;36m482[0m[39m, [0m[1;36m496[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. All existing tests must continue to pass, especially testSymLinks[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**What must change:**[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add validation before creating symlinks[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add validation within createParentDirectory when following symlinks[0m              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. These are additive security checks that don't alter the core functionality[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects:**[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Archives with malicious symlinks will fail extraction**: This is the intended [0m [2m                [0m
[2;36m                    [0m         [39mbehavior - archives designed for path traversal attacks should be rejected with [0m    [2m                [0m
[2;36m                    [0m         [39mclear error messages.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Archives with symlinks pointing outside might legitimately fail**: Some [0m       [2m                [0m
[2;36m                    [0m         [39marchives might have been created with symlinks that point outside the extraction [0m   [2m                [0m
[2;36m                    [0m         [39mdirectory. These will now be rejected. This is acceptable as it's a security [0m       [2m                [0m
[2;36m                    [0m         [39mrequirement.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Performance impact**: Minimal - only adds path normalization and string [0m       [2m                [0m
[2;36m                    [0m         [39mcomparison operations for symlink entries.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation Strategies:**[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Use the same error message format as existing zip slip protection: `[0m[32m"Zip slip [0m   [2m                [0m
[2;36m                    [0m         [32m'%s' + '%s' -> '%s'"[0m[39m` for consistency.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Ensure the validation uses `[0m[1;35mnormalize[0m[1;39m([0m[1;39m)[0m[39m` before `[0m[1;35mstartsWith[0m[1;39m([0m[1;39m)[0m[39m` check to handle [0m  [2m                [0m
[2;36m                    [0m         [32m".."[0m[39m and [0m[32m"."[0m[39m components correctly.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The createParentDirectory fix must properly handle both relative and absolute [0m   [2m                [0m
[2;36m                    [0m         [39msymlinks, as the current code doesn't account for this distinction.[0m                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in Codebase[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe codebase already has the correct pattern in two places:[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35mArchiveEntry.resolveIn[0m[1;39m([0m[1;39m)[0m[39m** [0m[1;39m([0m[39mlines [0m[1;36m75[0m[39m-[0m[1;36m82[0m[39m in ArchiveEntry.java[0m[1;39m)[0m[39m: Shows the [0m      [2m                [0m
[2;36m                    [0m         [39mcanonical validation pattern with [0m[1;35mnormalize[0m[1;39m([0m[1;39m)[0m[39m + [0m[1;35mstartsWith[0m[1;39m([0m[1;39m)[0m[39m + IOException on [0m      [2m                [0m
[2;36m                    [0m         [39mfailure.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Regular file validation in ZipFile expand** [0m[1;39m([0m[39mlines [0m[1;36m491[0m[39m-[0m[1;36m495[0m[39m in Expander.java[0m[1;39m)[0m[39m: [0m [2m                [0m
[2;36m                    [0m         [39mShows the manual implementation of the same pattern already used for regular files [0m [2m                [0m
[2;36m                    [0m         [39min the same method.[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix simply applies this existing, proven pattern to the symlink handling code [0m  [2m                [0m
[2;36m                    [0m         [39mthat currently lacks it.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this is the optimal approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal invasiveness**: Only adds validation checks without restructuring [0m     [2m                [0m
[2;36m                    [0m         [39mexisting code[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Consistency**: Uses the same validation pattern already proven effective for [0m  [2m                [0m
[2;36m                    [0m         [39mregular files[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves functionality**: Maintains symlink creation capability while adding [0m [2m                [0m
[2;36m                    [0m         [39msecurity[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Clear error messages**: Uses existing error message format for zip slip [0m       [2m                [0m
[2;36m                    [0m         [39mattacks[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Defense in depth**: Validates at multiple points [0m[1;39m([0m[39msymlink name, target, and [0m   [2m                [0m
[2;36m                    [0m         [39mduring parent directory creation[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How it addresses the vulnerability:**[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Prevents symlinks with names like [0m[32m"../evil"[0m[39m from being created outside the [0m      [2m                [0m
[2;36m                    [0m         [39mtarget directory[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Prevents symlinks from pointing outside the target directory[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Prevents exploitation via symlink chains where createParentDirectory follows a [0m  [2m                [0m
[2;36m                    [0m         [39mmalicious symlink[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Covers all three vulnerability points identified by the fuzzer[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why it preserves existing logic:**[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The core symlink creation logic [0m[1;39m([0m[39mline [0m[1;36m488[0m[1;39m)[0m[39m remains unchanged[0m                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The regular file extraction logic [0m[1;39m([0m[39mlines [0m[1;36m490[0m[39m-[0m[1;36m505[0m[1;39m)[0m[39m remains unchanged[0m              [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The createParentDirectory directory creation logic remains functional[0m            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Only adds security validation that rejects malicious paths while allowing [0m       [2m                [0m
[2;36m                    [0m         [39mlegitimate ones[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. All existing tests with benign symlinks will continue to pass[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/12/26 18:41:22][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=454895;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=50550;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=23959;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=972533;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp85o9txj6[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/apache-commons-compress_cc-de[0m [2m               [0m
[2;36m                    [0m         [35mlta-07_vuln_8/[0m[95magent-output-1768243282.0337787[0m                                        [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/apache-commons-compress_cc-delta-07_vuln_8.toml     [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-commons-compress[0m [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/12/26 18:41:24][0m[2;36m [0m[34mINFO    [0m Deleting environments directory:                                                     ]8;id=525017;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=366929;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/.cache/environments/[0m[95mapache-commons-compress[0m                         [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=974752;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=509352;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mapache-commons-compre[0m [2m               [0m
[2;36m                    [0m         [95mss[0m                                                                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=659471;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=249540;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mapache-commons-compres[0m [2m               [0m
[2;36m                    [0m         [95ms[0m                                                                                    [2m               [0m
