[2;36m[01/13/26 08:45:26][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=656142;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=428070;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpgrk499hb[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/[0m[95magent[0m [2m               [0m
[2;36m                    [0m         [95m-output-1768293926.7329285[0m                                                           [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-delta-01_vuln_9.toml [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Started[33m...[0m   ]8;id=565543;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=326215;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 08:47:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Building Cached for CLEAN environment[1m)[0m Took [1;36m106.71[0m ]8;id=722764;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=612388;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         seconds; [33mexception[0m=[3;91mFalse[0m                                                      [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m     ]8;id=523941;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=728727;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running tests for Cached for CLEAN environment[1m)[0m    ]8;id=107270;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=767086;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=600204;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=293044;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m106[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=862172;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=27659;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 08:47:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=5565;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=383191;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 08:47:16][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=691295;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=64569;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=995913;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=564046;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=821459;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=180002;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=863399;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=224962;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 08:47:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.28[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=717017;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=367773;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 08:47:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=575381;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=741183;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 08:47:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.95[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=858906;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=719026;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 08:47:30][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=397791;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=670080;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:594[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:453[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:314[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:274[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1m([0mParserDecorator.jav[1;92ma:153[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1m([0mDelegatingParser.jav[1;92ma:71[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mParsingEmb [2m                [0m
[2;36m                    [0m         eddedDocumentExtractor.jav[1;92ma:101[0m[1m)[0m                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1m([0mHtmlHandler.jav[1;92ma:377[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1m([0mHtmlHandler.jav[1;92ma:175[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1m([0mContentHandlerDecorator.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:125[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1m([0mXHTMLDowngradeHandle [2m                [0m
[2;36m                    [0m         r.jav[1;92ma:59[0m[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.parser.html.JSoupParser$[1;35mTikaNodeFilter.head[0m[1m([0mJSoupParser.jav[1;92ma:211[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.jsoup.select.NodeTraversor.filter[0m[1m([0mNodeTraversor.jav[1;92ma:92[0m[1m)[0m             [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1m([0mJSoupParser.jav[1;92ma:137[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:69[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:40[0m[1m)[0m           [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 3c99eeb1380e104c                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         == Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS [2m                [0m
[2;36m                    [0m         Command Injection                                                                   [2m                [0m
[2;36m                    [0m         Executing OS commands with attacker-controlled data can lead to remote code         [2m                [0m
[2;36m                    [0m         execution.                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1m([0mOsC [2m                [0m
[2;36m                    [0m         ommandInjection.jav[1;92ma:63[0m[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1110[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.ProcessBuilder.start[0m[1m([0mProcessBuilder.jav[1;92ma:1073[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:594[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at java.base/[1;35mjava.lang.Runtime.exec[0m[1m([0mRuntime.jav[1;92ma:453[0m[1m)[0m                       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:314[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1m([0mExternalParser.jav[1;92ma:274[0m[1m)[0m       [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1m([0mParserDecorator.jav[1;92ma:153[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1m([0mDelegatingParser.jav[1;92ma:71[0m[1m)[0m  [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1m([0mParsingEmb [2m                [0m
[2;36m                    [0m         eddedDocumentExtractor.jav[1;92ma:101[0m[1m)[0m                                                    [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1m([0mHtmlHandler.jav[1;92ma:377[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1m([0mHtmlHandler.jav[1;92ma:175[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1m([0mContentHandlerDecorator.ja [2m                [0m
[2;36m                    [0m         v[1;92ma:125[0m[1m)[0m                                                                             [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1m([0mXHTMLDowngradeHandle [2m                [0m
[2;36m                    [0m         r.jav[1;92ma:59[0m[1m)[0m                                                                          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         org.apache.tika.parser.html.JSoupParser$[1;35mTikaNodeFilter.head[0m[1m([0mJSoupParser.jav[1;92ma:211[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.jsoup.select.NodeTraversor.filter[0m[1m([0mNodeTraversor.jav[1;92ma:92[0m[1m)[0m             [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1m([0mJSoupParser.jav[1;92ma:137[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.CompositeParser.parse[0m[1m([0mCompositeParser.jav[1;92ma:298[0m[1m)[0m   [2m                [0m
[2;36m                    [0m                 at [1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1m([0mAutoDetectParser.jav[1;92ma:204[0m[1m)[0m [2m                [0m
[2;36m                    [0m                 at [1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:69[0m[1m)[0m          [2m                [0m
[2;36m                    [0m                 at                                                                          [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1m([0mHtmlParserFuzzer.jav[1;92ma:40[0m[1m)[0m           [2m                [0m
[2;36m                    [0m         DEDUP_TOKEN: 3c99eeb1380e104c                                                       [2m                [0m
[2;36m                    [0m         == libFuzzer crashing input ==                                                      [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 08:47:50][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=489058;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=756580;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 08:52:47][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=5520;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=384476;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 08:56:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=651387;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=195165;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=911798;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=166941;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 08:56:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.00[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=50826;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=729437;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=528876;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=431285;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp8cqwutak[0m                                                 ]8;id=469806;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=552084;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 08:57:31][0m[2;36m [0m[1;31mERROR   [0m Failed to build the challenge                                                         ]8;id=840914;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=252981;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#53\[2m53[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/agent[0m ]8;id=465182;file:///home/qqor/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=876491;file:///home/qqor/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m-output-1768293926.7329285/[0m[95mbuild_failed_stdout.txt[0m: [35m/[0m[95msrc[0m [35m/src/project-parent/[0m[95mtika[0m    [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/[0m[95mtika[0m                                                             [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         [33mCC[0m=[35mclang[0m                                                                             [2m               [0m
[2;36m                    [0m         [33mCXX[0m=[35mclang[0m++                                                                          [2m               [0m
[2;36m                    [0m         [33mCFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                            [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -fno-[33msanitize[0m=[35mleak[0m      [2m               [0m
[2;36m                    [0m         [33mCXXFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                          [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -[33mstdlib[0m=[35mlibc[0m++          [2m               [0m
[2;36m                    [0m         -fno-[33msanitize[0m=[35mleak[0m                                                                   [2m               [0m
[2;36m                    [0m         [33mRUSTFLAGS[0m=--cfg fuzzing -[33mZsanitizer[0m=[35maddress[0m -[33mCdebuginfo[0m=[1;36m1[0m -Cforce-frame-pointers     [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         + [33m__REAL_MAVEN_REPO[0m=[35m/root/.m2/[0m[95mrepository[0m                                             [2m               [0m
[2;36m                    [0m         + [33m__SHARED_MAVEN_REPO[0m=[35m/work/[0m[95mmavencache[0m                                               [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -L [35m/root/.m2/[0m[95mrepository[0m [32m'[0m[32m][0m[32m'[0m                                                [2m               [0m
[2;36m                    [0m         + unset __REAL_MAVEN_REPO                                                            [2m               [0m
[2;36m                    [0m         + unset __SHARED_MAVEN_REPO                                                          [2m               [0m
[2;36m                    [0m         + [33mPROJECT[0m=[35mtika[0m                                                                       [2m               [0m
[2;36m                    [0m         + [33mMAIN_REPOSITORY[0m=[4;94mhttps[0m[4;94m://github.com/apache/tika/[0m                                    [2m               [0m
[2;36m                    [0m         + [33mMAVEN_ARGS[0m=[32m'-Djavac.src.[0m[32mversion[0m[32m=[0m[32m17[0m[32m -Djavac.target.[0m[32mversion[0m[32m=[0m[32m17[0m[32m -DskipTests [0m          [2m               [0m
[2;36m                    [0m         [32m-Dcheckstyle.skip -Dossindex.skip -am -pl :tika-app'[0m                                 [2m               [0m
[2;36m                    [0m         + cd [35m/src/[0m[95mproject-parent[0m                                                             [2m               [0m
[2;36m                    [0m         + set_project_version_in_fuzz_targets_dependency                                     [2m               [0m
[2;36m                    [0m         ++ cd tika                                                                           [2m               [0m
[2;36m                    [0m         ++ [35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m                                             [2m               [0m
[2;36m                    [0m         org.apache.maven.plugins:maven-help-plugin:[1;36m3.2[0m.[1;92m0:e[0mvaluate                            [2m               [0m
[2;36m                    [0m         -[33mDexpression[0m=[35mproject[0m.version -q -DforceStdout                                        [2m               [0m
[2;36m                    [0m         + [33mPROJECT_VERSION[0m=[1;36m4[0m[1;36m.0[0m.[1;36m0[0m-SNAPSHOT                                                     [2m               [0m
[2;36m                    [0m         + cd fuzz-targets                                                                    [2m               [0m
[2;36m                    [0m         + [35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m versions:use-dep-version                     [2m               [0m
[2;36m                    [0m         -[33mDexcludes[0m=[35mcom[0m.code-intelligence:jazzer -[33mDdepVersion[0m=[1;36m4[0m[1;36m.0[0m.[1;36m0[0m-SNAPSHOT                  [2m               [0m
[2;36m                    [0m         -[33mDforceVersion[0m=[35mtrue[0m                                                                  [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Scanning for projects[33m...[0m                                                      [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m                                                                               [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ----------------------[1m<[0m[39m com.fuzzer:fuzz-targets >-----------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building fuzz [0m[1;36m0.0[0m[39m.[0m[1;36m1[0m[39m-SNAPSHOT[0m                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from pom.xml[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- versions:[0m[1;36m2.20[0m[39m.[0m[1;36m1[0m[39m:use-dep-version [0m[1;39m([0m[39mdefault-cli[0m[1;39m)[0m[39m @ fuzz-targets ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Updated org.apache.tika:tika-app:jar:[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT to version [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD SUCCESS[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m0.701[0m[39m s[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-13T[0m[1;92m08:57:03[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [39m+ cd tika[0m                                                                            [2m               [0m
[2;36m                    [0m         [39m+ [0m[35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m[39m install -Djavac.src.[0m[33mversion[0m[39m=[0m[1;36m17[0m[39m [0m              [2m               [0m
[2;36m                    [0m         [39m-Djavac.target.[0m[33mversion[0m[39m=[0m[1;36m17[0m[39m -DskipTests -Dcheckstyle.skip -Dossindex.skip -am -pl [0m     [2m               [0m
[2;36m                    [0m         [39m:tika-app -Dmaven.repo.[0m[33mlocal[0m[39m=[0m[35m/out/[0m[95mm2[0m                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for projects[0m[33m...[0m                                                      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Build Order:[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent                                                 [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core                                                [0m[1;39m[[0m[39mbundle[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization                                          [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules                                         [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package                    [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules                                [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module                                    [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module                               [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons                                           [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module                                    [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module                                   [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons                                         [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module              [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module                                  [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers                                               [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP                                                 [0m[1;39m[[0m[39mbundle[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection                                     [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect                                   [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes                                                  [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters                                               [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI                                              [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------< org.apache.tika:tika-parent >---------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                        [0m[1;39m[[0m[1;36m1[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from pom.xml[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m pom [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parent ---[0m               [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; POM module[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parent ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parent ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parent ---[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m1[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-parent ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-parent ---[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parent ---[0m                       [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                   [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ tika-parent [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parent ---[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parent ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/project-parent/tika/tika-parent/[0m[95mpom.xml[0m[39m to [0m                   [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parent/4.0.0-SNAPSHOT/[0m[95mtika-parent-4.0.0-SNAPSHOT.pom[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ---------------------< org.apache.tika:tika-core >----------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika core [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                          [0m[1;39m[[0m[1;36m2[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m[35m/src/project-parent/tika/tika-core/[0m[95mpom.xml[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------[0m[1;39m[[0m[39m bundle [0m[1;39m][0m[39m-------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-core ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-core ---[0m            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-core ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-core ---[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m1[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-core ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-core ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-core ---[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ tika-core ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying appended resource: META-INF/LICENSE[0m                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ tika-core ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m5[0m[39m resources from src/main/resources to target/classes[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-core ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed source code.[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m361[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m      [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mServiceLoade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m: Some input files use unchecked or unsafe operations.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mServiceLoade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m: Recompile with -Xlint:unchecked for details.[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m COMPILATION WARNING : [0m                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/exception/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/fork/[0m[95mpackage-info.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated[0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/io/[0m[95mpackage-info.jav[0m [2m               [0m
[2;36m                    [0m         [95ma[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated [0m  [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/metadata/[0m[95mpackage-in[0m [2m               [0m
[2;36m                    [0m         [95mfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m       [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mpackage-info.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated[0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/[0m[95mpackage-info.java[0m[39m:[0m[1;39m[[0m [2m               [0m
[2;36m                    [0m         [1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated and [0m [2m               [0m
[2;36m                    [0m         [39mmarked for removal[0m                                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/external/[0m[95mpac[0m [2m               [0m
[2;36m                    [0m         [95mkage-info.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been[0m [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/sax/[0m[95mpackage-info.ja[0m [2m               [0m
[2;36m                    [0m         [95mva[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated [0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/sax/xpath/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/utils/[0m[95mpackage-info.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m          [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/io/[0m[95mTikaInputStream.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m342[0m[39m,[0m[1;36m36[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                         [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mDefaultDetec[0m [2m               [0m
[2;36m                    [0m         [95mtor.java[0m[39m:[0m[1;39m[[0m[1;36m97[0m[39m,[0m[1;36m37[0m[1;39m][0m[39m org.apache.tika.detect.OverrideDetector in org.apache.tika.detect [0m  [2m               [0m
[2;36m                    [0m         [39mhas been deprecated[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mProbabilisticM[0m [2m               [0m
[2;36m                    [0m         [95mimeDetectionSelector.java[0m[39m:[0m[1;39m[[0m[1;36m162[0m[39m,[0m[1;36m36[0m[1;39m][0m[39m [0m[1;35mgetMimeType[0m[1;39m([0m[39mjava.lang.String[0m[1;39m)[0m[39m in [0m                 [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.mime.MimeTypes has been deprecated[0m                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mXmlRootExtra[0m [2m               [0m
[2;36m                    [0m         [95mctor.java[0m[39m:[0m[1;39m[[0m[1;36m46[0m[39m,[0m[1;36m43[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                     [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/embedder/[0m[95mExternalEm[0m [2m               [0m
[2;36m                    [0m         [95mbedder.java[0m[39m:[0m[1;39m[[0m[1;36m428[0m[39m,[0m[1;36m72[0m[1;39m][0m[39m [0m[1;35mget[0m[1;39m([0m[39mjava.io.File[0m[1;39m)[0m[39m in org.apache.tika.io.TikaInputStream has [0m    [2m               [0m
[2;36m                    [0m         [39mbeen deprecated[0m                                                                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParserCon[0m [2m               [0m
[2;36m                    [0m         [95mtainerExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m128[0m[39m,[0m[1;36m61[0m[1;39m][0m[39m [0m[1;35mget[0m[1;39m([0m[39mjava.io.File[0m[1;39m)[0m[39m in [0m                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.io.TikaInputStream has been deprecated[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mMimeTypesReade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m32[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                       [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m21[0m[39m warnings [0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m103[0m[39m,[0m[1;36m79[0m[1;39m][0m[39m incomparable types: org.apache.tika.parser.external.ExternalParser[0m [2m               [0m
[2;36m                    [0m         [39mand java.lang.Boolean[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingEm[0m [2m               [0m
[2;36m                    [0m         [95mbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m99[0m[1;39m][0m[39m incomparable types: [0m                           [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingEm[0m [2m               [0m
[2;36m                    [0m         [95mbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m108[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                           [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m                [2m               [0m
[2;36m                    [0m         [39m  required: java.lang.Class<T>,T[0m                                                     [2m               [0m
[2;36m                    [0m         [39m  found:    [0m                                                                         [2m               [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.ExternalParser>,java.lang.Boolean[0m    [2m               [0m
[2;36m                    [0m         [39m  reason: inference variable T has incompatible bounds[0m                               [2m               [0m
[2;36m                    [0m         [39m    equality constraints: org.apache.tika.parser.external.ExternalParser[0m             [2m               [0m
[2;36m                    [0m         [39m    lower bounds: java.lang.Boolean[0m                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingEm[0m [2m               [0m
[2;36m                    [0m         [95mbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m109[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                           [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m                [2m               [0m
[2;36m                    [0m         [39m  required: java.lang.Class<T>,T[0m                                                     [2m               [0m
[2;36m                    [0m         [39m  found:    [0m                                                                         [2m               [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.CompositeExternalParser>,java.lang.B[0m [2m               [0m
[2;36m                    [0m         [39moolean[0m                                                                               [2m               [0m
[2;36m                    [0m         [39m  reason: inference variable T has incompatible bounds[0m                               [2m               [0m
[2;36m                    [0m         [39m    equality constraints: org.apache.tika.parser.external.CompositeExternalParser[0m    [2m               [0m
[2;36m                    [0m         [39m    lower bounds: java.lang.Boolean[0m                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m4[0m[39m errors [0m                                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m13.621[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m4.844[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m26.638[0m[39m s[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-13T[0m[1;92m08:57:30[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m  [2m               [0m
[2;36m                    [0m         [39mproject tika-core: Compilation failure: Compilation failure: [0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m103[0m[39m,[0m[1;36m79[0m[1;39m][0m[39m incomparable types: org.apache.tika.parser.external.ExternalParser[0m [2m               [0m
[2;36m                    [0m         [39mand java.lang.Boolean[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingEm[0m [2m               [0m
[2;36m                    [0m         [95mbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m99[0m[1;39m][0m[39m incomparable types: [0m                           [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingEm[0m [2m               [0m
[2;36m                    [0m         [95mbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m108[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                           [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   required: java.lang.Class<T>,T[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   found:    [0m                                                                 [2m               [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.ExternalParser>,java.lang.Boolean[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   reason: inference variable T has incompatible bounds[0m                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     equality constraints: org.apache.tika.parser.external.ExternalParser[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     lower bounds: java.lang.Boolean[0m                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingEm[0m [2m               [0m
[2;36m                    [0m         [95mbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m109[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                           [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   required: java.lang.Class<T>,T[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   found:    [0m                                                                 [2m               [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.CompositeExternalParser>,java.lang.B[0m [2m               [0m
[2;36m                    [0m         [39moolean[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   reason: inference variable T has incompatible bounds[0m                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     equality constraints: [0m                                                   [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.CompositeExternalParser[0m                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     lower bounds: java.lang.Boolean[0m                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors and possible solutions, please read [0m   [2m               [0m
[2;36m                    [0m         [39mthe following articles:[0m                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m[39m [0m                                                                    [2m               [0m
[2;36m                    [0m         [4;94mhttp://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m After correcting the problems, you can resume the build with the command[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   mvn <args[0m[1m>[0m -rf :tika-core                                                  [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/agent[0m ]8;id=576108;file:///home/qqor/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=276975;file:///home/qqor/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m-output-1768293926.7329285/[0m[95mbuild_failed_stderr.txt[0m: INFO:__main__:Running: docker    [2m               [0m
[2;36m                    [0m         build -t aixcc-afc/tika:latest --file                                                [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/tika/[0m[95mDockerfile[0m         [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/[0m[95mtika.[0m                   [2m               [0m
[2;36m                    [0m         #[1;36m0[0m building with [32m"default"[0m instance using docker driver                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m1[0m [1m[[0minternal[1m][0m load build definition from Dockerfile                                  [2m               [0m
[2;36m                    [0m         #[1;36m1[0m transferring dockerfile: [1;36m1.[0m74kB done                                              [2m               [0m
[2;36m                    [0m         #[1;36m1[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m2[0m [1m[[0minternal[1m][0m load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m2.1[0m         [2m               [0m
[2;36m                    [0m         #[1;36m2[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m3[0m [1m[[0minternal[1m][0m load .dockerignore                                                     [2m               [0m
[2;36m                    [0m         #[1;36m3[0m transferring context: 2B done                                                     [2m               [0m
[2;36m                    [0m         #[1;36m3[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m4[0m [1m[[0m [1;36m1[0m/[1;36m11[0m[1m][0m FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m2.1[0m                         [2m               [0m
[2;36m                    [0m         #[1;36m4[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m5[0m [1m[[0minternal[1m][0m load build context                                                     [2m               [0m
[2;36m                    [0m         #[1;36m5[0m transferring context: [1;36m1.[0m73kB done                                                 [2m               [0m
[2;36m                    [0m         #[1;36m5[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m6[0m [1m[[0m [1;36m8[0m/[1;36m11[0m[1m][0m COPY pkgs/tika.tar.gz [35m/src/[0m[95mtika.tar.gz[0m                                    [2m               [0m
[2;36m                    [0m         #[1;36m6[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m7[0m [1m[[0m [1;36m4[0m/[1;36m11[0m[1m][0m RUN mkdir [35m/[0m[95mexif[0m && cp [35m/usr/bin/[0m[95mexiftool[0m [35m/[0m[95mexif[0m && chmod -R a+rwx [35m/[0m[95mexif[0m     [2m               [0m
[2;36m                    [0m         #[1;36m7[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m8[0m [1m[[0m [1;36m6[0m/[1;36m11[0m[1m][0m RUN unzip [35m/src/[0m[95mmaven.zip[0m -d [35m/src/[0m[95mmaven[0m && rm [35m/src/[0m[95mmaven.zip[0m               [2m               [0m
[2;36m                    [0m         #[1;36m8[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m9[0m [1m[[0m [1;36m2[0m/[1;36m11[0m[1m][0m RUN set -eux     && apt-get update     && apt-get install --yes           [2m               [0m
[2;36m                    [0m         --no-install-recommends         tesseract-ocr         tesseract-ocr-eng              [2m               [0m
[2;36m                    [0m         exiftool                                                                             [2m               [0m
[2;36m                    [0m         #[1;36m9[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m10[0m [1m[[0m [1;36m3[0m/[1;36m11[0m[1m][0m RUN mkdir [35m/usr/[0m[95mmy-bin[0m && mv [35m/usr/bin/[0m[95mtesseract[0m [35m/usr/my-bin/[0m[95mtesseract[0m     [2m               [0m
[2;36m                    [0m         #[1;36m10[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m11[0m [1m[[0m [1;36m5[0m/[1;36m11[0m[1m][0m COPY pkgs/maven.zip [35m/src/[0m[95mmaven.zip[0m                                       [2m               [0m
[2;36m                    [0m         #[1;36m11[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m12[0m [1m[[0m[1;36m10[0m/[1;36m11[0m[1m][0m COPY build.sh [35m/src/[0m                                                      [2m               [0m
[2;36m                    [0m         #[1;36m12[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m13[0m [1m[[0m [1;36m9[0m/[1;36m11[0m[1m][0m RUN tar -zxf [35m/src/[0m[95mtika.tar.gz[0m -C [35m/src/[0m[95mproject-parent[0m && rm               [2m               [0m
[2;36m                    [0m         [35m/src/[0m[95mtika.tar.gz[0m                                                                     [2m               [0m
[2;36m                    [0m         #[1;36m13[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m14[0m [1m[[0m [1;36m7[0m/[1;36m11[0m[1m][0m COPY project-parent [35m/src/project-parent/[0m                                 [2m               [0m
[2;36m                    [0m         #[1;36m14[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m15[0m [1m[[0m[1;36m11[0m/[1;36m11[0m[1m][0m WORKDIR [35m/src/project-parent/[0m[95mtika[0m                                         [2m               [0m
[2;36m                    [0m         #[1;36m15[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m16[0m exporting to image                                                               [2m               [0m
[2;36m                    [0m         #[1;36m16[0m exporting layers done                                                            [2m               [0m
[2;36m                    [0m         #[1;36m16[0m writing image                                                                    [2m               [0m
[2;36m                    [0m         sh[1;92ma256:d960[0me891282ff456c3e4bae3fede9b9849b941689517938e1f5e02d8a0c511c4 done         [2m               [0m
[2;36m                    [0m         #[1;36m16[0m naming to docker.io/aixcc-afc/tika:latest done                                   [2m               [0m
[2;36m                    [0m         #[1;36m16[0m DONE [1;36m0.[0m0s                                                                        [2m               [0m
[2;36m                    [0m         INFO:__main__:Keeping existing build artifacts as-is [1m([0mif any[1m)[0m.                       [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m -e [33mSANITIZER[0m=[35maddress[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -e   [2m               [0m
[2;36m                    [0m         [33mPROJECT_NAME[0m=[35mtika[0m -e [33mHELPER[0m=[3;92mTrue[0m -e [33mFUZZING_LANGUAGE[0m=[35mjvm[0m -e [33mBASH_ENV[0m=[35m/work/[0m[95mbashrc0[0m   [2m               [0m
[2;36m                    [0m         -e [33mMAVEN_OPTS[0m=-Dmaven.repo.[33mlocal[0m=[35m/work/[0m[95mmavencache[0m -v                                 [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m:[35m/[0m[95mlocal-source-mount[0m:ro -v                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/tika/[0m:[35m/[0m[95mout[0m -v          [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m:[35m/[0m[95mwork[0m -t         [2m               [0m
[2;36m                    [0m         aixcc-afc/tika:latest [35m/bin/[0m[95mbash[0m -c [32m'pushd $SRC && rm -rf /src/project-parent/tika &&[0m [2m               [0m
[2;36m                    [0m         [32mcp -r /local-source-mount /src/project-parent/tika && popd && compile'[0m.              [2m               [0m
[2;36m                    [0m         ERROR:__main__:Building fuzzers failed.                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m35.84[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=313163;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=622068;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=462511;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=469422;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 08:57:32][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.91[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=489464;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=868748;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 08:57:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=492410;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=445458;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 08:57:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.04[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=738524;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=455447;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 08:57:35][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=136089;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=754591;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java   [2m                [0m
[2;36m                    [0m         +++ b/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java   [2m                [0m
[2;36m                    [0m         @@ [1;36m-158[0m,[1;36m7[0m +[1;36m158[0m,[1;36m8[0m @@                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  Process process = null;                                                    [2m                [0m
[2;36m                    [0m                  try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            process = [1;35mRuntime.getRuntime[0m[1m([0m[1m)[0m[1;35m.exec[0m[1m([0mcheckCmd[1m)[0m;                         [2m                [0m
[2;36m                    [0m         +            ProcessBuilder pb = new [1;35mProcessBuilder[0m[1m([0mcheckCmd[1m)[0m;                      [2m                [0m
[2;36m                    [0m         +            process = [1;35mpb.start[0m[1m([0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m                      Thread stdErrSuckerThread = [1;35mignoreStream[0m[1m([0m[1;35mprocess.getErrorStream[0m[1m([0m[1m)[0m,     [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m                      Thread stdOutSuckerThread = [1;35mignoreStream[0m[1m([0m[1;35mprocess.getInputStream[0m[1m([0m[1m)[0m,     [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m                      [1;35mstdErrSuckerThread.join[0m[1m([0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-285[0m,[1;36m14[0m +[1;36m286[0m,[1;36m9[0m @@                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  File output = null;                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -        [35m/[0m[35m/[0m Build our command                                                       [2m                [0m
[2;36m                    [0m         -        String[1m[[0m[1m][0m cmd;                                                              [2m                [0m
[2;36m                    [0m         -        if [1m([0mcommand.length == [1;36m1[0m[1m)[0m [1m{[0m                                                 [2m                [0m
[2;36m                    [0m         -            cmd = command[1m[[0m[1;36m0[0m[1m][0m[1;35m.split[0m[1m([0m[32m" "[0m[1m)[0m;                                           [2m                [0m
[2;36m                    [0m         -        [1m}[0m else [1m{[0m                                                                   [2m                [0m
[2;36m                    [0m         -            cmd = new String[1m[[0mcommand.length[1m][0m;                                      [2m                [0m
[2;36m                    [0m         -            [1;35mSystem.arraycopy[0m[1m([0mcommand, [1;36m0[0m, cmd, [1;36m0[0m, command.length[1m)[0m;                  [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Build our command - use command array directly without string splitting [2m                [0m
[2;36m                    [0m         +        String[1m[[0m[1m][0m cmd = new String[1m[[0mcommand.length[1m][0m;                                 [2m                [0m
[2;36m                    [0m         +        [1;35mSystem.arraycopy[0m[1m([0mcommand, [1;36m0[0m, cmd, [1;36m0[0m, command.length[1m)[0m;                      [2m                [0m
[2;36m                    [0m                  for [1m([0mint i = [1;36m0[0m; i [1m<[0m[39m cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [39m                 cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                         [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-305[0m[39m,[0m[1;36m14[0m[39m +[0m[1;36m301[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Execute using ProcessBuilder to avoid shell injection[0m                   [2m                [0m
[2;36m                    [0m         [39m         Process process = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m         try [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m-                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m-                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m+            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- [0m                                                                                [2m                [0m
[2;36m                    [0m         [39ma/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html[0m [2m                [0m
[2;36m                    [0m         [39m-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java[0m                  [2m                [0m
[2;36m                    [0m         [39m+++ [0m                                                                                [2m                [0m
[2;36m                    [0m         [39mb/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html[0m [2m                [0m
[2;36m                    [0m         [39m-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java[0m                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-370[0m[39m,[0m[1;36m8[0m[39m +[0m[1;36m370[0m[39m,[0m[1;36m17[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        ParseContext restrictedContext = new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m+        Parser originalParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39moriginalParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mParser.class, originalParser[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mExternalParser.class, Boolean.FALSE[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mCompositeExternalParser.class, Boolean.FALSE[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m         EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                      [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m+                [0m                                                                   [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mrestrictedContext[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m             try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, true[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- [0m                                                                                [2m                [0m
[2;36m                    [0m         [39ma/tika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtracto[0m [2m                [0m
[2;36m                    [0m         [39mr.java[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m+++ [0m                                                                                [2m                [0m
[2;36m                    [0m         [39mb/tika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtracto[0m [2m                [0m
[2;36m                    [0m         [39mr.java[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-95[0m[39m,[0m[1;36m19[0m[39m +[0m[1;36m95[0m[39m,[0m[1;36m33[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+        ParseContext effectiveContext = context;[0m                                   [2m                [0m
[2;36m                    [0m         [39m+        boolean isInlineEmbedded = [0m                                                [2m                [0m
[2;36m                    [0m         [1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35m.equals[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE[0m[1;39m)[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39misInlineEmbedded && [0m                                                   [2m                [0m
[2;36m                    [0m         [1;35mcontext.get[0m[1;39m([0m[39morg.apache.tika.parser.external.ExternalParser.class[0m[1;39m)[0m[39m == Boolean.FALSE[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+            effectiveContext = new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+            Parser originalParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39moriginalParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35meffectiveContext.set[0m[1;39m([0m[39mParser.class, originalParser[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;35meffectiveContext.set[0m[1;39m([0m[39morg.apache.tika.parser.external.ExternalParser.class, [0m         [2m                [0m
[2;36m                    [0m         [39mBoolean.FALSE[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;35meffectiveContext.set[0m[1;39m([0m[39morg.apache.tika.parser.external.CompositeExternalParser.class,[0m [2m                [0m
[2;36m                    [0m         [39mBoolean.FALSE[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m Use the delegate parser to parse this entry[0m                             [2m                [0m
[2;36m                    [0m         [39m         try [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mtis.setCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mDELEGATING_PARSER.parse[0m[1;39m([0m[39mtis, new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m[39mnew [0m           [2m                [0m
[2;36m                    [0m         [1;35mBodyContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [39m-                    metadata, context[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m+                    metadata, effectiveContext[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEncryptedDocumentException ede[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mrecordException[0m[1;39m([0m[39mede, context[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mrecordException[0m[1;39m([0m[39mede, effectiveContext[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCorruptedFileException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[95mnecessary[0m[39m to stop the parse to avoid infinite loops[0m                  [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[95mon[0m[39m corrupt sqlite3 files[0m                                             [2m                [0m
[2;36m                    [0m         [39m             throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mrecordException[0m[1;39m([0m[39me, context[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mrecordException[0m[1;39m([0m[39me, effectiveContext[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mtis.removeCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java[0m           [2m                [0m
[2;36m                    [0m         [39m+++ b/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java[0m           [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-99[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m99[0m[39m,[0m[1;36m15[0m[39m @@[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [39m         Map<MediaType, Parser> map = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m+        boolean blockExternalParsers = context != null && [0m                         [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mcontext.get[0m[1;39m([0m[39morg.apache.tika.parser.external.ExternalParser.class[0m[1;39m)[0m[39m == [0m  [2m                [0m
[2;36m                    [0m         [39mBoolean.FALSE;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m         for [0m[1;39m([0m[39mParser parser : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39mblockExternalParsers && [0m                                           [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;39m([0m[39mparser instanceof org.apache.tika.parser.external.ExternalParser [0m [2m                [0m
[2;36m                    [0m         [39m||[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m+                 parser instanceof [0m                                                [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.CompositeExternalParser[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [39m+                continue;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m             for [0m[1;39m([0m[39mMediaType type : [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmap.put[0m[1;39m([0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m, parser[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m103[0m[39m,[0m[1;36m79[0m[1;39m][0m[39m incomparable types: [0m                                             [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m99[0m[1;39m][0m[39m incomparable types: [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m108[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m               [2m                [0m
[2;36m                    [0m         [39m  required: java.lang.Class<T>,T[0m                                                    [2m                [0m
[2;36m                    [0m         [39m  found:    [0m                                                                        [2m                [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.ExternalParser>,java.lang.Boolean[0m   [2m                [0m
[2;36m                    [0m         [39m  reason: inference variable T has incompatible bounds[0m                              [2m                [0m
[2;36m                    [0m         [39m    equality constraints: org.apache.tika.parser.external.ExternalParser[0m            [2m                [0m
[2;36m                    [0m         [39m    lower bounds: java.lang.Boolean[0m                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m109[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m               [2m                [0m
[2;36m                    [0m         [39m  required: java.lang.Class<T>,T[0m                                                    [2m                [0m
[2;36m                    [0m         [39m  found:    [0m                                                                        [2m                [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.CompositeExternalParser>,java.lang.[0m [2m                [0m
[2;36m                    [0m         [39mBoolean[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m  reason: inference variable T has incompatible bounds[0m                              [2m                [0m
[2;36m                    [0m         [39m    equality constraints: org.apache.tika.parser.external.CompositeExternalParser[0m   [2m                [0m
[2;36m                    [0m         [39m    lower bounds: java.lang.Boolean[0m                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m4[0m[39m errors [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m13.621[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m4.844[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m26.638[0m[39m s[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-13T[0m[1;92m08:57:30[0m[39mZ[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                     [2m                [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m [2m                [0m
[2;36m                    [0m         [39mproject tika-core: Compilation failure: Compilation failure: [0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m103[0m[39m,[0m[1;36m79[0m[1;39m][0m[39m incomparable types: [0m                                             [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m99[0m[1;39m][0m[39m incomparable types: [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m108[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m               [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   required: java.lang.Class<T>,T[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   found:    [0m                                                                [2m                [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.ExternalParser>,java.lang.Boolean[0m   [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   reason: inference variable T has incompatible bounds[0m                      [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     equality constraints: org.apache.tika.parser.external.ExternalParser[0m    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     lower bounds: java.lang.Boolean[0m                                         [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m109[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m               [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   required: java.lang.Class<T>,T[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   found:    [0m                                                                [2m                [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.CompositeExternalParser>,java.lang.[0m [2m                [0m
[2;36m                    [0m         [39mBoolean[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   reason: inference variable T has incompatible bounds[0m                      [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     equality constraints: [0m                                                  [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.CompositeExternalParser[0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     lower bounds: java.lang.Boolean[0m                                         [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors[0m                                       [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA critical OS Command Injection vulnerability has been detected in Apache Tika [0m     [2m                [0m
[2;36m                    [0m         [39mduring fuzzing operations. The vulnerability is triggered when parsing HTML content[0m [2m                [0m
[2;36m                    [0m         [39mcontaining data URIs that embed documents, leading to external parser execution [0m    [2m                [0m
[2;36m                    [0m         [39mwith potentially attacker-controlled data. The security issue is classified as [0m     [2m                [0m
[2;36m                    [0m         [39mcritical, indicating that successful exploitation could result in remote code [0m      [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is an **OS Command Injection** vulnerability, where user-supplied or [0m          [2m                [0m
[2;36m                    [0m         [39mattacker-controlled data can be used to construct and execute operating system [0m     [2m                [0m
[2;36m                    [0m         [39mcommands. This vulnerability class is considered critical as it can lead to [0m        [2m                [0m
[2;36m                    [0m         [39marbitrary code execution on the host system.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Details[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mThe stack trace reveals the following execution flow:[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The fuzzer triggers HTML parsing through `[0m[1;35mHtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The HTML parser [0m[1;39m([0m[39m`AutoDetectParser`[0m[1;39m)[0m[39m processes the input document[0m                [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. During HTML parsing [0m[1;39m([0m[39m`JSoupParser`[0m[1;39m)[0m[39m, the `[0m[1;35mHtmlHandler.startElement[0m[1;39m([0m[1;39m)[0m[39m` method [0m    [2m                [0m
[2;36m                    [0m         [39mencounters content requiring special handling[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. A data URI scheme is detected and processed via [0m                                 [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mHtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The embedded document is extracted and parsed through [0m                           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[1;39m)[0m[39m`[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. The parser delegates to `AutoDetectParser` and subsequently `CompositeParser`[0m    [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. An `ExternalParser` is invoked, which attempts to execute an external command[0m    [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. The execution chain reaches `[0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m` through `[0m[1;35mProcessBuilder.start[0m[1;39m([0m[1;39m)[0m[39m`[0m    [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m. At this point, the Jazzer security hook [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`[0m[1;35mOsCommandInjection.processImplStartHook[0m[1;39m([0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m intercepts the command execution and [0m [2m                [0m
[2;36m                    [0m         [39mdetects that attacker-controlled data is being used in the OS command[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Attack Vector**: The vulnerability is triggered through HTML content [0m          [2m                [0m
[2;36m                    [0m         [39mcontaining data URIs, which is a common method for embedding resources directly in [0m [2m                [0m
[2;36m                    [0m         [39mHTML documents using base64 encoding or other formats.[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **External Parser Involvement**: The `ExternalParser` class is directly involved[0m [2m                [0m
[2;36m                    [0m         [39min executing OS commands, suggesting that Tika relies on external command-line [0m     [2m                [0m
[2;36m                    [0m         [39mtools to parse certain document types.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Data Flow**: User-controlled input flows from HTML parsing through multiple [0m   [2m                [0m
[2;36m                    [0m         [39mparser layers before reaching the command execution point, indicating a complex [0m    [2m                [0m
[2;36m                    [0m         [39mdata flow that requires careful analysis.[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Critical Severity**: The Jazzer fuzzer has classified this as a [0m               [2m                [0m
[2;36m                    [0m         [39m`FuzzerSecurityIssueCritical`, indicating high confidence that this represents a [0m   [2m                [0m
[2;36m                    [0m         [39mgenuine security vulnerability with severe impact potential.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a holistic understanding of this vulnerability, the following components [0m   [2m                [0m
[2;36m                    [0m         [39mshould be thoroughly investigated:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **[0m[1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m**: Examine how [0m  [2m                [0m
[2;36m                    [0m         [39mdata URIs are extracted, decoded, and processed, particularly how the MIME type and[0m [2m                [0m
[2;36m                    [0m         [39mcontent are determined.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **org.apache.tika.extractor.ParsingEmbeddedDocumentExtractor**: Investigate how [0m [2m                [0m
[2;36m                    [0m         [39membedded documents are detected, extracted, and delegated to appropriate parsers.[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **org.apache.tika.parser.external.ExternalParser**: This is the critical [0m        [2m                [0m
[2;36m                    [0m         [39mcomponent where OS commands are constructed and executed. Analysis should focus on:[0m [2m                [0m
[2;36m                    [0m         [39m   - How external command paths and arguments are constructed[0m                       [2m                [0m
[2;36m                    [0m         [39m   - What data from the input document influences command construction[0m              [2m                [0m
[2;36m                    [0m         [39m   - What validation or sanitization is performed on inputs before command [0m         [2m                [0m
[2;36m                    [0m         [39mexecution[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **org.apache.tika.parser.AutoDetectParser and CompositeParser**: Understand the [0m [2m                [0m
[2;36m                    [0m         [39mparser selection logic to identify which file types or content trigger the external[0m [2m                [0m
[2;36m                    [0m         [39mparser pathway.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Configuration and External Parser Registry**: Investigate how external parsers[0m [2m                [0m
[2;36m                    [0m         [39mare configured and registered within Tika, including what external tools are [0m       [2m                [0m
[2;36m                    [0m         [39minvoked and under what conditions.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Input Validation Layer**: Examine if there are any validation mechanisms that [0m [2m                [0m
[2;36m                    [0m         [39mshould prevent untrusted data from reaching the command execution layer, and why [0m   [2m                [0m
[2;36m                    [0m         [39mthey may have failed in this case.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m60[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.external;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.Reader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.io.TemporaryResources;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * Parser that uses an external program [0m[1;39m([0m[39mlike catdoc or pdf2txt[0m[1;39m)[0m[39m to extract[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * text content and metadata from a given document.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ExternalParser implements Parser [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:268[0m[39m-[0m[1;36m319[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:        XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        TemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            [0m[1;35mparse[0m[1;39m([0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, metadata[0m[1;39m)[0m[39m, xhtml, metadata, [0m [2m                [0m
[2;36m                    [0m         [39mtmp[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:            [0m[1;35mtmp.dispose[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:19[0m[39m-[0m[1;36m53[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.net.MalformedURLException;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.metadata.HTML;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.Office;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.parser.external.CompositeExternalParser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.sax.TextContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.utils.StringUtils;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m384[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:19[0m[39m-[0m[1;36m40[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.apache.tika.sax.XHTMLContentHandler.XHTML;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.FilenameFilter;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.exception.CorruptedFileException;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.EncryptedDocumentException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.parser.DelegatingParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.ParseRecord;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.sax.BodyContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:80[0m[39m-[0m[1;36m118[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public void [0m[1;35mparseEmbedded[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            TikaInputStream tis, ContentHandler handler, Metadata metadata, [0m     [2m                [0m
[2;36m                    [0m         [39mboolean outputHtml[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws SAXException, IOException [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            AttributesImpl attributes = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            [0m[1;35mattributes.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"CDATA"[0m[39m, [0m              [2m                [0m
[2;36m                    [0m         [32m"package-entry"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[39m, attributes[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        if [0m[1;39m([0m[39mwriteFileNameToContent && name != null && [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m && [0m      [2m                [0m
[2;36m                    [0m         [39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[39m, new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m chars = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            [0m[1;35mhandler.characters[0m[1;39m([0m[39mchars, [0m[1;36m0[0m[39m, chars.length[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[35m/[0m[35m/[0m[39m Use the delegate parser to parse this entry[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;35mtis.setCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mDELEGATING_PARSER.parse[0m[1;39m([0m[39mtis, new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m[39mnew [0m        [2m                [0m
[2;36m                    [0m         [1;35mBodyContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                    metadata, context[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEncryptedDocumentException ede[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39mede, context[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCorruptedFileException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[95mnecessary[0m[39m to stop the parse to avoid infinite loops[0m               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[35m/[0m[35m/[0m[95mon[0m[39m corrupt sqlite3 files[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39me, context[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mtis.removeCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/utils/ProcessUtils.jav[0m[1;92ma:48[0m[39m-[0m[1;36m75[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * This should correctly put double-quotes around an argument if[0m             [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * ProcessBuilder doesn't seem to work [0m[1;39m([0m[39mas it doesn't[0m                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * on paths with spaces on Windows[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     * @param arg[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @return[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public static String [0m[1;35mescapeCommandLine[0m[1;39m([0m[39mString arg[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        if [0m[1;39m([0m[39marg == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            return arg;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        [0m[35m/[0m[35m/[0m[95mneed[0m[39m to test for [0m[32m" "[0m[39m on windows, can't just add double quotes[0m          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[35m/[0m[35m/[0m[95macross[0m[39m platforms.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        if [0m[1;39m([0m[1;35marg.contains[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m && SystemUtils.IS_OS_WINDOWS &&[0m                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                [0m[1;39m([0m[39m![0m[1;35marg.startsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[39m && ![0m[1;35marg.endsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:            arg = [0m[32m"\""[0m[39m + arg + [0m[32m"\""[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        return arg;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public static String [0m[1;35munescapeCommandLine[0m[1;39m([0m[39mString arg[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[1;35marg.contains[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m && SystemUtils.IS_OS_WINDOWS &&[0m                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;39m([0m[1;35marg.startsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[39m && [0m[1;35marg.endsWith[0m[1;39m([0m[32m"\""[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            arg = [0m[1;35marg.substring[0m[1;39m([0m[1;36m1[0m[39m, [0m[1;35marg.length[0m[1;39m([0m[1;39m)[0m[39m - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        return arg;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external2/ExternalParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m16[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[95mthis[0m[39m may remain null, depending on whether the external parser writes[0m [2m                [0m
[2;36m                    [0m         [39mto a file[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        Path outFile = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        try [0m[1;39m([0m[39mTemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            TikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, metadata[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            Path p = [0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            List<String> thisCommandLine = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            Matcher inputMatcher = [0m[1;35mIN[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            Matcher outputMatcher = [0m[1;35mOUT[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            boolean outputFileInCommandline = false;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            for [0m[1;39m([0m[39mString c : commandLine[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                if [0m[1;39m([0m[1;35minputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35mp.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35moutputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                    outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35moutFile.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                    outputFileInCommandline = true;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            FileProcessResult result = null;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            long localTimeoutMillis = [0m[1;35mTikaTaskTimeout.getTimeoutMillis[0m[1;39m([0m[39mcontext,[0m [2m                [0m
[2;36m                    [0m         [39mtimeoutMs[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            if [0m[1;39m([0m[39moutputFileInCommandline[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        localTimeoutMillis, maxStdOut, maxStdErr[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                        localTimeoutMillis, outFile, maxStdErr[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.IS_TIMEOUT, [0m[1;35mresult.isTimeout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.EXIT_VALUE, [0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_LENGTH, [0m                       [2m                [0m
[2;36m                    [0m         [1;35mresult.getStdoutLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_IS_TRUNCATED,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                    [0m[1;35mresult.isStdoutTruncated[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_ERR_LENGTH, [0m                       [2m                [0m
[2;36m                    [0m         [1;35mresult.getStderrLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_ERR_IS_TRUNCATED,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                    [0m[1;35mresult.isStderrTruncated[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            if [0m[1;39m([0m[39mreturnStdout[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT, [0m[1;35mresult.getStdout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            if [0m[1;39m([0m[39mreturnStderr[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_ERR, [0m[1;35mresult.getStderr[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;35mhandleOutput[0m[1;39m([0m[39mresult, outFile, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:            [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            if [0m[1;39m([0m[39moutFile != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                [0m[1;35mFiles.delete[0m[1;39m([0m[39moutFile[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/DataURIScheme.jav[0m[1;92ma:28[0m[39m-[0m[1;36m81[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:public class DataURIScheme [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    private final String rawMediaTypeString;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    private final boolean isBase64;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    private final byte[0m[1;39m[[0m[1;39m][0m[39m data;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    [0m[1;35mDataURIScheme[0m[1;39m([0m[39mString mediaTypeString, boolean isBase64, byte[0m[1;39m[[0m[1;39m][0m[39m data[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:        this.rawMediaTypeString = mediaTypeString;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        this.isBase64 = isBase64;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:        this.data = data;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public InputStream [0m[1;35mgetInputStream[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        return new [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * @return parsed media type or <code>null<[0m[35m/[0m[95mcode[0m[39m> if parse fails or if media[0m [2m                [0m
[2;36m                    [0m         [39mtype string was[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * not specified[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public MediaType [0m[1;35mgetMediaType[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        if [0m[1;39m([0m[39mrawMediaTypeString != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:            return [0m[1;35mMediaType.parse[0m[1;39m([0m[39mrawMediaTypeString[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        return null;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public boolean [0m[1;35misBase64[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        return isBase64;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    public boolean [0m[1;35mequals[0m[1;39m([0m[39mObject o[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        if [0m[1;39m([0m[39mthis == o[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            return true;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39m![0m[1;39m([0m[39mo instanceof DataURIScheme[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return false;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        DataURIScheme that = [0m[1;39m([0m[39mDataURIScheme[0m[1;39m)[0m[39m o;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        return [0m[1;35misBase64[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;35mthat.isBase64[0m[1;39m([0m[1;39m)[0m[39m &&[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                [0m[1;35mObjects.equals[0m[1;39m([0m[39mrawMediaTypeString, that.rawMediaTypeString[0m[1;39m)[0m[39m &&[0m   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                [0m[1;35mArrays.equals[0m[1;39m([0m[39mdata, that.data[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    public int [0m[1;35mhashCode[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        int result = [0m[1;35mObjects.hash[0m[1;39m([0m[39mrawMediaTypeString, [0m[1;35misBase64[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        result = [0m[1;36m31[0m[39m * result + [0m[1;35mArrays.hashCode[0m[1;39m([0m[39mdata[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        return result;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/DataURISchemeUtil.jav[0m[1;92ma:36[0m[39m-[0m[1;36m81[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:public class DataURISchemeUtil [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    public static String UNSPECIFIED_MEDIA_TYPE = [0m[32m"text/plain;[0m[32mcharset[0m[32m=[0m[32mUS[0m[32m-ASCII"[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    private static Pattern PARSE_PATTERN = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mPattern.compile[0m[1;39m([0m[32m"[0m[32m([0m[32m?s[0m[32m)[0m[32mdata:[0m[32m([0m[32m[[0m[32m^,[0m[32m][0m[32m*?[0m[32m)[0m[32m([0m[32mbase64[0m[32m)[0m[32m?,[0m[32m([0m[32m.*[0m[32m)[0m[32m$"[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private static Pattern EXTRACT_PATTERN =[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:            [0m[1;35mPattern.compile[0m[1;39m([0m[32m"[0m[32m([0m[32m?s[0m[32m)[0m[32mdata:[0m[32m([0m[32m[[0m[32m^,[0m[32m][0m[32m*?[0m[32m)[0m[32m([0m[32mbase64[0m[32m)[0m[32m?,[0m[32m([0m[32m[[0m[32m^\"\'[0m[32m][0m[32m*[0m[32m)[0m[32m[[0m[32m\"\'[0m[32m][0m[32m"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private final Matcher parseMatcher = [0m[1;35mPARSE_PATTERN.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    private final Matcher extractMatcher = [0m[1;35mEXTRACT_PATTERN.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    Base64 base64 = new [0m[1;35mBase64[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public DataURIScheme [0m[1;35mparse[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws DataURISchemeParseException[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mparseMatcher.reset[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        if [0m[1;39m([0m[1;35mparseMatcher.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            return [0m[1;35mbuild[0m[1;39m([0m[1;35mparseMatcher.group[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m, [0m[1;35mparseMatcher.group[0m[1;39m([0m[1;36m2[0m[1;39m)[0m[39m, [0m          [2m                [0m
[2;36m                    [0m         [1;35mparseMatcher.group[0m[1;39m([0m[1;36m3[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        throw new [0m[1;35mDataURISchemeParseException[0m[1;39m([0m[32m"Couldn't find expected pattern"[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private DataURIScheme [0m[1;35mbuild[0m[1;39m([0m[39mString mediaTypeString, String isBase64, String [0m [2m                [0m
[2;36m                    [0m         [39mdataString[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m data = null;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        [0m[35m/[0m[35m/[0m[95mstrip[0m[39m out back slashes as you might have in css[0m                        [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        dataString = [0m[1;39m([0m[39mdataString != null[0m[1;39m)[0m[39m ? [0m[1;35mdataString.replaceAll[0m[1;39m([0m[32m"\\\\", "[0m[39m "[0m[1;39m)[0m[39m :[0m [2m                [0m
[2;36m                    [0m         [39mdataString;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        if [0m[1;39m([0m[39mdataString == null || [0m[1;35mdataString.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:            data = new byte[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39misBase64 != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            data = [0m[1;35mbase64.decode[0m[1;39m([0m[39mdataString[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            [0m[35m/[0m[35m/[0m[95mTODO[0m[39m: handle encodings[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            MediaType mediaType = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mmediaTypeString[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            Charset charset = StandardCharsets.UTF_8;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            if [0m[1;39m([0m[1;35mmediaType.hasParameters[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:                String charsetName = [0m[1;35mmediaType.getParameters[0m[1;39m([0m[1;39m)[0m[1;35m.get[0m[1;39m([0m[32m"charset"[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                if [0m[1;39m([0m[39mcharsetName != null && [0m[1;35mCharset.isSupported[0m[1;39m([0m[39mcharsetName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                    try [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:                        charset = [0m[1;35mCharset.forName[0m[1;39m([0m[39mcharsetName[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                    [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIllegalCharsetNameException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                        [0m[35m/[0m[35m/[0m[95mswallow[0m[39m and default to UTF-[0m[1;36m8[0m                           [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:                    [0m[1;39m}[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            data = [0m[1;35mdataString.getBytes[0m[1;39m([0m[39mcharset[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        return new [0m[1;35mDataURIScheme[0m[1;39m([0m[39mmediaTypeString, [0m[1;39m([0m[39misBase64 != null[0m[1;39m)[0m[39m, data[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:781[0m[39m-[0m[1;36m783[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:    public File [0m[1;35mgetFile[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:        return [0m[1;35mgetPath[0m[1;39m([0m[1;39m)[0m[1;35m.toFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:232[0m[39m-[0m[1;36m246[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:    public static TikaInputStream [0m[1;35mget[0m[1;39m([0m[39mInputStream stream, TemporaryResources [0m   [2m                [0m
[2;36m                    [0m         [39mtmp, Metadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:        if [0m[1;39m([0m[39mstream == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            throw new [0m[1;35mNullPointerException[0m[1;39m([0m[32m"The Stream must not be null"[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:        if [0m[1;39m([0m[39mstream instanceof TikaInputStream[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:            return [0m[1;39m([0m[39mTikaInputStream[0m[1;39m)[0m[39m stream;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:            [0m[35m/[0m[35m/[0m[39m Make sure that the stream is buffered and that it[0m                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:            [0m[35m/[0m[35m/[0m[39m [0m[1;39m([0m[39mproperly[0m[1;39m)[0m[39m supports the mark feature[0m                             [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:            if [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mstream.markSupported[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                stream = new [0m[1;35mBufferedInputStream[0m[1;39m([0m[39mstream[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:            return new [0m[1;35mTikaInputStream[0m[1;39m([0m[39mstream, tmp, [0m[1;36m-1[0m[39m, [0m                        [2m                [0m
[2;36m                    [0m         [1;35mgetExtension[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TemporaryResources.jav[0m[1;92ma:79[0m[39m-[0m[1;36m120[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * Creates a temporary file that will automatically be deleted when[0m          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * the [0m[1;39m{[0m[39m@link #[0m[1;35mclose[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[39m method is called, returning its path.[0m                [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     * @param suffix -- the suffix of the file if known, starting with [0m[32m"."[0m[39m as in[0m [2m                [0m
[2;36m                    [0m         [32m".pdf"[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * @return Path to created temporary file that will be deleted after closing[0m [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    public Path [0m[1;35mcreateTempFile[0m[1;39m([0m[39mString suffix[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        String actualSuffix = [0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39msuffix[0m[1;39m)[0m[39m ? [0m[32m".tmp"[0m[39m : suffix;[0m     [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        final Path path = tempFileDir == null ? [0m                                 [2m                [0m
[2;36m                    [0m         [1;35mFiles.createTempFile[0m[1;39m([0m[32m"apache-tika-"[0m[39m, actualSuffix[0m[1;39m)[0m[39m :[0m                                [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:                [0m[1;35mFiles.createTempFile[0m[1;39m([0m[39mtempFileDir, [0m[32m"apache-tika-"[0m[39m, actualSuffix[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        [0m[1;35maddResource[0m[1;39m([0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            try [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:                [0m[1;35mFiles.delete[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:                [0m[35m/[0m[35m/[0m[39m delete when exit if current delete fail[0m                       [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"delete tmp file fail, will delete it on exit"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:                [0m[1;35mpath.toFile[0m[1;39m([0m[1;39m)[0m[1;35m.deleteOnExit[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;39m}[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        return path;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    public Path [0m[1;35mcreateTempFile[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        return [0m[1;35mcreateTempFile[0m[1;39m([0m[39mStringUtils.EMPTY[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:     * Creates a temporary file that will automatically be deleted when[0m         [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:     * the [0m[1;39m{[0m[39m@link #[0m[1;35mclose[0m[1;39m([0m[1;39m)[0m[1;39m}[0m[39m method is called, returning its path.[0m               [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @return Path to created temporary file that will be deleted after [0m       [2m                [0m
[2;36m                    [0m         [39mclosing[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     * @throws IOException[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    public Path [0m[1;35mcreateTempFile[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        String resourceName = [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        if [0m[1;39m([0m[1;35mStringUtils.isBlank[0m[1;39m([0m[39mresourceName[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:            return [0m[1;35mcreateTempFile[0m[1;39m([0m[39mStringUtils.EMPTY[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:        return [0m[1;35mcreateTempFile[0m[1;39m([0m[1;35mFilenameUtils.getSuffixFromPath[0m[1;39m([0m[39mresourceName[0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/TikaInputStream.jav[0m[1;92ma:713[0m[39m-[0m[1;36m776[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:    public Path [0m[1;35mgetPath[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        return [0m[1;35mgetPath[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:     * @param maxBytes if this is less than [0m[1;36m0[0m[39m and if an underlying file doesn't[0m [2m                [0m
[2;36m                    [0m         [39malready exist,[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:     *                 the full file will be spooled to disk[0m                    [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:     * @return the original path used in the initialization of this [0m            [2m                [0m
[2;36m                    [0m         [39mTikaInputStream,[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:     * a temporary file if the stream was shorter than <code>maxBytes<[0m[35m/[0m[95mcode[0m[39m>, [0m  [2m                [0m
[2;36m                    [0m         [39mor <code>null<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:     * if the underlying stream was longer than maxBytes.[0m                       [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:     * @throws IOException[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:    public Path [0m[1;35mgetPath[0m[1;39m([0m[39mint maxBytes[0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:        if [0m[1;39m([0m[39mpath != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            return path;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:        if [0m[1;39m([0m[39mposition > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Stream is already being read"[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:            Path tmpFile = [0m[1;35mtmp.createTempFile[0m[1;39m([0m[39msuffix[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            if [0m[1;39m([0m[39mmaxBytes > [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:                try [0m[1;39m([0m[39mBoundedInputStream boundedInputStream = new [0m               [2m                [0m
[2;36m                    [0m         [1;35mBoundedInputStream[0m[1;39m([0m[39mmaxBytes, this[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:                    [0m[1;35mboundedInputStream.mark[0m[1;39m([0m[39mmaxBytes[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:                    try [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:                        [0m[1;35mFiles.copy[0m[1;39m([0m[39mboundedInputStream, tmpFile, [0m                [2m                [0m
[2;36m                    [0m         [39mREPLACE_EXISTING[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                        if [0m[1;39m([0m[1;35mboundedInputStream.hasHitBound[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:                            [0m[35m/[0m[35m/[0m[95mtmpFile[0m[39m will be cleaned up when this [0m             [2m                [0m
[2;36m                    [0m         [39mTikaInputStream is closed[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:                            return null;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:                    [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:                        [0m[1;35mboundedInputStream.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m744[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m745[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:                [0m[35m/[0m[35m/[0m[39m Spool the entire stream into a temporary file[0m                [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:                [0m[1;35mFiles.copy[0m[1;39m([0m[39mthis, tmpFile, REPLACE_EXISTING[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:            [0m[35m/[0m[35m/[0m[95msuccessful[0m[39m so far, set tis' path to tmpFile[0m                       [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:            path = tmpFile;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:            [0m[35m/[0m[35m/[0m[39m Create a new input stream and make sure it'll get closed[0m         [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:            InputStream newStream = [0m[1;35mFiles.newInputStream[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:            [0m[1;35mtmp.addResource[0m[1;39m([0m[39mnewStream[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:            [0m[35m/[0m[35m/[0m[39m Replace the spooled stream with the new stream in a way[0m          [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:            [0m[35m/[0m[35m/[0m[39m that still ends up closing the old stream if or when the[0m         [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:            [0m[35m/[0m[35m/[0m[39m [0m[1;35mclose[0m[1;39m([0m[1;39m)[0m[39m method is called. The closing of the new stream[0m          [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:            [0m[35m/[0m[35m/[0m[39m is already being handled as noted above.[0m                         [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:            final InputStream oldStream = in;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:            in = new [0m[1;35mBufferedInputStream[0m[1;39m([0m[39mnewStream[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:                @Override[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:                public void [0m[1;35mclose[0m[1;39m([0m[1;39m)[0m[39m throws IOException [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:                    [0m[1;35moldStream.close[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:            [0m[1;39m}[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:            [0m[35m/[0m[35m/[0m[39m Update length to file size. Update position, mark[0m                [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:            length = [0m[1;35mFiles.size[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:            position = [0m[1;36m0[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m772[0m[39m:            mark = [0m[1;36m-1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m773[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m774[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m775[0m[39m:        return path;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m776[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/io/FilenameUtils.jav[0m[1;92ma:114[0m[39m-[0m[1;36m133[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:     * This includes the period, e.g. [0m[32m".pdf"[0m[39m.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:     * This requires that an extension contain only ascii alphanumerics[0m         [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:     * and it requires that an extension length be [0m[1;36m5[0m[39m or less.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * @param path[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     * @return the suffix or an empty string if one could not be found[0m          [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:    public static String [0m[1;35mgetSuffixFromPath[0m[1;39m([0m[39mString path[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        String n = [0m[1;35mgetName[0m[1;39m([0m[39mpath[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        int i = [0m[1;35mn.lastIndexOf[0m[1;39m([0m[32m"."[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        [0m[35m/[0m[35m/[0m[95marbitrarily[0m[39m sets max extension length[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:        if [0m[1;39m([0m[39mi > [0m[1;36m-1[0m[39m && [0m[1;35mn.length[0m[1;39m([0m[1;39m)[0m[39m - i < [0m[1;36m6[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            String suffix = [0m[1;35mn.substring[0m[1;39m([0m[39mi[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            if [0m[1;39m([0m[1;35mASCII_NUMERIC.matcher[0m[1;39m([0m[39msuffix[0m[1;39m)[0m[1;35m.matches[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:                return suffix;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        return StringUtils.EMPTY;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m319[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:150[0m[39m-[0m[1;36m201[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return [0m[1;35mcheck[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39mcheckCmd[0m[1;39m}[0m[39m, errorValue[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        if [0m[1;39m([0m[39merrorValue.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            errorValue = new int[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;36m127[0m[1;39m}[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            Thread stdErrSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            Thread stdOutSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;35mstdErrSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            [0m[1;35mstdOutSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[35m/[0m[35m/[0m[95mmake[0m[39m the timeout parameterizable[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;36m60000[0m[39m, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                throw new [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            int result = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exit value for [0m[32m{[0m[32m}[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, result[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            for [0m[1;39m([0m[39mint err : errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                if [0m[1;39m([0m[39mresult == err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:            return true;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException | InterruptedException | TimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exception trying to run  "[0m[39m + checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, e[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            [0m[35m/[0m[35m/[0m[39m Some problem, command is there or is broken[0m                      [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:            return false;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSecurityException se[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:            [0m[35m/[0m[35m/[0m[39m External process execution is banned by the security manager[0m     [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:            throw se;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mError err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            if [0m[1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[39m != null && [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"posix_spawn"[0m[1;39m)[0m[39m ||[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                    [0m[1;35merr.getMessage[0m[1;39m([0m[1;39m)[0m[1;35m.contains[0m[1;39m([0m[32m"UNIXProcess"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                [0m[1;35mLOG.debug[0m[1;39m([0m[32m"[0m[32m([0m[32mTIKA-1526[0m[32m)[0m[32m: exception trying to run: "[0m[39m + [0m           [2m                [0m
[2;36m                    [0m         [39mcheckCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, err[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                [0m[35m/[0m[35m/[0m[39m"Error forking command due to JVM locale bug[0m                  [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                [0m[35m/[0m[35m/[0m[1;39m([0m[39msee TIKA-[0m[1;36m1526[0m[39m and SOLR-[0m[1;36m6387[0m[1;39m)[0m[39m"[0m                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                return false;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:            [0m[35m/[0m[35m/[0m[95mthrow[0m[39m if a different kind of error[0m                                [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            throw err;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            if [0m[1;39m([0m[39mprocess != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:                [0m[1;35mprocess.destroyForcibly[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:288[0m[39m-[0m[1;36m318[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/resources/org/apache/tika/parser/external/tika-external-parsers.[0m [2m                [0m
[2;36m                    [0m         [39mxml:[0m[1;36m48[0m[39m-[0m[1;36m63[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:  <parser>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     <check>[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:       <command>exiftool -ver<[0m[35m/[0m[95mcommand[0m[39m>[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:       <error-codes>[0m[1;36m126[0m[39m,[0m[1;36m127[0m[39m<[0m[35m/[0m[95merror-codes[0m[39m>[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     <[0m[35m/[0m[95mcheck[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     <command>env [0m[33mFOO[0m[39m=$[0m[1;39m{[0m[39mOUT[0m[1;33mPUT[0m[1;39m}[0m[39m exiftool $[0m[1;39m{[0m[39mIN[0m[1;33mPUT[0m[1;39m}[0m[39m<[0m[35m/[0m[95mcommand[0m[39m>[0m                      [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     <mime-types>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:       <mime-type>video/avi<[0m[35m/[0m[95mmime-type[0m[39m>[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:       <mime-type>video/mpeg<[0m[35m/[0m[95mmime-type[0m[39m>[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:       <mime-type>video/x-msvideo<[0m[35m/[0m[95mmime-type[0m[39m>[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:       <mime-type>video/mp4<[0m[35m/[0m[95mmime-type[0m[39m>[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     <[0m[35m/[0m[95mmime-types[0m[39m>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     <metadata>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:       <match>\s*[0m[1;39m([0m[1;39m[[0m[39mA-Za-z0-[0m[1;36m9[0m[39m/ \[0m[1;39m([0m[39m\[0m[1;39m)[0m[1;39m][0m[39m+\S[0m[1;39m{[0m[1;36m1[0m[1;39m}[0m[1;39m)[0m[39m\s+:\s+[0m[1;39m([0m[1;39m[[0m[39mA-Za-z0-[0m[1;36m9[0m[39m\[0m[1;39m([0m[39m\[0m[1;39m)[0m[39m\[0m[1;39m[[0m[39m\[0m[1;39m][0m[39m [0m            [2m                [0m
[2;36m                    [0m         [39m\:\-\.[0m[1;39m][0m[39m+[0m[1;39m)[0m[39m\s*<[0m[35m/[0m[95mmatch[0m[39m>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     <[0m[35m/[0m[95mmetadata[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:  <[0m[35m/[0m[95mparser[0m[39m>[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:80[0m[39m-[0m[1;36m118[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public void [0m[1;35mparseEmbedded[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            TikaInputStream tis, ContentHandler handler, Metadata metadata, [0m     [2m                [0m
[2;36m                    [0m         [39mboolean outputHtml[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws SAXException, IOException [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            AttributesImpl attributes = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            [0m[1;35mattributes.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"CDATA"[0m[39m, [0m              [2m                [0m
[2;36m                    [0m         [32m"package-entry"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[39m, attributes[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        if [0m[1;39m([0m[39mwriteFileNameToContent && name != null && [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m && [0m      [2m                [0m
[2;36m                    [0m         [39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[39m, new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m chars = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            [0m[1;35mhandler.characters[0m[1;39m([0m[39mchars, [0m[1;36m0[0m[39m, chars.length[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[35m/[0m[35m/[0m[39m Use the delegate parser to parse this entry[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;35mtis.setCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mDELEGATING_PARSER.parse[0m[1;39m([0m[39mtis, new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m[39mnew [0m        [2m                [0m
[2;36m                    [0m         [1;35mBodyContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                    metadata, context[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEncryptedDocumentException ede[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39mede, context[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCorruptedFileException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[95mnecessary[0m[39m to stop the parse to avoid infinite loops[0m               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[35m/[0m[35m/[0m[95mon[0m[39m corrupt sqlite3 files[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39me, context[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mtis.removeCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:62[0m[39m-[0m[1;36m78[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        DocumentSelector selector = [0m[1;35mcontext.get[0m[1;39m([0m[39mDocumentSelector.class[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mselector != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return [0m[1;35mselector.select[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        FilenameFilter filter = [0m[1;35mcontext.get[0m[1;39m([0m[39mFilenameFilter.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[39mfilter != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                return [0m[1;35mfilter.accept[0m[1;39m([0m[39mABSTRACT_PATH, name[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/DelegatingParser.jav[0m[1;92ma:38[0m[39m-[0m[1;36m74[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:public class DelegatingParser implements Parser [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * Returns the parser instance to which parsing tasks should be delegated.[0m   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * The default implementation looks up the delegate parser from the given[0m    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * parse context, and uses an [0m[1;39m{[0m[39m@link EmptyParser[0m[1;39m}[0m[39m instance as a fallback.[0m    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Subclasses can override this method to implement alternative delegation[0m   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * strategies.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param context parse context[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @return delegate parser[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @since Apache Tika [0m[1;36m0.7[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    protected Parser [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        return [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class, EmptyParser.INSTANCE[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;35m.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Looks up the delegate parser from the parsing context and[0m                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * delegates the parse operation to it. If a delegate parser is not[0m          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * found, then an empty XHTML document is returned.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * Subclasses should override this method to parse the top level[0m             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * structure of the given document stream. Parsed sub-streams can[0m            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * be passed to this base class method to be parsed by the configured[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * delegate parser.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws SAXException, IOException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;35m.parse[0m[1;39m([0m[39mstream, handler, metadata, context[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:59[0m[39m-[0m[1;36m98[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ExternalParser implements Parser [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * be replaced with the input filename.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * Alternately, the input data can be streamed over STDIN.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public static final String IN[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * be replaced with the output filename.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * Alternately, the output data can be collected on STDOUT.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static final String OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mOUT[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private static final long serialVersionUID = -1079128990650687037L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[35m/[0m[95mmake[0m[39m this parameterizable[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final long timeoutMs = [0m[1;36m60000[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * Media types supported by the external program.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private Set<MediaType> supportedTypes = [0m[1;35mCollections.emptySet[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * Regular Expressions to run over STDOUT to[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * extract Metadata.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private Map<Pattern, String> metadataPatterns = null;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * The external command to invoke.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private String[0m[1;39m[[0m[1;39m][0m[39m command = new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[32m"cat"[0m[1;39m}[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     * A consumer for ignored Lines[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private LineConsumer ignoredLineConsumer = LineConsumer.NULL;[0m                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:203[0m[39m-[0m[1;36m228[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:        return [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        return supportedTypes;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:    public void [0m[1;35msetSupportedTypes[0m[1;39m([0m[39mSet<MediaType> supportedTypes[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        this.supportedTypes = [0m[1;35mCollections.unmodifiableSet[0m[1;39m([0m[39mnew [0m                  [2m                [0m
[2;36m                    [0m         [39mHashSet<>[0m[1;39m([0m[39msupportedTypes[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:    public String[0m[1;39m[[0m[1;39m][0m[39m [0m[1;35mgetCommand[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:        return command;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:     * Sets the command to be run. This can include either of[0m                   [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:     * [0m[1;39m{[0m[39m@link #IN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m[39m or [0m[1;39m{[0m[39m@link #OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m}[0m                  [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:     * if the command needs filenames.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:    public void [0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        this.command = command;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/ParseContext.jav[0m[1;92ma:31[0m[39m-[0m[1;36m86[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:public class ParseContext implements Serializable [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * Serial version UID.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final long serialVersionUID = -5921436862145826534L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * Map of objects in this context[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private final Map<String, Object> context = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Adds the given value to the context as an implementation of the given[0m     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * interface.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param key   the interface implemented by the given value[0m                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param value the value to be added, or <code>null<[0m[35m/[0m[95mcode[0m[39m> to remove[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    public <T> void [0m[1;35mset[0m[1;39m([0m[39mClass<T> key, T value[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            [0m[1;35mcontext.put[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            [0m[1;35mcontext.remove[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * Returns the object in this context that implements the given interface.[0m   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * @param key the interface implemented by the requested object[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * or <code>null<[0m[35m/[0m[95mcode[0m[39m> if not found[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        return [0m[1;39m([0m[39mT[0m[1;39m)[0m[39m [0m[1;35mcontext.get[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Returns the object in this context that implements the given interface,[0m   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * or the given default value if such an object is not found.[0m                [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @param key          the interface implemented by the requested object[0m     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param defaultValue value to return if the requested object is not found[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * or the given default value if not found[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key, T defaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        T value = [0m[1;35mget[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            return value;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return defaultValue;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:73[0m[39m-[0m[1;36m86[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers,[0m     [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                           Collection<Class<? extends Parser>> excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        if [0m[1;39m([0m[39mexcludeParsers == null || [0m[1;35mexcludeParsers.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            this.parsers = parsers;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            this.parsers = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            for [0m[1;39m([0m[39mParser p : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35misExcluded[0m[1;39m([0m[39mexcludeParsers, [0m[1;35mp.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    [0m[1;35mthis.parsers.add[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        this.registry = registry;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m123[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        Map<MediaType, Parser> map = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        for [0m[1;39m([0m[39mParser parser : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            for [0m[1;39m([0m[39mMediaType type : [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;35mmap.put[0m[1;39m([0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m, parser[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        return map;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private boolean [0m[1;35misExcluded[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m             [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                               Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        return [0m[1;35mexcludeParsers.contains[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m || [0m[1;35massignableFrom[0m[1;39m([0m[39mexcludeParsers, p[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private boolean [0m[1;35massignableFrom[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m         [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                                   Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        for [0m[1;39m([0m[39mClass<? extends Parser> e : excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            if [0m[1;39m([0m[1;35me.isAssignableFrom[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                return true;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        return false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m60[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.external;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.Reader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.io.TemporaryResources;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * Parser that uses an external program [0m[1;39m([0m[39mlike catdoc or pdf2txt[0m[1;39m)[0m[39m to extract[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * text content and metadata from a given document.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ExternalParser implements Parser [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:288[0m[39m-[0m[1;36m319[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis Summary[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter thorough examination of the codebase, I've identified the root cause of the [0m  [2m                [0m
[2;36m                    [0m         [39mOS Command Injection vulnerability:[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Core Issue**: The `ExternalParser` class constructs and executes system commands [0m [2m                [0m
[2;36m                    [0m         [39munsafely when processing embedded documents from data URIs in HTML content. The [0m    [2m                [0m
[2;36m                    [0m         [39mvulnerability manifests through:[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Unsafe Command Construction** [0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:290[0m[39m-[0m[1;36m291[0m[1;39m)[0m[39m: When [0m             [2m                [0m
[2;36m                    [0m         [39m`command.length == [0m[1;36m1[0m[39m`, the command string is split by spaces using `[0m[1;35mString.split[0m[1;39m([0m[32m" [0m [2m                [0m
[2;36m                    [0m         [32m"[0m[1;39m)[0m[39m`, which doesn't respect proper command tokenization[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Shell Invocation** [0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:311[0m[39m-[0m[1;36m312[0m[1;39m)[0m[39m: When the resulting array has[0m [2m                [0m
[2;36m                    [0m         [39monly one element, `[0m[1;35mRuntime.exec[0m[1;39m([0m[39mString[0m[1;39m)[0m[39m` is called, which invokes a shell [0m          [2m                [0m
[2;36m                    [0m         [39minterpreter[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Missing Security Context**: No mechanism exists to distinguish between trusted[0m [2m                [0m
[2;36m                    [0m         [39mfiles and untrusted embedded documents from data URIs[0m                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Unescaped Path Substitution** [0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:298[0m[1;39m)[0m[39m: File paths are [0m       [2m                [0m
[2;36m                    [0m         [39mdirectly substituted into command strings without proper escaping or validation[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is NOT in the temporary file naming [0m[1;39m([0m[39mwhich is secure[0m[1;39m)[0m[39m or data URI[0m [2m                [0m
[2;36m                    [0m         [39mparsing [0m[1;39m([0m[39mwhich is correct[0m[1;39m)[0m[39m, but in the command execution logic that can be [0m         [2m                [0m
[2;36m                    [0m         [39mtriggered when HTML data URIs embed documents that require external tool [0m           [2m                [0m
[2;36m                    [0m         [39mprocessing.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m1[0m[39m: Fix Command Execution in ExternalParser[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java` [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlines [0m[1;36m280[0m[39m-[0m[1;36m319[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Approach**: Replace the unsafe [0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m invocation with ProcessBuilder that[0m [2m                [0m
[2;36m                    [0m         [39mproperly handles command arrays without shell interpretation.[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Remove the string-splitting logic at line [0m[1;36m290[0m[39m-[0m[1;36m291[0m[39m that attempts to split a [0m      [2m                [0m
[2;36m                    [0m         [39msingle command string by spaces[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Always use ProcessBuilder with the command array directly, never invoke [0m         [2m                [0m
[2;36m                    [0m         [1;35mRuntime.exec[0m[1;39m([0m[39mString[0m[1;39m)[0m[39m which triggers shell interpretation[0m                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Ensure command arguments are passed as separate array elements to ProcessBuilder[0m [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Remove the conditional logic at lines [0m[1;36m311[0m[39m-[0m[1;36m315[0m[39m that chooses between single-string[0m [2m                [0m
[2;36m                    [0m         [39mand array execution[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Implementation Details**:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Keep the token replacement logic [0m[1;39m([0m[39mlines [0m[1;36m296[0m[39m-[0m[1;36m306[0m[1;39m)[0m[39m but ensure it operates on [0m       [2m                [0m
[2;36m                    [0m         [39mproperly pre-split command arrays[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- Use `new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m` constructor directly with the String array[0m          [2m                [0m
[2;36m                    [0m         [39m- Never concatenate or join command elements back into a single string[0m              [2m                [0m
[2;36m                    [0m         [39m- Maintain backward compatibility by ensuring commands are properly pre-split [0m      [2m                [0m
[2;36m                    [0m         [39mbefore being set via `[0m[1;35msetCommand[0m[1;39m([0m[39mString[0m[33m...[0m[39m command[0m[1;39m)[0m[39m`[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m2[0m[39m: Add Security Context for Embedded Documents[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `tika-core/src/main/java/org/apache/tika/parser/ParseContext.java`[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Approach**: Introduce a security marker interface that tracks document origin and[0m [2m                [0m
[2;36m                    [0m         [39mrestricts parser selection for untrusted sources.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Create a new interface `EmbeddedDocumentRestriction` that can be stored in [0m      [2m                [0m
[2;36m                    [0m         [39mParseContext[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. This interface should indicate whether external parsers are allowed for the [0m     [2m                [0m
[2;36m                    [0m         [39mcurrent parsing context[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. When HtmlHandler processes data URIs, set this restriction in the ParseContext [0m  [2m                [0m
[2;36m                    [0m         [39mbefore calling [0m[1;35mparseEmbedded[0m[1;39m([0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-[0m [2m                [0m
[2;36m                    [0m         [39mmodule/src/main/java/org/apache/tika/parser/html/HtmlHandler.java` [0m[1;39m([0m[39mlines [0m[1;36m354[0m[39m-[0m[1;36m384[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Before calling `[0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[1;39m)[0m[39m` at line [0m[1;36m377[0m[39m, check if[0m [2m                [0m
[2;36m                    [0m         [39mexternal parsers should be allowed for data URI content[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Set a restriction flag in the ParseContext to indicate this is an untrusted [0m     [2m                [0m
[2;36m                    [0m         [39membedded document[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. This allows downstream parsers to check the restriction and skip execution[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m3[0m[39m: Enforce Security Restrictions in CompositeParser[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java`[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Approach**: Modify parser selection logic to check for security restrictions [0m     [2m                [0m
[2;36m                    [0m         [39mbefore selecting ExternalParser.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. In the `[0m[1;35mparse[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39maround line [0m[1;36m298[0m[1;39m)[0m[39m, before delegating to an [0m              [2m                [0m
[2;36m                    [0m         [39mExternalParser, check if ParseContext contains a restriction flag[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. If processing an untrusted embedded document [0m[1;39m([0m[39mdata URI[0m[1;39m)[0m[39m, skip ExternalParser [0m    [2m                [0m
[2;36m                    [0m         [39minstances[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Fall back to safe parsers or return empty content for restricted document types[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m4[0m[39m: Apply Same Fix to ExternalParser2[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`tika-core/src/main/java/org/apache/tika/parser/external2/ExternalParser.java` [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mlines [0m[1;36m100[0m[39m-[0m[1;36m161[0m[1;39m)[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Approach**: Even though external2 uses ProcessBuilder, verify it doesn't have [0m    [2m                [0m
[2;36m                    [0m         [39msimilar command construction issues.[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Review the ProcessBuilder usage at lines [0m[1;36m130[0m[39m and [0m[1;36m134[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Ensure the command list is properly constructed without string concatenation[0m     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Verify that [0m[1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;39m)[0m[39m is not relied upon for security [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39monly for Windows path spaces[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The external2 parser already uses ProcessBuilder correctly, but ensure security [0m [2m                [0m
[2;36m                    [0m         [39mcontext checks are added[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Step [0m[1;36m5[0m[39m: Add Configuration Option[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Create new configuration interface[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Approach**: Allow administrators to configure whether external parsers should be [0m [2m                [0m
[2;36m                    [0m         [39mallowed for embedded documents.[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add a configuration property [0m[1;39m([0m[39me.g., `allowExternalParsersForEmbeddedDocuments`[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Default this to `false` for security[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Document this as a security-critical setting[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Check this configuration in the security restriction logic[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why This Approach is Optimal**:[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Addresses Root Cause**: Fixes the unsafe command execution pattern that [0m       [2m                [0m
[2;36m                    [0m         [39menables shell injection[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Defense in Depth**: Adds security context tracking to prevent external parser [0m [2m                [0m
[2;36m                    [0m         [39minvocation for untrusted sources[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Backward Compatible**: Existing legitimate uses of ExternalParser with [0m        [2m                [0m
[2;36m                    [0m         [39mfile-based parsing remain functional[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Minimal Code Changes**: Focuses on the specific vulnerability points without [0m  [2m                [0m
[2;36m                    [0m         [39mrefactoring the entire parser architecture[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Preserves Functionality**: External parsers still work for trusted sources [0m    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mregular files[0m[1;39m)[0m[39m, only restricted for data URIs[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Standards-Based**: Uses ProcessBuilder correctly according to Java security [0m   [2m                [0m
[2;36m                    [0m         [39mbest practices[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How It Preserves Existing Logic**:[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Normal file parsing continues to work with external tools[0m                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. HTML parsing without data URIs is unaffected[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Other parser types remain unchanged[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Configuration system remains intact[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. The token replacement mechanism [0m[1;39m([0m[39m$[0m[1;39m{[0m[39mIN[0m[1;33mPUT[0m[1;39m}[0m[39m, $[0m[1;39m{[0m[39mOUT[0m[1;33mPUT[0m[1;39m}[0m[1;39m)[0m[39m continues to function[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Side Effects and Mitigation**:[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Breaking Change**: Data URIs that embed documents requiring external tools [0m    [2m                [0m
[2;36m                    [0m         [39mwill no longer be parsed[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is intentional security hardening; provide configuration [0m [2m                [0m
[2;36m                    [0m         [39moption for users who need this[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Performance**: Minimal impact as only adds a context check before parser [0m      [2m                [0m
[2;36m                    [0m         [39mselection[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Testing**: Existing tests for regular file parsing should pass; data URI tests[0m [2m                [0m
[2;36m                    [0m         [39mmay need updates[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar Solutions in Codebase**:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe exclusion mechanism in CompositeParser [0m[1;39m([0m[39mlines [0m[1;36m73[0m[39m-[0m[1;36m86[0m[39m, [0m[1;36m110[0m[39m-[0m[1;36m123[0m[1;39m)[0m[39m demonstrates that[0m [2m                [0m
[2;36m                    [0m         [39mconditional parser selection based on configuration is already supported. This fix [0m [2m                [0m
[2;36m                    [0m         [39mextends that pattern to security-based restrictions.[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 08:58:03][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=303411;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=203253;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[01/13/26 09:02:35][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=540110;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=365075;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[01/13/26 09:07:39][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=828014;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=872790;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=292144;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=540700;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 09:07:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.97[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=109201;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=256525;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=782660;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=111624;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmply2jbtm4[0m                                                 ]8;id=995980;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=263569;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 09:08:18][0m[2;36m [0m[1;31mERROR   [0m Failed to build the challenge                                                         ]8;id=972237;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=378233;file:///home/qqor/crete/packages/crete/framework/evaluator/services/default/__init__.py#53\[2m53[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/agent[0m ]8;id=360281;file:///home/qqor/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=429836;file:///home/qqor/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m-output-1768293926.7329285/[0m[95mbuild_failed_stdout.txt[0m: [35m/[0m[95msrc[0m [35m/src/project-parent/[0m[95mtika[0m    [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/[0m[95mtika[0m                                                             [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         [33mCC[0m=[35mclang[0m                                                                             [2m               [0m
[2;36m                    [0m         [33mCXX[0m=[35mclang[0m++                                                                          [2m               [0m
[2;36m                    [0m         [33mCFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                            [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -fno-[33msanitize[0m=[35mleak[0m      [2m               [0m
[2;36m                    [0m         [33mCXXFLAGS[0m=-O1   -fno-omit-frame-pointer   -gline-tables-only                          [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35menum[0m-constexpr-conversion                                                 [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mincompatible[0m-function-pointer-types   -Wno-[33merror[0m=[35mint[0m-conversion           [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mdeprecated[0m-declarations   -Wno-[33merror[0m=[35mimplicit[0m-function-declaration        [2m               [0m
[2;36m                    [0m         -Wno-[33merror[0m=[35mimplicit[0m-int   -Wno-[33merror[0m=[35mvla[0m-cxx-extension                               [2m               [0m
[2;36m                    [0m         -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION -[33mfsanitize[0m=[35maddress[0m                        [2m               [0m
[2;36m                    [0m         -fsanitize-address-use-after-scope -[33mfsanitize[0m=[35mfuzzer[0m-no-link -[33mstdlib[0m=[35mlibc[0m++          [2m               [0m
[2;36m                    [0m         -fno-[33msanitize[0m=[35mleak[0m                                                                   [2m               [0m
[2;36m                    [0m         [33mRUSTFLAGS[0m=--cfg fuzzing -[33mZsanitizer[0m=[35maddress[0m -[33mCdebuginfo[0m=[1;36m1[0m -Cforce-frame-pointers     [2m               [0m
[2;36m                    [0m         ---------------------------------------------------------------                      [2m               [0m
[2;36m                    [0m         + [33m__REAL_MAVEN_REPO[0m=[35m/root/.m2/[0m[95mrepository[0m                                             [2m               [0m
[2;36m                    [0m         + [33m__SHARED_MAVEN_REPO[0m=[35m/work/[0m[95mmavencache[0m                                               [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -L [35m/root/.m2/[0m[95mrepository[0m [32m'[0m[32m][0m[32m'[0m                                                [2m               [0m
[2;36m                    [0m         + unset __REAL_MAVEN_REPO                                                            [2m               [0m
[2;36m                    [0m         + unset __SHARED_MAVEN_REPO                                                          [2m               [0m
[2;36m                    [0m         + [33mPROJECT[0m=[35mtika[0m                                                                       [2m               [0m
[2;36m                    [0m         + [33mMAIN_REPOSITORY[0m=[4;94mhttps[0m[4;94m://github.com/apache/tika/[0m                                    [2m               [0m
[2;36m                    [0m         + [33mMAVEN_ARGS[0m=[32m'-Djavac.src.[0m[32mversion[0m[32m=[0m[32m17[0m[32m -Djavac.target.[0m[32mversion[0m[32m=[0m[32m17[0m[32m -DskipTests [0m          [2m               [0m
[2;36m                    [0m         [32m-Dcheckstyle.skip -Dossindex.skip -am -pl :tika-app'[0m                                 [2m               [0m
[2;36m                    [0m         + cd [35m/src/[0m[95mproject-parent[0m                                                             [2m               [0m
[2;36m                    [0m         + set_project_version_in_fuzz_targets_dependency                                     [2m               [0m
[2;36m                    [0m         ++ cd tika                                                                           [2m               [0m
[2;36m                    [0m         ++ [35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m                                             [2m               [0m
[2;36m                    [0m         org.apache.maven.plugins:maven-help-plugin:[1;36m3.2[0m.[1;92m0:e[0mvaluate                            [2m               [0m
[2;36m                    [0m         -[33mDexpression[0m=[35mproject[0m.version -q -DforceStdout                                        [2m               [0m
[2;36m                    [0m         + [33mPROJECT_VERSION[0m=[1;36m4[0m[1;36m.0[0m.[1;36m0[0m-SNAPSHOT                                                     [2m               [0m
[2;36m                    [0m         + cd fuzz-targets                                                                    [2m               [0m
[2;36m                    [0m         + [35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m versions:use-dep-version                     [2m               [0m
[2;36m                    [0m         -[33mDexcludes[0m=[35mcom[0m.code-intelligence:jazzer -[33mDdepVersion[0m=[1;36m4[0m[1;36m.0[0m.[1;36m0[0m-SNAPSHOT                  [2m               [0m
[2;36m                    [0m         -[33mDforceVersion[0m=[35mtrue[0m                                                                  [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m Scanning for projects[33m...[0m                                                      [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m                                                                               [2m               [0m
[2;36m                    [0m         [1m[[0mINFO[1m][0m ----------------------[1m<[0m[39m com.fuzzer:fuzz-targets >-----------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building fuzz [0m[1;36m0.0[0m[39m.[0m[1;36m1[0m[39m-SNAPSHOT[0m                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from pom.xml[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m jar [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- versions:[0m[1;36m2.20[0m[39m.[0m[1;36m1[0m[39m:use-dep-version [0m[1;39m([0m[39mdefault-cli[0m[1;39m)[0m[39m @ fuzz-targets ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Updated org.apache.tika:tika-app:jar:[0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT to version [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD SUCCESS[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m0.738[0m[39m s[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-13T[0m[1;92m09:07:48[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [39m+ cd tika[0m                                                                            [2m               [0m
[2;36m                    [0m         [39m+ [0m[35m/src/maven/apache-maven-3.9.9/bin/[0m[95mmvn[0m[39m install -Djavac.src.[0m[33mversion[0m[39m=[0m[1;36m17[0m[39m [0m              [2m               [0m
[2;36m                    [0m         [39m-Djavac.target.[0m[33mversion[0m[39m=[0m[1;36m17[0m[39m -DskipTests -Dcheckstyle.skip -Dossindex.skip -am -pl [0m     [2m               [0m
[2;36m                    [0m         [39m:tika-app -Dmaven.repo.[0m[33mlocal[0m[39m=[0m[35m/out/[0m[95mm2[0m                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Scanning for projects[0m[33m...[0m                                                      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Build Order:[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent                                                 [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core                                                [0m[1;39m[[0m[39mbundle[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization                                          [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules                                         [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package                    [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules                                [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module                                    [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module                               [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons                                           [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module                                    [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module                                   [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons                                         [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module              [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module                                      [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module                                  [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers                                               [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP                                                 [0m[1;39m[[0m[39mbundle[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection                                     [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons                                [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect                                   [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes                                                  [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters                                               [0m[1;39m[[0m[39mpom[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter                                     [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI                                              [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application                                            [0m[1;39m[[0m[39mjar[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------< org.apache.tika:tika-parent >---------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                        [0m[1;39m[[0m[1;36m1[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from pom.xml[0m                                                                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --------------------------------[0m[1;39m[[0m[39m pom [0m[1;39m][0m[39m---------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-parent ---[0m               [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; POM module[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-parent ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-parent ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-parent ---[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m1[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-parent ---[0m         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-parent ---[0m        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-parent ---[0m                       [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ tika-parent [0m  [2m               [0m
[2;36m                    [0m         [39m---[0m                                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:report [0m[1;39m([0m[39mreport[0m[1;39m)[0m[39m @ tika-parent ---[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:check [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- forbiddenapis:[0m[1;36m3.9[0m[39m:testCheck [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-parent ---[0m                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping execution for packaging [0m[32m"pom"[0m                                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- install:[0m[1;36m3.1[0m[39m.[0m[1;36m4[0m[39m:install [0m[1;39m([0m[39mdefault-install[0m[1;39m)[0m[39m @ tika-parent ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Installing [0m[35m/src/project-parent/tika/tika-parent/[0m[95mpom.xml[0m[39m to [0m                   [2m               [0m
[2;36m                    [0m         [35m/out/m2/org/apache/tika/tika-parent/4.0.0-SNAPSHOT/[0m[95mtika-parent-4.0.0-SNAPSHOT.pom[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ---------------------< org.apache.tika:tika-core >----------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Building Apache Tika core [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT                          [0m[1;39m[[0m[1;36m2[0m[39m/[0m[1;36m40[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m   from [0m[35m/src/project-parent/tika/tika-core/[0m[95mpom.xml[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------[0m[1;39m[[0m[39m bundle [0m[1;39m][0m[39m-------------------------------[0m      [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- ossindex:[0m[1;36m3.2[0m[39m.[0m[1;92m0:a[0m[39mudit [0m[1;39m([0m[39maudit-dependencies[0m[1;39m)[0m[39m @ tika-core ---[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping; configured[0m                                                          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven-version[0m[1;39m)[0m[39m @ tika-core ---[0m            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-java-version[0m[1;39m)[0m[39m @ tika-core ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.version.RequireJavaVersion passed[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39menforce-maven[0m[1;39m)[0m[39m @ tika-core ---[0m                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.DependencyConvergence [0m     [2m               [0m
[2;36m                    [0m         [39mpassed[0m                                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m1[0m[39m: org.apache.maven.enforcer.rules.version.RequireMavenVersion passed[0m    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-bad-log4j-versions[0m[1;39m)[0m[39m @ tika-core ---[0m           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- enforcer:[0m[1;36m3.5[0m[39m.[0m[1;92m0:e[0m[39mnforce [0m[1;39m([0m[39mban-xerces-and-xml-apis[0m[1;39m)[0m[39m @ tika-core ---[0m          [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Rule [0m[1;36m0[0m[39m: org.apache.maven.enforcer.rules.dependency.BannedDependencies passed[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- checkstyl[0m[1;92me:3[0m[39m.[0m[1;36m6.0[0m[39m:check [0m[1;39m([0m[39mvalidate[0m[1;39m)[0m[39m @ tika-core ---[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- jacoco:[0m[1;36m0.8[0m[39m.[0m[1;36m13[0m[39m:prepare-agent [0m[1;39m([0m[39mdefault[0m[1;39m)[0m[39m @ tika-core ---[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Skipping JaCoCo execution because property jacoco.skip is set.[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- remote-resources:[0m[1;36m3.3[0m[39m.[0m[1;36m0[0m[39m:process [0m[1;39m([0m[39mprocess-resource-bundles[0m[1;39m)[0m[39m @ tika-core ---[0m [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Preparing remote bundle [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.apache.resources:apache-jar-resource-bundl[0m[1;92me:1[0m[39m.[0m[1;36m7[0m                           [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from [0m[1;36m1[0m[39m bundle.[0m                                            [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying appended resource: META-INF/LICENSE[0m                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- resources:[0m[1;36m3.3[0m[39m.[0m[1;36m1[0m[39m:resources [0m[1;39m([0m[39mdefault-resources[0m[1;39m)[0m[39m @ tika-core ---[0m             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m5[0m[39m resources from src/main/resources to target/classes[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Copying [0m[1;36m3[0m[39m resources from target/maven-shared-archive-resources to [0m            [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m --- compiler:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m @ tika-core ---[0m                 [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Recompiling the module because of changed source code.[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Compiling [0m[1;36m361[0m[39m source files with javac [0m[1;39m[[0m[39mdebug deprecation release [0m[1;36m17[0m[1;39m][0m[39m to [0m      [2m               [0m
[2;36m                    [0m         [39mtarget/classes[0m                                                                       [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mServiceLoade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m: Some input files use unchecked or unsafe operations.[0m                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mServiceLoade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m: Recompile with -Xlint:unchecked for details.[0m                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m COMPILATION WARNING : [0m                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/config/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/exception/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/fork/[0m[95mpackage-info.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated[0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/io/[0m[95mpackage-info.jav[0m [2m               [0m
[2;36m                    [0m         [95ma[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated [0m  [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/metadata/[0m[95mpackage-in[0m [2m               [0m
[2;36m                    [0m         [95mfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m       [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mpackage-info.j[0m [2m               [0m
[2;36m                    [0m         [95mava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated[0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/[0m[95mpackage-info.java[0m[39m:[0m[1;39m[[0m [2m               [0m
[2;36m                    [0m         [1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated and [0m [2m               [0m
[2;36m                    [0m         [39mmarked for removal[0m                                                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/external/[0m[95mpac[0m [2m               [0m
[2;36m                    [0m         [95mkage-info.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been[0m [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mpackage-info[0m [2m               [0m
[2;36m                    [0m         [95m.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m         [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/sax/[0m[95mpackage-info.ja[0m [2m               [0m
[2;36m                    [0m         [95mva[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been deprecated [0m [2m               [0m
[2;36m                    [0m         [39mand marked for removal[0m                                                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/sax/xpath/[0m[95mpackage-i[0m [2m               [0m
[2;36m                    [0m         [95mnfo.java[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m      [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/utils/[0m[95mpackage-info.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m21[0m[39m,[0m[1;36m22[0m[1;39m][0m[39m aQute.bnd.annotation.Version in aQute.bnd.annotation has been [0m          [2m               [0m
[2;36m                    [0m         [39mdeprecated and marked for removal[0m                                                    [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/io/[0m[95mTikaInputStream.[0m [2m               [0m
[2;36m                    [0m         [95mjava[0m[39m:[0m[1;39m[[0m[1;36m342[0m[39m,[0m[1;36m36[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                         [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mDefaultDetec[0m [2m               [0m
[2;36m                    [0m         [95mtor.java[0m[39m:[0m[1;39m[[0m[1;36m97[0m[39m,[0m[1;36m37[0m[1;39m][0m[39m org.apache.tika.detect.OverrideDetector in org.apache.tika.detect [0m  [2m               [0m
[2;36m                    [0m         [39mhas been deprecated[0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mProbabilisticM[0m [2m               [0m
[2;36m                    [0m         [95mimeDetectionSelector.java[0m[39m:[0m[1;39m[[0m[1;36m162[0m[39m,[0m[1;36m36[0m[1;39m][0m[39m [0m[1;35mgetMimeType[0m[1;39m([0m[39mjava.lang.String[0m[1;39m)[0m[39m in [0m                 [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.mime.MimeTypes has been deprecated[0m                                   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/detect/[0m[95mXmlRootExtra[0m [2m               [0m
[2;36m                    [0m         [95mctor.java[0m[39m:[0m[1;39m[[0m[1;36m46[0m[39m,[0m[1;36m43[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                     [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/embedder/[0m[95mExternalEm[0m [2m               [0m
[2;36m                    [0m         [95mbedder.java[0m[39m:[0m[1;39m[[0m[1;36m428[0m[39m,[0m[1;36m72[0m[1;39m][0m[39m [0m[1;35mget[0m[1;39m([0m[39mjava.io.File[0m[1;39m)[0m[39m in org.apache.tika.io.TikaInputStream has [0m    [2m               [0m
[2;36m                    [0m         [39mbeen deprecated[0m                                                                      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParserCon[0m [2m               [0m
[2;36m                    [0m         [95mtainerExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m128[0m[39m,[0m[1;36m61[0m[1;39m][0m[39m [0m[1;35mget[0m[1;39m([0m[39mjava.io.File[0m[1;39m)[0m[39m in [0m                                  [2m               [0m
[2;36m                    [0m         [39morg.apache.tika.io.TikaInputStream has been deprecated[0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mWARNING[0m[1;39m][0m[39m [0m                                                                           [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/mime/[0m[95mMimeTypesReade[0m [2m               [0m
[2;36m                    [0m         [95mr.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m32[0m[1;39m][0m[39m [0m[1;35mUnsynchronizedByteArrayInputStream[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[1;39m)[0m[39m in [0m                       [2m               [0m
[2;36m                    [0m         [39morg.apache.commons.io.input.UnsynchronizedByteArrayInputStream has been deprecated[0m   [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m21[0m[39m warnings [0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                  [2m               [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m104[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m255[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                  [2m               [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                 [2m               [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m4[0m[39m errors [0m                                                                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m15.080[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m4.983[0m[39m s[0m[1;39m][0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m28.237[0m[39m s[0m                                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-13T[0m[1;92m09:08:17[0m[39mZ[0m                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m      [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                      [2m               [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m  [2m               [0m
[2;36m                    [0m         [39mproject tika-core: Compilation failure: Compilation failure: [0m                        [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m104[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m255[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePar[0m [2m               [0m
[2;36m                    [0m         [95mser.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                                 [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                         [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors and possible solutions, please read [0m   [2m               [0m
[2;36m                    [0m         [39mthe following articles:[0m                                                              [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m[39m [0m                                                                    [2m               [0m
[2;36m                    [0m         [4;94mhttp://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException[0m                [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                             [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m After correcting the problems, you can resume the build with the command[0m     [2m               [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   mvn <args[0m[1m>[0m -rf :tika-core                                                  [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/agent[0m ]8;id=681104;file:///home/qqor/crete/packages/crete/framework/agent/functions.py\[2mfunctions.py[0m]8;;\[2m:[0m]8;id=638512;file:///home/qqor/crete/packages/crete/framework/agent/functions.py#17\[2m17[0m]8;;\
[2;36m                    [0m         [35m-output-1768293926.7329285/[0m[95mbuild_failed_stderr.txt[0m: INFO:__main__:Running: docker    [2m               [0m
[2;36m                    [0m         build -t aixcc-afc/tika:latest --file                                                [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/tika/[0m[95mDockerfile[0m         [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/projects/[0m[95mtika.[0m                   [2m               [0m
[2;36m                    [0m         #[1;36m0[0m building with [32m"default"[0m instance using docker driver                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m1[0m [1m[[0minternal[1m][0m load build definition from Dockerfile                                  [2m               [0m
[2;36m                    [0m         #[1;36m1[0m transferring dockerfile: [1;36m1.[0m74kB done                                              [2m               [0m
[2;36m                    [0m         #[1;36m1[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m2[0m [1m[[0minternal[1m][0m load metadata for ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m2.1[0m         [2m               [0m
[2;36m                    [0m         #[1;36m2[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m3[0m [1m[[0minternal[1m][0m load .dockerignore                                                     [2m               [0m
[2;36m                    [0m         #[1;36m3[0m transferring context: 2B done                                                     [2m               [0m
[2;36m                    [0m         #[1;36m3[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m4[0m [1m[[0m [1;36m1[0m/[1;36m11[0m[1m][0m FROM ghcr.io/aixcc-finals/base-builder-jvm:v1.[1;36m2.1[0m                         [2m               [0m
[2;36m                    [0m         #[1;36m4[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m5[0m [1m[[0minternal[1m][0m load build context                                                     [2m               [0m
[2;36m                    [0m         #[1;36m5[0m transferring context: [1;36m1.[0m73kB done                                                 [2m               [0m
[2;36m                    [0m         #[1;36m5[0m DONE [1;36m0.[0m0s                                                                         [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m6[0m [1m[[0m [1;36m9[0m/[1;36m11[0m[1m][0m RUN tar -zxf [35m/src/[0m[95mtika.tar.gz[0m -C [35m/src/[0m[95mproject-parent[0m && rm                [2m               [0m
[2;36m                    [0m         [35m/src/[0m[95mtika.tar.gz[0m                                                                     [2m               [0m
[2;36m                    [0m         #[1;36m6[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m7[0m [1m[[0m [1;36m7[0m/[1;36m11[0m[1m][0m COPY project-parent [35m/src/project-parent/[0m                                  [2m               [0m
[2;36m                    [0m         #[1;36m7[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m8[0m [1m[[0m [1;36m3[0m/[1;36m11[0m[1m][0m RUN mkdir [35m/usr/[0m[95mmy-bin[0m && mv [35m/usr/bin/[0m[95mtesseract[0m [35m/usr/my-bin/[0m[95mtesseract[0m      [2m               [0m
[2;36m                    [0m         #[1;36m8[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m9[0m [1m[[0m [1;36m4[0m/[1;36m11[0m[1m][0m RUN mkdir [35m/[0m[95mexif[0m && cp [35m/usr/bin/[0m[95mexiftool[0m [35m/[0m[95mexif[0m && chmod -R a+rwx [35m/[0m[95mexif[0m     [2m               [0m
[2;36m                    [0m         #[1;36m9[0m CACHED                                                                            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m10[0m [1m[[0m [1;36m2[0m/[1;36m11[0m[1m][0m RUN set -eux     && apt-get update     && apt-get install --yes          [2m               [0m
[2;36m                    [0m         --no-install-recommends         tesseract-ocr         tesseract-ocr-eng              [2m               [0m
[2;36m                    [0m         exiftool                                                                             [2m               [0m
[2;36m                    [0m         #[1;36m10[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m11[0m [1m[[0m[1;36m10[0m/[1;36m11[0m[1m][0m COPY build.sh [35m/src/[0m                                                      [2m               [0m
[2;36m                    [0m         #[1;36m11[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m12[0m [1m[[0m [1;36m8[0m/[1;36m11[0m[1m][0m COPY pkgs/tika.tar.gz [35m/src/[0m[95mtika.tar.gz[0m                                   [2m               [0m
[2;36m                    [0m         #[1;36m12[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m13[0m [1m[[0m [1;36m5[0m/[1;36m11[0m[1m][0m COPY pkgs/maven.zip [35m/src/[0m[95mmaven.zip[0m                                       [2m               [0m
[2;36m                    [0m         #[1;36m13[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m14[0m [1m[[0m [1;36m6[0m/[1;36m11[0m[1m][0m RUN unzip [35m/src/[0m[95mmaven.zip[0m -d [35m/src/[0m[95mmaven[0m && rm [35m/src/[0m[95mmaven.zip[0m              [2m               [0m
[2;36m                    [0m         #[1;36m14[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m15[0m [1m[[0m[1;36m11[0m/[1;36m11[0m[1m][0m WORKDIR [35m/src/project-parent/[0m[95mtika[0m                                         [2m               [0m
[2;36m                    [0m         #[1;36m15[0m CACHED                                                                           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         #[1;36m16[0m exporting to image                                                               [2m               [0m
[2;36m                    [0m         #[1;36m16[0m exporting layers done                                                            [2m               [0m
[2;36m                    [0m         #[1;36m16[0m writing image                                                                    [2m               [0m
[2;36m                    [0m         sh[1;92ma256:d960[0me891282ff456c3e4bae3fede9b9849b941689517938e1f5e02d8a0c511c4 done         [2m               [0m
[2;36m                    [0m         #[1;36m16[0m naming to docker.io/aixcc-afc/tika:latest done                                   [2m               [0m
[2;36m                    [0m         #[1;36m16[0m DONE [1;36m0.[0m0s                                                                        [2m               [0m
[2;36m                    [0m         INFO:__main__:Keeping existing build artifacts as-is [1m([0mif any[1m)[0m.                       [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m -e [33mSANITIZER[0m=[35maddress[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -e   [2m               [0m
[2;36m                    [0m         [33mPROJECT_NAME[0m=[35mtika[0m -e [33mHELPER[0m=[3;92mTrue[0m -e [33mFUZZING_LANGUAGE[0m=[35mjvm[0m -e [33mBASH_ENV[0m=[35m/work/[0m[95mbashrc0[0m   [2m               [0m
[2;36m                    [0m         -e [33mMAVEN_OPTS[0m=-Dmaven.repo.[33mlocal[0m=[35m/work/[0m[95mmavencache[0m -v                                 [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m:[35m/[0m[95mlocal-source-mount[0m:ro -v                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/tika/[0m:[35m/[0m[95mout[0m -v          [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m:[35m/[0m[95mwork[0m -t         [2m               [0m
[2;36m                    [0m         aixcc-afc/tika:latest [35m/bin/[0m[95mbash[0m -c [32m'pushd $SRC && rm -rf /src/project-parent/tika &&[0m [2m               [0m
[2;36m                    [0m         [32mcp -r /local-source-mount /src/project-parent/tika && popd && compile'[0m.              [2m               [0m
[2;36m                    [0m         ERROR:__main__:Building fuzzers failed.                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m37.31[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=257738;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=882360;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=986402;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=91997;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 09:08:19][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.98[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=865049;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=56519;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 09:08:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=981613;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=483794;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 09:08:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.02[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=815381;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=983112;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=853844;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=425539;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.UNCOMPILABLE                                                            [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java   [2m                [0m
[2;36m                    [0m         +++ b/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java   [2m                [0m
[2;36m                    [0m         @@ [1;36m-158[0m,[1;36m7[0m +[1;36m158[0m,[1;36m8[0m @@                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  Process process = null;                                                    [2m                [0m
[2;36m                    [0m                  try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            process = [1;35mRuntime.getRuntime[0m[1m([0m[1m)[0m[1;35m.exec[0m[1m([0mcheckCmd[1m)[0m;                         [2m                [0m
[2;36m                    [0m         +            ProcessBuilder pb = new [1;35mProcessBuilder[0m[1m([0mcheckCmd[1m)[0m;                      [2m                [0m
[2;36m                    [0m         +            process = [1;35mpb.start[0m[1m([0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m                      Thread stdErrSuckerThread = [1;35mignoreStream[0m[1m([0m[1;35mprocess.getErrorStream[0m[1m([0m[1m)[0m,     [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m                      Thread stdOutSuckerThread = [1;35mignoreStream[0m[1m([0m[1;35mprocess.getInputStream[0m[1m([0m[1m)[0m,     [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m                      [1;35mstdErrSuckerThread.join[0m[1m([0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-285[0m,[1;36m14[0m +[1;36m286[0m,[1;36m9[0m @@                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  File output = null;                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -        [35m/[0m[35m/[0m Build our command                                                       [2m                [0m
[2;36m                    [0m         -        String[1m[[0m[1m][0m cmd;                                                              [2m                [0m
[2;36m                    [0m         -        if [1m([0mcommand.length == [1;36m1[0m[1m)[0m [1m{[0m                                                 [2m                [0m
[2;36m                    [0m         -            cmd = command[1m[[0m[1;36m0[0m[1m][0m[1;35m.split[0m[1m([0m[32m" "[0m[1m)[0m;                                           [2m                [0m
[2;36m                    [0m         -        [1m}[0m else [1m{[0m                                                                   [2m                [0m
[2;36m                    [0m         -            cmd = new String[1m[[0mcommand.length[1m][0m;                                      [2m                [0m
[2;36m                    [0m         -            [1;35mSystem.arraycopy[0m[1m([0mcommand, [1;36m0[0m, cmd, [1;36m0[0m, command.length[1m)[0m;                  [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Build our command - use command array directly without string splitting [2m                [0m
[2;36m                    [0m         +        String[1m[[0m[1m][0m cmd = new String[1m[[0mcommand.length[1m][0m;                                 [2m                [0m
[2;36m                    [0m         +        [1;35mSystem.arraycopy[0m[1m([0mcommand, [1;36m0[0m, cmd, [1;36m0[0m, command.length[1m)[0m;                      [2m                [0m
[2;36m                    [0m                  for [1m([0mint i = [1;36m0[0m; i [1m<[0m[39m cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [39m                 cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                         [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-305[0m[39m,[0m[1;36m14[0m[39m +[0m[1;36m301[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Execute using ProcessBuilder to avoid shell injection[0m                   [2m                [0m
[2;36m                    [0m         [39m         Process process = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m         try [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m-                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m-                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m+            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java[0m           [2m                [0m
[2;36m                    [0m         [39m+++ b/tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java[0m           [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-99[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m99[0m[39m,[0m[1;36m17[0m[39m @@[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [39m         Map<MediaType, Parser> map = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m+        ParserFilterConfig filterConfig = null;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mcontext != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+            filterConfig = [0m[1;35mcontext.get[0m[1;39m([0m[39mParserFilterConfig.class[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m         for [0m[1;39m([0m[39mParser parser : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39mfilterConfig != null && [0m[1;35mfilterConfig.hasExclusions[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [39m+                if [0m[1;39m([0m[1;35misExcluded[0m[1;39m([0m[1;35mfilterConfig.getExcludedParsers[0m[1;39m([0m[1;39m)[0m[39m, [0m                 [2m                [0m
[2;36m                    [0m         [1;35mparser.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+                    continue;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m             for [0m[1;39m([0m[39mMediaType type : [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35mmap.put[0m[1;39m([0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m, parser[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-242[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m252[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m     protected Parser [0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata, ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [39m         Map<MediaType, Parser> map = [0m[1;35mgetParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m+        ParserFilterConfig filterConfig = null;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mcontext != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+            filterConfig = [0m[1;35mcontext.get[0m[1;39m([0m[39mParserFilterConfig.class[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[95mcheck[0m[39m for parser override first[0m                                          [2m                [0m
[2;36m                    [0m         [39m         String contentTypeString = [0m                                                [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[39mcontentTypeString == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-256[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m271[0m[39m,[0m[1;36m12[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m Try finding a parser for the type[0m                                   [2m                [0m
[2;36m                    [0m         [39m             Parser parser = [0m[1;35mmap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mparser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+                if [0m[1;39m([0m[39mfilterConfig != null && [0m[1;35mfilterConfig.hasExclusions[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [39m+                    if [0m[1;39m([0m[1;35misExcluded[0m[1;39m([0m[1;35mfilterConfig.getExcludedParsers[0m[1;39m([0m[1;39m)[0m[39m, [0m             [2m                [0m
[2;36m                    [0m         [1;35mparser.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+                        type = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+                        continue;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+                    [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m                 return parser;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- [0m                                                                                [2m                [0m
[2;36m                    [0m         [39ma/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html[0m [2m                [0m
[2;36m                    [0m         [39m-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java[0m                  [2m                [0m
[2;36m                    [0m         [39m+++ [0m                                                                                [2m                [0m
[2;36m                    [0m         [39mb/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html[0m [2m                [0m
[2;36m                    [0m         [39m-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java[0m                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-27[0m[39m,[0m[1;36m9[0m[39m +[0m[1;36m27[0m[39m,[0m[1;36m14[0m[39m @@[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m import java.util.Locale;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m import java.util.Map;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m import java.util.Set;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m-import java.util.regex.Matcher;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m-import java.util.regex.Pattern;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+import org.xml.sax.helpers.AttributesImpl;[0m                                         [2m                [0m
[2;36m                    [0m         [39m+[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+import org.apache.tika.config.TikaConfig;[0m                                          [2m                [0m
[2;36m                    [0m         [39m+import org.apache.tika.parser.ParseContext;[0m                                        [2m                [0m
[2;36m                    [0m         [39m+import org.apache.tika.parser.Parser;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+import org.apache.tika.parser.ParserFilterConfig;[0m                                  [2m                [0m
[2;36m                    [0m         [39m+import org.apache.tika.parser.external.CompositeExternalParser;[0m                    [2m                [0m
[2;36m                    [0m         [39m+import org.apache.tika.parser.external.ExternalParser;[0m                             [2m                [0m
[2;36m                    [0m         [39m import org.xml.sax.Attributes;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m import org.xml.sax.ContentHandler;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m import org.xml.sax.SAXException;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-370[0m[39m,[0m[1;36m8[0m[39m +[0m[1;36m375[0m[39m,[0m[1;36m21[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        ParseContext restrictedContext = new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m+        Parser originalParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39moriginalParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mParser.class, originalParser[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        Set<Class<? extends Parser>> excludedParsers = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mexcludedParsers.add[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mexcludedParsers.add[0m[1;39m([0m[39mCompositeExternalParser.class[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m+        ParserFilterConfig filterConfig = new [0m[1;35mParserFilterConfig[0m[1;39m([0m[39mexcludedParsers[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mParserFilterConfig.class, filterConfig[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m         EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                      [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m+                [0m                                                                   [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mrestrictedContext[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m             try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, true[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m                [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m104[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                               [2m                [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m255[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m                [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                               [2m                [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m4[0m[39m errors [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m15.080[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m4.983[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m28.237[0m[39m s[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-13T[0m[1;92m09:08:17[0m[39mZ[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                     [2m                [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m [2m                [0m
[2;36m                    [0m         [39mproject tika-core: Compilation failure: Compilation failure: [0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m104[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                               [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m255[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                               [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors[0m                                       [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue is an OS Command Injection vulnerability detected during fuzzing [0m [2m                [0m
[2;36m                    [0m         [39mof Apache Tika's HTML parser. The vulnerability occurs when processing data URI [0m    [2m                [0m
[2;36m                    [0m         [39mschemes in HTML content, which leads to execution of external parsers with [0m         [2m                [0m
[2;36m                    [0m         [39mpotentially attacker-controlled data. The patch attempt tried to mitigate this by [0m  [2m                [0m
[2;36m                    [0m         [39mpreventing shell injection through proper use of ProcessBuilder, removing string [0m   [2m                [0m
[2;36m                    [0m         [39msplitting of commands, and implementing a mechanism to block external parsers from [0m [2m                [0m
[2;36m                    [0m         [39mbeing invoked when processing inline embedded content. However, the patch failed to[0m [2m                [0m
[2;36m                    [0m         [39mcompile due to type incompatibility errors in the ParseContext API usage.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe exception stack trace reveals a critical security vulnerability with the [0m       [2m                [0m
[2;36m                    [0m         [39mfollowing characteristics:[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Vulnerability Type**: OS Command Injection [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mcom.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Entry Point**: The fuzzing harness invokes `[0m[1;35mHtmlParserFuzzer.parseOne[0m[1;39m([0m[1;39m)[0m[39m` which[0m [2m                [0m
[2;36m                    [0m         [39muses Tika's `AutoDetectParser`[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Execution Flow**: [0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - HTML content is parsed by `JSoupParser`[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - During HTML parsing, `[0m[1;35mHtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m` is called [0m[1;39m([0m[39mline [0m[1;36m377[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m   - A `ParsingEmbeddedDocumentExtractor` is used to parse embedded content [0m[1;39m([0m[39mline [0m  [2m                [0m
[2;36m                    [0m         [1;36m101[0m[1;39m)[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m   - The embedded content triggers the `AutoDetectParser` again[0m                     [2m                [0m
[2;36m                    [0m         [39m   - This eventually leads to `[0m[1;35mExternalParser.parse[0m[1;39m([0m[1;39m)[0m[39m` being invoked [0m[1;39m([0m[39mline [0m[1;36m274[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [39mthen [0m[1;36m314[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m   - `ExternalParser` calls `[0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m` which triggers the security violation[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe critical observation is that data URI schemes embedded in HTML can trigger [0m     [2m                [0m
[2;36m                    [0m         [39mexternal parser execution, creating a command injection vector when processing [0m     [2m                [0m
[2;36m                    [0m         [39muntrusted HTML content.[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch attempted to address the vulnerability through four main modifications:[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**[0m[1;36m1[0m[39m. ExternalParser.java modifications [0m[1;39m([0m[39mlines [0m[1;36m158[0m[39m-[0m[1;36m310[0m[1;39m)[0m[39m:**[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Replaced `[0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m` with `ProcessBuilder` approach [0m [2m                [0m
[2;36m                    [0m         [39mfor command checking[0m                                                                [2m                [0m
[2;36m                    [0m         [39m   - Removed string splitting logic that converted single-string commands into [0m     [2m                [0m
[2;36m                    [0m         [39marrays [0m[1;39m([0m[39m`command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m`[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m   - Changed command array construction to use direct copying without splitting[0m     [2m                [0m
[2;36m                    [0m         [39m   - Replaced all `[0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m` calls with `[0m[1;35mProcessBuilder.start[0m[1;39m([0m[1;39m)[0m[39m` to avoid [0m    [2m                [0m
[2;36m                    [0m         [39mshell injection[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m   - This prevents shell metacharacter interpretation by executing commands [0m        [2m                [0m
[2;36m                    [0m         [39mdirectly[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**[0m[1;36m2[0m[39m. HtmlHandler.java modifications [0m[1;39m([0m[39mlines [0m[1;36m370[0m[39m-[0m[1;36m383[0m[1;39m)[0m[39m:**[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Created a `restrictedContext` ParseContext when handling data URI schemes[0m      [2m                [0m
[2;36m                    [0m         [39m   - Attempted to set flags to block external parsers: `ExternalParser.class` and [0m  [2m                [0m
[2;36m                    [0m         [39m`CompositeExternalParser.class` both set to `Boolean.FALSE`[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Passed this restricted context to the embedded document extractor[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**[0m[1;36m3[0m[39m. ParsingEmbeddedDocumentExtractor.java modifications [0m[1;39m([0m[39mlines [0m[1;36m95[0m[39m-[0m[1;36m110[0m[1;39m)[0m[39m:**[0m          [2m                [0m
[2;36m                    [0m         [39m   - Added logic to detect inline embedded resources using [0m                         [2m                [0m
[2;36m                    [0m         [39m`TikaCoreProperties.EMBEDDED_RESOURCE_TYPE`[0m                                         [2m                [0m
[2;36m                    [0m         [39m   - When inline content is detected and external parsers are blocked in the parent[0m [2m                [0m
[2;36m                    [0m         [39mcontext, creates a new restricted context[0m                                           [2m                [0m
[2;36m                    [0m         [39m   - Attempted to propagate the external parser blocking flags to the new context[0m   [2m                [0m
[2;36m                    [0m         [39m   - Used the effective context for parsing instead of the original context[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**[0m[1;36m4[0m[39m. CompositeParser.java modifications [0m[1;39m([0m[39mlines [0m[1;36m99[0m[39m-[0m[1;36m110[0m[1;39m)[0m[39m:**[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Added logic in `[0m[1;35mgetParsers[0m[1;39m([0m[1;39m)[0m[39m` to check if external parsers should be blocked[0m   [2m                [0m
[2;36m                    [0m         [39m   - Attempted to filter out ExternalParser and CompositeExternalParser instances [0m  [2m                [0m
[2;36m                    [0m         [39mwhen the blocking flag is set[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Compilation Errors[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch produced four compilation errors, all related to type incompatibility:[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **CompositeParser.jav[0m[1;92ma:103[0m[39m** - Attempting to compare `ExternalParser` class type[0m [2m                [0m
[2;36m                    [0m         [39mwith `Boolean.FALSE`[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **ParsingEmbeddedDocumentExtractor.jav[0m[1;92ma:102[0m[39m** - Same comparison issue with [0m      [2m                [0m
[2;36m                    [0m         [39mExternalParser and Boolean[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **ParsingEmbeddedDocumentExtractor.jav[0m[1;92ma:108[0m[39m** - [0m[1;35mParseContext.set[0m[1;39m([0m[1;39m)[0m[39m method cannot[0m [2m                [0m
[2;36m                    [0m         [39maccept `ExternalParser.class` as key with `Boolean` as value [0m[1;39m([0m[39mtype parameter T [0m     [2m                [0m
[2;36m                    [0m         [39mconflict[0m[1;39m)[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **ParsingEmbeddedDocumentExtractor.jav[0m[1;92ma:109[0m[39m** - Same issue with [0m                 [2m                [0m
[2;36m                    [0m         [39m`CompositeExternalParser.class` and Boolean[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe root cause of these errors is that `[0m[1;35mParseContext.set[0m[1;39m([0m[39mClass<T>, T[0m[1;39m)[0m[39m` requires the[0m [2m                [0m
[2;36m                    [0m         [39mvalue type to match the class type. The patch attempted to use parser class types [0m  [2m                [0m
[2;36m                    [0m         [39mas keys with Boolean values, which violates the type safety constraints.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo develop a comprehensive solution, the following components should be [0m            [2m                [0m
[2;36m                    [0m         [39minvestigated:[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **ParseContext API Design**: Understanding the proper mechanism for storing [0m     [2m                [0m
[2;36m                    [0m         [39mconfiguration flags or blocklists in ParseContext that don't violate type [0m          [2m                [0m
[2;36m                    [0m         [39mconstraints[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Parser Selection Mechanism**: How CompositeParser and AutoDetectParser select [0m [2m                [0m
[2;36m                    [0m         [39mand instantiate parsers, and where filtering could be applied[0m                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **EmbeddedDocumentExtractor Configuration**: The proper way to configure or [0m     [2m                [0m
[2;36m                    [0m         [39mrestrict which parsers can be used for embedded content[0m                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **ExternalParser Configuration**: Whether ExternalParser has existing [0m           [2m                [0m
[2;36m                    [0m         [39mconfiguration options to restrict command execution or validate commands[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Data URI Scheme Handling**: The complete flow of how data URIs are extracted [0m  [2m                [0m
[2;36m                    [0m         [39mand parsed in HtmlHandler and whether restrictions should be applied at that level[0m  [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Security Context Propagation**: How security restrictions or parsing modes [0m    [2m                [0m
[2;36m                    [0m         [39mshould be propagated through the parser chain[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Alternative Mitigation Strategies**: Whether command validation, whitelisting,[0m [2m                [0m
[2;36m                    [0m         [39mor parser disable mechanisms already exist in the codebase that could be leveraged[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m103[0m[39m,[0m[1;36m79[0m[1;39m][0m[39m incomparable types: [0m                                             [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m99[0m[1;39m][0m[39m incomparable types: [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m108[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m               [2m                [0m
[2;36m                    [0m         [39m  required: java.lang.Class<T>,T[0m                                                    [2m                [0m
[2;36m                    [0m         [39m  found:    [0m                                                                        [2m                [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.ExternalParser>,java.lang.Boolean[0m   [2m                [0m
[2;36m                    [0m         [39m  reason: inference variable T has incompatible bounds[0m                              [2m                [0m
[2;36m                    [0m         [39m    equality constraints: org.apache.tika.parser.external.ExternalParser[0m            [2m                [0m
[2;36m                    [0m         [39m    lower bounds: java.lang.Boolean[0m                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m109[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m               [2m                [0m
[2;36m                    [0m         [39m  required: java.lang.Class<T>,T[0m                                                    [2m                [0m
[2;36m                    [0m         [39m  found:    [0m                                                                        [2m                [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.CompositeExternalParser>,java.lang.[0m [2m                [0m
[2;36m                    [0m         [39mBoolean[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m  reason: inference variable T has incompatible bounds[0m                              [2m                [0m
[2;36m                    [0m         [39m    equality constraints: org.apache.tika.parser.external.CompositeExternalParser[0m   [2m                [0m
[2;36m                    [0m         [39m    lower bounds: java.lang.Boolean[0m                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m4[0m[39m errors [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m13.621[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m4.844[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m26.638[0m[39m s[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-13T[0m[1;92m08:57:30[0m[39mZ[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                     [2m                [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m [2m                [0m
[2;36m                    [0m         [39mproject tika-core: Compilation failure: Compilation failure: [0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m103[0m[39m,[0m[1;36m79[0m[1;39m][0m[39m incomparable types: [0m                                             [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m99[0m[1;39m][0m[39m incomparable types: [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.ExternalParser and java.lang.Boolean[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m108[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m               [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   required: java.lang.Class<T>,T[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   found:    [0m                                                                [2m                [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.ExternalParser>,java.lang.Boolean[0m   [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   reason: inference variable T has incompatible bounds[0m                      [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     equality constraints: org.apache.tika.parser.external.ExternalParser[0m    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     lower bounds: java.lang.Boolean[0m                                         [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/extractor/[0m[95mParsingE[0m [2m                [0m
[2;36m                    [0m         [95mmbeddedDocumentExtractor.java[0m[39m:[0m[1;39m[[0m[1;36m109[0m[39m,[0m[1;36m29[0m[1;39m][0m[39m method set in class [0m                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.ParseContext cannot be applied to given types;[0m               [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   required: java.lang.Class<T>,T[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   found:    [0m                                                                [2m                [0m
[2;36m                    [0m         [39mjava.lang.Class<org.apache.tika.parser.external.CompositeExternalParser>,java.lang.[0m [2m                [0m
[2;36m                    [0m         [39mBoolean[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   reason: inference variable T has incompatible bounds[0m                      [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     equality constraints: [0m                                                  [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.external.CompositeExternalParser[0m                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m     lower bounds: java.lang.Boolean[0m                                         [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors[0m                                       [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/ParseContext.jav[0m[1;92ma:31[0m[39m-[0m[1;36m86[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:public class ParseContext implements Serializable [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * Serial version UID.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final long serialVersionUID = -5921436862145826534L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * Map of objects in this context[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private final Map<String, Object> context = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Adds the given value to the context as an implementation of the given[0m     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * interface.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param key   the interface implemented by the given value[0m                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param value the value to be added, or <code>null<[0m[35m/[0m[95mcode[0m[39m> to remove[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    public <T> void [0m[1;35mset[0m[1;39m([0m[39mClass<T> key, T value[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            [0m[1;35mcontext.put[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            [0m[1;35mcontext.remove[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * Returns the object in this context that implements the given interface.[0m   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * @param key the interface implemented by the requested object[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * or <code>null<[0m[35m/[0m[95mcode[0m[39m> if not found[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        return [0m[1;39m([0m[39mT[0m[1;39m)[0m[39m [0m[1;35mcontext.get[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Returns the object in this context that implements the given interface,[0m   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * or the given default value if such an object is not found.[0m                [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @param key          the interface implemented by the requested object[0m     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param defaultValue value to return if the requested object is not found[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * or the given default value if not found[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key, T defaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        T value = [0m[1;35mget[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            return value;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return defaultValue;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:73[0m[39m-[0m[1;36m123[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers,[0m     [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                           Collection<Class<? extends Parser>> excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        if [0m[1;39m([0m[39mexcludeParsers == null || [0m[1;35mexcludeParsers.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            this.parsers = parsers;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            this.parsers = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            for [0m[1;39m([0m[39mParser p : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35misExcluded[0m[1;39m([0m[39mexcludeParsers, [0m[1;35mp.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    [0m[1;35mthis.parsers.add[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        this.registry = registry;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, parsers, null[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, Parser[0m[33m...[0m[39m parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, [0m[1;35mArrays.asList[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        Map<MediaType, Parser> map = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        for [0m[1;39m([0m[39mParser parser : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            for [0m[1;39m([0m[39mMediaType type : [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;35mmap.put[0m[1;39m([0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m, parser[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        return map;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private boolean [0m[1;35misExcluded[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m             [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                               Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        return [0m[1;35mexcludeParsers.contains[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m || [0m[1;35massignableFrom[0m[1;39m([0m[39mexcludeParsers, p[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private boolean [0m[1;35massignableFrom[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m         [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                                   Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        for [0m[1;39m([0m[39mClass<? extends Parser> e : excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            if [0m[1;39m([0m[1;35me.isAssignableFrom[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                return true;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        return false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m108[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        Map<MediaType, Parser> map = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        for [0m[1;39m([0m[39mParser parser : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            for [0m[1;39m([0m[39mMediaType type : [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;35mmap.put[0m[1;39m([0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m, parser[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        return map;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:62[0m[39m-[0m[1;36m78[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        DocumentSelector selector = [0m[1;35mcontext.get[0m[1;39m([0m[39mDocumentSelector.class[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mselector != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return [0m[1;35mselector.select[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        FilenameFilter filter = [0m[1;35mcontext.get[0m[1;39m([0m[39mFilenameFilter.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[39mfilter != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                return [0m[1;35mfilter.accept[0m[1;39m([0m[39mABSTRACT_PATH, name[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/DocumentSelector.jav[0m[1;92ma:30[0m[39m-[0m[1;36m42[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public interface DocumentSelector [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     * Checks if a document with the given metadata matches the specified[0m        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * selection criteria.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * @param metadata document metadata[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * @return <code>true<[0m[35m/[0m[95mcode[0m[39m> if the document matches the selection criteria,[0m [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * <code>false<[0m[35m/[0m[95mcode[0m[39m> otherwise[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    boolean [0m[1;35mselect[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/pipes/HandlerConfig.jav[0m[1;92ma:25[0m[39m-[0m[1;36m93[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:public class HandlerConfig implements Serializable [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    private static final long serialVersionUID = -3861669115439125268L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    public static final HandlerConfig DEFAULT_HANDLER_CONFIG =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:            new [0m[1;35mHandlerConfig[0m[1;39m([0m[39mBasicContentHandlerFactory.HANDLER_TYPE.TEXT, [0m     [2m                [0m
[2;36m                    [0m         [39mPARSE_MODE.RMETA,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:                    [0m[1;36m-1[0m[39m, [0m[1;36m-1[0m[39m, true[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * [0m[1;39m{[0m[39m@link PARSE_MODE#RMETA[0m[1;39m}[0m[39m [0m[32m"recursive metadata"[0m[39m is the same as the -J [0m      [2m                [0m
[2;36m                    [0m         [39moption[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * in tika-app and the [0m[35m/[0m[95mrmeta[0m[39m endpoint in tika-server.  Each embedded file [0m  [2m                [0m
[2;36m                    [0m         [39mis represented as[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * its own metadata object.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * [0m[1;39m{[0m[39m@link PARSE_MODE#CONCATENATE[0m[1;39m}[0m[39m is similar[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * to the legacy tika-app behavior and the [0m[35m/[0m[95mtika[0m[39m endpoint [0m[1;39m([0m[39maccept: [0m          [2m                [0m
[2;36m                    [0m         [39mapplication/json[0m[1;39m)[0m[39m in[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * tika-server.  This concatenates the[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * contents of embedded files and returns a single metadata object for the [0m  [2m                [0m
[2;36m                    [0m         [39mfile no[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * matter how many embedded objects there are; this option throws away [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata from[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * embedded objects and silently skips exceptions in embedded objects.[0m       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public enum PARSE_MODE [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        RMETA,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        CONCATENATE;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        public static PARSE_MODE [0m[1;35mparseMode[0m[1;39m([0m[39mString modeString[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            for [0m[1;39m([0m[39mPARSE_MODE m : [0m[1;35mPARSE_MODE.values[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                if [0m[1;39m([0m[1;35mm.name[0m[1;39m([0m[1;39m)[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mmodeString[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                    return m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            int i = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            for [0m[1;39m([0m[39mPARSE_MODE m : [0m[1;35mPARSE_MODE.values[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:                if [0m[1;39m([0m[39mi++ > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                    [0m[1;35msb.append[0m[1;39m([0m[32m", "[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[1;35mm.name[0m[1;39m([0m[1;39m)[0m[1;35m.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"mode must be one of: [0m[32m([0m[32m"[0m[39m + sb +[0m   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                    [0m[32m"[0m[32m)[0m[32m. I regret I do not understand: "[0m[39m + modeString[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private BasicContentHandlerFactory.HANDLER_TYPE type =[0m                       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            BasicContentHandlerFactory.HANDLER_TYPE.TEXT;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    int writeLimit = [0m[1;36m-1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    int maxEmbeddedResources = [0m[1;36m-1[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    boolean throwOnWriteLimitReached = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    PARSE_MODE parseMode = PARSE_MODE.RMETA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public [0m[1;35mHandlerConfig[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public [0m[1;35mHandlerConfig[0m[1;39m([0m[39mBasicContentHandlerFactory.HANDLER_TYPE type, [0m          [2m                [0m
[2;36m                    [0m         [39mPARSE_MODE parseMode,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                         int writeLimit,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                         int maxEmbeddedResources, boolean [0m                      [2m                [0m
[2;36m                    [0m         [39mthrowOnWriteLimitReached[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        this.type = type;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        this.parseMode = parseMode;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        this.writeLimit = writeLimit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        this.maxEmbeddedResources = maxEmbeddedResources;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        this.throwOnWriteLimitReached = throwOnWriteLimitReached;[0m                [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:239[0m[39m-[0m[1;36m266[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    protected Parser [0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:        return [0m[1;35mgetParser[0m[1;39m([0m[39mmetadata, new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    protected Parser [0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata, ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        Map<MediaType, Parser> map = [0m[1;35mgetParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        [0m[35m/[0m[35m/[0m[95mcheck[0m[39m for parser override first[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        String contentTypeString = [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        if [0m[1;39m([0m[39mcontentTypeString == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:            contentTypeString = [0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mcontentTypeString[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:        if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:            [0m[35m/[0m[35m/[0m[39m We always work on the normalised, canonical form[0m                 [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            type = [0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:        while [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try finding a parser for the type[0m                                [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            Parser parser = [0m[1;35mmap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:            if [0m[1;39m([0m[39mparser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:                return parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:            [0m[35m/[0m[35m/[0m[39m Failing that, try for the parent of the type[0m                     [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            type = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        return fallback;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/ParserDecorator.jav[0m[1;92ma:43[0m[39m-[0m[1;36m171[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:public class ParserDecorator implements Parser [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private static final long serialVersionUID = -3861669115439125268L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     * The decorated parser instance.[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final Parser parser;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * Creates a decorator for the given parser.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * @param parser the parser instance to be decorated[0m                         [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    public [0m[1;35mParserDecorator[0m[1;39m([0m[39mParser parser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        this.parser = parser;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * Decorates the given parser so that it always claims to support[0m            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * parsing of the given media types.[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * @param parser the parser to be decorated[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * @param types  supported media types[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * @return the decorated parser[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    public static final Parser [0m[1;35mwithTypes[0m[1;39m([0m[39mParser parser, final Set<MediaType> [0m    [2m                [0m
[2;36m                    [0m         [39mtypes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        return new [0m[1;35mParserDecorator[0m[1;39m([0m[39mparser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:            private static final long serialVersionUID = -7345051519565330731L;[0m  [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:            @Override[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:                return types;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            @Override[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            public String [0m[1;35mgetDecorationName[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                return [0m[32m"With Types"[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:     * Decorates the given parser so that it never claims to support[0m             [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * parsing of the given media types, but will work for all others.[0m           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @param parser       the parser to be decorated[0m                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     * @param excludeTypes excluded/ignored media types[0m                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:     * @return the decorated parser[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:    public static final Parser [0m[1;35mwithoutTypes[0m[1;39m([0m[39mParser parser, final Set<MediaType> [0m [2m                [0m
[2;36m                    [0m         [39mexcludeTypes[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        return new [0m[1;35mParserDecorator[0m[1;39m([0m[39mparser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            private static final long serialVersionUID = 7979614774021768609L;[0m   [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:            @Override[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:                [0m[35m/[0m[35m/[0m[39m Get our own, writable copy of the types the parser supports[0m  [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                Set<MediaType> parserTypes =[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:                        new HashSet<>[0m[1;39m([0m[1;35msuper.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[35m/[0m[35m/[0m[39m Remove anything on our excludes list[0m                         [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                [0m[1;35mparserTypes.removeAll[0m[1;39m([0m[39mexcludeTypes[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                [0m[35m/[0m[35m/[0m[39m Return whatever is left[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:                return parserTypes;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            @Override[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            public String [0m[1;35mgetDecorationName[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:                return [0m[32m"Without Types"[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:     * Decorates the given parsers into a virtual parser, where they'll[0m         [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:     * be tried in preference order until one works without error.[0m              [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:     * @deprecated This has been replaced by [0m[1;39m{[0m[39m@link FallbackParser[0m[1;39m}[0m             [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    @Deprecated[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:    public static final Parser [0m[1;35mwithFallbacks[0m[1;39m([0m[39mfinal Collection<? extends Parser>[0m [2m                [0m
[2;36m                    [0m         [39mparsers,[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                                             final Set<MediaType> types[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:        [0m[35m/[0m[35m/[0m[39m Delegate to the new FallbackParser for now, until people upgrade[0m     [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:        [0m[35m/[0m[35m/[0m[39m Keep old behaviour on metadata, which was to preseve all[0m             [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:        MediaTypeRegistry registry = [0m[1;35mMediaTypeRegistry.getDefaultRegistry[0m[1;39m([0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        Parser p = new [0m[1;35mFallbackParser[0m[1;39m([0m[39mregistry, MetadataPolicy.KEEP_ALL, [0m       [2m                [0m
[2;36m                    [0m         [39mparsers[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:        if [0m[1;39m([0m[39mtypes == null || [0m[1;35mtypes.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            return p;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:        return [0m[1;35mwithTypes[0m[1;39m([0m[39mp, types[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:     * Delegates the method call to the decorated parser. Subclasses should[0m     [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:     * override this method [0m[1;39m([0m[39mand use <code>[0m[1;35msuper.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[39m<[0m[35m/[0m[95mcode[0m[39m>[0m     [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:     * to invoke the decorated parser[0m[1;39m)[0m[39m to implement extra decoration.[0m           [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        return [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:     * Delegates the method call to the decorated parser. Subclasses should[0m     [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:     * override this method [0m[1;39m([0m[39mand use <code>[0m[1;35msuper.parse[0m[1;39m([0m[1;39m)[0m[39m<[0m[35m/[0m[95mcode[0m[39m> to invoke[0m       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:     * the decorated parser[0m[1;39m)[0m[39m to implement extra decoration.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:        [0m[1;35mparser.parse[0m[1;39m([0m[39mstream, handler, metadata, context[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:     * @return A name/description of the decoration, or null if none available[0m  [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:    public String [0m[1;35mgetDecorationName[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        return null;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:     * Gets the parser wrapped by this ParserDecorator[0m                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:     * @return the parser wrapped by this ParserDecorator[0m                       [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:    public Parser [0m[1;35mgetWrappedParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:        return this.parser;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:62[0m[39m-[0m[1;36m78[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        DocumentSelector selector = [0m[1;35mcontext.get[0m[1;39m([0m[39mDocumentSelector.class[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mselector != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return [0m[1;35mselector.select[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        FilenameFilter filter = [0m[1;35mcontext.get[0m[1;39m([0m[39mFilenameFilter.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[39mfilter != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                return [0m[1;35mfilter.accept[0m[1;39m([0m[39mABSTRACT_PATH, name[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m384[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParsersFactory.jav[0m[1;92ma[0m [2m                [0m
[2;36m                    [0m         [1;92m:41[0m[39m-[0m[1;36m85[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class ExternalParsersFactory [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    public static List<ExternalParser> [0m[1;35mcreate[0m[1;39m([0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:        return [0m[1;35mcreate[0m[1;39m([0m[39mnew [0m[1;35mServiceLoader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    public static List<ExternalParser> [0m[1;35mcreate[0m[1;39m([0m[39mServiceLoader loader[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:            throws IOException, TikaException [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        return [0m[1;35mcreate[0m[1;39m([0m[32m"tika-external-parsers.xml"[0m[39m, loader[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static List<ExternalParser> [0m[1;35mcreate[0m[1;39m([0m[39mString filename, ServiceLoader [0m    [2m                [0m
[2;36m                    [0m         [39mloader[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            throws IOException, TikaException [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        String filepath =[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                [0m[1;35mExternalParsersFactory.class.getPackage[0m[1;39m([0m[1;39m)[0m[1;35m.getName[0m[1;39m([0m[1;39m)[0m[1;35m.replace[0m[1;39m([0m[32m'.'[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [32m'/'[0m[1;39m)[0m[39m + [0m[32m"/"[0m[39m +[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                        filename;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:        Enumeration<URL> files = [0m[1;35mloader.findServiceResources[0m[1;39m([0m[39mfilepath[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        ArrayList<URL> list = [0m[1;35mCollections.list[0m[1;39m([0m[39mfiles[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        URL[0m[1;39m[[0m[1;39m][0m[39m urls = [0m[1;35mlist.toArray[0m[1;39m([0m[39mnew URL[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        return [0m[1;35mcreate[0m[1;39m([0m[39murls[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public static List<ExternalParser> [0m[1;35mcreate[0m[1;39m([0m[39mURL[0m[33m...[0m[39m urls[0m[1;39m)[0m[39m throws IOException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        List<ExternalParser> parsers = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        for [0m[1;39m([0m[39mURL url : urls[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            try [0m[1;39m([0m[39mInputStream stream = [0m[1;35murl.openStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                [0m[1;35mparsers.addAll[0m[1;39m([0m[1;35mExternalParsersConfigReader.read[0m[1;39m([0m[39mstream[0m[1;39m)[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        return parsers;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public static void [0m[1;35mattachExternalParsers[0m[1;39m([0m[39mTikaConfig config[0m[1;39m)[0m[39m throws [0m          [2m                [0m
[2;36m                    [0m         [39mIOException, TikaException [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mattachExternalParsers[0m[1;39m([0m[1;35mcreate[0m[1;39m([0m[1;39m)[0m[39m, config[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    public static void [0m[1;35mattachExternalParsers[0m[1;39m([0m[39mList<ExternalParser> parsers, [0m      [2m                [0m
[2;36m                    [0m         [39mTikaConfig config[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        Parser parser = [0m[1;35mconfig.getParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        if [0m[1;39m([0m[39mparser instanceof CompositeParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:            CompositeParser cParser = [0m[1;39m([0m[39mCompositeParser[0m[1;39m)[0m[39m parser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            Map<MediaType, Parser> parserMap = [0m[1;35mcParser.getParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[39m TODO[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external2/ExternalParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m16[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[95mthis[0m[39m may remain null, depending on whether the external parser writes[0m [2m                [0m
[2;36m                    [0m         [39mto a file[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        Path outFile = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        try [0m[1;39m([0m[39mTemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            TikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, metadata[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            Path p = [0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            List<String> thisCommandLine = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            Matcher inputMatcher = [0m[1;35mIN[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            Matcher outputMatcher = [0m[1;35mOUT[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            boolean outputFileInCommandline = false;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            for [0m[1;39m([0m[39mString c : commandLine[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                if [0m[1;39m([0m[1;35minputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35mp.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35moutputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                    outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35moutFile.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                    outputFileInCommandline = true;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            FileProcessResult result = null;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            long localTimeoutMillis = [0m[1;35mTikaTaskTimeout.getTimeoutMillis[0m[1;39m([0m[39mcontext,[0m [2m                [0m
[2;36m                    [0m         [39mtimeoutMs[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            if [0m[1;39m([0m[39moutputFileInCommandline[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        localTimeoutMillis, maxStdOut, maxStdErr[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                        localTimeoutMillis, outFile, maxStdErr[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.IS_TIMEOUT, [0m[1;35mresult.isTimeout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.EXIT_VALUE, [0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_LENGTH, [0m                       [2m                [0m
[2;36m                    [0m         [1;35mresult.getStdoutLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_IS_TRUNCATED,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                    [0m[1;35mresult.isStdoutTruncated[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_ERR_LENGTH, [0m                       [2m                [0m
[2;36m                    [0m         [1;35mresult.getStderrLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_ERR_IS_TRUNCATED,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                    [0m[1;35mresult.isStderrTruncated[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            if [0m[1;39m([0m[39mreturnStdout[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT, [0m[1;35mresult.getStdout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            if [0m[1;39m([0m[39mreturnStderr[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_ERR, [0m[1;35mresult.getStderr[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;35mhandleOutput[0m[1;39m([0m[39mresult, outFile, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:            [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            if [0m[1;39m([0m[39moutFile != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                [0m[1;35mFiles.delete[0m[1;39m([0m[39moutFile[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/AutoDetectParserConfig.jav[0m[1;92ma:41[0m[39m-[0m[1;36m120[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class AutoDetectParserConfig extends ConfigBase implements Serializable [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private static ContentHandlerDecoratorFactory [0m                               [2m                [0m
[2;36m                    [0m         [39mNOOP_CONTENT_HANDLER_DECORATOR_FACTORY =[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            new [0m[1;35mContentHandlerDecoratorFactory[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                @Override[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                public ContentHandler [0m[1;35mdecorate[0m[1;39m([0m[39mContentHandler contentHandler, [0m   [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                                               ParseContext parseContext[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                    return contentHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;39m}[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static AutoDetectParserConfig DEFAULT = new [0m[1;35mAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public static AutoDetectParserConfig [0m[1;35mload[0m[1;39m([0m[39mElement element[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            throws TikaConfigException, IOException [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mAutoDetectParserConfig.buildSingle[0m[1;39m([0m[32m"autoDetectParserConfig"[0m[39m,[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                AutoDetectParserConfig.class, element, [0m                          [2m                [0m
[2;36m                    [0m         [39mAutoDetectParserConfig.DEFAULT[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * If this is not null and greater than [0m[1;36m-1[0m[39m, the AutoDetectParser[0m             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * will spool the stream to disk if the length of the stream is known[0m        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * ahead of time.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private Long spoolToDisk = null;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * SecureContentHandler -- Desired output threshold in characters.[0m           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private Long outputThreshold = null;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * SecureContentHandler -- Desired maximum compression ratio.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private Long maximumCompressionRatio = null;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * SecureContentHandler -- Desired maximum XML nesting level.[0m                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private Integer maximumDepth = null;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * SecureContentHandler -- Desired maximum package entry nesting level.[0m      [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private Integer maximumPackageEntryDepth = null;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private MetadataWriteFilterFactory metadataWriteFilterFactory = null;[0m        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private EmbeddedDocumentExtractorFactory embeddedDocumentExtractorFactory = [0m [2m                [0m
[2;36m                    [0m         [39mnull;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private ContentHandlerDecoratorFactory contentHandlerDecoratorFactory =[0m      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            NOOP_CONTENT_HANDLER_DECORATOR_FACTORY;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    private DigestingParser.DigesterFactory digesterFactory = null;[0m              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    private boolean throwOnZeroBytes = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Creates a SecureContentHandlerConfig using the passed in parameters.[0m      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * @param spoolToDisk[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     * @param outputThreshold          SecureContentHandler - character output [0m [2m                [0m
[2;36m                    [0m         [39mthreshold.[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     * @param maximumCompressionRatio  SecureContentHandler - max compression [0m  [2m                [0m
[2;36m                    [0m         [39mratio allowed.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:     * @param maximumDepth             SecureContentHandler - maximum XML [0m      [2m                [0m
[2;36m                    [0m         [39melement nesting level.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:     * @param maximumPackageEntryDepth SecureContentHandler - maximum package [0m  [2m                [0m
[2;36m                    [0m         [39mentry nesting level.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    public [0m[1;35mAutoDetectParserConfig[0m[1;39m([0m[39mLong spoolToDisk, Long outputThreshold,[0m       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                                  Long maximumCompressionRatio, Integer [0m        [2m                [0m
[2;36m                    [0m         [39mmaximumDepth,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                                  Integer maximumPackageEntryDepth[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        this.spoolToDisk = spoolToDisk;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        this.outputThreshold = outputThreshold;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        this.maximumCompressionRatio = maximumCompressionRatio;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        this.maximumDepth = maximumDepth;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        this.maximumPackageEntryDepth = maximumPackageEntryDepth;[0m               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    public [0m[1;35mAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/metadata/TikaCoreProperties.jav[0m[1;92ma:385[0m[39m-[0m[1;36m412[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:    Property PIPES_RESULT = [0m[1;35mProperty.externalText[0m[1;39m([0m[39mTIKA_META_PREFIX + [0m           [2m                [0m
[2;36m                    [0m         [32m"pipes_result"[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:     * A file might contain different types of embedded documents.[0m              [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:     * The most common is the ATTACHMENT.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:     * An INLINE embedded resource should be used for embedded image[0m            [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:     * files that are used to render the page image [0m[1;39m([0m[39mas in PDXObjImages in PDF [0m [2m                [0m
[2;36m                    [0m         [39mfiles[0m[1;39m)[0m[39m.[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:     * A MACRO is code that is embedded in the document and is intended[0m         [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:     * to be executable within the application that opens the document.  This[0m   [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:     * includes traditional macros within Microsoft Office files and[0m            [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:     * javascript within PDFActions.  This would not include, e.g., an[0m          [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:     * .exe file embedded in a .zip file.[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:     * A VERSION is an earlier version of the file as in incremental updates.[0m   [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:     * The initial use case for this is incremental updates in PDFs, but[0m        [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:     * it could be applied to other file formats as well where earlier versions[0m [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:     * are recoverable. See also [0m[1;39m{[0m[39m@link PDF#INCREMENTAL_UPDATE_NUMBER[0m[1;39m}[0m          [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:     * <p>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:     * Not all parsers have yet implemented this.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:    enum EmbeddedResourceType [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:        INLINE, [0m[35m/[0m[35m/[0m[95mimage[0m[39m that is intended to be displayed in a rendering of the [0m [2m                [0m
[2;36m                    [0m         [39mfile[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:        ATTACHMENT,[0m[35m/[0m[35m/[0m[95mstandard[0m[39m attachment as in email[0m                            [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:        MACRO, [0m[35m/[0m[35m/[0m[95many[0m[39m code that is intended to be run by the application[0m         [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:        METADATA, [0m[35m/[0m[35m/[0m[95me.g.[0m[39m xmp, xfa[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:        FONT,[0m[35m/[0m[35m/[0m[95membedded[0m[39m font files[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:        THUMBNAIL, [0m[35m/[0m[35m/[0m[95mTODO[0m[39m: set this in parsers that handle thumbnails[0m           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:367[0m[39m-[0m[1;36m372[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pdf-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/test/java/org/apache/tika/parser/pdf/PDFParserTest.jav[0m[1;92ma:1381[0m[39m-[0m[1;36m1391[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1381[0m[39m:    private static class AvoidInlineSelector implements DocumentSelector [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m1382[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1383[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1384[0m[39m:        public boolean [0m[1;35mselect[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1385[0m[39m:            String v = [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1386[0m[39m:            if [0m[1;39m([0m[39mv != null && [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mv.equals[0m[1;39m([0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m1387[0m[39m:                return false;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1388[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:            return true;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pdf-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/test/java/org/apache/tika/parser/pdf/PDFParserTest.jav[0m[1;92ma:1381[0m[39m-[0m[1;36m1391[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1381[0m[39m:    private static class AvoidInlineSelector implements DocumentSelector [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m1382[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1383[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1384[0m[39m:        public boolean [0m[1;35mselect[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1385[0m[39m:            String v = [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1386[0m[39m:            if [0m[1;39m([0m[39mv != null && [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mv.equals[0m[1;39m([0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m1387[0m[39m:                return false;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1388[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:            return true;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pdf-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/test/java/org/apache/tika/parser/pdf/PDFParserTest.jav[0m[1;92ma:19[0m[39m-[0m[1;36m70[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.junit.jupiter.api.Assertions.assertArrayEquals;[0m                [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import static org.junit.jupiter.api.Assertions.assertEquals;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import static org.junit.jupiter.api.Assertions.assertFalse;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import static org.junit.jupiter.api.Assertions.assertNotNull;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import static org.junit.jupiter.api.Assertions.assertNull;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import static org.junit.jupiter.api.Assertions.assertThrows;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import static org.junit.jupiter.api.Assertions.assertTrue;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import static org.junit.jupiter.api.Assertions.fail;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.logging.Level;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.logging.Logger;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.junit.jupiter.api.AfterAll;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.junit.jupiter.api.BeforeAll;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.junit.jupiter.api.Disabled;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.junit.jupiter.api.Test;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.Tika;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.TikaTest;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.config.TikaConfig;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.exception.AccessPermissionException;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.exception.EncryptedDocumentException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.exception.ZeroByteFileException;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:import org.apache.tika.extractor.DocumentSelector;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:import org.apache.tika.metadata.Font;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:import org.apache.tika.metadata.PDF;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:import org.apache.tika.metadata.TikaPagedText;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:import org.apache.tika.metadata.XMP;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:import org.apache.tika.metadata.XMPMM;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:import org.apache.tika.parser.AutoDetectParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:import org.apache.tika.parser.CompositeParser;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:import org.apache.tika.parser.PasswordProvider;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:import org.apache.tika.sax.BodyContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:import org.apache.tika.sax.ContentHandlerDecorator;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:import org.apache.tika.utils.ExceptionUtils;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:239[0m[39m-[0m[1;36m266[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    protected Parser [0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:        return [0m[1;35mgetParser[0m[1;39m([0m[39mmetadata, new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    protected Parser [0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata, ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        Map<MediaType, Parser> map = [0m[1;35mgetParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        [0m[35m/[0m[35m/[0m[95mcheck[0m[39m for parser override first[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        String contentTypeString = [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        if [0m[1;39m([0m[39mcontentTypeString == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:            contentTypeString = [0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mcontentTypeString[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:        if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:            [0m[35m/[0m[35m/[0m[39m We always work on the normalised, canonical form[0m                 [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            type = [0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:        while [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try finding a parser for the type[0m                                [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            Parser parser = [0m[1;35mmap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:            if [0m[1;39m([0m[39mparser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:                return parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:            [0m[35m/[0m[35m/[0m[39m Failing that, try for the parent of the type[0m                     [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            type = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        return fallback;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:280[0m[39m-[0m[1;36m320[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        Parser parser = [0m[1;35mgetParser[0m[1;39m([0m[39mmetadata, context[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        TemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        ParseRecord parserRecord = [0m[1;35mcontext.get[0m[1;39m([0m[39mParseRecord.class[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:        if [0m[1;39m([0m[39mparserRecord == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:            parserRecord = new [0m[1;35mParseRecord[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:            [0m[1;35mcontext.set[0m[1;39m([0m[39mParseRecord.class, parserRecord[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:            TikaInputStream taggedStream = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, [0m    [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            TaggedContentHandler taggedHandler =[0m                                [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:                    handler != null ? new [0m[1;35mTaggedContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m : null;[0m [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            String parserClassname = [0m[1;35mParserUtils.getParserClassname[0m[1;39m([0m[39mparser[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mparserRecord.addParserClass[0m[1;39m([0m[39mparserClassname[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:            [0m[1;35mParserUtils.recordParserDetails[0m[1;39m([0m[39mparserClassname, metadata[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:            [0m[1;35mparserRecord.beforeParse[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                [0m[1;35mparser.parse[0m[1;39m([0m[39mtaggedStream, taggedHandler, metadata, context[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSecurityException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:                [0m[35m/[0m[35m/[0m[95mrethrow[0m[39m security exceptions[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:                throw e;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                [0m[1;35mtaggedStream.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"TIKA-198: Illegal IOException from "[0m[39m +[0m [2m                [0m
[2;36m                    [0m         [39mparser, e[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:                [0m[1;35mWriteLimitReachedException.throwIfWriteLimitReached[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:                if [0m[1;39m([0m[39mtaggedHandler != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:                    [0m[1;35mtaggedHandler.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"TIKA-237: Illegal SAXException from "[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m+ parser, e[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mRuntimeException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                throw new [0m[1;35mTikaException[0m[1;39m([0m[32m"Unexpected RuntimeException from "[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [39mparser, e[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;35mtmp.dispose[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:            [0m[1;35mparserRecord.afterParse[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            if [0m[1;39m([0m[1;35mparserRecord.getDepth[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mTikaCoreProperties.TIKA_PARSED_BY_FULL_SET, [0m       [2m                [0m
[2;36m                    [0m         [1;35mparserRecord.getParsers[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:                [0m[1;35mrecordEmbeddedMetadata[0m[1;39m([0m[39mmetadata, context[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m123[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        Map<MediaType, Parser> map = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        for [0m[1;39m([0m[39mParser parser : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            for [0m[1;39m([0m[39mMediaType type : [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;35mmap.put[0m[1;39m([0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m, parser[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        return map;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private boolean [0m[1;35misExcluded[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m             [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                               Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        return [0m[1;35mexcludeParsers.contains[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m || [0m[1;35massignableFrom[0m[1;39m([0m[39mexcludeParsers, p[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private boolean [0m[1;35massignableFrom[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m         [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                                   Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        for [0m[1;39m([0m[39mClass<? extends Parser> e : excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            if [0m[1;39m([0m[1;35me.isAssignableFrom[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                return true;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        return false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:436[0m[39m-[0m[1;36m466[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:        [0m[1;35mexifToolParser.setCommand[0m[1;39m([0m[32m"exiftool"[0m[39m, [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:        [0m[1;35mexifToolParser.setSupportedTypes[0m[1;39m([0m[39mnewSupported[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:        [0m[1;35mmetadata.remove[0m[1;39m([0m[32m"exiftool_path"[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:        Map<MediaType, Parser> updated = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m440[0m[39m:        for [0m[1;39m([0m[39mMap.Entry<MediaType, Parser> e : [0m[1;35mexParser.getParsers[0m[1;39m([0m[1;39m)[0m[1;35m.entrySet[0m[1;39m([0m[1;39m)[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m441[0m[39m:            if [0m[1;39m([0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                       [2m                [0m
[2;36m                    [0m         [1;36m442[0m[39m:                ExternalParser p = [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m [0m[1;35me.getValue[0m[1;39m([0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m443[0m[39m:                if [0m[1;39m([0m[1;35mExternalParser.check[0m[1;39m([0m[1;35mp.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m444[0m[39m:                    for [0m[1;39m([0m[39mMediaType mediaType : [0m[1;35mp.getSupportedTypes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m445[0m[39m:                        [0m[1;35mupdated.put[0m[1;39m([0m[39mmediaType, p[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m446[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m447[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m448[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m449[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m450[0m[39m:        [0m[1;35mexParser.setParsers[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m451[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:    private ExternalParser [0m[1;35mgetExistingExifToolParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:        CompositeExternalParser exParser =[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:                [0m[1;39m([0m[39mCompositeExternalParser[0m[1;39m)[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.tryToFindExistingLeafParser[0m[1;39m([0m[39mCompositeExternalParser.class,[0m     [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:                        context[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:        if [0m[1;39m([0m[39mexParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:            return null;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:        for [0m[1;39m([0m[39mParser p : [0m[1;35mexParser.getAllComponentParsers[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:            if [0m[1;39m([0m[39mp instanceof ExternalParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:                String[0m[1;39m[[0m[1;39m][0m[39m args = [0m[1;39m([0m[1;39m([0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p[0m[1;39m)[0m[1;35m.getCommand[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:                for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < args.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m464[0m[39m:                    if [0m[1;39m([0m[39margs[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[32m"exiftool"[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m465[0m[39m:                        return [0m[1;39m([0m[39mExternalParser[0m[1;39m)[0m[39m p;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m466[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:182[0m[39m-[0m[1;36m193[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    public List<Parser> [0m[1;35mgetAllComponentParsers[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        return [0m[1;35mCollections.unmodifiableList[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:     * Returns the component parsers.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:     * @return component parsers, keyed by media type[0m                           [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        return [0m[1;35mgetParsers[0m[1;39m([0m[39mnew [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/CompositeExternalParser.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:33[0m[39m-[0m[1;36m44[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:public class CompositeExternalParser extends CompositeParser [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final long serialVersionUID = 6962436916649024024L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    public [0m[1;35mCompositeExternalParser[0m[1;39m([0m[1;39m)[0m[39m throws IOException, TikaException [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public [0m[1;35mCompositeExternalParser[0m[1;39m([0m[39mMediaTypeRegistry registry[0m[1;39m)[0m[39m throws [0m           [2m                [0m
[2;36m                    [0m         [39mIOException, TikaException [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mregistry, [0m[1;39m([0m[39mList<Parser>[0m[1;39m)[0m[39m [0m[1;39m([0m[39mList<? extends Parser>[0m[1;39m)[0m[39m [0m                 [2m                [0m
[2;36m                    [0m         [1;35mExternalParsersFactory.create[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:73[0m[39m-[0m[1;36m123[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers,[0m     [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                           Collection<Class<? extends Parser>> excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        if [0m[1;39m([0m[39mexcludeParsers == null || [0m[1;35mexcludeParsers.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            this.parsers = parsers;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            this.parsers = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            for [0m[1;39m([0m[39mParser p : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35misExcluded[0m[1;39m([0m[39mexcludeParsers, [0m[1;35mp.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    [0m[1;35mthis.parsers.add[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        this.registry = registry;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, parsers, null[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, Parser[0m[33m...[0m[39m parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, [0m[1;35mArrays.asList[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        Map<MediaType, Parser> map = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        for [0m[1;39m([0m[39mParser parser : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            for [0m[1;39m([0m[39mMediaType type : [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;35mmap.put[0m[1;39m([0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m, parser[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        return map;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private boolean [0m[1;35misExcluded[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m             [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                               Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        return [0m[1;35mexcludeParsers.contains[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m || [0m[1;35massignableFrom[0m[1;39m([0m[39mexcludeParsers, p[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private boolean [0m[1;35massignableFrom[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m         [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                                   Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        for [0m[1;39m([0m[39mClass<? extends Parser> e : excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            if [0m[1;39m([0m[1;35me.isAssignableFrom[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                return true;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        return false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:243[0m[39m-[0m[1;36m266[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    protected Parser [0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata, ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        Map<MediaType, Parser> map = [0m[1;35mgetParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        [0m[35m/[0m[35m/[0m[95mcheck[0m[39m for parser override first[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        String contentTypeString = [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        if [0m[1;39m([0m[39mcontentTypeString == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:            contentTypeString = [0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mcontentTypeString[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:        if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:            [0m[35m/[0m[35m/[0m[39m We always work on the normalised, canonical form[0m                 [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            type = [0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:        while [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try finding a parser for the type[0m                                [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            Parser parser = [0m[1;35mmap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:            if [0m[1;39m([0m[39mparser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:                return parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:            [0m[35m/[0m[35m/[0m[39m Failing that, try for the parent of the type[0m                     [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            type = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        return fallback;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/AutoDetectParserConfig.jav[0m[1;92ma:41[0m[39m-[0m[1;36m120[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class AutoDetectParserConfig extends ConfigBase implements Serializable [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    private static ContentHandlerDecoratorFactory [0m                               [2m                [0m
[2;36m                    [0m         [39mNOOP_CONTENT_HANDLER_DECORATOR_FACTORY =[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:            new [0m[1;35mContentHandlerDecoratorFactory[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                @Override[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:                public ContentHandler [0m[1;35mdecorate[0m[1;39m([0m[39mContentHandler contentHandler, [0m   [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                                               ParseContext parseContext[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                    return contentHandler;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:            [0m[1;39m}[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static AutoDetectParserConfig DEFAULT = new [0m[1;35mAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    public static AutoDetectParserConfig [0m[1;35mload[0m[1;39m([0m[39mElement element[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:            throws TikaConfigException, IOException [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mAutoDetectParserConfig.buildSingle[0m[1;39m([0m[32m"autoDetectParserConfig"[0m[39m,[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                AutoDetectParserConfig.class, element, [0m                          [2m                [0m
[2;36m                    [0m         [39mAutoDetectParserConfig.DEFAULT[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * If this is not null and greater than [0m[1;36m-1[0m[39m, the AutoDetectParser[0m             [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * will spool the stream to disk if the length of the stream is known[0m        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * ahead of time.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    private Long spoolToDisk = null;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * SecureContentHandler -- Desired output threshold in characters.[0m           [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    private Long outputThreshold = null;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * SecureContentHandler -- Desired maximum compression ratio.[0m                [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private Long maximumCompressionRatio = null;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * SecureContentHandler -- Desired maximum XML nesting level.[0m                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    private Integer maximumDepth = null;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:     * SecureContentHandler -- Desired maximum package entry nesting level.[0m      [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    private Integer maximumPackageEntryDepth = null;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private MetadataWriteFilterFactory metadataWriteFilterFactory = null;[0m        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private EmbeddedDocumentExtractorFactory embeddedDocumentExtractorFactory = [0m [2m                [0m
[2;36m                    [0m         [39mnull;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    private ContentHandlerDecoratorFactory contentHandlerDecoratorFactory =[0m      [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            NOOP_CONTENT_HANDLER_DECORATOR_FACTORY;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    private DigestingParser.DigesterFactory digesterFactory = null;[0m              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    private boolean throwOnZeroBytes = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Creates a SecureContentHandlerConfig using the passed in parameters.[0m      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * @param spoolToDisk[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     * @param outputThreshold          SecureContentHandler - character output [0m [2m                [0m
[2;36m                    [0m         [39mthreshold.[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:     * @param maximumCompressionRatio  SecureContentHandler - max compression [0m  [2m                [0m
[2;36m                    [0m         [39mratio allowed.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:     * @param maximumDepth             SecureContentHandler - maximum XML [0m      [2m                [0m
[2;36m                    [0m         [39melement nesting level.[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:     * @param maximumPackageEntryDepth SecureContentHandler - maximum package [0m  [2m                [0m
[2;36m                    [0m         [39mentry nesting level.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    public [0m[1;35mAutoDetectParserConfig[0m[1;39m([0m[39mLong spoolToDisk, Long outputThreshold,[0m       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:                                  Long maximumCompressionRatio, Integer [0m        [2m                [0m
[2;36m                    [0m         [39mmaximumDepth,[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:                                  Integer maximumPackageEntryDepth[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        this.spoolToDisk = spoolToDisk;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        this.outputThreshold = outputThreshold;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        this.maximumCompressionRatio = maximumCompressionRatio;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        this.maximumDepth = maximumDepth;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:        this.maximumPackageEntryDepth = maximumPackageEntryDepth;[0m               [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    public [0m[1;35mAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/pipes/HandlerConfig.jav[0m[1;92ma:25[0m[39m-[0m[1;36m93[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:public class HandlerConfig implements Serializable [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    private static final long serialVersionUID = -3861669115439125268L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    public static final HandlerConfig DEFAULT_HANDLER_CONFIG =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:            new [0m[1;35mHandlerConfig[0m[1;39m([0m[39mBasicContentHandlerFactory.HANDLER_TYPE.TEXT, [0m     [2m                [0m
[2;36m                    [0m         [39mPARSE_MODE.RMETA,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:                    [0m[1;36m-1[0m[39m, [0m[1;36m-1[0m[39m, true[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * [0m[1;39m{[0m[39m@link PARSE_MODE#RMETA[0m[1;39m}[0m[39m [0m[32m"recursive metadata"[0m[39m is the same as the -J [0m      [2m                [0m
[2;36m                    [0m         [39moption[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * in tika-app and the [0m[35m/[0m[95mrmeta[0m[39m endpoint in tika-server.  Each embedded file [0m  [2m                [0m
[2;36m                    [0m         [39mis represented as[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * its own metadata object.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * [0m[1;39m{[0m[39m@link PARSE_MODE#CONCATENATE[0m[1;39m}[0m[39m is similar[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * to the legacy tika-app behavior and the [0m[35m/[0m[95mtika[0m[39m endpoint [0m[1;39m([0m[39maccept: [0m          [2m                [0m
[2;36m                    [0m         [39mapplication/json[0m[1;39m)[0m[39m in[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * tika-server.  This concatenates the[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * contents of embedded files and returns a single metadata object for the [0m  [2m                [0m
[2;36m                    [0m         [39mfile no[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * matter how many embedded objects there are; this option throws away [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata from[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     * embedded objects and silently skips exceptions in embedded objects.[0m       [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    public enum PARSE_MODE [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        RMETA,[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        CONCATENATE;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        public static PARSE_MODE [0m[1;35mparseMode[0m[1;39m([0m[39mString modeString[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:            for [0m[1;39m([0m[39mPARSE_MODE m : [0m[1;35mPARSE_MODE.values[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:                if [0m[1;39m([0m[1;35mm.name[0m[1;39m([0m[1;39m)[0m[1;35m.equalsIgnoreCase[0m[1;39m([0m[39mmodeString[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:                    return m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:            StringBuilder sb = new [0m[1;35mStringBuilder[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:            int i = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:            for [0m[1;39m([0m[39mPARSE_MODE m : [0m[1;35mPARSE_MODE.values[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:                if [0m[1;39m([0m[39mi++ > [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:                    [0m[1;35msb.append[0m[1;39m([0m[32m", "[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:                [0m[1;35msb.append[0m[1;39m([0m[1;35mm.name[0m[1;39m([0m[1;39m)[0m[1;35m.toLowerCase[0m[1;39m([0m[39mLocale.US[0m[1;39m)[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            throw new [0m[1;35mIllegalArgumentException[0m[1;39m([0m[32m"mode must be one of: [0m[32m([0m[32m"[0m[39m + sb +[0m   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:                    [0m[32m"[0m[32m)[0m[32m. I regret I do not understand: "[0m[39m + modeString[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private BasicContentHandlerFactory.HANDLER_TYPE type =[0m                       [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            BasicContentHandlerFactory.HANDLER_TYPE.TEXT;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    int writeLimit = [0m[1;36m-1[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    int maxEmbeddedResources = [0m[1;36m-1[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    boolean throwOnWriteLimitReached = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    PARSE_MODE parseMode = PARSE_MODE.RMETA;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public [0m[1;35mHandlerConfig[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    public [0m[1;35mHandlerConfig[0m[1;39m([0m[39mBasicContentHandlerFactory.HANDLER_TYPE type, [0m          [2m                [0m
[2;36m                    [0m         [39mPARSE_MODE parseMode,[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:                         int writeLimit,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:                         int maxEmbeddedResources, boolean [0m                      [2m                [0m
[2;36m                    [0m         [39mthrowOnWriteLimitReached[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        this.type = type;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        this.parseMode = parseMode;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        this.writeLimit = writeLimit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        this.maxEmbeddedResources = maxEmbeddedResources;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:        this.throwOnWriteLimitReached = throwOnWriteLimitReached;[0m                [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:243[0m[39m-[0m[1;36m266[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    protected Parser [0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata, ParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:        Map<MediaType, Parser> map = [0m[1;35mgetParsers[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:        [0m[35m/[0m[35m/[0m[95mcheck[0m[39m for parser override first[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:        String contentTypeString = [0m                                             [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m247[0m[39m:        if [0m[1;39m([0m[39mcontentTypeString == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m248[0m[39m:            contentTypeString = [0m[1;35mmetadata.get[0m[1;39m([0m[39mMetadata.CONTENT_TYPE[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m249[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m250[0m[39m:        MediaType type = [0m[1;35mMediaType.parse[0m[1;39m([0m[39mcontentTypeString[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m251[0m[39m:        if [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m252[0m[39m:            [0m[35m/[0m[35m/[0m[39m We always work on the normalised, canonical form[0m                 [2m                [0m
[2;36m                    [0m         [1;36m253[0m[39m:            type = [0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m254[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m255[0m[39m:        while [0m[1;39m([0m[39mtype != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m256[0m[39m:            [0m[35m/[0m[35m/[0m[39m Try finding a parser for the type[0m                                [2m                [0m
[2;36m                    [0m         [1;36m257[0m[39m:            Parser parser = [0m[1;35mmap.get[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m258[0m[39m:            if [0m[1;39m([0m[39mparser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m259[0m[39m:                return parser;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m260[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m261[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m262[0m[39m:            [0m[35m/[0m[35m/[0m[39m Failing that, try for the parent of the type[0m                     [2m                [0m
[2;36m                    [0m         [1;36m263[0m[39m:            type = [0m[1;35mregistry.getSupertype[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m264[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m265[0m[39m:        return fallback;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m266[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:110[0m[39m-[0m[1;36m122[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private boolean [0m[1;35misExcluded[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m             [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                               Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        return [0m[1;35mexcludeParsers.contains[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m || [0m[1;35massignableFrom[0m[1;39m([0m[39mexcludeParsers, p[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private boolean [0m[1;35massignableFrom[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m         [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                                   Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        for [0m[1;39m([0m[39mClass<? extends Parser> e : excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            if [0m[1;39m([0m[1;35me.isAssignableFrom[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                return true;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        return false;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m384[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:80[0m[39m-[0m[1;36m118[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public void [0m[1;35mparseEmbedded[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            TikaInputStream tis, ContentHandler handler, Metadata metadata, [0m     [2m                [0m
[2;36m                    [0m         [39mboolean outputHtml[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws SAXException, IOException [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            AttributesImpl attributes = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            [0m[1;35mattributes.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"CDATA"[0m[39m, [0m              [2m                [0m
[2;36m                    [0m         [32m"package-entry"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[39m, attributes[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        if [0m[1;39m([0m[39mwriteFileNameToContent && name != null && [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m && [0m      [2m                [0m
[2;36m                    [0m         [39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[39m, new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m chars = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            [0m[1;35mhandler.characters[0m[1;39m([0m[39mchars, [0m[1;36m0[0m[39m, chars.length[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[35m/[0m[35m/[0m[39m Use the delegate parser to parse this entry[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;35mtis.setCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mDELEGATING_PARSER.parse[0m[1;39m([0m[39mtis, new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m[39mnew [0m        [2m                [0m
[2;36m                    [0m         [1;35mBodyContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                    metadata, context[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEncryptedDocumentException ede[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39mede, context[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCorruptedFileException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[95mnecessary[0m[39m to stop the parse to avoid infinite loops[0m               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[35m/[0m[35m/[0m[95mon[0m[39m corrupt sqlite3 files[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39me, context[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mtis.removeCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:288[0m[39m-[0m[1;36m318[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external2/ExternalParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m16[0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    @Override[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[95mthis[0m[39m may remain null, depending on whether the external parser writes[0m [2m                [0m
[2;36m                    [0m         [39mto a file[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        Path outFile = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        try [0m[1;39m([0m[39mTemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m               [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            TikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, metadata[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            Path p = [0m[1;35mtis.getPath[0m[1;39m([0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            List<String> thisCommandLine = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            Matcher inputMatcher = [0m[1;35mIN[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            Matcher outputMatcher = [0m[1;35mOUT[0m[1;33mPUT[0m[1;35m_TOKEN_MATCHER.matcher[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            boolean outputFileInCommandline = false;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            for [0m[1;39m([0m[39mString c : commandLine[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:                if [0m[1;39m([0m[1;35minputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35mp.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;35moutputMatcher.reset[0m[1;39m([0m[39mc[0m[1;39m)[0m[1;35m.find[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                    outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    String updated = [0m[1;35mc.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN,[0m               [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            [0m                                                    [2m                [0m
[2;36m                    [0m         [1;35mProcessUtils.escapeCommandLine[0m[1;39m([0m[1;35moutFile.toAbsolutePath[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mupdated[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                    outputFileInCommandline = true;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                    [0m[1;35mthisCommandLine.add[0m[1;39m([0m[39mc[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:            FileProcessResult result = null;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            long localTimeoutMillis = [0m[1;35mTikaTaskTimeout.getTimeoutMillis[0m[1;39m([0m[39mcontext,[0m [2m                [0m
[2;36m                    [0m         [39mtimeoutMs[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:            if [0m[1;39m([0m[39moutputFileInCommandline[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        localTimeoutMillis, maxStdOut, maxStdErr[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                outFile = [0m[1;35mFiles.createTempFile[0m[1;39m([0m[32m"tika-external2-"[0m[39m, [0m[32m""[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                result = [0m[1;35mProcessUtils.execute[0m[1;39m([0m[39mnew [0m                              [2m                [0m
[2;36m                    [0m         [1;35mProcessBuilder[0m[1;39m([0m[39mthisCommandLine[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                        localTimeoutMillis, outFile, maxStdErr[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.IS_TIMEOUT, [0m[1;35mresult.isTimeout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.EXIT_VALUE, [0m[1;35mresult.getExitValue[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_LENGTH, [0m                       [2m                [0m
[2;36m                    [0m         [1;35mresult.getStdoutLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT_IS_TRUNCATED,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                    [0m[1;35mresult.isStdoutTruncated[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_ERR_LENGTH, [0m                       [2m                [0m
[2;36m                    [0m         [1;35mresult.getStderrLength[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:            [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_ERR_IS_TRUNCATED,[0m                  [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                    [0m[1;35mresult.isStderrTruncated[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:            if [0m[1;39m([0m[39mreturnStdout[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_OUT, [0m[1;35mresult.getStdout[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:            if [0m[1;39m([0m[39mreturnStderr[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mExternalProcess.STD_ERR, [0m[1;35mresult.getStderr[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:            XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, [0m       [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:            [0m[1;35mxhtml.startDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:            [0m[1;35mhandleOutput[0m[1;39m([0m[39mresult, outFile, xhtml, metadata, context[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:            [0m[1;35mxhtml.endDocument[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            if [0m[1;39m([0m[39moutFile != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:                [0m[1;35mFiles.delete[0m[1;39m([0m[39moutFile[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/ParseContext.jav[0m[1;92ma:31[0m[39m-[0m[1;36m86[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:public class ParseContext implements Serializable [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * Serial version UID.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final long serialVersionUID = -5921436862145826534L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * Map of objects in this context[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private final Map<String, Object> context = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Adds the given value to the context as an implementation of the given[0m     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * interface.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param key   the interface implemented by the given value[0m                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param value the value to be added, or <code>null<[0m[35m/[0m[95mcode[0m[39m> to remove[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    public <T> void [0m[1;35mset[0m[1;39m([0m[39mClass<T> key, T value[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            [0m[1;35mcontext.put[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            [0m[1;35mcontext.remove[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * Returns the object in this context that implements the given interface.[0m   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * @param key the interface implemented by the requested object[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * or <code>null<[0m[35m/[0m[95mcode[0m[39m> if not found[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        return [0m[1;39m([0m[39mT[0m[1;39m)[0m[39m [0m[1;35mcontext.get[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Returns the object in this context that implements the given interface,[0m   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * or the given default value if such an object is not found.[0m                [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @param key          the interface implemented by the requested object[0m     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param defaultValue value to return if the requested object is not found[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * or the given default value if not found[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key, T defaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        T value = [0m[1;35mget[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            return value;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return defaultValue;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause Analysis[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe compilation errors stem from attempting to store `Boolean` values in [0m           [2m                [0m
[2;36m                    [0m         [39m`ParseContext` using parser class types as keys [0m[1;39m([0m[39me.g., [0m                             [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mcontext.set[0m[1;39m([0m[39mExternalParser.class, Boolean.FALSE[0m[1;39m)[0m[39m`[0m[1;39m)[0m[39m. This violates `ParseContext`'s[0m [2m                [0m
[2;36m                    [0m         [39mtype-safe API requirement: `public <T> void [0m[1;35mset[0m[1;39m([0m[39mClass<T> key, T value[0m[1;39m)[0m[39m` mandates [0m   [2m                [0m
[2;36m                    [0m         [39mthat the value type must match the class type used as the key.[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe underlying security vulnerability is an OS Command Injection that occurs when:[0m  [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. HTML content with data URI schemes is parsed[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The data URI content is marked as `INLINE` embedded resource[0m                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `AutoDetectParser` selects `ExternalParser` or `CompositeExternalParser` based [0m  [2m                [0m
[2;36m                    [0m         [39mon content type[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. These parsers execute external commands with potentially attacker-controlled [0m    [2m                [0m
[2;36m                    [0m         [39mdata[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Comprehensive Fix Strategy[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m1[0m[39m. Create a Type-Safe Parser Filter Configuration Class[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mCreate a new file [0m                                                                  [2m                [0m
[2;36m                    [0m         [39m`tika-core/src/main/java/org/apache/tika/parser/ParserFilterConfig.java`:[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Purpose**: Provide a Serializable configuration class that can be stored in [0m      [2m                [0m
[2;36m                    [0m         [39mParseContext without violating type constraints.[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Structure**:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- Implement `Serializable` [0m[1;39m([0m[39mrequired for ParseContext[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m- Store a `Collection<Class<? extends Parser>>` of parser classes to exclude[0m        [2m                [0m
[2;36m                    [0m         [39m- Follow the pattern of `HandlerConfig` and `AutoDetectParserConfig`[0m                [2m                [0m
[2;36m                    [0m         [39m- Provide getter methods for accessing the excluded parsers collection[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key points**:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- Use defensive copying in constructor to prevent external modification[0m             [2m                [0m
[2;36m                    [0m         [39m- Return unmodifiable collection from getter[0m                                        [2m                [0m
[2;36m                    [0m         [39m- Include proper serial version UID[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- This approach is type-safe: `[0m[1;35mcontext.set[0m[1;39m([0m[39mParserFilterConfig.class, [0m               [2m                [0m
[2;36m                    [0m         [39mparserFilterConfigInstance[0m[1;39m)[0m[39m`[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m2[0m[39m. Modify CompositeParser to Respect Parser Filtering[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mModify `tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java` in the[0m [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mgetParser[0m[1;39m([0m[39mMetadata metadata, ParseContext context[0m[1;39m)[0m[39m` method:[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Lines [0m[1;36m243[0m[39m-[0m[1;36m266[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- After line [0m[1;36m244[0m[39m, retrieve `ParserFilterConfig` from the context[0m                    [2m                [0m
[2;36m                    [0m         [39m- After line [0m[1;36m257[0m[39m-[0m[1;36m258[0m[39m where a parser is found, check if it should be excluded[0m        [2m                [0m
[2;36m                    [0m         [39m- Reuse the existing `[0m[1;35misExcluded[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m               [2m                [0m
[2;36m                    [0m         [39mexcludeParsers, Class<? extends Parser> p[0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mlines [0m[1;36m110[0m[39m-[0m[1;36m112[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m- If the parser is excluded, skip it and continue to try parent media types[0m         [2m                [0m
[2;36m                    [0m         [39m- This leverages the existing `[0m[1;35massignableFrom[0m[1;39m([0m[1;39m)[0m[39m` logic that properly handles [0m       [2m                [0m
[2;36m                    [0m         [39minheritance[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Logic flow**:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Get ParserFilterConfig from context[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Find parser based on media type[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. If parser found and filter config exists:[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - Check if [0m[1;35mparser.getClass[0m[1;39m([0m[1;39m)[0m[39m is in excluded list using [0m[1;35misExcluded[0m[1;39m([0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m   - If excluded: set type to parent type and continue loop[0m                         [2m                [0m
[2;36m                    [0m         [39m   - If not excluded: return parser[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Return fallback if no suitable parser found[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m3[0m[39m. Apply Parser Filtering in HtmlHandler for Data URI Schemes[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mModify [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-[0m [2m                [0m
[2;36m                    [0m         [39mmodule/src/main/java/org/apache/tika/parser/html/HtmlHandler.java` in the [0m          [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mhandleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m` method:[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Lines [0m[1;36m354[0m[39m-[0m[1;36m384[0m[39m, specifically around line [0m[1;36m373[0m[39m-[0m[1;36m377[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Before calling `[0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[1;39m)[0m[39m`, create a restricted [0m  [2m                [0m
[2;36m                    [0m         [39mParseContext[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Create a `HashSet<Class<? extends Parser>>` containing `ExternalParser.class` and[0m [2m                [0m
[2;36m                    [0m         [39m`CompositeExternalParser.class`[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Create a `ParserFilterConfig` instance with this set[0m                              [2m                [0m
[2;36m                    [0m         [39m- The challenge: `ParsingEmbeddedDocumentExtractor` uses the context stored in its [0m [2m                [0m
[2;36m                    [0m         [39mconstructor, not passed per-call[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Solution: The extractor needs to use the context from EmbeddedDocumentUtil, which[0m [2m                [0m
[2;36m                    [0m         [39mshould respect the parent context[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Approach**:[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- Instead of modifying where parseEmbedded is called, we need to set the [0m           [2m                [0m
[2;36m                    [0m         [39mParserFilterConfig in the context before getting the extractor[0m                      [2m                [0m
[2;36m                    [0m         [39m- The context passed to the parser chain will include this configuration[0m            [2m                [0m
[2;36m                    [0m         [39m- This ensures all parsers in the chain [0m[1;39m([0m[39mincluding CompositeParser[0m[1;39m)[0m[39m will see the [0m   [2m                [0m
[2;36m                    [0m         [39mfilter configuration[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m4[0m[39m. Propagate Context Through ParsingEmbeddedDocumentExtractor[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mModify [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m`tika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor[0m [2m                [0m
[2;36m                    [0m         [39m.java`:[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: Lines [0m[1;36m80[0m[39m-[0m[1;36m118[0m[39m, specifically the `[0m[1;35mparseEmbedded[0m[1;39m([0m[1;39m)[0m[39m` method[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes**:[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- The extractor already has a `context` field from its constructor[0m                  [2m                [0m
[2;36m                    [0m         [39m- When `[0m[1;35mDELEGATING_PARSER.parse[0m[1;39m([0m[1;39m)[0m[39m` is called at line [0m[1;36m101[0m[39m-[0m[1;36m102[0m[39m, it uses this context[0m  [2m                [0m
[2;36m                    [0m         [39m- The context chain should properly propagate from HtmlHandler through to [0m          [2m                [0m
[2;36m                    [0m         [39mCompositeParser[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- No changes needed here if HtmlHandler properly sets up the context before calling[0m [2m                [0m
[2;36m                    [0m         [39mthe extractor[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Verification**:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Ensure the context used contains the ParserFilterConfig[0m                           [2m                [0m
[2;36m                    [0m         [39m- The DELEGATING_PARSER will pass this context to CompositeParser[0m                   [2m                [0m
[2;36m                    [0m         [39m- [0m[1;35mCompositeParser.getParser[0m[1;39m([0m[1;39m)[0m[39m will check the filter and exclude external parsers[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m5[0m[39m. Fix ExternalParser Command Execution [0m[1;39m([0m[39mDefense in Depth[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mModify [0m                                                                             [2m                [0m
[2;36m                    [0m         [39m`tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java`:[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location [0m[1;36m1[0m[39m**: Lines [0m[1;36m158[0m[39m-[0m[1;36m167[0m[39m [0m[1;39m([0m[39mcheck command execution[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m- Replace `[0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m` with `ProcessBuilder`[0m               [2m                [0m
[2;36m                    [0m         [39m- Create `ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m`[0m                         [2m                [0m
[2;36m                    [0m         [39m- Call `process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location [0m[1;36m2[0m[39m**: Lines [0m[1;36m288[0m[39m-[0m[1;36m318[0m[39m [0m[1;39m([0m[39mmain parse execution[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m- Remove the string splitting logic at lines [0m[1;36m290[0m[39m-[0m[1;36m291[0m[39m that does `command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" [0m [2m                [0m
[2;36m                    [0m         [32m"[0m[1;39m)[0m[39m`[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m- Always use array copy: `String[0m[1;39m[[0m[1;39m][0m[39m cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m; [0m               [2m                [0m
[2;36m                    [0m         [1;35mSystem.arraycopy[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`[0m                                                              [2m                [0m
[2;36m                    [0m         [39m- Replace [0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m calls at lines [0m[1;36m311[0m[39m-[0m[1;36m314[0m[39m with ProcessBuilder[0m                 [2m                [0m
[2;36m                    [0m         [39m- Create `ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m`[0m                              [2m                [0m
[2;36m                    [0m         [39m- Set up any needed environment or working directory[0m                                [2m                [0m
[2;36m                    [0m         [39m- Call `process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m`[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Rationale**:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- ProcessBuilder doesn't invoke a shell, preventing shell metacharacter [0m            [2m                [0m
[2;36m                    [0m         [39mexploitation[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- Taking command as array means no string splitting, properly handling spaces and [0m  [2m                [0m
[2;36m                    [0m         [39mspecial characters[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Follows the pattern already used in `external2.ExternalParser` [0m[1;39m([0m[39mlines [0m[1;36m130[0m[39m, [0m[1;36m134[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m- This is defense in depth - even if parser selection fails, command execution is [0m  [2m                [0m
[2;36m                    [0m         [39msafer[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Order[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **First**: Create `ParserFilterConfig.java` - this is the foundation for [0m        [2m                [0m
[2;36m                    [0m         [39mtype-safe filtering[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Second**: Modify `[0m[1;35mCompositeParser.getParser[0m[1;39m([0m[1;39m)[0m[39m` - this implements the filtering[0m [2m                [0m
[2;36m                    [0m         [39mlogic[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Third**: Modify `[0m[1;35mHtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m` - this applies filtering [0m  [2m                [0m
[2;36m                    [0m         [39mto data URI content[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fourth**: Fix `ExternalParser` command execution - defense in depth measure[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Strategy is Optimal[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Type Safety**: Uses a proper configuration class instead of violating [0m            [2m                [0m
[2;36m                    [0m         [39mParseContext API constraints[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Targeted**: Only restricts external parsers for INLINE embedded content from data[0m [2m                [0m
[2;36m                    [0m         [39mURIs, not all parsing operations[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Reuses Existing Infrastructure**: Leverages CompositeParser's existing [0m           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35misExcluded[0m[1;39m([0m[1;39m)[0m[39m` and `[0m[1;35massignableFrom[0m[1;39m([0m[1;39m)[0m[39m` methods[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Follows Established Patterns**: Mirrors `HandlerConfig` and [0m                      [2m                [0m
[2;36m                    [0m         [39m`AutoDetectParserConfig` design patterns[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Defense in Depth**: Combines parser selection blocking with command execution [0m    [2m                [0m
[2;36m                    [0m         [39mhardening[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Backward Compatible**: Doesn't modify public APIs or break existing functionality[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Minimal Changes**: Focuses changes in the parser selection path rather than [0m      [2m                [0m
[2;36m                    [0m         [39mscattered modifications[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Preserving Existing Logic[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- CompositeParser's parser selection logic remains intact; we only add filtering[0m    [2m                [0m
[2;36m                    [0m         [39m- The [0m[1;35misExcluded[0m[1;39m([0m[1;39m)[0m[39m method is already designed for this purpose[0m                      [2m                [0m
[2;36m                    [0m         [39m- HtmlHandler continues to process data URIs normally; we only restrict which [0m      [2m                [0m
[2;36m                    [0m         [39mparsers can process them[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- ParsingEmbeddedDocumentExtractor's flow is unchanged; it respects the context it [0m [2m                [0m
[2;36m                    [0m         [39mreceives[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All other parsing paths [0m[1;39m([0m[39mnon-INLINE content, non-data-URI content[0m[1;39m)[0m[39m are unaffected[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Addressing Evaluation Report Requirements[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Compilation Errors**: Resolved by using ParserFilterConfig instead of storing [0m    [2m                [0m
[2;36m                    [0m         [39mBoolean values with parser class keys[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Security Vulnerability**: Mitigated by preventing external parsers from being [0m    [2m                [0m
[2;36m                    [0m         [39mselected for inline content[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No Harness Modifications**: All changes are in source code, not fuzzing or test [0m  [2m                [0m
[2;36m                    [0m         [39mharnesses[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No External Library Changes**: Only modifies Tika's own code[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Supports Same Fuzzing Logic**: The fuzzing can still test all the same APIs; we [0m  [2m                [0m
[2;36m                    [0m         [39monly restrict internal parser selection[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 09:08:54][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=224643;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=56309;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[01/13/26 09:12:05][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=201741;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=400867;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m[01/13/26 09:12:57][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=683109;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=992093;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.UNCOMPILABLE[1m)[0m                                 [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=889343;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=115345;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 09:12:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.96[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=747500;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=501444;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 09:12:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Started[33m...[0m                                ]8;id=284453;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=130592;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpij1fp3sq[0m                                                 ]8;id=969765;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=262565;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 09:14:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Patching[1m)[0m Took [1;36m75.53[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=289082;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=285217;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Started[33m...[0m                          ]8;id=979644;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=846643;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 09:14:47][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Checking build[1m)[0m Took [1;36m32.70[0m seconds;                ]8;id=84900;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=435417;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Started[33m...[0m                             ]8;id=645378;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=268533;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 09:15:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Running PoV[1m)[0m Took [1;36m12.99[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=829556;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=641129;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Started[33m...[0m                                 ]8;id=462995;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=380575;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m        ]8;id=86652;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=73977;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=739426;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=627082;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 09:15:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.94[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=191650;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=880716;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 09:15:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=306451;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=439022;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 09:15:03][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m1.01[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=338237;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=380662;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m[01/13/26 09:15:04][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Started[33m...[0m                           ]8;id=682183;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=18032;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 09:15:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mtika Setting owner[1m)[0m Took [1;36m0.98[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=519088;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=858534;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=793470;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=826921;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java   [2m                [0m
[2;36m                    [0m         +++ b/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java   [2m                [0m
[2;36m                    [0m         @@ [1;36m-158[0m,[1;36m7[0m +[1;36m158[0m,[1;36m8[0m @@                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  Process process = null;                                                    [2m                [0m
[2;36m                    [0m                  try [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -            process = [1;35mRuntime.getRuntime[0m[1m([0m[1m)[0m[1;35m.exec[0m[1m([0mcheckCmd[1m)[0m;                         [2m                [0m
[2;36m                    [0m         +            ProcessBuilder pb = new [1;35mProcessBuilder[0m[1m([0mcheckCmd[1m)[0m;                      [2m                [0m
[2;36m                    [0m         +            process = [1;35mpb.start[0m[1m([0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m                      Thread stdErrSuckerThread = [1;35mignoreStream[0m[1m([0m[1;35mprocess.getErrorStream[0m[1m([0m[1m)[0m,     [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m                      Thread stdOutSuckerThread = [1;35mignoreStream[0m[1m([0m[1;35mprocess.getInputStream[0m[1m([0m[1m)[0m,     [2m                [0m
[2;36m                    [0m         false[1m)[0m;                                                                             [2m                [0m
[2;36m                    [0m                      [1;35mstdErrSuckerThread.join[0m[1m([0m[1m)[0m;                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-285[0m,[1;36m14[0m +[1;36m286[0m,[1;36m9[0m @@                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  File output = null;                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -        [35m/[0m[35m/[0m Build our command                                                       [2m                [0m
[2;36m                    [0m         -        String[1m[[0m[1m][0m cmd;                                                              [2m                [0m
[2;36m                    [0m         -        if [1m([0mcommand.length == [1;36m1[0m[1m)[0m [1m{[0m                                                 [2m                [0m
[2;36m                    [0m         -            cmd = command[1m[[0m[1;36m0[0m[1m][0m[1;35m.split[0m[1m([0m[32m" "[0m[1m)[0m;                                           [2m                [0m
[2;36m                    [0m         -        [1m}[0m else [1m{[0m                                                                   [2m                [0m
[2;36m                    [0m         -            cmd = new String[1m[[0mcommand.length[1m][0m;                                      [2m                [0m
[2;36m                    [0m         -            [1;35mSystem.arraycopy[0m[1m([0mcommand, [1;36m0[0m, cmd, [1;36m0[0m, command.length[1m)[0m;                  [2m                [0m
[2;36m                    [0m         -        [1m}[0m                                                                          [2m                [0m
[2;36m                    [0m         +        [35m/[0m[35m/[0m Build our command - use command array directly without string splitting [2m                [0m
[2;36m                    [0m         +        String[1m[[0m[1m][0m cmd = new String[1m[[0mcommand.length[1m][0m;                                 [2m                [0m
[2;36m                    [0m         +        [1;35mSystem.arraycopy[0m[1m([0mcommand, [1;36m0[0m, cmd, [1;36m0[0m, command.length[1m)[0m;                      [2m                [0m
[2;36m                    [0m                  for [1m([0mint i = [1;36m0[0m; i [1m<[0m[39m cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [39m                 cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                         [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-305[0m[39m,[0m[1;36m14[0m[39m +[0m[1;36m301[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                               [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Execute using ProcessBuilder to avoid shell injection[0m                   [2m                [0m
[2;36m                    [0m         [39m         Process process = null;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m         try [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [39m-                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [39m-                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m+            process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- [0m                                                                                [2m                [0m
[2;36m                    [0m         [39ma/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html[0m [2m                [0m
[2;36m                    [0m         [39m-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java[0m                  [2m                [0m
[2;36m                    [0m         [39m+++ [0m                                                                                [2m                [0m
[2;36m                    [0m         [39mb/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html[0m [2m                [0m
[2;36m                    [0m         [39m-module/src/main/java/org/apache/tika/parser/html/HtmlHandler.java[0m                  [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-35[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m35[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m import org.xml.sax.SAXException;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m import org.xml.sax.helpers.AttributesImpl;[0m                                         [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+import org.apache.tika.config.TikaConfig;[0m                                          [2m                [0m
[2;36m                    [0m         [39m import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                        [2m                [0m
[2;36m                    [0m         [39m import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                             [2m                [0m
[2;36m                    [0m         [39m import org.apache.tika.io.TikaInputStream;[0m                                         [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-44[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m45[0m[39m,[0m[1;36m8[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m import org.apache.tika.metadata.Property;[0m                                          [2m                [0m
[2;36m                    [0m         [39m import org.apache.tika.metadata.TikaCoreProperties;[0m                                [2m                [0m
[2;36m                    [0m         [39m import org.apache.tika.mime.MediaType;[0m                                             [2m                [0m
[2;36m                    [0m         [39m+import org.apache.tika.mime.MediaTypeRegistry;[0m                                     [2m                [0m
[2;36m                    [0m         [39m+import org.apache.tika.parser.CompositeParser;[0m                                     [2m                [0m
[2;36m                    [0m         [39m import org.apache.tika.parser.ParseContext;[0m                                        [2m                [0m
[2;36m                    [0m         [39m import org.apache.tika.parser.Parser;[0m                                              [2m                [0m
[2;36m                    [0m         [39m import org.apache.tika.parser.external.CompositeExternalParser;[0m                    [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-370[0m[39m,[0m[1;36m8[0m[39m +[0m[1;36m373[0m[39m,[0m[1;36m36[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Create a restricted context that excludes external parsers for data URI[0m [2m                [0m
[2;36m                    [0m         [39msecurity[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m+        ParseContext restrictedContext = new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Get the current parser and create a restricted version[0m                  [2m                [0m
[2;36m                    [0m         [39m+        Parser originalParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39moriginalParser instanceof CompositeParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [39m+            CompositeParser cp = [0m[1;39m([0m[39mCompositeParser[0m[1;39m)[0m[39m originalParser;[0m                 [2m                [0m
[2;36m                    [0m         [39m+            List<Parser> parsers = [0m[1;35mcp.getAllComponentParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m+            MediaTypeRegistry registry = [0m[1;35mcp.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m Exclude external parsers to prevent command injection[0m               [2m                [0m
[2;36m                    [0m         [39m+            Set<Class<? extends Parser>> excludeParsers = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mexcludeParsers.add[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mexcludeParsers.add[0m[1;39m([0m[39mCompositeExternalParser.class[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+            [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+            Parser restrictedParser = new [0m[1;35mCompositeParser[0m[1;39m([0m[39mregistry, parsers, [0m      [2m                [0m
[2;36m                    [0m         [39mexcludeParsers[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mParser.class, restrictedParser[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39moriginalParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mParser.class, originalParser[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[35m/[0m[35m/[0m[39m Copy TikaConfig if present[0m                                              [2m                [0m
[2;36m                    [0m         [39m+        TikaConfig tikaConfig = [0m[1;35mcontext.get[0m[1;39m([0m[39mTikaConfig.class[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m+        if [0m[1;39m([0m[39mtikaConfig != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mTikaConfig.class, tikaConfig[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+        [0m                                                                           [2m                [0m
[2;36m                    [0m         [39m         EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                      [2m                [0m
[2;36m                    [0m         [39m-                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m+                [0m                                                                   [2m                [0m
[2;36m                    [0m         [1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mrestrictedContext[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m         if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [39m             try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                         [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, true[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue is an OS Command Injection vulnerability detected during fuzz [0m    [2m                [0m
[2;36m                    [0m         [39mtesting. The vulnerability manifests when the Apache Tika parser processes HTML [0m    [2m                [0m
[2;36m                    [0m         [39mdocuments containing data URIs, which triggers external parser execution with [0m      [2m                [0m
[2;36m                    [0m         [39mpotentially attacker-controlled data. The patch attempt aims to address this by [0m    [2m                [0m
[2;36m                    [0m         [39mmodifying how external commands are executed and introducing a parser filtering [0m    [2m                [0m
[2;36m                    [0m         [39mmechanism to prevent external parsers from being invoked in unsafe contexts. [0m       [2m                [0m
[2;36m                    [0m         [39mHowever, the patch fails to compile due to missing class definitions for [0m           [2m                [0m
[2;36m                    [0m         [39m`ParserFilterConfig` and related supporting infrastructure.[0m                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue Analysis[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fuzzer detected a critical security vulnerability with the following [0m           [2m                [0m
[2;36m                    [0m         [39mcharacteristics:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Vulnerability Type**: OS Command Injection [0m                                    [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mcom.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Security Impact**: Remote code execution potential through attacker-controlled[0m [2m                [0m
[2;36m                    [0m         [39mdata in OS commands[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Call Stack Path**: The issue originates from HTML parsing and traverses [0m       [2m                [0m
[2;36m                    [0m         [39mthrough multiple layers:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mHtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[1;39m)[0m[39m → [0m[1;35mparseOne[0m[1;39m([0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mAutoDetectParser.parse[0m[1;39m([0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mCompositeParser.parse[0m[1;39m([0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mJSoupParser.parse[0m[1;39m([0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mHtmlHandler.startElement[0m[1;39m([0m[1;39m)[0m[39m → [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mAutoDetectParser.parse[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39msecond invocation for embedded content[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mCompositeParser.parse[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39msecond invocation[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mExternalParser.parse[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mvulnerable point[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - [0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mcommand injection point[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Root Cause Location**: The vulnerability is triggered at [0m                      [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[1;39m)[0m[39m` line [0m[1;36m314[0m[39m, where [0m           [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m` is called with potentially malicious input.[0m                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Attack Vector**: HTML documents with embedded data URIs can trigger parsing of[0m [2m                [0m
[2;36m                    [0m         [39membedded content, which may be routed to external parsers that execute OS commands.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt Description[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch modifies three key files:[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m1[0m[39m. ExternalParser.java Changes[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java`[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Modifications**:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m161[0m[39m-[0m[1;36m162[0m[39m: Changed from `[0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m` to using [0m       [2m                [0m
[2;36m                    [0m         [39mProcessBuilder:[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [39m  process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m289[0m[39m-[0m[1;36m294[0m[39m: Removed string splitting logic for single-element command arrays:[0m  [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m Old code split command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m with [0m[32m" "[0m[39m if command.length == [0m[1;36m1[0m                      [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m New code always uses command array directly without splitting[0m                  [2m                [0m
[2;36m                    [0m         [39m  String[0m[1;39m[[0m[1;39m][0m[39m cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m  [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m304[0m[39m-[0m[1;36m311[0m[39m: Consolidated command execution to always use ProcessBuilder:[0m       [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m Old code had two paths: [0m[1;35mRuntime.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m or [0m[1;35mRuntime.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m              [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m New code uses single path:[0m                                                     [2m                [0m
[2;36m                    [0m         [39m  ProcessBuilder pb = new [0m[1;35mProcessBuilder[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m  process = [0m[1;35mpb.start[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m2[0m[39m. CompositeParser.java Changes[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: `tika-core/src/main/java/org/apache/tika/parser/CompositeParser.java`[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Modifications**:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m102[0m[39m-[0m[1;36m112[0m[39m in [0m[1;35mgetParsers[0m[1;39m([0m[1;39m)[0m[39m method: Added parser filtering logic to check for [0m  [2m                [0m
[2;36m                    [0m         [39mexcluded parsers via `ParserFilterConfig`[0m                                           [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m255[0m[39m-[0m[1;36m277[0m[39m in [0m[1;35mgetParser[0m[1;39m([0m[1;39m)[0m[39m method: Added parser filtering logic to skip [0m        [2m                [0m
[2;36m                    [0m         [39mexcluded parsers when resolving parser for a media type[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Intent**: These changes attempt to implement a mechanism to exclude certain [0m      [2m                [0m
[2;36m                    [0m         [39mparsers [0m[1;39m([0m[39mspecifically ExternalParser[0m[1;39m)[0m[39m from being used in contexts where they might [0m [2m                [0m
[2;36m                    [0m         [39mbe unsafe.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### [0m[1;36m3[0m[39m. HtmlHandler.java Changes[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-[0m [2m                [0m
[2;36m                    [0m         [39mmodule/src/main/java/org/apache/tika/parser/html/HtmlHandler.java`[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Modifications**:[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m378[0m[39m-[0m[1;36m389[0m[39m in [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m method: Added creation of restricted [0m      [2m                [0m
[2;36m                    [0m         [39mParseContext that excludes ExternalParser and CompositeExternalParser:[0m              [2m                [0m
[2;36m                    [0m         [39m  ```java[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m  ParseContext restrictedContext = new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m  [0m[35m/[0m[35m/[0m[39m Copy original parser[0m                                                           [2m                [0m
[2;36m                    [0m         [39m  Set<Class<? extends Parser>> excludedParsers = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;35mexcludedParsers.add[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m  [0m[1;35mexcludedParsers.add[0m[1;39m([0m[39mCompositeExternalParser.class[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [39m  ParserFilterConfig filterConfig = new [0m[1;35mParserFilterConfig[0m[1;39m([0m[39mexcludedParsers[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [39m  [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mParserFilterConfig.class, filterConfig[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m  ```[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m391[0m[39m: Changed to use restrictedContext instead of original context when [0m      [2m                [0m
[2;36m                    [0m         [39mextracting embedded documents.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Compilation Failure Analysis[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe build fails with the following errors:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Missing Class**: `ParserFilterConfig` class is referenced but not defined in [0m  [2m                [0m
[2;36m                    [0m         [39mthe codebase[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Error Locations**: All errors occur in `CompositeParser.java` at lines [0m[1;36m102[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m, [0m[1;36m255[0m[39m, and [0m[1;36m257[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Missing Method**: The patch references `[0m[1;35misExcluded[0m[1;39m([0m[1;39m)[0m[39m` method in [0m               [2m                [0m
[2;36m                    [0m         [39mCompositeParser which is also not defined[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Missing Methods in ParserFilterConfig**: The code expects `[0m[1;35mhasExclusions[0m[1;39m([0m[1;39m)[0m[39m` [0m   [2m                [0m
[2;36m                    [0m         [39mand `[0m[1;35mgetExcludedParsers[0m[1;39m([0m[1;39m)[0m[39m` methods that don't exist[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe compilation failure indicates that the patch is incomplete - it attempts to use[0m [2m                [0m
[2;36m                    [0m         [39minfrastructure [0m[1;39m([0m[39mParserFilterConfig class and supporting methods[0m[1;39m)[0m[39m that hasn't been [0m  [2m                [0m
[2;36m                    [0m         [39mcreated.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Further Investigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo achieve a holistic understanding of the vulnerability and develop a complete [0m    [2m                [0m
[2;36m                    [0m         [39mfix, the following areas should be investigated:[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **ExternalParser Configuration**: How external parsers are configured, which [0m    [2m                [0m
[2;36m                    [0m         [39mcommands they execute, and what inputs are passed to these commands[0m                 [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Command Construction Logic**: The original string splitting logic [0m[1;39m([0m[39mremoved in [0m [2m                [0m
[2;36m                    [0m         [39mthe patch[0m[1;39m)[0m[39m at line [0m[1;36m290[0m[39m - understanding why single-element arrays were split by [0m     [2m                [0m
[2;36m                    [0m         [39mspaces and what legitimate use cases this served[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Parser Selection Mechanism**: How CompositeParser and AutoDetectParser select [0m [2m                [0m
[2;36m                    [0m         [39mparsers for different media types and contexts[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **EmbeddedDocumentExtractor Behavior**: How embedded documents [0m[1;39m([0m[39mincluding data [0m  [2m                [0m
[2;36m                    [0m         [39mURIs[0m[1;39m)[0m[39m are extracted and routed to appropriate parsers[0m                               [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Data URI Handling**: The complete flow of data URI processing in HtmlHandler, [0m [2m                [0m
[2;36m                    [0m         [39mincluding what media types can be embedded and how they are detected[0m                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **ParseContext Usage**: How ParseContext is used throughout the parsing pipeline[0m [2m                [0m
[2;36m                    [0m         [39mand whether there are existing mechanisms for controlling parser selection[0m          [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Security Configuration**: Whether Apache Tika has existing security [0m           [2m                [0m
[2;36m                    [0m         [39mconfiguration mechanisms that could be leveraged or extended[0m                        [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m. **External Parser Dependencies**: What external tools/commands are typically [0m    [2m                [0m
[2;36m                    [0m         [39minvoked by ExternalParser and whether they can be safely disabled or sandboxed[0m      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m== Java Exception: com.code_intelligence.jazzer.api.FuzzerSecurityIssueCritical: OS[0m [2m                [0m
[2;36m                    [0m         [39mCommand Injection[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mExecuting OS commands with attacker-controlled data can lead to remote code [0m        [2m                [0m
[2;36m                    [0m         [39mexecution.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.code_intelligence.jazzer.sanitizers.OsCommandInjection.processImplStartHook[0m[1;39m([0m[39mOsC[0m [2m                [0m
[2;36m                    [0m         [39mommandInjection.jav[0m[1;92ma:63[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1110[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.ProcessBuilder.start[0m[1;39m([0m[39mProcessBuilder.jav[0m[1;92ma:1073[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:594[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat java.base/[0m[1;35mjava.lang.Runtime.exec[0m[1;39m([0m[39mRuntime.jav[0m[1;92ma:453[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:314[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.external.ExternalParser.parse[0m[1;39m([0m[39mExternalParser.jav[0m[1;92ma:274[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.ParserDecorator.parse[0m[1;39m([0m[39mParserDecorator.jav[0m[1;92ma:153[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.DelegatingParser.parse[0m[1;39m([0m[39mDelegatingParser.jav[0m[1;92ma:71[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.extractor.ParsingEmbeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mParsingEmb[0m [2m                [0m
[2;36m                    [0m         [39meddedDocumentExtractor.jav[0m[1;92ma:101[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.handleDataURIScheme[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:377[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.HtmlHandler.startElement[0m[1;39m([0m[39mHtmlHandler.jav[0m[1;92ma:175[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.sax.ContentHandlerDecorator.startElement[0m[1;39m([0m[39mContentHandlerDecorator.ja[0m [2m                [0m
[2;36m                    [0m         [39mv[0m[1;92ma:125[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35morg.apache.tika.parser.html.XHTMLDowngradeHandler.startElement[0m[1;39m([0m[39mXHTMLDowngradeHandle[0m [2m                [0m
[2;36m                    [0m         [39mr.jav[0m[1;92ma:59[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [39morg.apache.tika.parser.html.JSoupParser$[0m[1;35mTikaNodeFilter.head[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:211[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.jsoup.select.NodeTraversor.filter[0m[1;39m([0m[39mNodeTraversor.jav[0m[1;92ma:92[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.html.JSoupParser.parse[0m[1;39m([0m[39mJSoupParser.jav[0m[1;92ma:137[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.CompositeParser.parse[0m[1;39m([0m[39mCompositeParser.jav[0m[1;92ma:298[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35morg.apache.tika.parser.AutoDetectParser.parse[0m[1;39m([0m[39mAutoDetectParser.jav[0m[1;92ma:204[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m[1;35mcom.example.HtmlParserFuzzer.parseOne[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:69[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m        [0m[39mat [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;35mcom.example.HtmlParserFuzzer.fuzzerTestOneInput[0m[1;39m([0m[39mHtmlParserFuzzer.jav[0m[1;92ma:40[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: 3c99eeb1380e104c[0m                                                       [2m                [0m
[2;36m                    [0m         [39m== libFuzzer crashing input ==[0m                                                      [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m COMPILATION ERROR : [0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m                [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m104[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                               [2m                [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m255[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m                [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                               [2m                [0m
[2;36m                    [0m         [39m  symbol:   class ParserFilterConfig[0m                                                [2m                [0m
[2;36m                    [0m         [39m  location: class org.apache.tika.parser.CompositeParser[0m                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m[1;36m4[0m[39m errors [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m -------------------------------------------------------------[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Reactor Summary for Apache Tika parent [0m[1;36m4.0[0m[39m.[0m[1;36m0[0m[39m-SNAPSHOT:[0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parent [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SUCCESS [0m[1;39m[[0m[39m [0m[1;36m15.080[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika core [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. FAILURE [0m[1;39m[[0m[39m  [0m[1;36m4.983[0m[39m s[0m[1;39m][0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika serialization [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules and package [0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser modules [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika ZIP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Apple parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika audiovideo parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika text parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika html parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XML parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika image parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m.. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika OCR parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika mail parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Microsoft parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika cad parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika code parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika crypto parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika digest commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika font parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika miscellaneous office format parser module SKIPPED[0m                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika news parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika PDF parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika package parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika WARC parser module [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika handlers [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m tika-handler-boilerpipe [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika standard parser package [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika XMP [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika language detection [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika langdetect test commons [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Optimaize langdetect [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika pipes [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika emitters [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika filesystem emitter [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika Async CLI [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Apache Tika application [0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[33m...[0m[39m. SKIPPED[0m                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m BUILD FAILURE[0m                                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Total time:  [0m[1;36m28.237[0m[39m s[0m                                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m Finished at: [0m[1;36m2026[0m[39m-[0m[1;36m01[0m[39m-13T[0m[1;92m09:08:17[0m[39mZ[0m                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mINFO[0m[1;39m][0m[39m ------------------------------------------------------------------------[0m     [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Failed to execute goal [0m                                                     [2m                [0m
[2;36m                    [0m         [39morg.apache.maven.plugins:maven-compiler-plugin:[0m[1;36m3.14[0m[39m.[0m[1;92m0:c[0m[39mompile [0m[1;39m([0m[39mdefault-compile[0m[1;39m)[0m[39m on [0m [2m                [0m
[2;36m                    [0m         [39mproject tika-core: Compilation failure: Compilation failure: [0m                       [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m102[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m104[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                               [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m255[0m[39m,[0m[1;36m9[0m[1;39m][0m[39m cannot find symbol[0m                                                [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [35m/src/project-parent/tika/tika-core/src/main/java/org/apache/tika/parser/[0m[95mCompositePa[0m [2m                [0m
[2;36m                    [0m         [95mrser.java[0m[39m:[0m[1;39m[[0m[1;36m257[0m[39m,[0m[1;36m40[0m[1;39m][0m[39m cannot find symbol[0m                                               [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   symbol:   class ParserFilterConfig[0m                                        [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m   location: class org.apache.tika.parser.CompositeParser[0m                    [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m -> [0m[1;39m[[0m[39mHelp [0m[1;36m1[0m[1;39m][0m                                                                 [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m To see the full stack trace of the errors, re-run Maven with the -e switch.[0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m Re-run Maven using the -X switch to enable full debug logging.[0m              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m [0m                                                                            [2m                [0m
[2;36m                    [0m         [1;39m[[0m[39mERROR[0m[1;39m][0m[39m For more information about the errors[0m                                       [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:73[0m[39m-[0m[1;36m123[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers,[0m     [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                           Collection<Class<? extends Parser>> excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        if [0m[1;39m([0m[39mexcludeParsers == null || [0m[1;35mexcludeParsers.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            this.parsers = parsers;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            this.parsers = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            for [0m[1;39m([0m[39mParser p : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35misExcluded[0m[1;39m([0m[39mexcludeParsers, [0m[1;35mp.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    [0m[1;35mthis.parsers.add[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        this.registry = registry;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, parsers, null[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, Parser[0m[33m...[0m[39m parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, [0m[1;35mArrays.asList[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        Map<MediaType, Parser> map = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        for [0m[1;39m([0m[39mParser parser : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            for [0m[1;39m([0m[39mMediaType type : [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;35mmap.put[0m[1;39m([0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m, parser[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        return map;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private boolean [0m[1;35misExcluded[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m             [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                               Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        return [0m[1;35mexcludeParsers.contains[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m || [0m[1;35massignableFrom[0m[1;39m([0m[39mexcludeParsers, p[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private boolean [0m[1;35massignableFrom[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m         [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                                   Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        for [0m[1;39m([0m[39mClass<? extends Parser> e : excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            if [0m[1;39m([0m[1;35me.isAssignableFrom[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                return true;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        return false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/DocumentSelector.jav[0m[1;92ma:30[0m[39m-[0m[1;36m42[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:public interface DocumentSelector [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:     * Checks if a document with the given metadata matches the specified[0m        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * selection criteria.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:     * @param metadata document metadata[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:     * @return <code>true<[0m[35m/[0m[95mcode[0m[39m> if the document matches the selection criteria,[0m [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:     * <code>false<[0m[35m/[0m[95mcode[0m[39m> otherwise[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    boolean [0m[1;35mselect[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:62[0m[39m-[0m[1;36m78[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    public boolean [0m[1;35mshouldParseEmbedded[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        DocumentSelector selector = [0m[1;35mcontext.get[0m[1;39m([0m[39mDocumentSelector.class[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        if [0m[1;39m([0m[39mselector != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:            return [0m[1;35mselector.select[0m[1;39m([0m[39mmetadata[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        FilenameFilter filter = [0m[1;35mcontext.get[0m[1;39m([0m[39mFilenameFilter.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        if [0m[1;39m([0m[39mfilter != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            if [0m[1;39m([0m[39mname != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:                return [0m[1;35mfilter.accept[0m[1;39m([0m[39mABSTRACT_PATH, name[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        return true;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:19[0m[39m-[0m[1;36m60[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static org.apache.tika.sax.XHTMLContentHandler.XHTML;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.FilenameFilter;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.tika.exception.CorruptedFileException;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.tika.exception.EncryptedDocumentException;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.tika.parser.DelegatingParser;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import org.apache.tika.parser.ParseRecord;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.sax.BodyContentHandler;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.sax.EmbeddedContentHandler;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m: * Helper class for parsers of package archives or other compound document[0m       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m: * formats that support embedded or attached component documents.[0m                [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m: * @since Apache Tika [0m[1;36m0.8[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:public class ParsingEmbeddedDocumentExtractor implements [0m                        [2m                [0m
[2;36m                    [0m         [39mEmbeddedDocumentExtractor [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final File ABSTRACT_PATH = new [0m[1;35mFile[0m[1;39m([0m[32m""[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private static final Parser DELEGATING_PARSER = new [0m[1;35mDelegatingParser[0m[1;39m([0m[1;39m)[0m[39m;[0m      [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private boolean writeFileNameToContent = true;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    protected final ParseContext context;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public [0m[1;35mParsingEmbeddedDocumentExtractor[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/ParsingEmbeddedDocumentExtractor.[0m [2m                [0m
[2;36m                    [0m         [39mjav[0m[1;92ma:80[0m[39m-[0m[1;36m118[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    @Override[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    public void [0m[1;35mparseEmbedded[0m[1;39m([0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            TikaInputStream tis, ContentHandler handler, Metadata metadata, [0m     [2m                [0m
[2;36m                    [0m         [39mboolean outputHtml[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            throws SAXException, IOException [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:            AttributesImpl attributes = new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:            [0m[1;35mattributes.addAttribute[0m[1;39m([0m[32m""[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"class"[0m[39m, [0m[32m"CDATA"[0m[39m, [0m              [2m                [0m
[2;36m                    [0m         [32m"package-entry"[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[39m, attributes[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        String name = [0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.RESOURCE_NAME_KEY[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:        if [0m[1;39m([0m[39mwriteFileNameToContent && name != null && [0m[1;35mname.length[0m[1;39m([0m[1;39m)[0m[39m > [0m[1;36m0[0m[39m && [0m      [2m                [0m
[2;36m                    [0m         [39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;35mhandler.startElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[39m, new [0m[1;35mAttributesImpl[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:            char[0m[1;39m[[0m[1;39m][0m[39m chars = [0m[1;35mname.toCharArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:            [0m[1;35mhandler.characters[0m[1;39m([0m[39mchars, [0m[1;36m0[0m[39m, chars.length[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"h1"[0m[39m, [0m[32m"h1"[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[35m/[0m[35m/[0m[39m Use the delegate parser to parse this entry[0m                           [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        try [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:            [0m[1;35mtis.setCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:            [0m[1;35mDELEGATING_PARSER.parse[0m[1;39m([0m[39mtis, new [0m[1;35mEmbeddedContentHandler[0m[1;39m([0m[39mnew [0m        [2m                [0m
[2;36m                    [0m         [1;35mBodyContentHandler[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[1;39m)[0m[39m,[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                    metadata, context[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mEncryptedDocumentException ede[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39mede, context[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mCorruptedFileException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:            [0m[35m/[0m[35m/[0m[95mnecessary[0m[39m to stop the parse to avoid infinite loops[0m               [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            [0m[35m/[0m[35m/[0m[95mon[0m[39m corrupt sqlite3 files[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mTikaException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[1;35mrecordException[0m[1;39m([0m[39me, context[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[1;35mtis.removeCloseShield[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:        if [0m[1;39m([0m[39moutputHtml[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:            [0m[1;35mhandler.endElement[0m[1;39m([0m[39mXHTML, [0m[32m"div"[0m[39m, [0m[32m"div"[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/EmbeddedDocumentUtil.jav[0m[1;92ma:52[0m[39m-[0m[1;36m97[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:public class EmbeddedDocumentUtil implements Serializable [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    private final ParseContext context;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private final EmbeddedDocumentExtractor embeddedDocumentExtractor;[0m           [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[35m/[0m[35m/[0m[95mthese[0m[39m are lazily initialized and can be null[0m                               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    private TikaConfig tikaConfig;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    private MimeTypes mimeTypes;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private Detector detector;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    public [0m[1;35mEmbeddedDocumentUtil[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        this.context = context;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        this.embeddedDocumentExtractor = [0m[1;35mgetEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m  [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * This offers a uniform way to get an EmbeddedDocumentExtractor from a [0m     [2m                [0m
[2;36m                    [0m         [39mParseContext.[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * As of Tika [0m[1;36m1.15[0m[39m, an AutoDetectParser will automatically be added to parse[0m [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * embedded documents if no Parser.class is specified in the ParseContext.[0m   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * <p/>[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * If you'd prefer not to parse embedded documents, set Parser.class[0m         [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     * to [0m[1;39m{[0m[39m@link org.apache.tika.parser.EmptyParser[0m[1;39m}[0m[39m in the ParseContext.[0m        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param context[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @return EmbeddedDocumentExtractor[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    public static EmbeddedDocumentExtractor [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mgetEmbeddedDocumentExtractor[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        EmbeddedDocumentExtractor extractor = [0m                                   [2m                [0m
[2;36m                    [0m         [1;35mcontext.get[0m[1;39m([0m[39mEmbeddedDocumentExtractor.class[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        if [0m[1;39m([0m[39mextractor != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            return extractor;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[95mensure[0m[39m that an AutoDetectParser is[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[35m/[0m[35m/[0m[95mavailable[0m[39m for parsing embedded docs TIKA-[0m[1;36m2096[0m                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        Parser embeddedParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        if [0m[1;39m([0m[39membeddedParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            TikaConfig tikaConfig = [0m[1;35mcontext.get[0m[1;39m([0m[39mTikaConfig.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            if [0m[1;39m([0m[39mtikaConfig == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;35mcontext.set[0m[1;39m([0m[39mParser.class, new [0m[1;35mAutoDetectParser[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                [0m[1;35mcontext.set[0m[1;39m([0m[39mParser.class, new [0m[1;35mAutoDetectParser[0m[1;39m([0m[39mtikaConfig[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        EmbeddedDocumentExtractor ex = new [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mParsingEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mcontext.set[0m[1;39m([0m[39mEmbeddedDocumentExtractor.class, ex[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        return ex;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/DelegatingParser.jav[0m[1;92ma:19[0m[39m-[0m[1;36m74[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * Base class for parser implementations that want to delegate parts of the[0m      [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: * task of parsing an input document to another parser. The delegate parser[0m      [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m: * is looked up from the parsing context using the [0m[1;39m{[0m[39m@link Parser[0m[1;39m}[0m[39m class as[0m       [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m: * the key.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m: * @since Apache Tika [0m[1;36m0.4[0m[39m, major changes in Tika [0m[1;36m0.5[0m                             [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:public class DelegatingParser implements Parser [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:     * Returns the parser instance to which parsing tasks should be delegated.[0m   [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * The default implementation looks up the delegate parser from the given[0m    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * parse context, and uses an [0m[1;39m{[0m[39m@link EmptyParser[0m[1;39m}[0m[39m instance as a fallback.[0m    [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Subclasses can override this method to implement alternative delegation[0m   [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * strategies.[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param context parse context[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @return delegate parser[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * @since Apache Tika [0m[1;36m0.7[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    protected Parser [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        return [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class, EmptyParser.INSTANCE[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:    public Set<MediaType> [0m[1;35mgetSupportedTypes[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;35m.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Looks up the delegate parser from the parsing context and[0m                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * delegates the parse operation to it. If a delegate parser is not[0m          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * found, then an empty XHTML document is returned.[0m                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * <p>[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * Subclasses should override this method to parse the top level[0m             [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * structure of the given document stream. Parsed sub-streams can[0m            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * be passed to this base class method to be parsed by the configured[0m        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     * delegate parser.[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m      [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws SAXException, IOException, [0m   [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mgetDelegateParser[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;35m.parse[0m[1;39m([0m[39mstream, handler, metadata, context[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:1[0m[39m-[0m[1;36m100[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.external;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import static java.nio.charset.StandardCharsets.UTF_8;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.BufferedReader;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.File;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.FileInputStream;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.io.InputStreamReader;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.io.OutputStream;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.io.Reader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.io.Serializable;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import java.util.concurrent.TimeUnit;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import java.util.concurrent.TimeoutException;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.commons.io.IOUtils;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.commons.io.output.NullOutputStream;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.slf4j.Logger;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.slf4j.LoggerFactory;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.io.TemporaryResources;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:import org.apache.tika.sax.XHTMLContentHandler;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m: * Parser that uses an external program [0m[1;39m([0m[39mlike catdoc or pdf2txt[0m[1;39m)[0m[39m to extract[0m      [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m: * text content and metadata from a given document.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:public class ExternalParser implements Parser [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final Logger LOG = [0m                                           [2m                [0m
[2;36m                    [0m         [1;35mLoggerFactory.getLogger[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * be replaced with the input filename.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     * Alternately, the input data can be streamed over STDIN.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    public static final String IN[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mIN[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     * The token, which if present in the Command string, will[0m                   [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * be replaced with the output filename.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * Alternately, the output data can be collected on STDOUT.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public static final String OUT[0m[1;33mPUT[0m[39m_FILE_TOKEN = [0m[32m"$[0m[32m{[0m[32mOUT[0m[1;33mPUT[0m[32m}[0m[32m"[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    private static final long serialVersionUID = -1079128990650687037L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[35m/[0m[35m/[0m[95mmake[0m[39m this parameterizable[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    private final long timeoutMs = [0m[1;36m60000[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * Media types supported by the external program.[0m                            [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private Set<MediaType> supportedTypes = [0m[1;35mCollections.emptySet[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:     * Regular Expressions to run over STDOUT to[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * extract Metadata.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private Map<Pattern, String> metadataPatterns = null;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * The external command to invoke.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @see Runtime#[0m[1;35mexec[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    private String[0m[1;39m[[0m[1;39m][0m[39m command = new String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[32m"cat"[0m[1;39m}[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:     * A consumer for ignored Lines[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    private LineConsumer ignoredLineConsumer = LineConsumer.NULL;[0m                [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * Starts a thread that reads and discards the contents of the[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:150[0m[39m-[0m[1;36m180[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m           [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:        return [0m[1;35mcheck[0m[1;39m([0m[39mnew String[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[39mcheckCmd[0m[1;39m}[0m[39m, errorValue[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:    public static boolean [0m[1;35mcheck[0m[1;39m([0m[39mString[0m[1;39m[[0m[1;39m][0m[39m checkCmd, int[0m[33m...[0m[39m errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:        if [0m[1;39m([0m[39merrorValue.length == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            errorValue = new int[0m[1;39m[[0m[1;39m][0m[1;39m{[0m[1;36m127[0m[1;39m}[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:            process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcheckCmd[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            Thread stdErrSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getErrorStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            Thread stdOutSuckerThread = [0m[1;35mignoreStream[0m[1;39m([0m[1;35mprocess.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m [2m                [0m
[2;36m                    [0m         [39mfalse[0m[1;39m)[0m[39m;[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;35mstdErrSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:            [0m[1;35mstdOutSuckerThread.join[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:            [0m[35m/[0m[35m/[0m[95mmake[0m[39m the timeout parameterizable[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:            boolean finished = [0m[1;35mprocess.waitFor[0m[1;39m([0m[1;36m60000[0m[39m, TimeUnit.MILLISECONDS[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:            if [0m[1;39m([0m[39m!finished[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                throw new [0m[1;35mTimeoutException[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:            int result = [0m[1;35mprocess.exitValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exit value for [0m[32m{[0m[32m}[0m[32m: [0m[32m{[0m[32m}[0m[32m"[0m[39m, checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, result[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            for [0m[1;39m([0m[39mint err : errorValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:                if [0m[1;39m([0m[39mresult == err[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                    return false;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:            return true;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException | InterruptedException | TimeoutException e[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            [0m[1;35mLOG.debug[0m[1;39m([0m[32m"exception trying to run  "[0m[39m + checkCmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m, e[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/AutoDetectParser.jav[0m[1;92ma:100[0m[39m-[0m[1;36m127[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    private static Parser [0m[1;35mbuildFallbackParser[0m[1;39m([0m[39mTikaConfig config[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        Parser fallback = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        Parser p = [0m[1;35mconfig.getParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        if [0m[1;39m([0m[39mp instanceof DefaultParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            fallback = [0m[1;39m([0m[1;39m([0m[39mDefaultParser[0m[1;39m)[0m[39mp[0m[1;39m)[0m[1;35m.getFallback[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            fallback = new [0m[1;35mEmptyParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:        if [0m[1;39m([0m[1;35mconfig.getAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[1;35m.getDigesterFactory[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            return fallback;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            return new [0m[1;35mDigestingParser[0m[1;39m([0m[39mfallback,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:                    [0m                                                            [2m                [0m
[2;36m                    [0m         [1;35mconfig.getAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[1;35m.getDigesterFactory[0m[1;39m([0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[39m,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                    [0m                                                            [2m                [0m
[2;36m                    [0m         [1;35mconfig.getAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[1;35m.getDigesterFactory[0m[1;39m([0m[1;39m)[0m[1;35m.isSkipContainerDocument[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:    private static Parser [0m[1;35mgetParser[0m[1;39m([0m[39mTikaConfig config[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        if [0m[1;39m([0m[1;35mconfig.getAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[1;35m.getDigesterFactory[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:            return [0m[1;35mconfig.getParser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:        return new [0m[1;35mDigestingParser[0m[1;39m([0m[1;35mconfig.getParser[0m[1;39m([0m[1;39m)[0m[39m,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mconfig.getAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[1;35m.getDigesterFactory[0m[1;39m([0m[1;39m)[0m[1;35m.build[0m[1;39m([0m[1;39m)[0m[39m,[0m                    [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:                [0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mconfig.getAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[1;35m.getDigesterFactory[0m[1;39m([0m[1;39m)[0m[1;35m.isSkipContainerDocument[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/AutoDetectParser.jav[0m[1;92ma:166[0m[39m-[0m[1;36m213[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:        if [0m[1;39m([0m[1;35mautoDetectParserConfig.getMetadataWriteFilterFactory[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:            [0m[1;35mmetadata.setMetadataWriteFilter[0m[1;39m([0m                                    [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                    [0m                                                            [2m                [0m
[2;36m                    [0m         [1;35mautoDetectParserConfig.getMetadataWriteFilterFactory[0m[1;39m([0m[1;39m)[0m[1;35m.newInstance[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:        TemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            TikaInputStream tis = [0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, metadata[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:            [0m[35m/[0m[35m/[0m[95mfigure[0m[39m out if we should spool to disk[0m                             [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            [0m[1;35mmaybeSpool[0m[1;39m([0m[39mtis, autoDetectParserConfig, metadata[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:            [0m[35m/[0m[35m/[0m[39m Automatically detect the MIME type of the document[0m               [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:            MediaType type = [0m[1;35mdetector.detect[0m[1;39m([0m[39mtis, metadata[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:            [0m[35m/[0m[35m/[0m[95mupdate[0m[39m CONTENT_TYPE as long as it wasn't set by parser override[0m   [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:            if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE[0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39m== null ||[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:                    [0m                                                            [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.CONTENT_TYPE_PARSER_OVERRIDE[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:                            [0m[1;35m.equals[0m[1;39m([0m[1;35mtype.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                         [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:                [0m[1;35mmetadata.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m[1;35mtype.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            [0m[35m/[0m[35m/[0m[95mcheck[0m[39m for zero-byte inputstream[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            if [0m[1;39m([0m[1;35mtis.getOpenContainer[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:                if [0m[1;39m([0m[1;35mautoDetectParserConfig.getThrowOnZeroBytes[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                    [0m[1;35mtis.mark[0m[1;39m([0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:                    if [0m[1;39m([0m[1;35mtis.read[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m-1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                        throw new [0m[1;35mZeroByteFileException[0m[1;39m([0m[32m"InputStream must have [0m [2m                [0m
[2;36m                    [0m         [32m> 0 bytes"[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                    [0m[1;35mtis.reset[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            handler = [0m[1;35mdecorateHandler[0m[1;39m([0m[39mhandler, metadata, context, [0m              [2m                [0m
[2;36m                    [0m         [39mautoDetectParserConfig[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            [0m[35m/[0m[35m/[0m[39m TIKA-[0m[1;36m216[0m[39m: Zip bomb prevention[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            SecureContentHandler sch = handler != null ?[0m                        [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:                    [0m[1;35mcreateSecureContentHandler[0m[1;39m([0m[39mhandler, tis, [0m                   [2m                [0m
[2;36m                    [0m         [39mautoDetectParserConfig[0m[1;39m)[0m[39m : null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;35minitializeEmbeddedDocumentExtractor[0m[1;39m([0m[39mmetadata, context[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            try [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:                [0m[35m/[0m[35m/[0m[39m Parse the document[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                [0m[1;35msuper.parse[0m[1;39m([0m[39mtis, sch, metadata, context[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mSAXException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:                [0m[35m/[0m[35m/[0m[39m Convert zip bomb exceptions to TikaExceptions[0m                [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:                [0m[1;35msch.throwIfCauseOf[0m[1;39m([0m[39me[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:                throw e;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mtmp.dispose[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.jav[0m[1;92ma:268[0m[39m-[0m[1;36m320[0m [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m268[0m[39m:    public void [0m[1;35mparse[0m[1;39m([0m[39mInputStream stream, ContentHandler handler, Metadata [0m     [2m                [0m
[2;36m                    [0m         [39mmetadata,[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m269[0m[39m:                      ParseContext context[0m[1;39m)[0m[39m throws IOException, SAXException, [0m  [2m                [0m
[2;36m                    [0m         [39mTikaException [0m[1;39m{[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m270[0m[39m:        XHTMLContentHandler xhtml = new [0m[1;35mXHTMLContentHandler[0m[1;39m([0m[39mhandler, metadata[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m271[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m272[0m[39m:        TemporaryResources tmp = new [0m[1;35mTemporaryResources[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:            [0m[1;35mparse[0m[1;39m([0m[1;35mTikaInputStream.get[0m[1;39m([0m[39mstream, tmp, metadata[0m[1;39m)[0m[39m, xhtml, metadata, [0m [2m                [0m
[2;36m                    [0m         [39mtmp[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m276[0m[39m:            [0m[1;35mtmp.dispose[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m277[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m278[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m279[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m280[0m[39m:    private void [0m[1;35mparse[0m[1;39m([0m[39mTikaInputStream stream, XHTMLContentHandler xhtml, [0m      [2m                [0m
[2;36m                    [0m         [39mMetadata metadata,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m281[0m[39m:                       TemporaryResources tmp[0m[1;39m)[0m[39m throws IOException, [0m             [2m                [0m
[2;36m                    [0m         [39mSAXException, TikaException [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m282[0m[39m:        boolean inputToStdIn = true;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m283[0m[39m:        boolean outputFromStdOut = true;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m284[0m[39m:        boolean hasPatterns = [0m[1;39m([0m[39mmetadataPatterns != null && [0m                     [2m                [0m
[2;36m                    [0m         [39m![0m[1;35mmetadataPatterns.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m285[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m286[0m[39m:        File output = null;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m287[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m288[0m[39m:        [0m[35m/[0m[35m/[0m[39m Build our command[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m289[0m[39m:        String[0m[1;39m[[0m[1;39m][0m[39m cmd;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m290[0m[39m:        if [0m[1;39m([0m[39mcommand.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m291[0m[39m:            cmd = command[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;35m.split[0m[1;39m([0m[32m" "[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:            cmd = new String[0m[1;39m[[0m[39mcommand.length[0m[1;39m][0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:            [0m[1;35mSystem.arraycopy[0m[1;39m([0m[39mcommand, [0m[1;36m0[0m[39m, cmd, [0m[1;36m0[0m[39m, command.length[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < cmd.length; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mIN[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m                      [2m                [0m
[2;36m                    [0m         [1;35mstream.getFile[0m[1;39m([0m[1;39m)[0m[1;35m.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:                inputToStdIn = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:            if [0m[1;39m([0m[39mcmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.contains[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:                output = [0m[1;35mtmp.createTemporaryFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:                outputFromStdOut = false;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:                cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m = cmd[0m[1;39m[[0m[39mi[0m[1;39m][0m[1;35m.replace[0m[1;39m([0m[39mOUT[0m[1;33mPUT[0m[39m_FILE_TOKEN, [0m[1;35moutput.getPath[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:        [0m[35m/[0m[35m/[0m[39m Execute[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:        Process process = null;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:            if [0m[1;39m([0m[39mcmd.length == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                process = [0m[1;35mRuntime.getRuntime[0m[1;39m([0m[1;39m)[0m[1;35m.exec[0m[1;39m([0m[39mcmd[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:            [0m[1;35mLOG.warn[0m[1;39m([0m[32m"problem with process exec"[0m[39m, e[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/AutoDetectParser.jav[0m[1;92ma:40[0m[39m-[0m[1;36m100[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.sax.SecureContentHandler;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:public class AutoDetectParser extends CompositeParser [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    private static final long serialVersionUID = 6110455808615143122L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[35m/[0m[95mprivate[0m[39m final TikaConfig config;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:     * The type detector used by this parser to auto-detect the type[0m             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * of a document.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private Detector detector; [0m[35m/[0m[35m/[0m[39m always set in the constructor[0m                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Configuration used when initializing a SecureContentHandler[0m               [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * and the TikaInputStream.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private AutoDetectParserConfig autoDetectParserConfig;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * Creates an auto-detecting parser instance using the default Tika[0m          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * configuration.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public [0m[1;35mAutoDetectParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mTikaConfig.getDefaultConfig[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    public [0m[1;35mAutoDetectParser[0m[1;39m([0m[39mDetector detector[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mTikaConfig.getDefaultConfig[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;35msetDetector[0m[1;39m([0m[39mdetector[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * Creates an auto-detecting parser instance using the specified set of [0m     [2m                [0m
[2;36m                    [0m         [39mparser.[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * This allows one to create a Tika configuration where only a subset of the[0m [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * available parsers have their 3rd party jars included, as otherwise the[0m    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * use of the default TikaConfig will throw various [0m[32m"ClassNotFound"[0m[39m [0m         [2m                [0m
[2;36m                    [0m         [39mexceptions.[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * @param parsers[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    public [0m[1;35mAutoDetectParser[0m[1;39m([0m[39mParser[0m[33m...[0m[39m parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mDefaultDetector[0m[1;39m([0m[1;39m)[0m[39m, parsers[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    public [0m[1;35mAutoDetectParser[0m[1;39m([0m[39mDetector detector, Parser[0m[33m...[0m[39m parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[1;35mMediaTypeRegistry.getDefaultRegistry[0m[1;39m([0m[1;39m)[0m[39m, parsers[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35msetDetector[0m[1;39m([0m[39mdetector[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:        [0m[1;35msetAutoDetectParserConfig[0m[1;39m([0m[39mAutoDetectParserConfig.DEFAULT[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public [0m[1;35mAutoDetectParser[0m[1;39m([0m[39mTikaConfig config[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[1;35mconfig.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mgetParser[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35msetFallback[0m[1;39m([0m[1;35mbuildFallbackParser[0m[1;39m([0m[39mconfig[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;35msetDetector[0m[1;39m([0m[1;35mconfig.getDetector[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        [0m[1;35msetAutoDetectParserConfig[0m[1;39m([0m[1;35mconfig.getAutoDetectParserConfig[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/DefaultParser.jav[0m[1;92ma:41[0m[39m-[0m[1;36m88[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:public class DefaultParser extends CompositeParser [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Serial version UID[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final long serialVersionUID = 3612324825403757520L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    private transient final ServiceLoader loader;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    public [0m[1;35mDefaultParser[0m[1;39m([0m[39mMediaTypeRegistry registry, ServiceLoader loader,[0m       [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:                         Collection<Class<? extends Parser>> excludeParsers,[0m     [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                         EncodingDetector encodingDetector, Renderer renderer[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mregistry, [0m[1;35mgetDefaultParsers[0m[1;39m([0m[39mloader, encodingDetector, renderer, [0m   [2m                [0m
[2;36m                    [0m         [39mexcludeParsers[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        this.loader = loader;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    public [0m[1;35mDefaultParser[0m[1;39m([0m[39mMediaTypeRegistry registry, ServiceLoader loader,[0m       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                         Collection<Class<? extends Parser>> excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mregistry,[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:                [0m[1;35mgetDefaultParsers[0m[1;39m([0m[39mloader, new [0m[1;35mDefaultEncodingDetector[0m[1;39m([0m[39mloader[0m[1;39m)[0m[39m,[0m   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:                        new [0m[1;35mCompositeRenderer[0m[1;39m([0m[39mloader[0m[1;39m)[0m[39m, excludeParsers[0m[1;39m)[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        this.loader = loader;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    public [0m[1;35mDefaultParser[0m[1;39m([0m[39mMediaTypeRegistry registry, ServiceLoader loader,[0m       [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:                         EncodingDetector encodingDetector, Renderer renderer[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, loader, Collections.EMPTY_SET, encodingDetector, [0m         [2m                [0m
[2;36m                    [0m         [39mrenderer[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:    public [0m[1;35mDefaultParser[0m[1;39m([0m[39mMediaTypeRegistry registry, ServiceLoader loader[0m[1;39m)[0m[39m [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, loader, Collections.EMPTY_SET, new [0m                       [2m                [0m
[2;36m                    [0m         [1;35mDefaultEncodingDetector[0m[1;39m([0m[39mloader[0m[1;39m)[0m[39m,[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:                new [0m[1;35mCompositeRenderer[0m[1;39m([0m[39mloader[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    public [0m[1;35mDefaultParser[0m[1;39m([0m[39mMediaTypeRegistry registry, ClassLoader loader[0m[1;39m)[0m[39m [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, new [0m[1;35mServiceLoader[0m[1;39m([0m[39mloader[0m[1;39m)[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    public [0m[1;35mDefaultParser[0m[1;39m([0m[39mClassLoader loader[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mMediaTypeRegistry.getDefaultRegistry[0m[1;39m([0m[1;39m)[0m[39m, new [0m[1;35mServiceLoader[0m[1;39m([0m[39mloader[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    public [0m[1;35mDefaultParser[0m[1;39m([0m[39mMediaTypeRegistry registry[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, new [0m[1;35mServiceLoader[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    public [0m[1;35mDefaultParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mMediaTypeRegistry.getDefaultRegistry[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m384[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:73[0m[39m-[0m[1;36m123[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers,[0m     [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:                           Collection<Class<? extends Parser>> excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        if [0m[1;39m([0m[39mexcludeParsers == null || [0m[1;35mexcludeParsers.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:            this.parsers = parsers;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:            this.parsers = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:            for [0m[1;39m([0m[39mParser p : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35misExcluded[0m[1;39m([0m[39mexcludeParsers, [0m[1;35mp.getClass[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:                    [0m[1;35mthis.parsers.add[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:                [0m[1;39m}[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        this.registry = registry;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, parsers, null[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, Parser[0m[33m...[0m[39m parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mregistry, [0m[1;35mArrays.asList[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    public [0m[1;35mCompositeParser[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        Map<MediaType, Parser> map = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        for [0m[1;39m([0m[39mParser parser : parsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:            for [0m[1;39m([0m[39mMediaType type : [0m[1;35mparser.getSupportedTypes[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m          [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:                [0m[1;35mmap.put[0m[1;39m([0m[1;35mregistry.normalize[0m[1;39m([0m[39mtype[0m[1;39m)[0m[39m, parser[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:        return map;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    private boolean [0m[1;35misExcluded[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m             [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:                               Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                     [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:        return [0m[1;35mexcludeParsers.contains[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m || [0m[1;35massignableFrom[0m[1;39m([0m[39mexcludeParsers, p[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    private boolean [0m[1;35massignableFrom[0m[1;39m([0m[39mCollection<Class<? extends Parser>> [0m         [2m                [0m
[2;36m                    [0m         [39mexcludeParsers,[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                                   Class<? extends Parser> p[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        for [0m[1;39m([0m[39mClass<? extends Parser> e : excludeParsers[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            if [0m[1;39m([0m[1;35me.isAssignableFrom[0m[1;39m([0m[39mp[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                return true;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:        return false;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/config/TikaConfig.jav[0m[1;92ma:1001[0m[39m-[0m[1;36m1010[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:                    if [0m[1;39m([0m[1;35mchildParsers.size[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m1[0m[39m && [0m[1;35mexcludeParsers.isEmpty[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39m&&[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1002[0m[39m:                            [0m[1;35mchildParsers.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m instanceof CompositeParser[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m1003[0m[39m:                        cp = [0m[1;39m([0m[39mCompositeParser[0m[1;39m)[0m[39m [0m[1;35mchildParsers.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1004[0m[39m:                    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1005[0m[39m:                        cp = new [0m[1;35mCompositeParser[0m[1;39m([0m[39mregistry, childParsers, [0m      [2m                [0m
[2;36m                    [0m         [39mexcludeParsers[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:                    [0m[1;39m}[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:                    c = [0m[1;35mparserClass.getConstructor[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:                    parser = [0m[1;35mc.newInstance[0m[1;39m([0m[39mcp[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNoSuchMethodException me[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:                    [0m[35m/[0m[35m/[0m[95mswallow[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:1[0m[39m-[0m[1;36m50[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.html;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.net.MalformedURLException;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.metadata.HTML;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.Office;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.parser.external.CompositeExternalParser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/external/CompositeExternalParser.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:1[0m[39m-[0m[1;36m44[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.external;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import org.apache.tika.exception.TikaException;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.tika.mime.MediaTypeRegistry;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.tika.parser.CompositeParser;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:[0m[35m/[0m[39m**[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m: * A Composite Parser that wraps up all the available External Parsers,[0m          [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m: * and provides an easy way to access them.[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m: * Parser that uses an external program [0m[1;39m([0m[39mlike catdoc or pdf2txt[0m[1;39m)[0m[39m to extract[0m      [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m: * text content and metadata from a given document.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:public class CompositeExternalParser extends CompositeParser [0m[1;39m{[0m                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    private static final long serialVersionUID = 6962436916649024024L;[0m           [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    public [0m[1;35mCompositeExternalParser[0m[1;39m([0m[1;39m)[0m[39m throws IOException, TikaException [0m[1;39m{[0m         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[39mnew [0m[1;35mMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    public [0m[1;35mCompositeExternalParser[0m[1;39m([0m[39mMediaTypeRegistry registry[0m[1;39m)[0m[39m throws [0m           [2m                [0m
[2;36m                    [0m         [39mIOException, TikaException [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:        [0m[1;35msuper[0m[1;39m([0m[39mregistry, [0m[1;39m([0m[39mList<Parser>[0m[1;39m)[0m[39m [0m[1;39m([0m[39mList<? extends Parser>[0m[1;39m)[0m[39m [0m                 [2m                [0m
[2;36m                    [0m         [1;35mExternalParsersFactory.create[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m[1;39m}[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/extractor/EmbeddedDocumentUtil.jav[0m[1;92ma:78[0m[39m-[0m[1;36m97[0m   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    public static EmbeddedDocumentExtractor [0m                                     [2m                [0m
[2;36m                    [0m         [1;35mgetEmbeddedDocumentExtractor[0m[1;39m([0m[39mParseContext context[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:        EmbeddedDocumentExtractor extractor = [0m                                   [2m                [0m
[2;36m                    [0m         [1;35mcontext.get[0m[1;39m([0m[39mEmbeddedDocumentExtractor.class[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        if [0m[1;39m([0m[39mextractor != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:            return extractor;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[35m/[0m[35m/[0m[95mensure[0m[39m that an AutoDetectParser is[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        [0m[35m/[0m[35m/[0m[95mavailable[0m[39m for parsing embedded docs TIKA-[0m[1;36m2096[0m                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        Parser embeddedParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:        if [0m[1;39m([0m[39membeddedParser == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:            TikaConfig tikaConfig = [0m[1;35mcontext.get[0m[1;39m([0m[39mTikaConfig.class[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:            if [0m[1;39m([0m[39mtikaConfig == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:                [0m[1;35mcontext.set[0m[1;39m([0m[39mParser.class, new [0m[1;35mAutoDetectParser[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:                [0m[1;35mcontext.set[0m[1;39m([0m[39mParser.class, new [0m[1;35mAutoDetectParser[0m[1;39m([0m[39mtikaConfig[0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:            [0m[1;39m}[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:        EmbeddedDocumentExtractor ex = new [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mParsingEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mcontext.set[0m[1;39m([0m[39mEmbeddedDocumentExtractor.class, ex[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        return ex;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/config/TikaConfig.jav[0m[1;92ma:1001[0m[39m-[0m[1;36m1010[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:                    if [0m[1;39m([0m[1;35mchildParsers.size[0m[1;39m([0m[1;39m)[0m[39m == [0m[1;36m1[0m[39m && [0m[1;35mexcludeParsers.isEmpty[0m[1;39m([0m[1;39m)[0m[39m [0m  [2m                [0m
[2;36m                    [0m         [39m&&[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1002[0m[39m:                            [0m[1;35mchildParsers.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m instanceof CompositeParser[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m1003[0m[39m:                        cp = [0m[1;39m([0m[39mCompositeParser[0m[1;39m)[0m[39m [0m[1;35mchildParsers.get[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1004[0m[39m:                    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1005[0m[39m:                        cp = new [0m[1;35mCompositeParser[0m[1;39m([0m[39mregistry, childParsers, [0m      [2m                [0m
[2;36m                    [0m         [39mexcludeParsers[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1006[0m[39m:                    [0m[1;39m}[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1007[0m[39m:                    c = [0m[1;35mparserClass.getConstructor[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m1008[0m[39m:                    parser = [0m[1;35mc.newInstance[0m[1;39m([0m[39mcp[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1009[0m[39m:                [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mNoSuchMethodException me[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1010[0m[39m:                    [0m[35m/[0m[35m/[0m[95mswallow[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/test/java/org/apache/tika/parser/CompositeParserTest.jav[0m[1;92ma:101[0m[39m-[0m[1;36m106[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        CompositeParser canonical =[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:                new [0m[1;35mCompositeParser[0m[1;39m([0m[1;35mconfig.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m, [0m             [2m                [0m
[2;36m                    [0m         [39mbmpCanonicalParser[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        CompositeParser alias = new [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mCompositeParser[0m[1;39m([0m[1;35mconfig.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m, bmpAliasParser[0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        CompositeParser both =[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:                new [0m[1;35mCompositeParser[0m[1;39m([0m[1;35mconfig.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m, [0m             [2m                [0m
[2;36m                    [0m         [39mbmpCanonicalParser,[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:                        bmpAliasParser[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-pdf-mo[0m [2m                [0m
[2;36m                    [0m         [39mdule/src/test/java/org/apache/tika/parser/pdf/PDFParserTest.jav[0m[1;92ma:1381[0m[39m-[0m[1;36m1391[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1381[0m[39m:    private static class AvoidInlineSelector implements DocumentSelector [0m[1;39m{[0m     [2m                [0m
[2;36m                    [0m         [1;36m1382[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1383[0m[39m:        @Override[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1384[0m[39m:        public boolean [0m[1;35mselect[0m[1;39m([0m[39mMetadata metadata[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1385[0m[39m:            String v = [0m                                                        [2m                [0m
[2;36m                    [0m         [1;35mmetadata.get[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1386[0m[39m:            if [0m[1;39m([0m[39mv != null && [0m                                                  [2m                [0m
[2;36m                    [0m         [1;35mv.equals[0m[1;39m([0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m1387[0m[39m:                return false;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1388[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1389[0m[39m:            return true;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1390[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1391[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/ParseContext.jav[0m[1;92ma:31[0m[39m-[0m[1;36m86[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:public class ParseContext implements Serializable [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:     * Serial version UID.[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    private static final long serialVersionUID = -5921436862145826534L;[0m          [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:     * Map of objects in this context[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    private final Map<String, Object> context = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * Adds the given value to the context as an implementation of the given[0m     [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     * interface.[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:     * @param key   the interface implemented by the given value[0m                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * @param value the value to be added, or <code>null<[0m[35m/[0m[95mcode[0m[39m> to remove[0m        [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    public <T> void [0m[1;35mset[0m[1;39m([0m[39mClass<T> key, T value[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:            [0m[1;35mcontext.put[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[39m, value[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:            [0m[1;35mcontext.remove[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * Returns the object in this context that implements the given interface.[0m   [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     * @param key the interface implemented by the requested object[0m              [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * or <code>null<[0m[35m/[0m[95mcode[0m[39m> if not found[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    @[0m[1;35mSuppressWarnings[0m[1;39m([0m[32m"unchecked"[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        return [0m[1;39m([0m[39mT[0m[1;39m)[0m[39m [0m[1;35mcontext.get[0m[1;39m([0m[1;35mkey.getName[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:     * Returns the object in this context that implements the given interface,[0m   [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:     * or the given default value if such an object is not found.[0m                [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * @param key          the interface implemented by the requested object[0m     [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * @param defaultValue value to return if the requested object is not found[0m  [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     * @return the object that implements the given interface,[0m                   [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * or the given default value if not found[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    public <T> T [0m[1;35mget[0m[1;39m([0m[39mClass<T> key, T defaultValue[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:        T value = [0m[1;35mget[0m[1;39m([0m[39mkey[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:        if [0m[1;39m([0m[39mvalue != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:            return value;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:            return defaultValue;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-bundles/tika-bundle-standard/src/test/java/org/apache/tika/bundle/BundleIT.jav[0m [2m                [0m
[2;36m                    [0m         [1;92ma:273[0m[39m-[0m[1;36m275[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m273[0m[39m:        Parser parser = new [0m[1;35mAutoDetectParser[0m[1;39m([0m[39mdefaultParser[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m274[0m[39m:        ParseContext context = new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m275[0m[39m:        [0m[1;35mcontext.set[0m[1;39m([0m[39mParser.class, parser[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:182[0m[39m-[0m[1;36m193[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:    public List<Parser> [0m[1;35mgetAllComponentParsers[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:        return [0m[1;35mCollections.unmodifiableList[0m[1;39m([0m[39mparsers[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:     * Returns the component parsers.[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:     * @return component parsers, keyed by media type[0m                           [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:    public Map<MediaType, Parser> [0m[1;35mgetParsers[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:        return [0m[1;35mgetParsers[0m[1;39m([0m[39mnew [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-core/src/main/java/org/apache/tika/parser/CompositeParser.jav[0m[1;92ma:163[0m[39m-[0m[1;36m176[0m         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:    public MediaTypeRegistry [0m[1;35mgetMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:        return registry;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:     * Sets the media type registry used to infer type relationships.[0m           [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:     *[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:     * @param registry media type registry[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:     * @since Apache Tika [0m[1;36m0.8[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:    public void [0m[1;35msetMediaTypeRegistry[0m[1;39m([0m[39mMediaTypeRegistry registry[0m[1;39m)[0m[39m [0m[1;39m{[0m              [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:        this.registry = registry;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:1[0m[39m-[0m[1;36m50[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m*[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m: * Licensed to the Apache Software Foundation [0m[1;39m([0m[39mASF[0m[1;39m)[0m[39m under one or more[0m             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m: * contributor license agreements.  See the NOTICE file distributed with[0m          [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m: * this work for additional information regarding copyright ownership.[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m: * The ASF licenses this file to You under the Apache License, Version [0m[1;36m2.0[0m        [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: * [0m[1;39m([0m[39mthe [0m[32m"License"[0m[1;39m)[0m[39m; you may not use this file except in compliance with[0m           [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: * the License.  You may obtain a copy of the License at[0m                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: *[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m: *     [0m[4;94mhttp://www.apache.org/licenses/LICENSE-2.0[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: * Unless required by applicable law or agreed to in writing, software[0m           [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: * distributed under the License is distributed on an [0m[32m"AS IS"[0m[39m BASIS,[0m             [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m: * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.[0m      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m: * See the License for the specific language governing permissions and[0m           [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: * limitations under the License.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:package org.apache.tika.parser.html;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.net.MalformedURLException;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.net.URL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.nio.charset.StandardCharsets;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.Arrays;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashSet;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Locale;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import java.util.regex.Matcher;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import java.util.regex.Pattern;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.xml.sax.Attributes;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.xml.sax.ContentHandler;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.xml.sax.SAXException;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.xml.sax.helpers.AttributesImpl;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentExtractor;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:import org.apache.tika.extractor.EmbeddedDocumentUtil;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:import org.apache.tika.io.TikaInputStream;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:import org.apache.tika.metadata.HTML;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:import org.apache.tika.metadata.Metadata;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:import org.apache.tika.metadata.Office;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:import org.apache.tika.metadata.Property;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:import org.apache.tika.metadata.TikaCoreProperties;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:import org.apache.tika.mime.MediaType;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:import org.apache.tika.parser.ParseContext;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:import org.apache.tika.parser.Parser;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:import org.apache.tika.parser.external.CompositeExternalParser;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:import org.apache.tika.parser.external.ExternalParser;[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-m[0m [2m                [0m
[2;36m                    [0m         [39module/src/main/java/org/apache/tika/parser/html/HtmlHandler.jav[0m[1;92ma:354[0m[39m-[0m[1;36m384[0m            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:    private void [0m[1;35mhandleDataURIScheme[0m[1;39m([0m[39mString string[0m[1;39m)[0m[39m throws SAXException [0m[1;39m{[0m       [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        DataURIScheme dataURIScheme = null;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:        try [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            dataURIScheme = [0m[1;35mdataURISchemeUtil.parse[0m[1;39m([0m[39mstring[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mDataURISchemeParseException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:            [0m[35m/[0m[35m/[0m[95mswallow[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:            return;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        int added = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:        if [0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:            added = [0m[1;35mconfigureExifTool[0m[1;39m([0m[1;35mmetadata.get[0m[1;39m([0m[32m"html_meta:exiftool_path"[0m[1;39m)[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m366[0m[39m:        [0m[35m/[0m[35m/[0m[95mdo[0m[39m anything with attrs?[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m367[0m[39m:        Metadata m = new [0m[1;35mMetadata[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m368[0m[39m:        [0m[1;35mm.set[0m[1;39m([0m[39mTikaCoreProperties.EMBEDDED_RESOURCE_TYPE,[0m                        [2m                [0m
[2;36m                    [0m         [1;36m369[0m[39m:                [0m[1;35mTikaCoreProperties.EmbeddedResourceType.INLINE.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m370[0m[39m:        if [0m[1;39m([0m[1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[39m != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m371[0m[39m:            [0m[1;35mm.set[0m[1;39m([0m[39mMetadata.CONTENT_TYPE, [0m                                       [2m                [0m
[2;36m                    [0m         [1;35mdataURIScheme.getMediaType[0m[1;39m([0m[1;39m)[0m[1;35m.toString[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m372[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m:        EmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                   [2m                [0m
[2;36m                    [0m         [1;36m374[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mcontext[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m375[0m[39m:        if [0m[1;39m([0m[1;35membeddedDocumentExtractor.shouldParseEmbedded[0m[1;39m([0m[39mm[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                 [2m                [0m
[2;36m                    [0m         [1;36m376[0m[39m:            try [0m[1;39m([0m[39mTikaInputStream stream = [0m                                      [2m                [0m
[2;36m                    [0m         [1;35mTikaInputStream.get[0m[1;39m([0m[1;35mdataURIScheme.getInputStream[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m377[0m[39m:                [0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[39mstream, xhtml, m, [0m      [2m                [0m
[2;36m                    [0m         [39mtrue[0m[1;39m)[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m378[0m[39m:            [0m[1;39m}[0m[39m catch [0m[1;39m([0m[39mIOException e[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m379[0m[39m:                [0m[1;35mEmbeddedDocumentUtil.recordEmbeddedStreamException[0m[1;39m([0m[39me, [0m          [2m                [0m
[2;36m                    [0m         [39mmetadata[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m380[0m[39m:            [0m[1;39m}[0m[39m finally [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m381[0m[39m:                [0m[1;35mresetExifTool[0m[1;39m([0m[39madded[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe compilation errors occur because the previous patch attempted to use a [0m         [2m                [0m
[2;36m                    [0m         [39mnon-existent `ParserFilterConfig` class. However, after analyzing the codebase, I [0m  [2m                [0m
[2;36m                    [0m         [39mfound that Apache Tika already has built-in infrastructure to exclude parsers - the[0m [2m                [0m
[2;36m                    [0m         [39m`CompositeParser` constructor accepts an `excludeParsers` parameter.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe core issue is that data URIs in HTML documents trigger embedded document [0m       [2m                [0m
[2;36m                    [0m         [39mparsing, which can invoke `ExternalParser` to execute external commands with [0m       [2m                [0m
[2;36m                    [0m         [39mpotentially malicious input. The solution is to use a restricted parser for data [0m   [2m                [0m
[2;36m                    [0m         [39mURI processing that excludes external parsers.[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m1[0m[39m. Remove the Invalid ParserFilterConfig Approach[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe previous patch attempted to create a filtering mechanism using [0m                 [2m                [0m
[2;36m                    [0m         [39m`ParserFilterConfig`, which doesn't exist. This approach should be completely [0m      [2m                [0m
[2;36m                    [0m         [39mremoved from:[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m- `CompositeParser.java` [0m[1;39m([0m[39mlines [0m[1;36m102[0m[39m-[0m[1;36m112[0m[39m and [0m[1;36m255[0m[39m-[0m[1;36m277[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [39m- `HtmlHandler.java` [0m[1;39m([0m[39mlines [0m[1;36m378[0m[39m-[0m[1;36m391[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m2[0m[39m. Use Existing CompositeParser Exclusion Mechanism[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInstead of creating new infrastructure, leverage the existing `CompositeParser` [0m    [2m                [0m
[2;36m                    [0m         [39mconstructor that accepts `excludeParsers`:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mpublic [0m[1;35mCompositeParser[0m[1;39m([0m[39mMediaTypeRegistry registry, List<Parser> parsers,[0m            [2m                [0m
[2;36m                    [0m         [39m                       Collection<Class<? extends Parser>> excludeParsers[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis constructor is already implemented and filters parsers at construction time [0m   [2m                [0m
[2;36m                    [0m         [39musing the `[0m[1;35misExcluded[0m[1;39m([0m[1;39m)[0m[39m` and `[0m[1;35massignableFrom[0m[1;39m([0m[1;39m)[0m[39m` methods.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m3[0m[39m. Modify [0m[1;35mHtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix should be applied only in `[0m[1;35mHtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m` method:[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location**: [0m                                                                      [2m                [0m
[2;36m                    [0m         [39m`tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-html-[0m [2m                [0m
[2;36m                    [0m         [39mmodule/src/main/java/org/apache/tika/parser/html/HtmlHandler.java`[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Steps**:[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39ma[0m[1;39m)[0m[39m Add required imports:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- `java.util.HashSet`[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- `java.util.List` [0m[1;39m([0m[39malready imported[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m- `org.apache.tika.parser.CompositeParser`[0m                                          [2m                [0m
[2;36m                    [0m         [39m- `org.apache.tika.mime.MediaTypeRegistry`[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mb[0m[1;39m)[0m[39m Before calling `[0m[1;35membeddedDocumentExtractor.parseEmbedded[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mcurrently line [0m[1;36m377[0m[1;39m)[0m[39m,[0m [2m                [0m
[2;36m                    [0m         [39mcreate a restricted ParseContext:[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Create a new `ParseContext` instance[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Get the current `Parser` from the original context[0m                               [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. If the parser is a `CompositeParser`:[0m                                            [2m                [0m
[2;36m                    [0m         [39m   - Get its list of parsers using `[0m[1;35mgetAllComponentParsers[0m[1;39m([0m[1;39m)[0m[39m`[0m                       [2m                [0m
[2;36m                    [0m         [39m   - Get its `MediaTypeRegistry` using `[0m[1;35mgetMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m`[0m                     [2m                [0m
[2;36m                    [0m         [39m   - Create a `Set<Class<? extends Parser>>` with `ExternalParser.class` and [0m       [2m                [0m
[2;36m                    [0m         [39m`CompositeExternalParser.class`[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Create a new `CompositeParser` with the same registry, parsers, but with the [0m  [2m                [0m
[2;36m                    [0m         [39mexclusion set[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - Set this restricted parser in the new context[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. If the parser is not a `CompositeParser`, use the original parser[0m                [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Copy other necessary objects from the original context [0m[1;39m([0m[39me.g., `TikaConfig`[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Get the `EmbeddedDocumentExtractor` using the new restricted context[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mc[0m[1;39m)[0m[39m Pass the restricted context when getting the `EmbeddedDocumentExtractor`:[0m        [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mEmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                               [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mrestrictedContext[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m4[0m[39m. Keep ProcessBuilder Changes in ExternalParser.java[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe ProcessBuilder changes from the previous patch should be retained as they are [0m  [2m                [0m
[2;36m                    [0m         [39mgood security practices:[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- Line [0m[1;36m161[0m[39m-[0m[1;36m162[0m[39m: Using `ProcessBuilder` instead of `[0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m`[0m                  [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m289[0m[39m-[0m[1;36m294[0m[39m: Removing string splitting logic to prevent shell injection[0m         [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m304[0m[39m-[0m[1;36m311[0m[39m: Consolidating to use `ProcessBuilder`[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThese changes prevent shell injection vulnerabilities even if `ExternalParser` is [0m  [2m                [0m
[2;36m                    [0m         [39msomehow invoked.[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;36m5[0m[39m. Revert CompositeParser.java Changes[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll modifications to `CompositeParser.java` should be reverted since they reference[0m [2m                [0m
[2;36m                    [0m         [39mnon-existent classes.[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Implementation Details[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### [0m[1;35mHtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m Modification[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mInsert the following logic after line [0m[1;36m372[0m[39m [0m[1;39m([0m[39mafter setting metadata[0m[1;39m)[0m[39m and before line [0m [2m                [0m
[2;36m                    [0m         [1;36m373[0m[39m [0m[1;39m([0m[39mgetting embeddedDocumentExtractor[0m[1;39m)[0m[39m:[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Create a restricted context that excludes external parsers for data URI security[0m [2m                [0m
[2;36m                    [0m         [39mParseContext restrictedContext = new [0m[1;35mParseContext[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Get the current parser and create a restricted version[0m                           [2m                [0m
[2;36m                    [0m         [39mParser originalParser = [0m[1;35mcontext.get[0m[1;39m([0m[39mParser.class[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39moriginalParser instanceof CompositeParser[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m    CompositeParser cp = [0m[1;39m([0m[39mCompositeParser[0m[1;39m)[0m[39m originalParser;[0m                          [2m                [0m
[2;36m                    [0m         [39m    List<Parser> parsers = [0m[1;35mcp.getAllComponentParsers[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m    MediaTypeRegistry registry = [0m[1;35mcp.getMediaTypeRegistry[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m Exclude external parsers to prevent command injection[0m                        [2m                [0m
[2;36m                    [0m         [39m    Set<Class<? extends Parser>> excludeParsers = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexcludeParsers.add[0m[1;39m([0m[39mExternalParser.class[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mexcludeParsers.add[0m[1;39m([0m[39mCompositeExternalParser.class[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    Parser restrictedParser = new [0m[1;35mCompositeParser[0m[1;39m([0m[39mregistry, parsers, [0m               [2m                [0m
[2;36m                    [0m         [39mexcludeParsers[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mParser.class, restrictedParser[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else if [0m[1;39m([0m[39moriginalParser != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mParser.class, originalParser[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Copy TikaConfig if present[0m                                                       [2m                [0m
[2;36m                    [0m         [39mTikaConfig tikaConfig = [0m[1;35mcontext.get[0m[1;39m([0m[39mTikaConfig.class[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mtikaConfig != null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mrestrictedContext.set[0m[1;39m([0m[39mTikaConfig.class, tikaConfig[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThen modify line [0m[1;36m373[0m[39m-[0m[1;36m374[0m[39m to use `restrictedContext` instead of `context`:[0m           [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mEmbeddedDocumentExtractor embeddedDocumentExtractor =[0m                               [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mEmbeddedDocumentUtil.getEmbeddedDocumentExtractor[0m[1;39m([0m[39mrestrictedContext[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Justification[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This is the Optimal Approach[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Uses Existing Infrastructure**: The `CompositeParser` constructor with [0m        [2m                [0m
[2;36m                    [0m         [39m`excludeParsers` already exists and is tested. No new classes are needed.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Minimal Code Changes**: Only modifies `[0m[1;35mHtmlHandler.handleDataURIScheme[0m[1;39m([0m[1;39m)[0m[39m` to [0m  [2m                [0m
[2;36m                    [0m         [39mcreate a restricted parser for data URIs, and improves `ExternalParser` to use [0m     [2m                [0m
[2;36m                    [0m         [39m`ProcessBuilder`.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Existing Logic**: The approach doesn't break any existing [0m           [2m                [0m
[2;36m                    [0m         [39mfunctionality:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m   - Normal [0m[1;39m([0m[39mnon-data URI[0m[1;39m)[0m[39m parsing uses the original parser[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Only data URI embedded content uses the restricted parser[0m                      [2m                [0m
[2;36m                    [0m         [39m   - The `CompositeParser` exclusion mechanism is already used in the codebase [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39me.g., `DefaultParser`[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Defense in Depth**: Combines two security measures:[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Prevents `ExternalParser` from being invoked for data URIs [0m[1;39m([0m[39mprimary fix[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m         [39m   - Improves `ExternalParser` to use `ProcessBuilder` instead of `[0m[1;35mRuntime.exec[0m[1;39m([0m[1;39m)[0m[39m` [0m [2m                [0m
[2;36m                    [0m         [1;39m([0m[39msecondary hardening[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **No Breaking Changes**: The fix only affects the security-critical path [0m[1;39m([0m[39mdata [0m  [2m                [0m
[2;36m                    [0m         [39mURI processing[0m[1;39m)[0m[39m and doesn't modify test codes, utility functions, or fuzzing [0m       [2m                [0m
[2;36m                    [0m         [39mharness.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### How It Addresses the Issues[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Original Vulnerability**: Data URIs can no longer trigger `ExternalParser` [0m    [2m                [0m
[2;36m                    [0m         [39mexecution because they are excluded from the parser list when processing data URI [0m  [2m                [0m
[2;36m                    [0m         [39membedded content.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Compilation Errors**: Completely resolved by removing references to [0m           [2m                [0m
[2;36m                    [0m         [39mnon-existent `ParserFilterConfig` class and using existing `CompositeParser` [0m       [2m                [0m
[2;36m                    [0m         [39minfrastructure.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Security**: The fix specifically targets inline embedded content [0m[1;39m([0m[39mdata URIs [0m   [2m                [0m
[2;36m                    [0m         [39mare marked as `INLINE` in line [0m[1;36m368[0m[39m-[0m[1;36m369[0m[1;39m)[0m[39m, which is the attack vector identified in [0m  [2m                [0m
[2;36m                    [0m         [39mthe fuzzer report.[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Side Effect**: Data URIs that legitimately need external tools won't be [0m       [2m                [0m
[2;36m                    [0m         [39mprocessed.[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: This is acceptable because data URIs are inline data that [0m     [2m                [0m
[2;36m                    [0m         [39mshould be parseable without external tools. External parsers are for formats [0m       [2m                [0m
[2;36m                    [0m         [39mrequiring external programs [0m[1;39m([0m[39mlike `catdoc` for old Word formats[0m[1;39m)[0m[39m, which shouldn't [0m  [2m                [0m
[2;36m                    [0m         [39mbe embedded as data URIs in HTML.[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Side Effect**: If the original parser is not a `CompositeParser`, external [0m    [2m                [0m
[2;36m                    [0m         [39mparsers might still be invoked.[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - **Mitigation**: The code handles this by preserving the original parser if [0m    [2m                [0m
[2;36m                    [0m         [39mit's not a `CompositeParser`. In practice, Apache Tika uses `AutoDetectParser` or [0m  [2m                [0m
[2;36m                    [0m         [39m`DefaultParser`, both of which extend `CompositeParser`.[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Similar Solutions in the Codebase[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe `DefaultParser` constructor [0m[1;39m([0m[39mlines [0m[1;36m49[0m[39m-[0m[1;36m54[0m[39m in DefaultParser.java[0m[1;39m)[0m[39m uses the same [0m  [2m                [0m
[2;36m                    [0m         [39mpattern:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mpublic [0m[1;35mDefaultParser[0m[1;39m([0m[39mMediaTypeRegistry registry, ServiceLoader loader,[0m              [2m                [0m
[2;36m                    [0m         [39m                     Collection<Class<? extends Parser>> excludeParsers,[0m            [2m                [0m
[2;36m                    [0m         [39m                     EncodingDetector encodingDetector, Renderer renderer[0m[1;39m)[0m[39m [0m[1;39m{[0m        [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35msuper[0m[1;39m([0m[39mregistry, [0m[1;35mgetDefaultParsers[0m[1;39m([0m[39mloader, encodingDetector, renderer, [0m          [2m                [0m
[2;36m                    [0m         [39mexcludeParsers[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m    this.loader = loader;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis confirms that parser exclusion is a standard pattern in Apache Tika.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 09:15:06][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=252642;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=384377;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m4[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=614876;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=219899;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpgrk499hb[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/tika_tk-delta-01_vuln_9/[0m[95magent[0m [2m               [0m
[2;36m                    [0m         [95m-output-1768295706.1619306[0m                                                           [2m               [0m
[2;36m                    [0m         - Detection toml file: scripts/benchmark/afc-delta-full/tika_tk-delta-01_vuln_9.toml [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-tika[0m             [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 09:15:08][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mtika[0m           ]8;id=873379;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=91574;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=636495;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=471147;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mtika[0m                  [2m               [0m
[2;36m[01/13/26 09:15:09][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=47946;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=894006;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mtika[0m                   [2m               [0m
