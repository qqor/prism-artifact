[2;36m[01/13/26 02:56:00][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=818492;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=848825;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmphyfizjdz[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/libxml2_lx-delta-03_vuln_004/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768272960.035255[0m                                                       [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libxml2_lx-delta-03_vuln_004.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-libxml2[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Building Cached for CLEAN environment[1m)[0m           ]8;id=998333;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=440281;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/13/26 02:56:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Building Cached for CLEAN environment[1m)[0m Took     ]8;id=993790;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=209643;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m39.98[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=866887;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=586200;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running tests for Cached for CLEAN environment[1m)[0m ]8;id=815398;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=221840;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=385714;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=615013;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m39[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=407919;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=848059;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.88[0m seconds;               ]8;id=696404;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=316967;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 02:56:41][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=571727;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=564365;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=730157;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=126594;file:///home/qqor/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=696781;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=930752;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=295528;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=10889;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:56:42][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m1.02[0m seconds;               ]8;id=89888;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=140859;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=722766;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=979442;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 02:56:43][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.96[0m seconds;               ]8;id=386101;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=221256;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 02:56:46][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=343016;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=573304;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mhtml[0m                                                                       [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer html -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m -[33mtimeout_exitcode[0m=[1;36m0[0m    [2m                [0m
[2;36m                    [0m         -[33mdict[0m=[35mhtml[0m.dict [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m118[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m610285526[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49724[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55aa145d1838[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55aa145dda74[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49724[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55aa145dda78[0m[39m,[0m[1;36m0x55aa1469fe38[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x523000003471[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55aa14495545[0m[39m bp [0m[1;36m0x7fff2ae182f0[0m[39m sp [0m[1;36m0x7fff2ae182e8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x523000003471[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aa14495544[0m[39m in UTF32ToUTF8 [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aa14491ad4[0m[39m in xmlEncInputChunk [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1485:15[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aa14491ad4[0m[39m in xmlCharEncInput [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1611:15[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aa142da576[0m[39m in xmlParserInputBufferGrow [0m[35m/src/libxml2/[0m[95mxmlIO.c[0m[39m:[0m[1;92m2213:6[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aa1425e2d1[0m[39m in xmlParserGrow [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m585:11[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aa14309dcb[0m[39m in htmlParseCharData [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m3033:21[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aa142f4199[0m[39m in htmlParseContent [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4142:13[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aa142f7bcb[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4415:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aa142ffe72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aa141eca28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aa140a1410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aa1408c685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aa1409211f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aa140bd3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f5beca5f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x55aa1408486d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mhtml+0x1aa86d[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UTF32ToUTF8--xmlEncInputChunk--xmlCharEncInput[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x523000003471[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m6001[0m[39m-byte region [0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x523000001d00[0m[39m,[0m[1;36m0x523000003471[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aa141ad1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aa141ecf38[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aa1447e9c9[0m[39m in xmlBufCreate [0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m:[0m[1;92m140:16[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aa14260d7f[0m[39m in xmlInputSetEncodingHandler [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1316:11[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aa14260387[0m[39m in xmlSwitchToEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1399:12[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aa14260387[0m[39m in xmlSwitchEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1194:11[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aa14261bea[0m[39m in xmlDetectEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1521:13[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aa142f6630[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4346:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aa142ffe72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aa141eca28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aa140a1410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aa1408c685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aa1409211f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aa140bd3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f5beca5f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlBufCreate[0m                      [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUTF32ToUTF8[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003280[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003300[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003380[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x523000003400[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m01[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp5e4jv7kb[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mhtml -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mhtml[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer html -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mhtml[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m118[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m610285526[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49724[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55aa145d1838[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55aa145dda74[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49724[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55aa145dda78[0m[39m,[0m[1;36m0x55aa1469fe38[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x523000003471[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55aa14495545[0m[39m bp [0m[1;36m0x7fff2ae182f0[0m[39m sp [0m[1;36m0x7fff2ae182e8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x523000003471[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aa14495544[0m[39m in UTF32ToUTF8 [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aa14491ad4[0m[39m in xmlEncInputChunk [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1485:15[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aa14491ad4[0m[39m in xmlCharEncInput [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1611:15[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aa142da576[0m[39m in xmlParserInputBufferGrow [0m[35m/src/libxml2/[0m[95mxmlIO.c[0m[39m:[0m[1;92m2213:6[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aa1425e2d1[0m[39m in xmlParserGrow [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m585:11[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aa14309dcb[0m[39m in htmlParseCharData [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m3033:21[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aa142f4199[0m[39m in htmlParseContent [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4142:13[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aa142f7bcb[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4415:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aa142ffe72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aa141eca28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aa140a1410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aa1408c685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aa1409211f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aa140bd3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f5beca5f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x55aa1408486d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mhtml+0x1aa86d[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UTF32ToUTF8--xmlEncInputChunk--xmlCharEncInput[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x523000003471[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m6001[0m[39m-byte region [0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x523000001d00[0m[39m,[0m[1;36m0x523000003471[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aa141ad1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aa141ecf38[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aa1447e9c9[0m[39m in xmlBufCreate [0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m:[0m[1;92m140:16[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aa14260d7f[0m[39m in xmlInputSetEncodingHandler [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1316:11[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aa14260387[0m[39m in xmlSwitchToEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1399:12[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aa14260387[0m[39m in xmlSwitchEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1194:11[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aa14261bea[0m[39m in xmlDetectEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1521:13[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aa142f6630[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4346:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aa142ffe72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aa141eca28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aa140a1410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aa1408c685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aa1409211f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aa140bd3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f5beca5f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlBufCreate[0m                      [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUTF32ToUTF8[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003280[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003300[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003380[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x523000003400[0m: [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m [1;36m00[0m[1m[[0m[1;36m01[0m[1m][0mfa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003480[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003500[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003580[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003600[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x523000003680[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp5e4jv7kb[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         html -[33mruns[0m=[1;36m100[0m.                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 02:57:05][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=825513;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=854625;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 03:01:45][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=806480;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=971457;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 03:02:56][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=9656;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=431104;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=218662;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=338986;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:02:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m1.04[0m seconds;               ]8;id=749355;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=102297;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Patching[1m)[0m Started[33m...[0m                             ]8;id=938783;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=871126;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp2lec03p6[0m                                                 ]8;id=329134;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=236273;file:///home/qqor/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 03:03:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Patching[1m)[0m Took [1;36m28.22[0m seconds; [33mexception[0m=[3;91mFalse[0m   ]8;id=719489;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=10191;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Checking build[1m)[0m Started[33m...[0m                       ]8;id=300142;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=119943;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:03:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Checking build[1m)[0m Took [1;36m8.49[0m seconds;              ]8;id=11847;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=17414;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running PoV[1m)[0m Started[33m...[0m                          ]8;id=628122;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=823996;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:03:37][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Running PoV[1m)[0m Took [1;36m2.69[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=545584;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=183538;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Testing[1m)[0m Started[33m...[0m                              ]8;id=527967;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=756003;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=748728;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=248317;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=975874;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=805679;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:03:38][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.84[0m seconds;               ]8;id=505651;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=410829;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 03:03:39][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=963788;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=372399;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:03:40][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m0.98[0m seconds;               ]8;id=440305;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=87385;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Started[33m...[0m                        ]8;id=63624;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=771386;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 03:03:41][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mlibxml2 Setting owner[1m)[0m Took [1;36m1.00[0m seconds;               ]8;id=192218;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=291611;file:///home/qqor/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=56900;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=456087;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/encoding.c                                                                    [2m                [0m
[2;36m                    [0m         +++ b/encoding.c                                                                    [2m                [0m
[2;36m                    [0m         @@ [1;36m-2844[0m,[1;36m8[0m +[1;36m2844[0m,[1;36m9[0m @@                                                               [2m                [0m
[2;36m                    [0m                        const unsigned char *in, int *inlen,                                 [2m                [0m
[2;36m                    [0m                        void *vctxt ATTRIBUTE_UNUSED[1m)[0m [1m{[0m                                      [2m                [0m
[2;36m                    [0m              const unsigned char *instart = in;                                             [2m                [0m
[2;36m                    [0m         -    const unsigned char *inend = in + [1m([0m*inlen & ~[1;36m1[0m[1m)[0m;                               [2m                [0m
[2;36m                    [0m         +    const unsigned char *inend = in + [1m([0m*inlen & ~[1;36m3[0m[1m)[0m;                               [2m                [0m
[2;36m                    [0m              unsigned char *outstart = out;                                                 [2m                [0m
[2;36m                    [0m         +    unsigned char *outend = out + *outlen;                                         [2m                [0m
[2;36m                    [0m              unsigned long int b0, b1, b2, b3, c, d;                                        [2m                [0m
[2;36m                    [0m              int ret = XML_ENC_ERR_SPACE;                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         @@ [1;36m-2865[0m,[1;36m15[0m +[1;36m2866[0m,[1;36m21[0m @@                                                             [2m                [0m
[2;36m                    [0m                  c = b0 | b1 | b2 | b3;                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  if [1m([0mc [1m<[0m[39m [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+                goto done;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m             in += [0m[1;36m4[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m             out += [0m[1;36m1[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+                goto done;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m             in += [0m[1;36m4[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m             out += [0m[1;36m2[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[39moutend - out < [0m[1;36m3[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+                goto done;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m             out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-2882[0m[39m,[0m[1;36m37[0m[39m +[0m[1;36m2889[0m[39m,[0m[1;36m39[0m[39m @@[0m                                                             [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                                   [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m-                ret = XML_ERR_INTERNAL_ERROR;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m                 break;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-       [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m8[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m        [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m-            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m+            b0 = in[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+            b1 = in[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+            b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m+            b2 = in[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+            b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+            b3 = in[0m[1;39m[[0m[1;36m7[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+            b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+            d = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m-                ret = XML_ERR_INTERNAL_ERROR;[0m                                      [2m                [0m
[2;36m                    [0m         [39m+                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m                 break;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            [0m[35m/[0m[39m*[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m-                simplified due to encoding errors encountered with:[0m                [2m                [0m
[2;36m                    [0m         [39m-[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [39m-                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m-                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m-                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m-                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [39m-            *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m-            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xff[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m-            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m8[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m-            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x10[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m-            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x18[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m-            in += [0m[1;36m4[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m+       [0m[39m        [0m[39m        goto done;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+            c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m+            in += [0m[1;36m8[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m             out += [0m[1;36m4[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m-    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m+    if [0m[1;39m([0m[39min >= inend[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m         ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m+done:[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m     *outlen = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m     *inlen = in - instart;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m     [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mhtml[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer html -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mhtml[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m118[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m610285526[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49724[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55aa145d1838[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55aa145dda74[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49724[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55aa145dda78[0m[39m,[0m[1;36m0x55aa1469fe38[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x523000003471[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55aa14495545[0m[39m bp [0m[1;36m0x7fff2ae182f0[0m[39m sp [0m[1;36m0x7fff2ae182e8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x523000003471[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aa14495544[0m[39m in UTF32ToUTF8 [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aa14491ad4[0m[39m in xmlEncInputChunk [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1485:15[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aa14491ad4[0m[39m in xmlCharEncInput [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1611:15[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aa142da576[0m[39m in xmlParserInputBufferGrow [0m[35m/src/libxml2/[0m[95mxmlIO.c[0m[39m:[0m[1;92m2213:6[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aa1425e2d1[0m[39m in xmlParserGrow [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m585:11[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aa14309dcb[0m[39m in htmlParseCharData [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m3033:21[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aa142f4199[0m[39m in htmlParseContent [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4142:13[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aa142f7bcb[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4415:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aa142ffe72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aa141eca28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aa140a1410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aa1408c685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aa1409211f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aa140bd3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f5beca5f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x55aa1408486d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mhtml+0x1aa86d[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UTF32ToUTF8--xmlEncInputChunk--xmlCharEncInput[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x523000003471[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m6001[0m[39m-byte region [0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x523000001d00[0m[39m,[0m[1;36m0x523000003471[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aa141ad1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aa141ecf38[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aa1447e9c9[0m[39m in xmlBufCreate [0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m:[0m[1;92m140:16[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aa14260d7f[0m[39m in xmlInputSetEncodingHandler [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1316:11[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aa14260387[0m[39m in xmlSwitchToEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1399:12[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aa14260387[0m[39m in xmlSwitchEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1194:11[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aa14261bea[0m[39m in xmlDetectEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1521:13[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aa142f6630[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4346:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aa142ffe72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aa141eca28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aa140a1410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aa1408c685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aa1409211f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aa140bd3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f5beca5f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlBufCreate[0m                      [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUTF32ToUTF8[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003280[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003300[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003380[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x523000003400[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m01[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp5e4jv7kb[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mhtml -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in libxml2's HTML parser [0m    [2m                [0m
[2;36m                    [0m         [39mwhen processing a test case. The overflow occurs during UTF-[0m[1;36m32[0m[39m to UTF-[0m[1;36m8[0m[39m character [0m  [2m                [0m
[2;36m                    [0m         [39mencoding conversion, specifically in the `UTF32ToUTF8` function. AddressSanitizer [0m  [2m                [0m
[2;36m                    [0m         [39mreports a [0m[1;36m1[0m[39m-byte write operation beyond the bounds of a [0m[1;36m6001[0m[39m-byte allocated buffer,[0m [2m                [0m
[2;36m                    [0m         [39mresulting in a write at address [0m[1;36m0x523000003471[0m[39m, which is located [0m[1;36m0[0m[39m bytes after the [0m [2m                [0m
[2;36m                    [0m         [39mend of the allocated region.[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Issue Overview[0m                                                                  [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as a heap-buffer-overflow error detected by AddressSanitizer [0m   [2m                [0m
[2;36m                    [0m         [39mduring fuzzing of libxml2's HTML parsing functionality. The fuzzer was running with[0m [2m                [0m
[2;36m                    [0m         [39mthe libfuzzer engine in interactive mode, executing [0m[1;36m100[0m[39m iterations on a specific [0m   [2m                [0m
[2;36m                    [0m         [39mtest case.[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Vulnerability Type[0m                                                              [2m                [0m
[2;36m                    [0m         [39mThis is a **heap-buffer-overflow** vulnerability with a SCARINESS score of [0m[1;36m31[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mclassified as a [0m[32m"1-byte-write-heap-buffer-overflow"[0m[39m. The overflow involves writing [0m [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m byte beyond the allocated heap buffer boundary.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Error Details[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- **Error Location**: `[0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m[39m` in the `UTF32ToUTF8` [0m       [2m                [0m
[2;36m                    [0m         [39mfunction[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- **Operation**: WRITE of size [0m[1;36m1[0m[39m at address [0m[1;36m0x523000003471[0m                          [2m                [0m
[2;36m                    [0m         [39m- **Buffer Details**: [0m                                                              [2m                [0m
[2;36m                    [0m         [39m  - Allocated region: [0m[1;39m[[0m[1;36m0x523000001d00[0m[39m, [0m[1;36m0x523000003471[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m  - Size: [0m[1;36m6001[0m[39m bytes[0m                                                                [2m                [0m
[2;36m                    [0m         [39m  - Overflow location: [0m[1;36m0[0m[39m bytes after the end of the allocated region[0m                [2m                [0m
[2;36m                    [0m         [39m  - Shadow byte status: Shows [0m[32m"01"[0m[39m [0m[1;39m([0m[39mpartially addressable[0m[1;39m)[0m[39m at the overflow location[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Call Stack Analysis[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerability is triggered through the following execution path:[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Entry Point**: `LLVMFuzzerTestOneInput` in `[0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;36m49[0m[39m` [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mfuzzer harness[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **HTML Parsing**: [0m                                                               [2m                [0m
[2;36m                    [0m         [39m   - `htmlCtxtParseDocument` → `htmlParseDocument` → `htmlParseContent` → [0m          [2m                [0m
[2;36m                    [0m         [39m`htmlParseCharData`[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Parser Growth**: `htmlParseCharData` calls `xmlParserGrow`[0m                     [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Buffer Management**: `xmlParserGrow` → `xmlParserInputBufferGrow`[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Encoding Conversion**: [0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - `xmlCharEncInput` → `xmlEncInputChunk` → `UTF32ToUTF8` [0m[1;39m([0m[39mwhere the overflow [0m    [2m                [0m
[2;36m                    [0m         [39moccurs[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Buffer Allocation Context[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe buffer was allocated through:[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `xmlBufCreate` in `[0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m:[0m[1;36m140[0m[39m`[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Called by `xmlInputSetEncodingHandler` during encoding detection and switching[0m   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The allocation path: `xmlDetectEncoding` → `xmlSwitchEncoding` → [0m                [2m                [0m
[2;36m                    [0m         [39m`xmlSwitchToEncoding` → `xmlInputSetEncodingHandler` → `xmlBufCreate`[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo obtain a holistic understanding of this issue, the following components should [0m  [2m                [0m
[2;36m                    [0m         [39mbe investigated:[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Encoding Conversion Logic** [0m[1;39m([0m[39m`[0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m`[0m[1;39m)[0m[39m:[0m                       [2m                [0m
[2;36m                    [0m         [39m   - The `UTF32ToUTF8` function at line [0m[1;36m2868[0m[39m, specifically the write operation that[0m [2m                [0m
[2;36m                    [0m         [39mcauses the overflow[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - Buffer size calculations and boundary checks in `xmlEncInputChunk` and [0m        [2m                [0m
[2;36m                    [0m         [39m`xmlCharEncInput`[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Buffer Management** [0m[1;39m([0m[39m`[0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m`[0m[1;39m)[0m[39m:[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - The `xmlBufCreate` function and how it determines initial buffer sizes[0m         [2m                [0m
[2;36m                    [0m         [39m   - Buffer growth and reallocation mechanisms[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Parser Internals** [0m[1;39m([0m[39m`[0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m`[0m[1;39m)[0m[39m:[0m                         [2m                [0m
[2;36m                    [0m         [39m   - `xmlParserGrow` and `xmlParserInputBufferGrow` functions[0m                       [2m                [0m
[2;36m                    [0m         [39m   - How these functions coordinate with encoding handlers and buffer management[0m    [2m                [0m
[2;36m                    [0m         [39m   - The encoding detection and switching logic in `xmlDetectEncoding`, [0m            [2m                [0m
[2;36m                    [0m         [39m`xmlSwitchEncoding`, and `xmlSwitchToEncoding`[0m                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **HTML Parser** [0m[1;39m([0m[39m`[0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m`[0m[1;39m)[0m[39m:[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - `htmlParseCharData` function that triggers the parser growth[0m                   [2m                [0m
[2;36m                    [0m         [39m   - The interaction between HTML parsing and character encoding conversion[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Input/Output Operations** [0m[1;39m([0m[39m`[0m[35m/src/libxml2/[0m[95mxmlIO.c[0m[39m`[0m[1;39m)[0m[39m:[0m                            [2m                [0m
[2;36m                    [0m         [39m   - `xmlParserInputBufferGrow` function at line [0m[1;36m2213[0m                               [2m                [0m
[2;36m                    [0m         [39m   - How buffer sizes are managed during input processing[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue appears to be related to incorrect buffer size calculations or missing [0m   [2m                [0m
[2;36m                    [0m         [39mboundary checks during the UTF-[0m[1;36m32[0m[39m to UTF-[0m[1;36m8[0m[39m encoding conversion process, potentially[0m [2m                [0m
[2;36m                    [0m         [39mwhen the input buffer requires growth during HTML parsing operations.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mhtml[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer html -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                                               [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m -[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m [0m   [2m                [0m
[2;36m                    [0m         [39m-[0m[33mdict[0m[39m=[0m[35mhtml[0m[39m.dict < [0m[35m/dev/[0m[95mnull[0m                                                         [2m                [0m
[2;36m                    [0m         [39mDictionary: [0m[1;36m118[0m[39m entries[0m                                                             [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m610285526[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m modules   [0m[1;39m([0m[1;36m49724[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55aa145d1838[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [1;36m0x55aa145dda74[0m[1;39m)[0m[39m, [0m                                                                   [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m1[0m[39m PC tables [0m[1;39m([0m[1;36m49724[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m49724[0m[39m [0m[1;39m[[0m[1;36m0x55aa145dda78[0m[39m,[0m[1;36m0x55aa1469fe38[0m[1;39m)[0m[39m, [0m       [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mhtml[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                                       [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x523000003471[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x55aa14495545[0m[39m bp [0m[1;36m0x7fff2ae182f0[0m[39m sp [0m[1;36m0x7fff2ae182e8[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x523000003471[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aa14495544[0m[39m in UTF32ToUTF8 [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m                [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aa14491ad4[0m[39m in xmlEncInputChunk [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1485:15[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aa14491ad4[0m[39m in xmlCharEncInput [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m1611:15[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aa142da576[0m[39m in xmlParserInputBufferGrow [0m[35m/src/libxml2/[0m[95mxmlIO.c[0m[39m:[0m[1;92m2213:6[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aa1425e2d1[0m[39m in xmlParserGrow [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m585:11[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aa14309dcb[0m[39m in htmlParseCharData [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m3033:21[0m        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aa142f4199[0m[39m in htmlParseContent [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4142:13[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aa142f7bcb[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4415:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aa142ffe72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aa141eca28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aa140a1410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aa1408c685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aa1409211f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aa140bd3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f5beca5f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m15[0m[39m [0m[1;36m0x55aa1408486d[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mhtml+0x1aa86d[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: UTF32ToUTF8--xmlEncInputChunk--xmlCharEncInput[0m                         [2m                [0m
[2;36m                    [0m         [1;36m0x523000003471[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m6001[0m[39m-byte region [0m                           [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x523000001d00[0m[39m,[0m[1;36m0x523000003471[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x55aa141ad1df[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x55aa141ecf38[0m[39m in xmlFuzzMalloc [0m[35m/src/libxml2/fuzz/[0m[95mfuzz.c[0m[39m:[0m[1;92m127:11[0m              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x55aa1447e9c9[0m[39m in xmlBufCreate [0m[35m/src/libxml2/[0m[95mbuf.c[0m[39m:[0m[1;92m140:16[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x55aa14260d7f[0m[39m in xmlInputSetEncodingHandler [0m                                [2m                [0m
[2;36m                    [0m         [35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1316:11[0m                                              [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x55aa14260387[0m[39m in xmlSwitchToEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1399:12[0m [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x55aa14260387[0m[39m in xmlSwitchEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1194:11[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x55aa14261bea[0m[39m in xmlDetectEncoding [0m[35m/src/libxml2/[0m[95mparserInternals.c[0m[39m:[0m[1;92m1521:13[0m   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x55aa142f6630[0m[39m in htmlParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m4346:5[0m         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m8[0m[39m [0m[1;36m0x55aa142ffe72[0m[39m in htmlCtxtParseDocument [0m[35m/src/libxml2/[0m[95mHTMLparser.c[0m[39m:[0m[1;92m5927:5[0m     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m9[0m[39m [0m[1;36m0x55aa141eca28[0m[39m in LLVMFuzzerTestOneInput [0m[35m/src/libxml2/fuzz/[0m[95mhtml.c[0m[39m:[0m[1;92m49:15[0m      [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m10[0m[39m [0m[1;36m0x55aa140a1410[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m    [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m11[0m[39m [0m[1;36m0x55aa1408c685[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned[0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m12[0m[39m [0m[1;36m0x55aa1409211f[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char[0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m13[0m[39m [0m[1;36m0x55aa140bd3c2[0m[39m in main [0m                                                     [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m14[0m[39m [0m[1;36m0x7f5beca5f082[0m[39m in __libc_start_main [0m                                        [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: __interceptor_malloc--xmlFuzzMalloc--xmlBufCreate[0m                      [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m[35m/src/libxml2/[0m[95mencoding.c[0m[39m:[0m[1;92m2868:20[0m[39m in [0m [2m                [0m
[2;36m                    [0m         [39mUTF32ToUTF8[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003180[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003200[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003280[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003300[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003380[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x523000003400[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[1;39m[[0m[1;36m01[0m[1;39m][0m[39mfa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003480[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003500[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003580[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003600[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x523000003680[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmp5e4jv7kb[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mhtml -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2850[0m[39m-[0m[1;36m2900[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m != [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        b0 = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        b1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:        b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2861[0m[39m:        b2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2862[0m[39m:        b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2863[0m[39m:        b3 = in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2864[0m[39m:        b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2865[0m[39m:        c = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2866[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2867[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2869[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2870[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2871[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2872[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2873[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2874[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2875[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2876[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2878[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2879[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2880[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2881[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2882[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2883[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2884[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2885[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2886[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2887[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2888[0m[39m:   [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2889[0m[39m:   [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2890[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2891[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2892[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2893[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2894[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2895[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2896[0m[39m:                simplified due to encoding errors encountered with:[0m            [2m                [0m
[2;36m                    [0m         [1;36m2897[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2898[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m2899[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2900[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2842[0m[39m-[0m[1;36m2919[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2842[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2843[0m[39m:[0m[1;35mUTF32ToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2844[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2845[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2846[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2847[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2848[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2849[0m[39m:    unsigned long int b0, b1, b2, b3, c, d;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m != [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        b0 = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        b1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:        b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2861[0m[39m:        b2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2862[0m[39m:        b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2863[0m[39m:        b3 = in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2864[0m[39m:        b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2865[0m[39m:        c = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2866[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2867[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2869[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2870[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2871[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2872[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2873[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2874[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2875[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2876[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2878[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2879[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2880[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2881[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2882[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2883[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2884[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2885[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2886[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2887[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2888[0m[39m:   [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2889[0m[39m:   [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2890[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2891[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2892[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2893[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2894[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2895[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2896[0m[39m:                simplified due to encoding errors encountered with:[0m            [2m                [0m
[2;36m                    [0m         [1;36m2897[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2898[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m2899[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2900[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2901[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2902[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2903[0m[39m:            *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2904[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xff[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2905[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m8[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2906[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x10[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2907[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x18[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2908[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2909[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2910[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2911[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2913[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2914[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2915[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2916[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2917[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2918[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2919[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:124[0m[39m-[0m[1;36m150[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:xmlBufPtr[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:[0m[1;35mxmlBufCreate[0m[1;39m([0m[39msize_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:    xmlBufPtr ret;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:    if [0m[1;39m([0m[39msize == SIZE_MAX[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:    ret = [0m[1;35mxmlMalloc[0m[1;39m([0m[1;35msizeof[0m[1;39m([0m[39m*ret[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:    if [0m[1;39m([0m[39mret == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:    ret->use = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:    ret->flags = [0m[1;36m0[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:    ret->size = size;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:    ret->maxSize = SIZE_MAX - [0m[1;36m1[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:    ret->mem = [0m[1;35mxmlMalloc[0m[1;39m([0m[39mret->size + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:    if [0m[1;39m([0m[39mret->mem == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:        [0m[1;35mxmlFree[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mNULL[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:    ret->content = ret->mem;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:    ret->content[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:    [0m[1;35mUPDATE_COMPAT[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:496[0m[39m-[0m[1;36m504[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:size_t[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:[0m[1;35mxmlBufAvail[0m[1;39m([0m[39mconst xmlBufPtr buf[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39m!buf[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_ERROR[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:    [0m[1;35mCHECK_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mbuf->size - buf->use[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:431[0m[39m-[0m[1;36m439[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:xmlChar *[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:[0m[1;35mxmlBufEnd[0m[1;39m([0m[39mxmlBufPtr buf[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m433[0m[39m:[0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m434[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39m!buf[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_ERROR[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m435[0m[39m:        return NULL;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m436[0m[39m:    [0m[1;35mCHECK_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m437[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m438[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39m&buf->content[0m[1;39m[[0m[39mbuf->use[0m[1;39m][0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m439[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2227[0m[39m-[0m[1;36m2293[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2227[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2228[0m[39m:[0m[1;35mUTF16LEToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2229[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2230[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2231[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2232[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2233[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2234[0m[39m:    unsigned char *outend = out + *outlen;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2235[0m[39m:    unsigned c, d;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2236[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2237[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2238[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2239[0m[39m:        c = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2240[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2241[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2242[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2243[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2244[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2245[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2246[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2247[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2248[0m[39m:            if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2249[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2250[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2251[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2252[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2253[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2254[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2255[0m[39m:            if [0m[1;39m([0m[39moutend - out < [0m[1;36m3[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2256[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2257[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2258[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2259[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2260[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2261[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2262[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2263[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2264[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2265[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2266[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2267[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2268[0m[39m:   [0m[39m    if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2269[0m[39m:   [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2270[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2271[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2272[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2273[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2274[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2275[0m[39m:   [0m[39m    if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2276[0m[39m:   [0m[39m        [0m[39mgoto done;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2277[0m[39m:            c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m2278[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2279[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2280[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2281[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2282[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2283[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2284[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2285[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2286[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2287[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2288[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2289:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2290[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2291[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2292[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2293[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2421[0m[39m-[0m[1;36m2487[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2421[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2422[0m[39m:[0m[1;35mUTF16BEToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2423[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2424[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2425[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2426[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2427[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2428[0m[39m:    unsigned char *outend = out + *outlen;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2429[0m[39m:    unsigned c, d;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2430[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2431[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2432[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2433[0m[39m:        c = [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2434[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2435[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2436[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2437[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2438[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2439[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2440[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2441[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2442[0m[39m:            if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2443[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2444[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2445[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2446[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2447[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2448[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2449[0m[39m:            if [0m[1;39m([0m[39moutend - out < [0m[1;36m3[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2450[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2451[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2452[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2453[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2454[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2455[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2456[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2457[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2458[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2459[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2460[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2461[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2462[0m[39m:   [0m[39m    if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2463[0m[39m:   [0m[39m        [0m[39mbreak;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2464[0m[39m:            d = [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2465[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2466[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2467[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2468[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2469[0m[39m:   [0m[39m    if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2470[0m[39m:   [0m[39m        [0m[39mgoto done;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2471[0m[39m:            c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m2472[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2473[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2474[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2475[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2476[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2477[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2478[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2479[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2480[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2481[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2482[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2483:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2484[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2485[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2486[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2487[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2738[0m[39m-[0m[1;36m2840[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2738[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2739[0m[39m:[0m[1;35mUTF8ToUTF32[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2740[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2741[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2742[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2743[0m[39m:    const unsigned char *inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2744[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2745[0m[39m:    unsigned char *outend;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2746[0m[39m:    unsigned c, d;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2747[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2748[0m[39m:    int i, len;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2749[0m[39m:    [0m[35m/[0m[39m* UTF32 encoding has no BOM *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2750[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mout == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moutlen == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39minlen == NULL[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2751[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_INTERNAL[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2752[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2753[0m[39m:   [0m[39m*outlen = [0m[1;36m0[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2754[0m[39m:   [0m[39m*inlen = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2755[0m[39m:   [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2756[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2757[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2758[0m[39m:    outend = out + [0m[1;39m([0m[39m*outlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2759[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2760[0m[39m:        c = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2761[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2762[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2763[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2764[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2765[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2766[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2767[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2768[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2769[0m[39m:            in += [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2770[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2771[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2772[0m[39m:            unsigned min;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2773[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0xE0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2774[0m[39m:                if [0m[1;39m([0m[39mc < [0m[1;36m0xC2[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2775[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2776[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2777[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2778[0m[39m:                c &= [0m[1;36m0x1F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2779[0m[39m:                len = [0m[1;36m2[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2780[0m[39m:                min = [0m[1;36m0x80[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2781[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0xF0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2782[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2783[0m[39m:                len = [0m[1;36m3[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2784[0m[39m:                min = [0m[1;36m0x800[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2785[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2786[0m[39m:                c &= [0m[1;36m0x0F[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2787[0m[39m:                len = [0m[1;36m4[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2788[0m[39m:                min = [0m[1;36m0x10000[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2789[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2790[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2791[0m[39m:            if [0m[1;39m([0m[39minend - in < len[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2792[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2793[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2794[0m[39m:            for [0m[1;39m([0m[39mi = [0m[1;36m1[0m[39m; i < len; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2795[0m[39m:                if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0xC0[0m[1;39m)[0m[39m != [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2796[0m[39m:                    ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2797[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2798[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2799[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m6[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[39mi[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2800[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2801[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2802[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc < min[0m[1;39m)[0m[39m ||[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2803[0m[39m:                [0m[1;39m([0m[1;39m([0m[39mc >= [0m[1;36m0xD800[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mc <= [0m[1;36m0xDFFF[0m[1;39m)[0m[1;39m)[0m[39m ||[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2804[0m[39m:                [0m[1;39m([0m[39mc > [0m[1;36m0x10FFFF[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2805[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2806[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2807[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2808[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2809[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0x10000[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2810[0m[39m:                if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2811[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2812[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2813[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2814[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2815[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2816[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2817[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2818[0m[39m:                if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2819[0m[39m:                    break;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2820[0m[39m:                c -= [0m[1;36m0x10000[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2821[0m[39m:                d = [0m[1;39m([0m[39mc & [0m[1;36m0x03FF[0m[1;39m)[0m[39m | [0m[1;36m0xDC00[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2822[0m[39m:                c = [0m[1;39m([0m[39mc >> [0m[1;36m10[0m[1;39m)[0m[39m    | [0m[1;36m0xD800[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2823[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2824[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = c >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2825[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = d & [0m[1;36m0xFF[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2826[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = d >> [0m[1;36m8[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2827[0m[39m:                out += [0m[1;36m4[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2828[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2829[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2830[0m[39m:            in += len;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2831[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2832[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2833[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2834[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2835[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2836[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2837[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2838[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2839[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2840[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mparserInternals.[0m[1;92mc:1274[0m[39m-[0m[1;36m1352[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1274[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1275[0m[39m:[0m[1;35mxmlInputSetEncodingHandler[0m[1;39m([0m[39mxmlParserInputPtr input,[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1276[0m[39m:                           xmlCharEncodingHandlerPtr handler[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m1277[0m[39m:    xmlParserInputBufferPtr in;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1278[0m[39m:    xmlBufPtr buf;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1279[0m[39m:    int code = XML_ERR_OK;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1280[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1281[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39minput == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39minput->buf == NULL[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1282[0m[39m:        [0m[1;35mxmlCharEncCloseFunc[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1283[0m[39m:   [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_ARGUMENT[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1284[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1285[0m[39m:    in = input->buf;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1286[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1287[0m[39m:    input->flags |= XML_IN[0m[1;33mPUT[0m[39m_HAS_ENCODING;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1288[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1289[0m[39m:    [0m[35m/[0m[39m*[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1290[0m[39m:     * UTF-[0m[1;36m8[0m[39m requires no encoding handler.[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1291[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1292[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mhandler != NULL[0m[1;39m)[0m[39m &&[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1293[0m[39m:        [0m[1;39m([0m[1;35mxmlStrcasecmp[0m[1;39m([0m[39mBAD_CAST handler->name, BAD_CAST [0m[32m"UTF-8"[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m1294[0m[39m:        [0m[1;35mxmlCharEncCloseFunc[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1295[0m[39m:        handler = NULL;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1296[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1297[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1298[0m[39m:    if [0m[1;39m([0m[39min->encoder == handler[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1299[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_OK[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1300[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1301[0m[39m:    if [0m[1;39m([0m[39min->encoder != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1302[0m[39m:        [0m[35m/[0m[39m*[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1303[0m[39m:         * Switching encodings during parsing is a really bad idea,[0m            [2m                [0m
[2;36m                    [0m         [1;36m1304[0m[39m:         * but Chromium can switch between ISO-[0m[1;36m8859[0m[39m-[0m[1;36m1[0m[39m and UTF-[0m[1;36m16[0m[39m before[0m        [2m                [0m
[2;36m                    [0m         [1;36m1305[0m[39m:         * separate calls to xmlParseChunk.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1306[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1307[0m[39m:         * TODO: We should check whether the [0m[32m"raw"[0m[39m input buffer is empty and[0m   [2m                [0m
[2;36m                    [0m         [1;36m1308[0m[39m:         * convert the old content using the old encoder.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1309[0m[39m:         *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1310[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1311[0m[39m:        [0m[1;35mxmlCharEncCloseFunc[0m[1;39m([0m[39min->encoder[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1312[0m[39m:        in->encoder = handler;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1313[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_OK[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1314[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1315[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1316[0m[39m:    buf = [0m[1;35mxmlBufCreate[0m[1;39m([0m[39mXML_IO_BUFFER_SIZE[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1317[0m[39m:    if [0m[1;39m([0m[39mbuf == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1318[0m[39m:        [0m[1;35mxmlCharEncCloseFunc[0m[1;39m([0m[39mhandler[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1319[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_NO_MEMORY[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1320[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1321[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1322[0m[39m:    in->encoder = handler;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1323[0m[39m:    in->raw = in->buffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1324[0m[39m:    in->buffer = buf;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1325[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1326[0m[39m:    [0m[35m/[0m[39m*[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:     * Is there already some content down the pipe to convert ?[0m                [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:    if [0m[1;39m([0m[39minput->end > input->base[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:        size_t processed;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:        size_t nbchars;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:        int res;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:        [0m[35m/[0m[39m*[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:         * Shrink the current input buffer.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1336[0m[39m:         * Move it as the raw buffer and create a new input buffer[0m             [2m                [0m
[2;36m                    [0m         [1;36m1337[0m[39m:         *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1338[0m[39m:        processed = input->cur - input->base;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m:        [0m[1;35mxmlBufShrink[0m[1;39m([0m[39min->raw, processed[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1340[0m[39m:        input->consumed += processed;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1341[0m[39m:        in->rawconsumed = processed;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1342[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1343[0m[39m:        nbchars = [0m[1;36m4000[0m[39m [0m[35m/[0m[39m* MINLEN *[0m[35m/[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1344[0m[39m:        res = [0m[1;35mxmlCharEncInput[0m[1;39m([0m[39min, &nbchars[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1345[0m[39m:        if [0m[1;39m([0m[39mres < [0m[1;36m0[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1346[0m[39m:            code = in->error;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1347[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1348[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1349[0m[39m:    [0m[1;35mxmlBufResetInput[0m[1;39m([0m[39min->buffer, input[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1350[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mcode[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39minclude/private/io.h:[0m[1;36m16[0m[39m-[0m[1;36m17[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:#define XML_IO_BUFFER_SIZE [0m[1;36m6000[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mparserInternals.[0m[1;92mc:553[0m[39m-[0m[1;36m593[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m553[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m554[0m[39m:[0m[1;35mxmlParserGrow[0m[1;39m([0m[39mxmlParserCtxtPtr ctxt[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m555[0m[39m:    xmlParserInputPtr in = ctxt->input;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:    xmlParserInputBufferPtr buf = in->buf;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:    size_t curEnd = in->end - in->cur;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:    size_t curBase = in->cur - in->base;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:    size_t maxLength = [0m[1;39m([0m[39mctxt->options & XML_PARSE_HUGE[0m[1;39m)[0m[39m ?[0m                       [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:                       XML_MAX_HUGE_LENGTH :[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:                       XML_MAX_LOOKUP_LIMIT;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:    int ret;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:    if [0m[1;39m([0m[39mbuf == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m566[0m[39m:    [0m[35m/[0m[39m* Don't grow push parser buffer. *[0m[35m/[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m567[0m[39m:    if [0m[1;39m([0m[1;35mPARSER_PROGRESSIVE[0m[1;39m([0m[39mctxt[0m[1;39m)[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m568[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m569[0m[39m:    [0m[35m/[0m[39m* Don't grow memory buffers. *[0m[35m/[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m570[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf->encoder == NULL[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mbuf->readcallback == NULL[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m571[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m572[0m[39m:    if [0m[1;39m([0m[39mbuf->error != [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m573[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m574[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m575[0m[39m:    if [0m[1;39m([0m[39mcurBase > maxLength[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m576[0m[39m:        [0m[1;35mxmlFatalErr[0m[1;39m([0m[39mctxt, XML_ERR_RESOURCE_LIMIT,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m577[0m[39m:                    [0m[32m"Buffer size limit exceeded, try XML_PARSE_HUGE\n"[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m578[0m[39m:        [0m[1;35mxmlHaltParser[0m[1;39m([0m[39mctxt[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m579[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m580[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m581[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m582[0m[39m:    if [0m[1;39m([0m[39mcurEnd >= IN[0m[1;33mPUT[0m[39m_CHUNK[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m583[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m584[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m585[0m[39m:    ret = [0m[1;35mxmlParserInputBufferGrow[0m[1;39m([0m[39mbuf, IN[0m[1;33mPUT[0m[39m_CHUNK[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m586[0m[39m:    [0m[1;35mxmlBufUpdateInput[0m[1;39m([0m[39mbuf->buffer, in, curBase[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m587[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m588[0m[39m:    if [0m[1;39m([0m[39mret < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m589[0m[39m:        [0m[1;35mxmlCtxtErrIO[0m[1;39m([0m[39mctxt, buf->error, NULL[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m590[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m591[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m592[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m593[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mxmlIO.[0m[1;92mc:2144[0m[39m-[0m[1;36m2218[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2144[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2145[0m[39m:[0m[1;35mxmlParserInputBufferGrow[0m[1;39m([0m[39mxmlParserInputBufferPtr in, int len[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m2146[0m[39m:    int res = [0m[1;36m0[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2147[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2148[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39min->error[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2149[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2150[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2151[0m[39m:    if [0m[1;39m([0m[39mlen < MINLEN[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2152[0m[39m:        len = MINLEN;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2153[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2154[0m[39m:    [0m[35m/[0m[39m*[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2155[0m[39m:     * Call the read method for this I/O type.[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2156[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2157[0m[39m:    if [0m[1;39m([0m[39min->readcallback != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m2158[0m[39m:        xmlBufPtr buf;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2159[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2160[0m[39m:        if [0m[1;39m([0m[39min->encoder == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2161[0m[39m:            buf = in->buffer;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2162[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2163[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2164[0m[39m:             * Some users only set [0m[32m'encoder'[0m[39m and expect us to create[0m           [2m                [0m
[2;36m                    [0m         [1;36m2165[0m[39m:             * the raw buffer lazily.[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2166[0m[39m:             *[0m[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m2167[0m[39m:            if [0m[1;39m([0m[39min->raw == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2168[0m[39m:                in->raw = [0m[1;35mxmlBufCreate[0m[1;39m([0m[39mXML_IO_BUFFER_SIZE[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2169[0m[39m:                if [0m[1;39m([0m[39min->raw == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2170[0m[39m:                    in->error = XML_ERR_NO_MEMORY;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2171[0m[39m:                    [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2172[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2173[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2174[0m[39m:            buf = in->raw;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2175[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2176[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2177[0m[39m:        if [0m[1;39m([0m[1;35mxmlBufGrow[0m[1;39m([0m[39mbuf, len[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2178[0m[39m:            in->error = XML_ERR_NO_MEMORY;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2179[0m[39m:            [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2180[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2181[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2182[0m[39m:   [0m[39mres = in->[0m[1;35mreadcallback[0m[1;39m([0m[39min->context, [0m[1;39m([0m[39mchar *[0m[1;39m)[0m[1;35mxmlBufEnd[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[39m, len[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m2183[0m[39m:   [0m[39mif [0m[1;39m([0m[39mres <= [0m[1;36m0[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2184[0m[39m:   [0m[39m    in->readcallback = endOfInput;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2185[0m[39m:        if [0m[1;39m([0m[39mres < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2186[0m[39m:            if [0m[1;39m([0m[39mres == [0m[1;36m-1[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2187[0m[39m:                in->error = XML_IO_UNKNOWN;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2188[0m[39m:            else[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2189[0m[39m:                in->error = -res;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2190[0m[39m:            [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2191[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2192[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2193[0m[39m:        if [0m[1;39m([0m[1;35mxmlBufAddLen[0m[1;39m([0m[39mbuf, res[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2194[0m[39m:            in->error = XML_ERR_NO_MEMORY;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2195[0m[39m:            [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2196[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2197[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2198[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2199[0m[39m:    [0m[35m/[0m[39m*[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2200[0m[39m:     * Handle encoding.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2201[0m[39m:     *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m2202[0m[39m:    if [0m[1;39m([0m[39min->encoder != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2203[0m[39m:        size_t sizeOut;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2204[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2205[0m[39m:        [0m[35m/[0m[39m*[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2206[0m[39m:         * Don't convert whole buffer when reading from memory.[0m                [2m                [0m
[2;36m                    [0m         [1;36m2207[0m[39m:         *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2208[0m[39m:        if [0m[1;39m([0m[39min->readcallback == NULL[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2209[0m[39m:            sizeOut = len;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2210[0m[39m:        else[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2211[0m[39m:            sizeOut = SIZE_MAX;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2212[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2213[0m[39m:   [0m[39mif [0m[1;39m([0m[1;35mxmlCharEncInput[0m[1;39m([0m[39min, &sizeOut[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2214[0m[39m:   [0m[39m    [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2215[0m[39m:        res = sizeOut;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2216[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2217[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mres[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2218[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39minclude/private/parser.h:[0m[1;36m69[0m[39m-[0m[1;36m70[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:#define IN[0m[1;33mPUT[0m[39m_CHUNK  [0m[1;36m250[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mxmlIO.[0m[1;92mc:57[0m[39m-[0m[1;36m58[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:#define MINLEN [0m[1;36m4000[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2600[0m[39m-[0m[1;36m2734[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2600[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2601[0m[39m:#if ![0m[1;35mdefined[0m[1;39m([0m[39mLIBXML_ICONV_ENABLED[0m[1;39m)[0m[39m && ![0m[1;35mdefined[0m[1;39m([0m[39mLIBXML_ICU_ENABLED[0m[1;39m)[0m[39m && \[0m        [2m                [0m
[2;36m                    [0m         [1;36m2602[0m[39m:    [0m[1;35mdefined[0m[1;39m([0m[39mLIBXML_ISO8859X_ENABLED[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2603[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2604[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2605[0m[39m:[0m[1;35mUTF8ToISO8859x[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2606[0m[39m:               const unsigned char *in, int *inlen, void *vctxt[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m2607[0m[39m:    const unsigned char *xlattable = vctxt;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2608[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2609[0m[39m:    const unsigned char *inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2610[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2611[0m[39m:    unsigned char *outend;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2612[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2613[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2614[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2615[0m[39m:        [0m[35m/[0m[39m*[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2616[0m[39m:        * initialization nothing to do[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2617[0m[39m:        *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2618[0m[39m:        *outlen = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2619[0m[39m:        *inlen = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2620[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_SUCCESS[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2621[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2622[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2623[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2624[0m[39m:    outend = out + *outlen;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2625[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2626[0m[39m:        unsigned d = *in;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2627[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2628[0m[39m:        if  [0m[1;39m([0m[39md < [0m[1;36m0x80[0m[1;39m)[0m[39m  [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2629[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2630[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2631[0m[39m:            in += [0m[1;36m1[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2632[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39md < [0m[1;36m0xE0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2633[0m[39m:            unsigned c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2634[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2635[0m[39m:            if [0m[1;39m([0m[39minend - in < [0m[1;36m2[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2636[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2637[0m[39m:            c = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2638[0m[39m:            d = d & [0m[1;36m0x1F[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2639[0m[39m:            d = xlattable [0m[1;39m[[0m[1;36m48[0m[39m + c + xlattable [0m[1;39m[[0m[39md[0m[1;39m][0m[39m * [0m[1;36m64[0m[1;39m][0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2640[0m[39m:            if [0m[1;39m([0m[39md == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2641[0m[39m:                [0m[35m/[0m[39m* not in character set *[0m[35m/[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2642[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2643[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2644[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2645[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2646[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2647[0m[39m:            in += [0m[1;36m2[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2648[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39md < [0m[1;36m0xF0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2649[0m[39m:            unsigned c1;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2650[0m[39m:            unsigned c2;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2651[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2652[0m[39m:            if [0m[1;39m([0m[39minend - in < [0m[1;36m3[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2653[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2654[0m[39m:            c1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2655[0m[39m:            c2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m & [0m[1;36m0x3F[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2656[0m[39m:   [0m[39m    d = d & [0m[1;36m0x0F[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2657[0m[39m:   [0m[39m    d = xlattable [0m[1;39m[[0m[1;36m48[0m[39m + c2 + xlattable [0m[1;39m[[0m[1;36m48[0m[39m + c1 +[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2658[0m[39m:   [0m[39m        [0m[39m        [0m[39mxlattable [0m[1;39m[[0m[1;36m32[0m[39m + d[0m[1;39m][0m[39m * [0m[1;36m64[0m[1;39m][0m[39m * [0m[1;36m64[0m[1;39m][0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2659[0m[39m:            if [0m[1;39m([0m[39md == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2660[0m[39m:                [0m[35m/[0m[39m* not in character set *[0m[35m/[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2661[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2662[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2663[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2664[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2665[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2666[0m[39m:            in += [0m[1;36m3[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2667[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2668[0m[39m:            [0m[35m/[0m[39m* cannot transcode >= U+[0m[1;36m010000[0m[39m *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2669[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2670[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2671[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2672[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2673[0m[39m:        *out++ = d;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2674[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2675[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2676[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2677[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2678:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2679[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2680[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2681[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2682[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2683[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2684[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2685[0m[39m:[0m[1;35mISO8859xToUTF8[0m[1;39m([0m[39munsigned char* out, int *outlen,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2686[0m[39m:               const unsigned char* in, int *inlen, void *vctxt[0m[1;39m)[0m[39m [0m[1;39m{[0m             [2m                [0m
[2;36m                    [0m         [1;36m2687[0m[39m:    unsigned short const *unicodetable = vctxt;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2688[0m[39m:    const unsigned char* instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2689[0m[39m:    const unsigned char* inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2690[0m[39m:    unsigned char* outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2691[0m[39m:    unsigned char* outend;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2692[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2693[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2694[0m[39m:    outend = out + *outlen;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2695[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2696[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2697[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2698[0m[39m:        unsigned c = *in;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2699[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2700[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2701[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2702[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2703[0m[39m:            *out++ = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2704[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2705[0m[39m:            c = unicodetable[0m[1;39m[[0m[39mc - [0m[1;36m0x80[0m[1;39m][0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2706[0m[39m:            if [0m[1;39m([0m[39mc == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2707[0m[39m:                [0m[35m/[0m[39m* undefined code point *[0m[35m/[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2708[0m[39m:                ret = XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2709[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2710[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2711[0m[39m:            if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m2712[0m[39m:                if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2713[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2714[0m[39m:                *out++ = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x1F[0m[1;39m)[0m[39m | [0m[1;36m0xC0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2715[0m[39m:                *out++ = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2716[0m[39m:            [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2717[0m[39m:                if [0m[1;39m([0m[39moutend - out < [0m[1;36m3[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2718[0m[39m:                    goto done;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2719[0m[39m:                *out++ = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x0F[0m[1;39m)[0m[39m | [0m[1;36m0xE0[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2720[0m[39m:                *out++ = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2721[0m[39m:                *out++ = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2722[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2723[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2724[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2725[0m[39m:        in += [0m[1;36m1[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2726[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2727[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2728[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2729[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2730:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2731[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2732[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2733[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2734[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mHTMLparser.[0m[1;92mc:3026[0m[39m-[0m[1;36m3042[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m3026[0m[39m:            if [0m[1;39m([0m[39mavail <= [0m[1;36m64[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3027[0m[39m:                if [0m[1;39m([0m[39m!eof[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m3028[0m[39m:                    size_t oldAvail = avail;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m3029[0m[39m:                    size_t off = in - chunk;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m3030[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3031[0m[39m:                    input->cur = in;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m3032[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3033[0m[39m:                    [0m[1;35mxmlParserGrow[0m[1;39m([0m[39mctxt[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m3034[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3035[0m[39m:                    in = input->cur;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m3036[0m[39m:                    chunk = in - off;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m3037[0m[39m:                    input->cur = chunk;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m3038[0m[39m:                    avail = input->end - in;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m3039[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m3040[0m[39m:                    if [0m[1;39m([0m[39moldAvail == avail[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m3041[0m[39m:                        eof = [0m[1;36m1[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m3042[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:100[0m[39m-[0m[1;36m113[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"SHIFT_JIS"[0m[39m, XML_CHAR_ENCODING_SHIFT_JIS [0m[1;39m}[0m[39m,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UCS-2"[0m[39m, XML_CHAR_ENCODING_UCS2 [0m[1;39m}[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UCS-4"[0m[39m, XML_CHAR_ENCODING_UCS4LE [0m[1;39m}[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UCS2"[0m[39m, XML_CHAR_ENCODING_UCS2 [0m[1;39m}[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UCS4"[0m[39m, XML_CHAR_ENCODING_UCS4LE [0m[1;39m}[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"US-ASCII"[0m[39m, XML_CHAR_ENCODING_ASCII [0m[1;39m}[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UTF-16"[0m[39m, XML_CHAR_ENCODING_UTF16 [0m[1;39m}[0m[39m,[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UTF-16BE"[0m[39m, XML_CHAR_ENCODING_UTF16BE [0m[1;39m}[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UTF-16LE"[0m[39m, XML_CHAR_ENCODING_UTF16LE [0m[1;39m}[0m[39m,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UTF-8"[0m[39m, XML_CHAR_ENCODING_UTF8 [0m[1;39m}[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UTF16"[0m[39m, XML_CHAR_ENCODING_UTF16 [0m[1;39m}[0m[39m,[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UTF8"[0m[39m, XML_CHAR_ENCODING_UTF8 [0m[1;39m}[0m[39m,[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:    [0m[1;39m{[0m[39m [0m[32m"UTF-32"[0m[39m, XML_CHAR_ENCODING_UTF32 [0m[1;39m}[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:[0m[1;39m}[0m[39m;[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:243[0m[39m-[0m[1;36m243[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:    [0m[1;35mMAKE_HANDLER[0m[1;39m([0m[32m"UTF-32"[0m[39m, UTF32ToUTF8, UTF8ToUTF32[0m[1;39m)[0m[39m,[0m                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:907[0m[39m-[0m[1;36m935[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m907[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m908[0m[39m:[0m[1;35mxmlLookupCharEncodingHandler[0m[1;39m([0m[39mxmlCharEncoding enc,[0m                               [2m                [0m
[2;36m                    [0m         [1;36m909[0m[39m:                             xmlCharEncodingHandler **out[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m910[0m[39m:    const xmlCharEncodingHandler *handler;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m911[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m912[0m[39m:    if [0m[1;39m([0m[39mout == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m913[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_ARGUMENT[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m914[0m[39m:    *out = NULL;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m915[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m916[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39menc <= [0m[1;36m0[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m enc >= NUM_DEFAULT_HANDLERS[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m917[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_UNSUPPORTED_ENCODING[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m918[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m919[0m[39m:    [0m[35m/[0m[39m* Return NULL handler for UTF-[0m[1;36m8[0m[39m *[0m[35m/[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m920[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39menc == XML_CHAR_ENCODING_UTF8[0m[1;39m)[0m[39m ||[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m921[0m[39m:        [0m[1;39m([0m[39menc == XML_CHAR_ENCODING_NONE[0m[1;39m)[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m922[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_OK[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m923[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m924[0m[39m:    handler = &defaultHandlers[0m[1;39m[[0m[39menc[0m[1;39m][0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m925[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mhandler->input != NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39mhandler->output != NULL[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                [2m                [0m
[2;36m                    [0m         [1;36m926[0m[39m:        *out = [0m[1;39m([0m[39mxmlCharEncodingHandler *[0m[1;39m)[0m[39m handler;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m927[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_OK[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m928[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m929[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m930[0m[39m:    if [0m[1;39m([0m[39mhandler->name != NULL[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m931[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;35mxmlFindExtraHandler[0m[1;39m([0m[39mhandler->name, handler->name, [0m[1;36m0[0m[39m,[0m             [2m                [0m
[2;36m                    [0m         [1;36m932[0m[39m:                                   NULL, NULL, out[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m933[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m934[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mXML_ERR_UNSUPPORTED_ENCODING[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m935[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39minclude/libxml/encoding.h:[0m[1;36m78[0m[39m-[0m[1;36m78[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[33mXML_CHAR_ENCODING_UTF32[0m[39m=    [0m[1;36m31[0m[39m [0m[35m/[0m[39m* UTF32 native *[0m[35m/[0m                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:328[0m[39m-[0m[1;36m329[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:    [0m[39m    [0m[1;35mreturn[0m[1;39m([0m[39mXML_CHAR_ENCODING_UTF32[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mparserInternals.[0m[1;92mc:1449[0m[39m-[0m[1;36m1452[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1449[0m[39m:            [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[1;36m0x00[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m == [0m[1;36m0xfe[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m == [0m[1;36m0xff[0m[1;39m)[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1450[0m[39m:                enc = XML_CHAR_ENCODING_UTF32;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1451[0m[39m:                autoFlag = XML_CHAR_ENCODING_UTF32;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1452[0m[39m:                bomSize = [0m[1;36m4[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:388[0m[39m-[0m[1;36m402[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:[0m[1;35mxmlBufGrow[0m[1;39m([0m[39mxmlBufPtr buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_ERROR[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_STATIC[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:    [0m[1;35mCHECK_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:    if [0m[1;39m([0m[39mlen <= buf->size - buf->use[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:    if [0m[1;39m([0m[1;35mxmlBufGrowInternal[0m[1;39m([0m[39mbuf, len[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:    [0m[1;35mUPDATE_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:452[0m[39m-[0m[1;36m463[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m452[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m453[0m[39m:[0m[1;35mxmlBufAddLen[0m[1;39m([0m[39mxmlBufPtr buf, size_t len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m454[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_ERROR[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[39m || [0m[1;39m([0m[1;35mBUF_STATIC[0m[1;39m([0m[39mbuf[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m455[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m456[0m[39m:    [0m[1;35mCHECK_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m457[0m[39m:    if [0m[1;39m([0m[39mlen > buf->size - buf->use[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m458[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m459[0m[39m:    buf->use += len;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m460[0m[39m:    buf->content[0m[1;39m[[0m[39mbuf->use[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m461[0m[39m:    [0m[1;35mUPDATE_COMPAT[0m[1;39m([0m[39mbuf[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m462[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m463[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2842[0m[39m-[0m[1;36m2919[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2842[0m[39m:int[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2843[0m[39m:[0m[1;35mUTF32ToUTF8[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2844[0m[39m:              const unsigned char *in, int *inlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2845[0m[39m:              void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2846[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2847[0m[39m:    const unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m2848[0m[39m:    unsigned char *outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2849[0m[39m:    unsigned long int b0, b1, b2, b3, c, d;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2850[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2851[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2852[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m != [0m[1;36m0x20[0m[1;39m)[0m[39m && [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m != [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x20[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m2853[0m[39m:        [0m[35m/[0m[39m* bom is managed already *[0m[35m/[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2854[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2855[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2856[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2857[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2858[0m[39m:        b0 = in[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2859[0m[39m:        b1 = in[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2860[0m[39m:        b1 = [0m[1;39m([0m[39mb1 << [0m[1;36m0x8[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2861[0m[39m:        b2 = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2862[0m[39m:        b2 = [0m[1;39m([0m[39mb2 << [0m[1;36m0x10[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2863[0m[39m:        b3 = in[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2864[0m[39m:        b3 = [0m[1;39m([0m[39mb3 << [0m[1;36m0x18[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2865[0m[39m:        c = b0 | b1 | b2 | b3;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2866[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2867[0m[39m:        if [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2868[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2869[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2870[0m[39m:            out += [0m[1;36m1[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2871[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[39mc < [0m[1;36m0x800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2872[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m   | [0m[1;36m0xC0[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2873[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2874[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2875[0m[39m:            out += [0m[1;36m2[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2876[0m[39m:        [0m[1;39m}[0m[39m else if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xF800[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2877[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m         | [0m[1;36m0xE0[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2878[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2879[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2880[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2881[0m[39m:            out += [0m[1;36m3[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2882[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2883[0m[39m:            [0m[35m/[0m[39m* Surrogate pair *[0m[35m/[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2884[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39mc & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xD800[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2885[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2886[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2887[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2888[0m[39m:   [0m[39m        if [0m[1;39m([0m[39minend - in < [0m[1;36m4[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2889[0m[39m:   [0m[39m        [0m[39m        break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2890[0m[39m:            d = in[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2891[0m[39m:            if [0m[1;39m([0m[1;39m([0m[39md & [0m[1;36m0xFC00[0m[1;39m)[0m[39m != [0m[1;36m0xDC00[0m[1;39m)[0m[39m [0m[1;39m{[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m2892[0m[39m:                ret = XML_ERR_INTERNAL_ERROR;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2893[0m[39m:                break;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2894[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2895[0m[39m:            [0m[35m/[0m[39m*[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2896[0m[39m:                simplified due to encoding errors encountered with:[0m            [2m                [0m
[2;36m                    [0m         [1;36m2897[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2898[0m[39m:                c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m2899[0m[39m:                out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2900[0m[39m:                out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2901[0m[39m:                out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2902[0m[39m:                out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m2903[0m[39m:            *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2904[0m[39m:            out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c & [0m[1;36m0xff[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2905[0m[39m:            out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m8[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m2906[0m[39m:            out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x10[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2907[0m[39m:            out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m = [0m[1;39m([0m[39mc >> [0m[1;36m0x18[0m[1;39m)[0m[39m & [0m[1;36m0xff[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m2908[0m[39m:            in += [0m[1;36m4[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2909[0m[39m:            out += [0m[1;36m4[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2910[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2911[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2912[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2913[0m[39m:    if [0m[1;39m([0m[39min-instart > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2914[0m[39m:        ret = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2915[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2916[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2917[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2918[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2919[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2013[0m[39m-[0m[1;36m2055[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2013[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;92m2014:a[0m[1;35msciiToAscii[0m[1;39m([0m[39munsigned char* out, int *poutlen,[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m2015[0m[39m:             const unsigned char* in, int *pinlen,[0m                             [2m                [0m
[2;36m                    [0m         [1;36m2016[0m[39m:             void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2017[0m[39m:    const unsigned char *inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2018[0m[39m:    const unsigned char *instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2019[0m[39m:    int inlen, outlen, ret;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2020[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2021[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2022[0m[39m:        *pinlen = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2023[0m[39m:        *poutlen = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2024[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_SUCCESS[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2025[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2026[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2027[0m[39m:    inlen = *pinlen;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2028[0m[39m:    outlen = *poutlen;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2029[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2030[0m[39m:    if [0m[1;39m([0m[39moutlen < inlen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2031[0m[39m:        inlen = outlen;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2032[0m[39m:        ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2033[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2034[0m[39m:        ret = inlen;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2035[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2036[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2037[0m[39m:    inend = in + inlen;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2038[0m[39m:    *poutlen = inlen;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2039[0m[39m:    *pinlen = inlen;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2040[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2041[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2042[0m[39m:   [0m[39munsigned c = *in;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2043[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2044[0m[39m:        if [0m[1;39m([0m[39mc >= [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2045[0m[39m:   [0m[39m    *poutlen = in - instart;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2046[0m[39m:   [0m[39m    *pinlen = in - instart;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2047[0m[39m:   [0m[39m    [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_IN[0m[1;33mPUT[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2048[0m[39m:   [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m2049[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2050[0m[39m:        in++;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2051[0m[39m:   [0m[39m*out++ = c;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2052[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2053[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2054[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2055[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2120[0m[39m-[0m[1;36m2146[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2120[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2121[0m[39m:[0m[1;35mUTF8ToUTF8[0m[1;39m([0m[39munsigned char* out, int *outlen,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m2122[0m[39m:           const unsigned char* in, int *inlen,[0m                                [2m                [0m
[2;36m                    [0m         [1;36m2123[0m[39m:           void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m2124[0m[39m:    int len;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2125[0m[39m:    int ret;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2126[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2127[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m2128[0m[39m:        *inlen = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m2129[0m[39m:        *outlen = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2130[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_SUCCESS[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m2131[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2132[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2133[0m[39m:    if [0m[1;39m([0m[39m*outlen < *inlen[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2134[0m[39m:   [0m[39mlen = *outlen;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2135[0m[39m:        ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2136[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m2137[0m[39m:   [0m[39mlen = *inlen;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2138[0m[39m:        ret = len;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2139[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2140[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2141[0m[39m:    [0m[1;35mmemcpy[0m[1;39m([0m[39mout, in, len[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2142[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2143[0m[39m:    *outlen = len;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2144[0m[39m:    *inlen = len;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m2145[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2146[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:2057[0m[39m-[0m[1;36m2096[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m2057[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m2058[0m[39m:[0m[1;35mlatin1ToUTF8[0m[1;39m([0m[39munsigned char* out, int *outlen,[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2059[0m[39m:             const unsigned char* in, int *inlen,[0m                              [2m                [0m
[2;36m                    [0m         [1;36m2060[0m[39m:             void *vctxt ATTRIBUTE_UNUSED[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2061[0m[39m:    unsigned char* outstart = out;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m2062[0m[39m:    const unsigned char* instart = in;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m2063[0m[39m:    unsigned char* outend;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2064[0m[39m:    const unsigned char* inend;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2065[0m[39m:    int ret = XML_ENC_ERR_SPACE;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2066[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2067[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mout == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39moutlen == NULL[0m[1;39m)[0m[39m || [0m[1;39m([0m[39minlen == NULL[0m[1;39m)[0m[1;39m)[0m  [2m                [0m
[2;36m                    [0m         [1;36m2068[0m[39m:   [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_INTERNAL[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2069[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2070[0m[39m:    outend = out + *outlen;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m2071[0m[39m:    inend = in + *inlen;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2072[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2073[0m[39m:    while [0m[1;39m([0m[39min < inend[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m2074[0m[39m:        unsigned c = *in;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2075[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2076[0m[39m:   [0m[39mif [0m[1;39m([0m[39mc < [0m[1;36m0x80[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m2077[0m[39m:            if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m2078[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2079[0m[39m:            *out++ = c;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m2080[0m[39m:   [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m2081[0m[39m:            if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m2082[0m[39m:                goto done;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2083[0m[39m:   [0m[39m    *out++ = [0m[1;39m([0m[39mc >> [0m[1;36m6[0m[1;39m)[0m[39m | [0m[1;36m0xC0[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m2084[0m[39m:            *out++ = [0m[1;39m([0m[39mc & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m2085[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m2086[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2087[0m[39m:        in++;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m2088[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2089[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m2090[0m[39m:    ret = out - outstart;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m2091[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;92m2092:d[0m[39mone:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m2093[0m[39m:    *outlen = out - outstart;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m2094[0m[39m:    *inlen = in - instart;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2095[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m2096[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:1664[0m[39m-[0m[1;36m1693[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1664[0m[39m:[0m[1;35mxmlCharEncInFunc[0m[1;39m([0m[39mxmlCharEncodingHandler * handler, xmlBufferPtr out,[0m           [2m                [0m
[2;36m                    [0m         [1;36m1665[0m[39m:                 xmlBufferPtr in[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1666[0m[39m:[0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m1667[0m[39m:    int ret;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1668[0m[39m:    int written;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1669[0m[39m:    int toconv;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m1670[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1671[0m[39m:    if [0m[1;39m([0m[39mhandler == NULL[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1672[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_INTERNAL[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1673[0m[39m:    if [0m[1;39m([0m[39mout == NULL[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1674[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_INTERNAL[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1675[0m[39m:    if [0m[1;39m([0m[39min == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1676[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_INTERNAL[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1677[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1678[0m[39m:    toconv = in->use;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1679[0m[39m:    if [0m[1;39m([0m[39mtoconv == [0m[1;36m0[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1680[0m[39m:        return [0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1681[0m[39m:    written = out->size - out->use [0m[1;36m-1[0m[39m; [0m[35m/[0m[39m* count [0m[32m'\0'[0m[39m *[0m[35m/[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1682[0m[39m:    if [0m[1;39m([0m[39mtoconv * [0m[1;36m2[0m[39m >= written[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1683[0m[39m:        [0m[1;35mxmlBufferGrow[0m[1;39m([0m[39mout, out->size + toconv * [0m[1;36m2[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1684[0m[39m:        written = out->size - out->use - [0m[1;36m1[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1685[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m1686[0m[39m:    ret = [0m[1;35mxmlEncInputChunk[0m[1;39m([0m[39mhandler, &out->content[0m[1;39m[[0m[39mout->use[0m[1;39m][0m[39m, &written,[0m         [2m                [0m
[2;36m                    [0m         [1;36m1687[0m[39m:                           in->content, &toconv[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1688[0m[39m:    [0m[1;35mxmlBufferShrink[0m[1;39m([0m[39min, toconv[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1689[0m[39m:    out->use += written;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1690[0m[39m:    out->content[0m[1;39m[[0m[39mout->use[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1691[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1692[0m[39m:    return [0m[1;39m([0m[39mwritten? written : ret[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1693[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:957[0m[39m-[0m[1;36m1001[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:[0m[1;35mxmlBufferGrow[0m[1;39m([0m[39mxmlBufferPtr buf, unsigned int len[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m959[0m[39m:    unsigned int size;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m960[0m[39m:    xmlChar *newbuf;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m961[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m962[0m[39m:    if [0m[1;39m([0m[39mbuf == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:    if [0m[1;39m([0m[39mlen < buf->size - buf->use[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:    if [0m[1;39m([0m[39mlen >= INT_MAX - buf->use[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:    if [0m[1;39m([0m[39mbuf->size > [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:        if [0m[1;39m([0m[39mbuf->size <= INT_MAX [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:            size = buf->size * [0m[1;36m2[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:            size = INT_MAX;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:        size = buf->use + len + [0m[1;36m1[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:        if [0m[1;39m([0m[39msize <= INT_MAX - [0m[1;36m100[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:            size += [0m[1;36m100[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf->alloc == XML_BUFFER_ALLOC_IO[0m[1;39m)[0m[39m &&[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:        [0m[1;39m([0m[39mbuf->content != buf->contentIO[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:        newbuf = [0m[1;35mxmlMalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:        if [0m[1;39m([0m[39mnewbuf == NULL[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:            [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:        if [0m[1;39m([0m[39mbuf->content != NULL[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:            [0m[1;35mmemcpy[0m[1;39m([0m[39mnewbuf, buf->content, buf->use + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:        [0m[1;35mxmlFree[0m[1;39m([0m[39mbuf->contentIO[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m989[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m990[0m[39m:        newbuf = [0m[1;35mxmlRealloc[0m[1;39m([0m[39mbuf->content, size[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m991[0m[39m:        if [0m[1;39m([0m[39mnewbuf == NULL[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m:            [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m993[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m994[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m995[0m[39m:    if [0m[1;39m([0m[39mbuf->alloc == XML_BUFFER_ALLOC_IO[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m996[0m[39m:        buf->contentIO = newbuf;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m997[0m[39m:    buf->content = newbuf;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m998[0m[39m:    buf->size = size;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m999[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m1000[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mbuf->size - buf->use - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mbuf.[0m[1;92mc:957[0m[39m-[0m[1;36m1001[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m957[0m[39m:int[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m958[0m[39m:[0m[1;35mxmlBufferGrow[0m[1;39m([0m[39mxmlBufferPtr buf, unsigned int len[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m959[0m[39m:    unsigned int size;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m960[0m[39m:    xmlChar *newbuf;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m961[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m962[0m[39m:    if [0m[1;39m([0m[39mbuf == NULL[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m963[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m964[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m965[0m[39m:    if [0m[1;39m([0m[39mlen < buf->size - buf->use[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m966[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m967[0m[39m:    if [0m[1;39m([0m[39mlen >= INT_MAX - buf->use[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m968[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m969[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m970[0m[39m:    if [0m[1;39m([0m[39mbuf->size > [0m[1;39m([0m[39msize_t[0m[1;39m)[0m[39m len[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m971[0m[39m:        if [0m[1;39m([0m[39mbuf->size <= INT_MAX [0m[35m/[0m[39m [0m[1;36m2[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m972[0m[39m:            size = buf->size * [0m[1;36m2[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m973[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m974[0m[39m:            size = INT_MAX;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m975[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m976[0m[39m:        size = buf->use + len + [0m[1;36m1[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m977[0m[39m:        if [0m[1;39m([0m[39msize <= INT_MAX - [0m[1;36m100[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m978[0m[39m:            size += [0m[1;36m100[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m979[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m980[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m981[0m[39m:    if [0m[1;39m([0m[1;39m([0m[39mbuf->alloc == XML_BUFFER_ALLOC_IO[0m[1;39m)[0m[39m &&[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m982[0m[39m:        [0m[1;39m([0m[39mbuf->content != buf->contentIO[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m983[0m[39m:        newbuf = [0m[1;35mxmlMalloc[0m[1;39m([0m[39msize[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m984[0m[39m:        if [0m[1;39m([0m[39mnewbuf == NULL[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m985[0m[39m:            [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m986[0m[39m:        if [0m[1;39m([0m[39mbuf->content != NULL[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m987[0m[39m:            [0m[1;35mmemcpy[0m[1;39m([0m[39mnewbuf, buf->content, buf->use + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m988[0m[39m:        [0m[1;35mxmlFree[0m[1;39m([0m[39mbuf->contentIO[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m989[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m990[0m[39m:        newbuf = [0m[1;35mxmlRealloc[0m[1;39m([0m[39mbuf->content, size[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m991[0m[39m:        if [0m[1;39m([0m[39mnewbuf == NULL[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m992[0m[39m:            [0m[1;35mreturn[0m[1;39m([0m[1;36m-1[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m993[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m994[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m995[0m[39m:    if [0m[1;39m([0m[39mbuf->alloc == XML_BUFFER_ALLOC_IO[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m996[0m[39m:        buf->contentIO = newbuf;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m997[0m[39m:    buf->content = newbuf;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m998[0m[39m:    buf->size = size;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m999[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m1000[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mbuf->size - buf->use - [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1001[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mtestapi.[0m[1;92mc:7973[0m[39m-[0m[1;36m7996[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7973[0m[39m:static int[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m7974[0m[39m:[0m[1;35mtest_UTF32ToUTF8[0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m7975[0m[39m:    int test_ret = [0m[1;36m0[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7976[0m[39m:    char* test_str = [0m[32m"AAAA"[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m7977[0m[39m:    int [0m[33min_len[0m[39m=[0m[1;35mstrlen[0m[1;39m([0m[39mtest_str[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m7978[0m[39m:    int [0m[33mout_len[0m[39m=[0m[1;36m1024[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7979[0m[39m:    unsigned char* outb1 = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m,[0m[1;36m1024[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m7980[0m[39m:    char* outb2 = [0m[1;35mcalloc[0m[1;39m([0m[1;36m1[0m[39m,[0m[1;36m1024[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m7981[0m[39m:    int r = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7982[0m[39m:    r = [0m[1;35mUTF8ToUTF32[0m[1;39m([0m[39moutb1, &out_len, [0m[1;39m([0m[39munsigned char*[0m[1;39m)[0m[39mtest_str, &in_len, NULL[0m[1;39m)[0m[39m;[0m [2m                [0m
[2;36m                    [0m         [1;36m7983[0m[39m:    if [0m[1;39m([0m[33mout_len[0m[39m==[0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7984[0m[39m:        test_ret++;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7985[0m[39m:        in_len = [0m[1;36m0[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7986[0m[39m:    [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m7987[0m[39m:        in_len = out_len;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m7988[0m[39m:    [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m7989[0m[39m:    out_len = [0m[1;36m1024[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7990[0m[39m:    r = [0m[1;35mUTF32ToUTF8[0m[1;39m([0m[1;39m([0m[39munsigned char*[0m[1;39m)[0m[39moutb2, &out_len, outb1, &in_len, NULL[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m7991[0m[39m:    if [0m[1;39m([0m[33mout_len[0m[39m==[0m[1;36m0[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7992[0m[39m:        test_ret++;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7993[0m[39m:    [0m[1;35mfree[0m[1;39m([0m[39moutb1[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m7994[0m[39m:    [0m[1;35mfree[0m[1;39m([0m[39moutb2[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m7995[0m[39m:    [0m[1;35mreturn[0m[1;39m([0m[39mtest_ret[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m7996[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39minclude/libxml/encoding.h:[0m[1;36m31[0m[39m-[0m[1;36m37[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:    XML_ENC_ERR_SUCCESS     =  [0m[1;36m0[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    XML_ENC_ERR_INTERNAL    = [0m[1;36m-1[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    XML_ENC_ERR_IN[0m[1;33mPUT[0m[39m       = [0m[1;36m-2[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    XML_ENC_ERR_SPACE       = [0m[1;36m-3[0m[39m,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:    XML_ENC_ERR_MEMORY      = [0m[1;36m-4[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:[0m[1;39m}[0m[39m xmlCharEncError;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39minclude/libxml/encoding.h:[0m[1;36m82[0m[39m-[0m[1;36m96[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m: * xmlCharEncodingInputFunc:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m: * @out:  a pointer to an array of bytes to store the UTF-[0m[1;36m8[0m[39m result[0m               [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m: * @outlen:  the length of @out[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m: * @in:  a pointer to an array of chars in the original encoding[0m                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m: * @inlen:  the length of @in[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m: * Convert characters to UTF-[0m[1;36m8[0m[39m.[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m: * On success, the value of @inlen after return is the number of[0m                 [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m: * bytes consumed and @outlen is the number of bytes produced.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m: *[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m: * Returns the number of bytes written or an XML_ENC_ERR code.[0m                   [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m: *[0m[35m/[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:typedef int [0m[1;39m([0m[39m*xmlCharEncodingInputFunc[0m[1;39m)[0m[1;39m([0m[39munsigned char *out, int *outlen,[0m         [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:                                        const unsigned char *in, int *inlen[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfuzz/html.[0m[1;92mc:26[0m[39m-[0m[1;36m52[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst char *data, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                          [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:    xmlParserCtxtPtr ctxt;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    htmlDocPtr doc;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    const char *docBuffer;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:    size_t failurePos, docSize;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:    int opts;[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:    [0m[1;35mxmlFuzzDataInit[0m[1;39m([0m[39mdata, size[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:    opts = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m [0m[1;35mxmlFuzzReadInt[0m[1;39m([0m[1;36m4[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:    failurePos = [0m[1;35mxmlFuzzReadInt[0m[1;39m([0m[1;36m4[0m[1;39m)[0m[39m % [0m[1;39m([0m[39msize + [0m[1;36m100[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:    docBuffer = [0m[1;35mxmlFuzzReadRemaining[0m[1;39m([0m[39m&docSize[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    if [0m[1;39m([0m[39mdocBuffer == NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:        [0m[1;35mxmlFuzzDataCleanup[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:        [0m[1;35mreturn[0m[1;39m([0m[1;36m0[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[39m* Pull parser *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    [0m[1;35mxmlFuzzInjectFailure[0m[1;39m([0m[39mfailurePos[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    ctxt = [0m[1;35mhtmlNewParserCtxt[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    if [0m[1;39m([0m[39mctxt != NULL[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        [0m[1;35mxmlCtxtSetErrorHandler[0m[1;39m([0m[39mctxt, xmlFuzzSErrorFunc, NULL[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        doc = [0m[1;35mhtmlCtxtReadMemory[0m[1;39m([0m[39mctxt, docBuffer, docSize, NULL, NULL, opts[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        [0m[1;35mxmlFuzzCheckFailureReport[0m[1;39m([0m[32m"htmlCtxtReadMemory"[0m[39m,[0m                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:                                  ctxt->errNo == XML_ERR_NO_MEMORY,[0m              [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:                                  ctxt->errNo == XML_IO_EIO[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mencoding.[0m[1;92mc:1622[0m[39m-[0m[1;36m1639[0m                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mret != XML_ENC_ERR_SUCCESS[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mret != XML_ENC_ERR_SPACE[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m      [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:            input->error = [0m[1;35mxmlEncConvertError[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:            [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mcompleteOut[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mcompleteIn[0m[1;39m)[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:            break;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mcompleteOut[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mret == XML_ENC_ERR_SPACE[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:            break;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:        if [0m[1;39m([0m[1;39m([0m[39mcompleteIn[0m[1;39m)[0m[39m && [0m[1;39m([0m[39mret == XML_ENC_ERR_SUCCESS[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:            break;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:        if [0m[1;39m([0m[39mret == XML_ENC_ERR_SPACE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:            if [0m[1;39m([0m[1;35mxmlBufGrow[0m[1;39m([0m[39mout, [0m[1;36m4096[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:                input->error = XML_ERR_NO_MEMORY;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:                [0m[1;35mreturn[0m[1;39m([0m[39mXML_ENC_ERR_MEMORY[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:            [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m1639[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause and developed a comprehensive fix strategy.[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe `UTF32ToUTF8` function in `encoding.c` [0m[1;39m([0m[39mlines [0m[1;36m2842[0m[39m-[0m[1;36m2919[0m[1;39m)[0m[39m has a critical [0m        [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow vulnerability caused by:[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Missing boundary checks**: Unlike all other encoding conversion functions in [0m  [2m                [0m
[2;36m                    [0m         [39mthe codebase [0m[1;39m([0m[39mUTF16LEToUTF8, UTF16BEToUTF8, latin1ToUTF8, ISO8859xToUTF8, etc.[0m[1;39m)[0m[39m, [0m   [2m                [0m
[2;36m                    [0m         [39m`UTF32ToUTF8` never checks if there's sufficient space in the output buffer before [0m [2m                [0m
[2;36m                    [0m         [39mwriting.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **No outend calculation**: The function doesn't calculate `outend = out + [0m       [2m                [0m
[2;36m                    [0m         [39m*outlen` at the beginning, which is the standard pattern used throughout the [0m       [2m                [0m
[2;36m                    [0m         [39mcodebase.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Additional bugs identified**:[0m                                                  [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m2847[0m[39m: Incorrect input alignment mask [0m[1;39m([0m[39m`& ~[0m[1;36m1[0m[39m` instead of `& ~[0m[1;36m3[0m[39m` for [0m[1;36m4[0m[39m-byte[0m [2m                [0m
[2;36m                    [0m         [39mUTF-[0m[1;36m32[0m[1;39m)[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   - Lines [0m[1;36m2904[0m[39m-[0m[1;36m2907[0m[39m: Incorrect surrogate pair handling [0m[1;39m([0m[39mraw byte copying instead [0m  [2m                [0m
[2;36m                    [0m         [39mof proper UTF-[0m[1;36m8[0m[39m encoding[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - Line [0m[1;36m2890[0m[39m: Incorrect surrogate pair reading [0m[1;39m([0m[39mreads [0m[1;36m2[0m[39m bytes instead of [0m[1;36m4[0m[1;39m)[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Critical Code Locations[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe overflow occurs at line [0m[1;36m2868[0m[39m: `out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = c;` when writing without checking [0m      [2m                [0m
[2;36m                    [0m         [39mboundaries. Similar unchecked writes occur at:[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m2872[0m[39m-[0m[1;36m2873[0m[39m [0m[1;39m([0m[1;36m2[0m[39m-byte write[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m2877[0m[39m-[0m[1;36m2879[0m[39m [0m[1;39m([0m[1;36m3[0m[39m-byte write[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m2904[0m[39m-[0m[1;36m2907[0m[39m [0m[1;39m([0m[1;36m4[0m[39m-byte write for surrogate pairs[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Fix Strategy[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must be applied to `encoding.c` starting from the initial codebase, [0m        [2m                [0m
[2;36m                    [0m         [39mspecifically the `UTF32ToUTF8` function [0m[1;39m([0m[39mlines [0m[1;36m2842[0m[39m-[0m[1;36m2919[0m[1;39m)[0m[39m.[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m1[0m[39m: Add outend calculation and boundary checks[0m                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mFollowing the pattern established by `UTF16LEToUTF8` [0m[1;39m([0m[39mlines [0m[1;36m2227[0m[39m-[0m[1;36m2293[0m[1;39m)[0m[39m and [0m         [2m                [0m
[2;36m                    [0m         [39m`UTF16BEToUTF8` [0m[1;39m([0m[39mlines [0m[1;36m2421[0m[39m-[0m[1;36m2487[0m[1;39m)[0m[39m:[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. After line [0m[1;36m2848[0m[39m [0m[1;39m([0m[39mafter `unsigned char *outstart = out;`[0m[1;39m)[0m[39m, add:[0m                   [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   unsigned char *outend = out + *outlen;[0m                                           [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Before line [0m[1;36m2868[0m[39m [0m[1;39m([0m[39mthe [0m[1;36m1[0m[39m-byte write for c < [0m[1;36m0x80[0m[1;39m)[0m[39m, add:[0m                           [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39mout >= outend[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [39m       goto done;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Before line [0m[1;36m2872[0m[39m [0m[1;39m([0m[39mthe [0m[1;36m2[0m[39m-byte write for c < [0m[1;36m0x800[0m[1;39m)[0m[39m, add:[0m                          [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39moutend - out < [0m[1;36m2[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m       goto done;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Before line [0m[1;36m2877[0m[39m [0m[1;39m([0m[39mthe [0m[1;36m3[0m[39m-byte write for non-surrogate characters[0m[1;39m)[0m[39m, add:[0m           [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39moutend - out < [0m[1;36m3[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m       goto done;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Before line [0m[1;36m2904[0m[39m [0m[1;39m([0m[39mthe surrogate pair handling[0m[1;39m)[0m[39m, add:[0m                             [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39moutend - out < [0m[1;36m4[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [39m       goto done;[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m2[0m[39m: Fix the surrogate pair handling[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace lines [0m[1;36m2890[0m[39m and [0m[1;36m2904[0m[39m-[0m[1;36m2907[0m[39m with the correct implementation [0m[1;39m([0m[39musing the [0m        [2m                [0m
[2;36m                    [0m         [39mcommented-out formula at lines [0m[1;36m2898[0m[39m-[0m[1;36m2902[0m[1;39m)[0m[39m:[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Line [0m[1;36m2890[0m[39m should read [0m[1;36m4[0m[39m bytes for the low surrogate [0m[1;39m([0m[39mfor UTF-32LE byte order[0m[1;39m)[0m[39m:[0m   [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   d = in[0m[1;39m[[0m[1;36m4[0m[1;39m][0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m5[0m[1;39m][0m[39m << [0m[1;36m8[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m << [0m[1;36m16[0m[1;39m)[0m[39m | [0m[1;39m([0m[39min[0m[1;39m[[0m[1;36m7[0m[1;39m][0m[39m << [0m[1;36m24[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Lines [0m[1;36m2904[0m[39m-[0m[1;36m2907[0m[39m should use proper UTF-[0m[1;36m8[0m[39m encoding instead of raw byte copying:[0m    [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   c = [0m[1;39m([0m[39mc << [0m[1;36m10[0m[1;39m)[0m[39m + d - [0m[1;39m([0m[1;39m([0m[1;36m0xD800[0m[39m << [0m[1;36m10[0m[1;39m)[0m[39m + [0m[1;36m0xDC00[0m[39m - [0m[1;36m0x10000[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m   out[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc >> [0m[1;36m18[0m[1;39m)[0m[39m         | [0m[1;36m0xF0[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   out[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >> [0m[1;36m12[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   out[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[1;39m([0m[1;39m([0m[39mc >>  [0m[1;36m6[0m[1;39m)[0m[39m & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   out[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m =  [0m[1;39m([0m[39mc        & [0m[1;36m0x3F[0m[1;39m)[0m[39m | [0m[1;36m0x80[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Line [0m[1;36m2908[0m[39m should increment input by [0m[1;36m8[0m[39m bytes [0m[1;39m([0m[39mtwo UTF-[0m[1;36m32[0m[39m characters[0m[1;39m)[0m[39m:[0m             [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   in += [0m[1;36m8[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Line [0m[1;36m2888[0m[39m check should verify [0m[1;36m8[0m[39m bytes available:[0m                                 [2m                [0m
[2;36m                    [0m         [39m   ```c[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m   if [0m[1;39m([0m[39minend - in < [0m[1;36m8[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m       break;[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   ```[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m3[0m[39m: Fix input alignment mask[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mChange line [0m[1;36m2847[0m[39m from:[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mconst unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m1[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mto:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mconst unsigned char *inend = in + [0m[1;39m([0m[39m*inlen & ~[0m[1;36m3[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures proper [0m[1;36m4[0m[39m-byte alignment for UTF-[0m[1;36m32[0m[39m encoding.[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m4[0m[39m: Add done label and cleanup[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter line [0m[1;36m2911[0m[39m [0m[1;39m([0m[39mafter the while loop closing brace[0m[1;39m)[0m[39m, add a `done:` label before [0m   [2m                [0m
[2;36m                    [0m         [39mthe existing return logic:[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mdone:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    *outlen = out - outstart;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    *inlen = in - instart;[0m                                                          [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mreturn[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mReplace the existing lines [0m[1;36m2913[0m[39m-[0m[1;36m2918[0m[39m with this single done block to ensure [0m         [2m                [0m
[2;36m                    [0m         [39mconsistent cleanup whether exiting normally or via boundary check.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### Step [0m[1;36m5[0m[39m: Adjust return value logic[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe return value calculation at lines [0m[1;36m2913[0m[39m-[0m[1;36m2914[0m[39m should be moved into the done [0m      [2m                [0m
[2;36m                    [0m         [39mblock. When exiting due to insufficient space, `ret` should remain [0m                 [2m                [0m
[2;36m                    [0m         [39m`XML_ENC_ERR_SPACE` [0m[1;39m([0m[39minitialized at line [0m[1;36m2850[0m[1;39m)[0m[39m. Only set `ret = out - outstart` [0m    [2m                [0m
[2;36m                    [0m         [39mwhen the loop completes successfully [0m[1;39m([0m[39mall input consumed[0m[1;39m)[0m[39m.[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd before the done label:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39min >= inend[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m    ret = out - outstart;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Justification[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why this is the optimal approach:**[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Follows established patterns**: The fix replicates the boundary-checking [0m      [2m                [0m
[2;36m                    [0m         [39mpattern used successfully in UTF16LEToUTF8, UTF16BEToUTF8, latin1ToUTF8, and [0m       [2m                [0m
[2;36m                    [0m         [39mISO8859xToUTF8 functions. This ensures consistency with the codebase.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserves existing logic**: The fix adds safety checks without changing the [0m   [2m                [0m
[2;36m                    [0m         [39mfundamental conversion logic, ensuring existing valid conversions continue to work.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Addresses the encoding contract**: The function will now properly return [0m      [2m                [0m
[2;36m                    [0m         [39mXML_ENC_ERR_SPACE when output buffer is full, allowing the caller [0m[1;39m([0m[39mxmlCharEncInput[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mto grow the buffer and retry [0m[1;39m([0m[39mas shown in encoding.c lines [0m[1;36m1634[0m[39m-[0m[1;36m1639[0m[1;39m)[0m[39m.[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Fixes multiple bugs**: Beyond the buffer overflow, the fix corrects the [0m       [2m                [0m
[2;36m                    [0m         [39msurrogate pair handling and input alignment issues, making the function fully [0m      [2m                [0m
[2;36m                    [0m         [39mcompliant with UTF-[0m[1;36m32[0m[39m/UTF-[0m[1;36m8[0m[39m specifications.[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **No impact on fuzzing or tests**: The fix is entirely within the encoding [0m      [2m                [0m
[2;36m                    [0m         [39mfunction and doesn't modify harness code, fuzzing logic, or test infrastructure. It[0m [2m                [0m
[2;36m                    [0m         [39msupports the same API and fulfills the encoding conversion contract.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How it preserves existing codebase logic:**[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- The conversion algorithm remains the same for valid inputs with sufficient buffer[0m [2m                [0m
[2;36m                    [0m         [39mspace[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m- The function signature and API contract are unchanged[0m                             [2m                [0m
[2;36m                    [0m         [39m- The buffer management infrastructure [0m[1;39m([0m[39mxmlBufGrow, xmlCharEncInput[0m[1;39m)[0m[39m already [0m       [2m                [0m
[2;36m                    [0m         [39mhandles XML_ENC_ERR_SPACE correctly[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- Existing tests will continue to pass as they use sufficiently large buffers[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**How it addresses the evaluation report issues:**[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Prevents the [0m[1;36m1[0m[39m-byte write at address [0m[1;36m0x523000003471[0m[39m [0m[1;39m([0m[39mline [0m[1;36m2868[0m[1;39m)[0m[39m by checking `if [0m  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mout >= outend[0m[1;39m)[0m[39m` before writing[0m                                                     [2m                [0m
[2;36m                    [0m         [39m- Prevents all other potential overflows at lines [0m[1;36m2872[0m[39m-[0m[1;36m2873[0m[39m, [0m[1;36m2877[0m[39m-[0m[1;36m2879[0m[39m, and [0m        [2m                [0m
[2;36m                    [0m         [1;36m2904[0m[39m-[0m[1;36m2907[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m- Returns XML_ENC_ERR_SPACE to allow buffer growth when needed[0m                      [2m                [0m
[2;36m                    [0m         [39m- Correctly handles the [0m[1;36m6001[0m[39m-byte allocation scenario by respecting the *outlen [0m    [2m                [0m
[2;36m                    [0m         [39mparameter[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential side effects and mitigation:**[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Performance**: Additional boundary checks add minimal overhead [0m[1;39m([0m[39msimple pointer [0m [2m                [0m
[2;36m                    [0m         [39mcomparisons[0m[1;39m)[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m- **Backward compatibility**: Functions that previously [0m[32m"succeeded"[0m[39m by overflowing [0m [2m                [0m
[2;36m                    [0m         [39mwill now return XML_ENC_ERR_SPACE, but this is the correct behavior per the API [0m    [2m                [0m
[2;36m                    [0m         [39mcontract[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- **Buffer growth**: The caller's buffer growth mechanism [0m[1;39m([0m[39mxmlCharEncInput[0m[1;39m)[0m[39m will [0m   [2m                [0m
[2;36m                    [0m         [39mhandle space errors transparently[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Similar solutions in the codebase:**[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix directly mirrors the implementations in:[0m                                    [2m                [0m
[2;36m                    [0m         [39m- `UTF16LEToUTF8` [0m[1;39m([0m[39mencoding.[0m[1;92mc:2227[0m[39m-[0m[1;36m2293[0m[1;39m)[0m[39m - lines [0m[1;36m2234[0m[39m, [0m[1;36m2242[0m[39m, [0m[1;36m2248[0m[39m, [0m[1;36m2255[0m[39m, [0m[1;36m2275[0m       [2m                [0m
[2;36m                    [0m         [39m- `UTF16BEToUTF8` [0m[1;39m([0m[39mencoding.[0m[1;92mc:2421[0m[39m-[0m[1;36m2487[0m[1;39m)[0m[39m - lines [0m[1;36m2428[0m[39m, [0m[1;36m2436[0m[39m, [0m[1;36m2442[0m[39m, [0m[1;36m2449[0m[39m, [0m[1;36m2469[0m       [2m                [0m
[2;36m                    [0m         [39m- `latin1ToUTF8` [0m[1;39m([0m[39mencoding.[0m[1;92mc:2057[0m[39m-[0m[1;36m2096[0m[1;39m)[0m[39m - lines [0m[1;36m2070[0m[39m, [0m[1;36m2077[0m[39m, [0m[1;36m2081[0m                    [2m                [0m
[2;36m                    [0m         [39m- `ISO8859xToUTF8` [0m[1;39m([0m[39mencoding.[0m[1;92mc:2684[0m[39m-[0m[1;36m2734[0m[1;39m)[0m[39m - lines [0m[1;36m2694[0m[39m, [0m[1;36m2701[0m[39m, [0m[1;36m2712[0m[39m, [0m[1;36m2717[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll these functions demonstrate the same boundary-checking pattern that UTF32ToUTF8[0m [2m                [0m
[2;36m                    [0m         [39mmust adopt.[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=405665;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=680488;file:///home/qqor/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=987328;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=839489;file:///home/qqor/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmphyfizjdz[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/qqor/crete/reports/prism.prism_claude_sonnet_4_5/libxml2_lx-delta-03_vuln_004/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768273421.9754894[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/libxml2_lx-delta-03_vuln_004.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/qqor/crete/.cache/[0m[95mofficial-afc-libxml2[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 03:03:44][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/qqor/crete/.cache/environments/[0m[95mlibxml2[0m        ]8;id=425756;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=12360;file:///home/qqor/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=280504;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=152851;file:///home/qqor/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mlibxml2[0m               [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=263099;file:///home/qqor/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=359964;file:///home/qqor/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/qqor/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mlibxml2[0m                [2m               [0m
