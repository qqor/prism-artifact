--- a/src/reformat.c
+++ b/src/reformat.c
@@ -771,14 +771,25 @@
                     spill_Cb = AVIF_CLAMP(Cb - AVIF_CLAMP(Cb,minCb,maxCb),0.0f,1.0f);
 
                     // now we have generated the spill, get it's neigbors
-                    int adjCol = (i%2) ? -1 : 1;
-                    int adjRow = (j%2) ? -1 : 1;
-                    // check the bounds
-                    if (i + adjCol >= image->width){
+                    int adjCol, adjRow;
+                    if ((i == 0) || (i == (image->width - 1))) {
                         adjCol = 0;
-                    }
-                    if (j + adjRow >= image->height){
+                    } else {
+                        if ((i % 2) != 0) {
+                            adjCol = 1;
+                        } else {
+                            adjCol = -1;
+                        }
+                    }
+
+                    if ((j == 0) || (j == (image->height - 1))) {
                         adjRow = 0;
+                    } else {
+                        if ((j % 2) != 0) {
+                            adjRow = 1;
+                        } else {
+                            adjRow = -1;
+                        }
                     }
                     float pSpillCb = spill_Cb/3;
                     float pSpillCr = spill_Cr/3;
@@ -797,15 +808,24 @@
                     // if spill too high, dampen
                     if ((image->height * image->width) >= 0x1000 && total_spill > ((image->height * image->width) * 3.8f)){
                         int a, b;
-                        if (i % 2 == 0){
-                            a = 1;
-                        }else{
-                            a = -1;
-                        }
-                        if (j % 2 == 0){
-                            b = 1;
-                        }else{
-                            b = -1;
+                        if ((i == 0) || (i == (image->width - 1))) {
+                            a = 0;
+                        } else {
+                            if ((i % 2) == 0) {
+                                a = 1;
+                            } else {
+                                a = -1;
+                            }
+                        }
+
+                        if ((j == 0) || (j == (image->height - 1))) {
+                            b = 0;
+                        } else {
+                            if ((j % 2) == 0) {
+                                b = 1;
+                            } else {
+                                b = -1;
+                            }
                         }
                         uspill_image[i][j] -= pSpillCb;
                         vspill_image[i][j] -= pSpillCb;
