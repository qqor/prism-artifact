--- a/libexif/exif-data.c
+++ b/libexif/exif-data.c
@@ -921,6 +921,11 @@
 		d++;
 		ds--;
 		len = (((unsigned int)d[0]) << 8) | d[1];
+		if (len > ds) {
+			exif_log (data->priv->log, EXIF_LOG_CODE_CORRUPT_DATA,
+				  "ExifData", _("APP1 segment size (%u) exceeds available data (%u)."), len, ds);
+			return;
+		}
 		exif_log (data->priv->log, EXIF_LOG_CODE_DEBUG, "ExifData",
 			  "We have to deal with %i byte(s) of EXIF data.",
 			  len);
