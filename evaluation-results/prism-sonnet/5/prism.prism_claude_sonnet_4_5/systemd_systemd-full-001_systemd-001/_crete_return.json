{
  "project_name": "systemd",
  "vulnerability_identifier": "systemd_systemd-full-001_systemd-001",
  "source_directory": "/home/user/crete/.cache/official-afc-systemd",
  "llm_usage": {
    "total_cost": 3.0847739999999995,
    "prompt_tokens": 859783,
    "completion_tokens": 33695
  },
  "variant": "sound",
  "diff": "--- a/src/udev/udev-rules.c\n+++ b/src/udev/udev-rules.c\n@@ -1169,7 +1169,7 @@\n         if (str[pos] != '\"')\n                 return -EINVAL;\n         \n-        m = str + is_escaped + is_case_insensitive + is_prefix_match;\n+        m = str + pos;\n \n         if (!is_escaped) {\n                 /* unescape double quotation '\\\"'->'\"' */\n@@ -1184,6 +1184,14 @@\n                  * The return value must be terminated by two subsequent NULs\n                  * so it could be safely interpreted as nulstr.\n                  */\n+                /* Verify we have space for terminators before the closing quote */\n+                if (is_prefix_match) {\n+                        if (j + 2 > i)\n+                                return -EINVAL;\n+                } else {\n+                        if (j + 1 > i)\n+                                return -EINVAL;\n+                }\n                 if (is_prefix_match){\n                         j[0] = '*';\n                         j[1] = '\\0';\n@@ -1215,6 +1223,14 @@\n                 * The return value must be terminated by two subsequent NULs\n                 * so it could be safely interpreted as nulstr.\n                 */\n+                /* Verify we have space for the unescaped content and terminators */\n+                if (is_prefix_match) {\n+                        if (str + pos + l + 1 > i)\n+                                return -EINVAL;\n+                } else {\n+                        if (m + l + 1 > i)\n+                                return -EINVAL;\n+                }\n                 if (is_prefix_match){\n                         /* need more room to make rule glob match */\n                         memcpy(str + pos - 1, unescaped, l + 1);\n",
  "stdout": "",
  "stderr": ""
}