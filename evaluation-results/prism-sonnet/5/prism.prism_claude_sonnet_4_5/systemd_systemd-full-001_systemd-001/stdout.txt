[2;36m[01/13/26 07:25:12][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=4920;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=487958;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp3kywn7cw[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/systemd_systemd-full-001_syst[0m [2m               [0m
[2;36m                    [0m         [35memd-001/[0m[95magent-output-1768289112.4592223[0m                                              [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/systemd_systemd-full-001_systemd-[1;36m001.[0mtoml           [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-systemd[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Building Cached for CLEAN environment[1m)[0m           ]8;id=840077;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=561399;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m[01/13/26 07:26:54][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Building Cached for CLEAN environment[1m)[0m Took     ]8;id=380021;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=618832;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m102.31[0m seconds; [33mexception[0m=[3;91mFalse[0m                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=198088;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=905260;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running tests for Cached for CLEAN environment[1m)[0m ]8;id=460323;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=224566;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=483250;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=166663;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m102[0m[1m)[0m                                                         [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=681399;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=315027;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:26:55][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.98[0m seconds;               ]8;id=574341;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=953976;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 07:26:57][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=554153;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=450975;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=978095;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=412068;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=624756;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=640994;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=105447;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=194291;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:26:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m1.33[0m seconds;               ]8;id=711156;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=846252;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=126733;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=991045;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:27:00][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m1.00[0m seconds;               ]8;id=897417;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=907105;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 07:27:03][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=80658;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=742984;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-udev-rule-parse-value                                                 [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m  [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3942423992[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd66a920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7feffd681ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555c7db664e8[0m[39m, [0m[1;36m0x555c7db67ad7[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd681ab8[0m[39m,[0m[1;36m0x7feffd7f33e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555c7db67ad8[0m[39m,[0m[1;36m0x555c7db7d9c8[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555c7d9c61b3[0m[39m bp [0m[1;36m0x7ffedda38030[0m[39m sp [0m[1;36m0x7ffedda38028[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9c61b2[0m[39m in udev_rule_parse_value [0m                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50fe[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555c7d8ec8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsi[0m [2m                [0m
[2;36m                    [0m         [39mgned char const*, unsigned long[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9858cf[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50aa[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in [0m                     [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value[0m                                                               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpn3r1absz[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m[39m-udev-rule-parse-value[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3942423992[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd66a920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7feffd681ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555c7db664e8[0m[39m, [0m[1;36m0x555c7db67ad7[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd681ab8[0m[39m,[0m[1;36m0x7feffd7f33e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555c7db67ad8[0m[39m,[0m[1;36m0x555c7db7d9c8[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555c7d9c61b3[0m[39m bp [0m[1;36m0x7ffedda38030[0m[39m sp [0m[1;36m0x7ffedda38028[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9c61b2[0m[39m in udev_rule_parse_value [0m                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50fe[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555c7d8ec8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsi[0m [2m                [0m
[2;36m                    [0m         [39mgned char const*, unsigned long[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9858cf[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50aa[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in [0m                     [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value[0m                                                               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x502000000080[0m: fa fa [1;36m06[0m fa fa fa [1;36m06[0m fa fa fa[1m[[0m[1;36m07[0m[1m][0mfa fa fa [1;36m02[0m fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000100[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m           [1;36m0x502000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                   [2m                [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                [2m                [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                       [2m                [0m
[2;36m                    [0m           Heap left redzone:       fa                                                       [2m                [0m
[2;36m                    [0m           Freed heap region:       fd                                                       [2m                [0m
[2;36m                    [0m           Stack left redzone:      f1                                                       [2m                [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                       [2m                [0m
[2;36m                    [0m           Stack right redzone:     f3                                                       [2m                [0m
[2;36m                    [0m           Stack after return:      f5                                                       [2m                [0m
[2;36m                    [0m           Stack use after scope:   f8                                                       [2m                [0m
[2;36m                    [0m           Global redzone:          f9                                                       [2m                [0m
[2;36m                    [0m           Global init order:       f6                                                       [2m                [0m
[2;36m                    [0m           Poisoned by user:        f7                                                       [2m                [0m
[2;36m                    [0m           Container overflow:      fc                                                       [2m                [0m
[2;36m                    [0m           Array cookie:            ac                                                       [2m                [0m
[2;36m                    [0m           Intra object redzone:    bb                                                       [2m                [0m
[2;36m                    [0m           ASan internal:           fe                                                       [2m                [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                       [2m                [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                       [2m                [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                      [2m                [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                               [2m                [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64 [2m                [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                    [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m:[35m/[0m[95mout[0m -v       [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpn3r1absz[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce     [2m                [0m
[2;36m                    [0m         fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m.                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 07:27:20][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=613063;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=248005;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 07:32:34][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=495484;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=345399;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 07:33:11][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=891469;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=351294;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=159412;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=974691;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:33:12][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m1.05[0m seconds;               ]8;id=608951;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=954054;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Patching[1m)[0m Started[33m...[0m                             ]8;id=440438;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=112078;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmp2rlce88l[0m                                                 ]8;id=915856;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=465048;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 07:34:59][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Patching[1m)[0m Took [1;36m107.26[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=631769;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=879909;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Checking build[1m)[0m Started[33m...[0m                       ]8;id=128541;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=196717;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:35:11][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Checking build[1m)[0m Took [1;36m11.47[0m seconds;             ]8;id=60316;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=190618;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running PoV[1m)[0m Started[33m...[0m                          ]8;id=586950;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=179857;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:35:13][0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=299271;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=265751;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#102\[2m102[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-udev-rule-parse-value                                                  [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                          [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m   [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m137775214[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff620920[0m[39m, [0m     [2m               [0m
[2;36m                    [0m         [1;36m0x7f76ff637ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555f08d274e8[0m[39m, [0m[1;36m0x555f08d28ad7[0m[1;39m)[0m[39m, [0m                             [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff637ab8[0m[39m,[0m[1;36m0x7f76ff7a93e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555f08d28ad8[0m[39m,[0m[1;36m0x555f08d3e9c8[0m[1;39m)[0m[39m, [0m                                                    [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                  [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x555f08b871b3[0m[39m bp [0m[1;36m0x7ffd3c6efd30[0m[39m sp [0m[1;36m0x7ffd3c6efd28[0m                                   [2m               [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                          [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b871b2[0m[39m in udev_rule_parse_value [0m                                      [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                          [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860fe[0m[39m in LLVMFuzzerTestOneInput [0m                                     [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m            [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555f08aad8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m               [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b468cf[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860aa[0m[39m in LLVMFuzzerTestOneInput [0m                                     [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m             [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in udev_rule_parse_value[0m [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x502000000080[0m: fa fa [1;36m06[0m fa fa fa [1;36m06[0m fa fa fa[1m[[0m[1;36m07[0m[1m][0mfa fa fa [1;36m02[0m fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000100[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m:[35m/[0m[95mout[0m -v        [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpdvkbzrwu[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m.                                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[1;31mERROR   [0m PoV found:                                                                           ]8;id=715140;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=499758;file:///home/user/crete/packages/crete/framework/evaluator/services/default/__init__.py#103\[2m103[0m]8;;\
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-udev-rule-parse-value                                                  [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                          [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m   [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m137775214[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff620920[0m[39m, [0m     [2m               [0m
[2;36m                    [0m         [1;36m0x7f76ff637ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555f08d274e8[0m[39m, [0m[1;36m0x555f08d28ad7[0m[1;39m)[0m[39m, [0m                             [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff637ab8[0m[39m,[0m[1;36m0x7f76ff7a93e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555f08d28ad8[0m[39m,[0m[1;36m0x555f08d3e9c8[0m[1;39m)[0m[39m, [0m                                                    [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                  [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x555f08b871b3[0m[39m bp [0m[1;36m0x7ffd3c6efd30[0m[39m sp [0m[1;36m0x7ffd3c6efd28[0m                                   [2m               [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                          [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b871b2[0m[39m in udev_rule_parse_value [0m                                      [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                          [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860fe[0m[39m in LLVMFuzzerTestOneInput [0m                                     [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m            [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555f08aad8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m               [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b468cf[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860aa[0m[39m in LLVMFuzzerTestOneInput [0m                                     [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m             [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in udev_rule_parse_value[0m [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x502000000080[0m: fa fa [1;36m06[0m fa fa fa [1;36m06[0m fa fa fa[1m[[0m[1;36m07[0m[1m][0mfa fa fa [1;36m02[0m fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000100[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m:[35m/[0m[95mout[0m -v        [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpdvkbzrwu[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m.                                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [31m╭─[0m[31m──────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m───────────────────────[0m[31m─╮[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/evaluator/services/default/[0m[1m__init__.py[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m :97 in _evaluate_internal                                                        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 94 [0m[2m│   │   [0m[94mwith[0m logging_performance(context, header=[33m"[0m[33mRunning PoV[0m[33m"[0m):           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 95 [0m[2m│   │   │   [0m[94mtry[0m:                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 96 [0m[2m│   │   │   │   [0m[94mif[0m [96mlen[0m(detection.blobs) > [94m0[0m:                               [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 97 [2m│   │   │   │   │   [0menvironment.run_pov(context, detection)                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 98 [0m[2m│   │   │   │   [0m[94melse[0m:                                                      [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 99 [0m[2m│   │   │   │   │   [0mcontext[[33m"[0m[33mlogger[0m[33m"[0m].warning([33m"[0m[33mNo blob data found for the [0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m100 [0m                                                                           [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mcached.p[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1my[0m:56 in run_pov                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 53 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, detection: Detection            [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 54 [0m[2m│   [0m) -> [96mtuple[0m[[96mstr[0m, [96mstr[0m]:                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 55 [0m[2m│   │   [0m[94massert[0m [96mlen[0m(detection.blobs) > [94m0[0m, [33m"[0m[33mAt least one blob is required[0m[33m"[0m   [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m 56 [2m│   │   [0m[94mreturn[0m [1;4;96mself[0m[1;4m.environment.run_pov(context, detection)[0m                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 57 [0m[2m│   [0m                                                                       [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 58 [0m[2m│   [0m[94mdef[0m[90m [0m[92mrun_tests[0m(                                                         [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m 59 [0m[2m│   │   [0m[96mself[0m, context: EnvironmentContext, env: [96mdict[0m[[96mstr[0m, [96mstr[0m] = {}        [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [2m/home/user/crete/packages/crete/framework/environment/services/oss_fuzz/[0m[1mdefault.[0m [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [1mpy[0m:210 in run_pov                                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m                                                                                  [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m207 [0m[2m│   │   │   │   [0mcontext, blobinfo.blob, blobinfo.harness_name              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m208 [0m[2m│   │   │   [0m)                                                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m209 [0m[2m│   │   │   [0m[94mif[0m [95mnot[0m success:                                                [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m [31m❱ [0m210 [2m│   │   │   │   [0m[1;4;94mraise[0m[1;4m ChallengePoVFoundError([0m                              [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m211 [0m[2m│   │   │   │   │   [0m[1;4mstdout=stdout.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m212 [0m[2m│   │   │   │   │   [0m[1;4mstderr=stderr.encode(errors=[0m[1;4;33m"[0m[1;4;33mignore[0m[1;4;33m"[0m[1;4m),[0m                 [31m│[0m [2m               [0m
[2;36m                    [0m         [31m│[0m   [2m213 [0m[2m│   │   │   │   [0m[1;4m)[0m                                                          [31m│[0m [2m               [0m
[2;36m                    [0m         [31m╰──────────────────────────────────────────────────────────────────────────────────╯[0m [2m               [0m
[2;36m                    [0m         [1;91mChallengePoVFoundError: [0mPoV found:                                                   [2m               [0m
[2;36m                    [0m         - Stdout:                                                                            [2m               [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-udev-rule-parse-value                                                  [2m               [0m
[2;36m                    [0m         + shift                                                                              [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                            [2m               [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                 [2m               [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                 [2m               [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                        [2m               [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                    [2m               [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                           [2m               [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                          [2m               [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                 [2m               [0m
[2;36m                    [0m         + run_fuzzer fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                          [2m               [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                                [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m   [2m               [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                      [2m               [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                              [2m               [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m137775214[0m                                                                [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff620920[0m[39m, [0m     [2m               [0m
[2;36m                    [0m         [1;36m0x7f76ff637ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555f08d274e8[0m[39m, [0m[1;36m0x555f08d28ad7[0m[1;39m)[0m[39m, [0m                             [2m               [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff637ab8[0m[39m,[0m[1;36m0x7f76ff7a93e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m  [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555f08d28ad8[0m[39m,[0m[1;36m0x555f08d3e9c8[0m[1;39m)[0m[39m, [0m                                                    [2m               [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                  [2m               [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                   [2m               [0m
[2;36m                    [0m         [39m=================================================================[0m                    [2m               [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc [0m [2m               [0m
[2;36m                    [0m         [1;36m0x555f08b871b3[0m[39m bp [0m[1;36m0x7ffd3c6efd30[0m[39m sp [0m[1;36m0x7ffd3c6efd28[0m                                   [2m               [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                          [2m               [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b871b2[0m[39m in udev_rule_parse_value [0m                                      [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                          [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860fe[0m[39m in LLVMFuzzerTestOneInput [0m                                     [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m            [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555f08aad8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m            [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m               [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                               [2m               [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                      [2m               [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                         [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b468cf[0m[39m in malloc [0m                                                     [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                    [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860aa[0m[39m in LLVMFuzzerTestOneInput [0m                                     [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m             [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m      [2m               [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m  [2m               [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m                [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m  [2m               [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                             [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                      [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                       [2m               [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                        [2m               [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m[1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m [2m               [0m
[2;36m                    [0m         [1;39m([0m[39mBuildId: 5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                  [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                        [2m               [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsign[0m [2m               [0m
[2;36m                    [0m         [39med char const*, unsigned long[0m[1;39m)[0m                                                       [2m               [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                     [2m               [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in udev_rule_parse_value[0m [2m               [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                               [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                    [2m               [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                    [2m               [0m
[2;36m                    [0m         [39m=[0m[1m>[0m[1;36m0x502000000080[0m: fa fa [1;36m06[0m fa fa fa [1;36m06[0m fa fa fa[1m[[0m[1;36m07[0m[1m][0mfa fa fa [1;36m02[0m fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000100[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000180[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000200[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000280[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m           [1;36m0x502000000300[0m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa                    [2m               [0m
[2;36m                    [0m         Shadow byte legend [1m([0mone shadow byte represents [1;36m8[0m application bytes[1m)[0m:                 [2m               [0m
[2;36m                    [0m           Addressable:           [1;36m00[0m                                                          [2m               [0m
[2;36m                    [0m           Partially addressable: [1;36m01[0m [1;36m02[0m [1;36m03[0m [1;36m04[0m [1;36m05[0m [1;36m06[0m [1;36m07[0m                                        [2m               [0m
[2;36m                    [0m           Heap left redzone:       fa                                                        [2m               [0m
[2;36m                    [0m           Freed heap region:       fd                                                        [2m               [0m
[2;36m                    [0m           Stack left redzone:      f1                                                        [2m               [0m
[2;36m                    [0m           Stack mid redzone:       f2                                                        [2m               [0m
[2;36m                    [0m           Stack right redzone:     f3                                                        [2m               [0m
[2;36m                    [0m           Stack after return:      f5                                                        [2m               [0m
[2;36m                    [0m           Stack use after scope:   f8                                                        [2m               [0m
[2;36m                    [0m           Global redzone:          f9                                                        [2m               [0m
[2;36m                    [0m           Global init order:       f6                                                        [2m               [0m
[2;36m                    [0m           Poisoned by user:        f7                                                        [2m               [0m
[2;36m                    [0m           Container overflow:      fc                                                        [2m               [0m
[2;36m                    [0m           Array cookie:            ac                                                        [2m               [0m
[2;36m                    [0m           Intra object redzone:    bb                                                        [2m               [0m
[2;36m                    [0m           ASan internal:           fe                                                        [2m               [0m
[2;36m                    [0m           Left alloca redzone:     ca                                                        [2m               [0m
[2;36m                    [0m           Right alloca redzone:    cb                                                        [2m               [0m
[2;36m                    [0m         ==[1;36m18[0m==ABORTING                                                                       [2m               [0m
[2;36m                    [0m         subprocess command returned a non-zero exit status: [1;36m1[0m                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m         - Stderr:                                                                            [2m               [0m
[2;36m                    [0m         INFO:__main__:Running: docker run --privileged --shm-[33msize[0m=[35m2g[0m --platform linux/amd64  [2m               [0m
[2;36m                    [0m         --rm -i -e [33mHELPER[0m=[3;92mTrue[0m -e [33mARCHITECTURE[0m=[35mx86_64[0m -v                                     [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m:[35m/[0m[95mout[0m -v        [2m               [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpdvkbzrwu[0m:[35m/[0m[95mtestcase[0m -t ghcr.io/aixcc-finals/base-runner:v1.[1;36m3.0[0m reproduce      [2m               [0m
[2;36m                    [0m         fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m.                                                [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running PoV[1m)[0m Took [1;36m2.53[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=770064;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=832150;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=700737;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=229326;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:35:14][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.97[0m seconds;               ]8;id=588588;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=379111;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 07:35:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=190713;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=813126;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:35:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m1.00[0m seconds;               ]8;id=1499;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=351542;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 07:35:18][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=956994;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=186699;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/udev/udev-rules.c                                                         [2m                [0m
[2;36m                    [0m         +++ b/src/udev/udev-rules.c                                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-1336[0m,[1;36m9[0m +[1;36m1336[0m,[1;36m11[0m @@                                                              [2m                [0m
[2;36m                    [0m                  if [1m([0m[1;35misempty[0m[1m([0mline_str[1m)[0m[1m)[0m                                                     [2m                [0m
[2;36m                    [0m                          return [1;36m0[0m;                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -        line = [1;35mstrdup[0m[1m([0mline_str[1m)[0m;                                                   [2m                [0m
[2;36m                    [0m         +        size_t line_len = [1;35mstrlen[0m[1m([0mline_str[1m)[0m;                                        [2m                [0m
[2;36m                    [0m         +        line = [1;35mmalloc[0m[1m([0mline_len + [1;36m1[0m + [1;36m3[0m[1m)[0m;                                           [2m                [0m
[2;36m                    [0m                  if [1m([0m!line[1m)[0m                                                                 [2m                [0m
[2;36m                    [0m                          return [1;35mlog_oom[0m[1m([0m[1m)[0m;                                                  [2m                [0m
[2;36m                    [0m         +        [1;35mmemcpy[0m[1m([0mline, line_str, line_len + [1;36m1[0m[1m)[0m;                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  rule_line = [1;35mnew[0m[1m([0mUdevRuleLine, [1;36m1[0m[1m)[0m;                                          [2m                [0m
[2;36m                    [0m                  if [1m([0m!rule_line[1m)[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-udev-rule-parse-value                                                 [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m  [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m137775214[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff620920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7f76ff637ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555f08d274e8[0m[39m, [0m[1;36m0x555f08d28ad7[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff637ab8[0m[39m,[0m[1;36m0x7f76ff7a93e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555f08d28ad8[0m[39m,[0m[1;36m0x555f08d3e9c8[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555f08b871b3[0m[39m bp [0m[1;36m0x7ffd3c6efd30[0m[39m sp [0m[1;36m0x7ffd3c6efd28[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b871b2[0m[39m in udev_rule_parse_value [0m                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860fe[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555f08aad8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsi[0m [2m                [0m
[2;36m                    [0m         [39mgned char const*, unsigned long[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b468cf[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860aa[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in [0m                     [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value[0m                                                               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpdvkbzrwu[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m[39m-udev-rule-parse-value[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3942423992[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd66a920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7feffd681ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555c7db664e8[0m[39m, [0m[1;36m0x555c7db67ad7[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd681ab8[0m[39m,[0m[1;36m0x7feffd7f33e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555c7db67ad8[0m[39m,[0m[1;36m0x555c7db7d9c8[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555c7d9c61b3[0m[39m bp [0m[1;36m0x7ffedda38030[0m[39m sp [0m[1;36m0x7ffedda38028[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9c61b2[0m[39m in udev_rule_parse_value [0m                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50fe[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555c7d8ec8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsi[0m [2m                [0m
[2;36m                    [0m         [39mgned char const*, unsigned long[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9858cf[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50aa[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in [0m                     [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value[0m                                                               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpn3r1absz[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA heap-buffer-overflow vulnerability has been detected in the systemd udev rule [0m    [2m                [0m
[2;36m                    [0m         [39mparser. The AddressSanitizer [0m[1;39m([0m[39mASAN[0m[1;39m)[0m[39m identified a [0m[1;36m1[0m[39m-byte write operation that [0m       [2m                [0m
[2;36m                    [0m         [39mexceeds the bounds of a [0m[1;36m7[0m[39m-byte heap-allocated buffer at address [0m[1;36m0x5020000000d7[0m[39m. The[0m [2m                [0m
[2;36m                    [0m         [39moverflow occurs in the `udev_rule_parse_value` function at line [0m[1;36m1223[0m[39m of [0m            [2m                [0m
[2;36m                    [0m         [39m`src/udev/udev-rules.c` during fuzzing with the `fuzz-udev-rule-parse-value` test [0m  [2m                [0m
[2;36m                    [0m         [39mharness.[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe issue manifests as a heap-buffer-overflow vulnerability discovered during [0m      [2m                [0m
[2;36m                    [0m         [39mfuzzing operations. Specifically:[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Vulnerability Type**: Heap-buffer-overflow [0m[1;39m([0m[39mwrite operation[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [39m- SCARINESS score: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [39m- A write operation of size [0m[1;36m1[0m[39m byte occurs at memory address [0m[1;36m0x5020000000d7[0m          [2m                [0m
[2;36m                    [0m         [39m- This address is located [0m[1;36m0[0m[39m bytes after a [0m[1;36m7[0m[39m-byte region allocated at [0m               [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m, [0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Stack Trace Analysis**:[0m                                                           [2m                [0m
[2;36m                    [0m         [39mThe error originates from the following call chain:[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. `udev_rule_parse_value` in [0m                                                      [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m` - The actual location[0m [2m                [0m
[2;36m                    [0m         [39mwhere the overflow write occurs[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. `LLVMFuzzerTestOneInput` in [0m                                                     [2m                [0m
[2;36m                    [0m         [39m`[0m[35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m[39m` - The [0m  [2m                [0m
[2;36m                    [0m         [39mfuzzer harness entry point that calls the vulnerable function[0m                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Standard fuzzer execution functions in the libfuzzer framework[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Memory Allocation Details**:[0m                                                      [2m                [0m
[2;36m                    [0m         [39m- The [0m[1;36m7[0m[39m-byte buffer was allocated via `malloc` in the fuzzer harness at [0m            [2m                [0m
[2;36m                    [0m         [39m`fuzz-udev-rule-parse-value.[0m[1;92mc:18:9[0m[39m`[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- The shadow byte representation shows the buffer is marked with `[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39m`, indicating[0m [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m bytes are partially addressable[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- The overflow occurs immediately after this [0m[1;36m7[0m[39m-byte region[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Key Observations**:[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The vulnerability is triggered during parsing of udev rule values[0m                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The buffer size appears to be insufficient for the data being written[0m            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The overflow is deterministic and reproducible with the provided testcase[0m        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The fuzzer was configured with: libfuzzer engine, [0m[1;36m100[0m[39m runs, 2560MB RSS limit, [0m   [2m                [0m
[2;36m                    [0m         [39mand [0m[1;36m25[0m[39m-second timeout[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Areas for Investigation**:[0m                                                        [2m                [0m
[2;36m                    [0m         [39mTo understand the complete scope of this issue, the following codebase components [0m  [2m                [0m
[2;36m                    [0m         [39mshould be examined:[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Primary Source**: `src/udev/udev-rules.c` around line [0m[1;36m1223[0m[39m where [0m              [2m                [0m
[2;36m                    [0m         [39m`udev_rule_parse_value` performs the buffer write operation[0m                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Function Context**: The entire `udev_rule_parse_value` function to understand [0m [2m                [0m
[2;36m                    [0m         [39mits buffer allocation and boundary checking logic[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Caller Analysis**: How `udev_rule_parse_value` is invoked and what data flows [0m [2m                [0m
[2;36m                    [0m         [39minto it[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Buffer Management**: Memory allocation patterns and size calculations that [0m    [2m                [0m
[2;36m                    [0m         [39mdetermine the [0m[1;36m7[0m[39m-byte buffer size[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Input Validation**: Any input sanitization or size validation that should [0m     [2m                [0m
[2;36m                    [0m         [39moccur before data is written to the buffer[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Related Functions**: Other functions in the udev rule parsing module that may [0m [2m                [0m
[2;36m                    [0m         [39mshare similar patterns or vulnerabilities[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fuzzer harness [0m[1;39m([0m[39m`fuzz-udev-rule-parse-value.c`[0m[1;39m)[0m[39m serves as the entry point for [0m  [2m                [0m
[2;36m                    [0m         [39mtesting but is not the root cause of the vulnerability. The actual issue lies in [0m   [2m                [0m
[2;36m                    [0m         [39mthe production code's handling of buffer boundaries during udev rule value parsing.[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m[39m-udev-rule-parse-value[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3942423992[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd66a920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7feffd681ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555c7db664e8[0m[39m, [0m[1;36m0x555c7db67ad7[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd681ab8[0m[39m,[0m[1;36m0x7feffd7f33e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555c7db67ad8[0m[39m,[0m[1;36m0x555c7db7d9c8[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555c7d9c61b3[0m[39m bp [0m[1;36m0x7ffedda38030[0m[39m sp [0m[1;36m0x7ffedda38028[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9c61b2[0m[39m in udev_rule_parse_value [0m                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50fe[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555c7d8ec8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsi[0m [2m                [0m
[2;36m                    [0m         [39mgned char const*, unsigned long[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9858cf[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50aa[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in [0m                     [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value[0m                                                               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpn3r1absz[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/fuzz-udev-rule-parse-value.[0m[1;92mc:1[0m[39m-[0m[1;36m30[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <string.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include [0m[32m"alloc-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"fuzz.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"udev-rules.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *data, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:        _cleanup_free_ char *str = NULL;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:        char *value = [0m[1;35mUINT_TO_PTR[0m[1;39m([0m[1;36m0x12345678[0m[39mU[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:        char *endpos = [0m[1;35mUINT_TO_PTR[0m[1;39m([0m[1;36m0x87654321[0m[39mU[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:        bool is_case_sensitive;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:        [0m[1;35mfuzz_setup_logging[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        [0m[1;35massert_se[0m[1;39m([0m[39mstr = [0m[1;35mmalloc[0m[1;39m([0m[39msize + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr, data, size[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        str[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        r = [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mstr, &value, &endpos, &is_case_sensitive[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:                [0m[35m/[0m[39m* not modified on failure *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[39mvalue == [0m[1;35mUINT_TO_PTR[0m[1;39m([0m[1;36m0x12345678[0m[39mU[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[39mendpos == [0m[1;35mUINT_TO_PTR[0m[1;39m([0m[1;36m0x87654321[0m[39mU[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[39mendpos <= str + size[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[39mendpos > str + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1196[0m[39m-[0m[1;36m1232[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1196[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1197[0m[39m:                _cleanup_free_ char *unescaped = NULL;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1198[0m[39m:                ssize_t l;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1199[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1200[0m[39m:                [0m[35m/[0m[39m* find the end position of value *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1201[0m[39m:                for [0m[1;39m([0m[39mi = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1202[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == '\\'[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1204[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1205[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1206[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1207[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:                l = [0m[1;35mcunescape_length[0m[1;39m([0m[39mm + [0m[1;36m1[0m[39m, i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m, &unescaped[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1209[0m[39m:                if [0m[1;39m([0m[39ml < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1210[0m[39m:                        return l;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1211[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1212[0m[39m:                [0m[1;35massert[0m[1;39m([0m[39ml <= i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1213[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1214[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1215[0m[39m:                * The return value must be terminated by two subsequent NULs[0m   [2m                [0m
[2;36m                    [0m         [1;36m1216[0m[39m:                * so it could be safely interpreted as nulstr.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1217[0m[39m:                *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1174[0m[39m-[0m[1;36m1195[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1174[0m[39m:        if [0m[1;39m([0m[39m!is_escaped[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1175[0m[39m:                [0m[35m/[0m[39m* unescape double quotation [0m[32m'\"'[0m[39m->[0m[32m'"'[0m[39m *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1176[0m[39m:                for [0m[1;39m([0m[39mj = m, i = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++, j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1177[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1178[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1179[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'\\' && i[0m[32m[[0m[32m1[0m[32m][0m[32m == '[0m[39m"'[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1180[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1181[0m[39m:                        *j = *i;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1183[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1184[0m[39m:                 * The return value must be terminated by two subsequent NULs[0m  [2m                [0m
[2;36m                    [0m         [1;36m1185[0m[39m:                 * so it could be safely interpreted as nulstr.[0m                [2m                [0m
[2;36m                    [0m         [1;36m1186[0m[39m:                 *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1[0m[39m-[0m[1;36m50[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: GPL-[0m[1;36m2.0[0m[39m-or-later *[0m[35m/[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <ctype.h>[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include [0m[32m"alloc-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"architecture.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"conf-files.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:#include [0m[32m"conf-parser.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:#include [0m[32m"confidential-virt.h"[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#include [0m[32m"constants.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:#include [0m[32m"device-private.h"[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:#include [0m[32m"device-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:#include [0m[32m"dirent-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:#include [0m[32m"escape.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:#include [0m[32m"fd-util.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:#include [0m[32m"fileio.h"[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:#include [0m[32m"format-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:#include [0m[32m"fs-util.h"[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:#include [0m[32m"glob-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:#include [0m[32m"list.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:#include [0m[32m"mkdir.h"[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:#include [0m[32m"netif-naming-scheme.h"[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:#include [0m[32m"nulstr-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:#include [0m[32m"parse-util.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:#include [0m[32m"path-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:#include [0m[32m"proc-cmdline.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:#include [0m[32m"socket-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:#include [0m[32m"stat-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:#include [0m[32m"string-table.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:#include [0m[32m"strv.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:#include [0m[32m"strxcpyx.h"[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:#include [0m[32m"sysctl-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:#include [0m[32m"syslog-util.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:#include [0m[32m"udev-builtin.h"[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:#include [0m[32m"udev-event.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:#include [0m[32m"udev-format.h"[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:#include [0m[32m"udev-node.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:#include [0m[32m"udev-rules.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:#include [0m[32m"udev-spawn.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:#include [0m[32m"udev-trace.h"[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:#include [0m[32m"udev-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:#include [0m[32m"user-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:#include [0m[32m"virt.h"[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:#define RULES_DIRS [0m[1;39m([0m[1;39m([0m[39mconst char* const*[0m[1;39m)[0m[39m [0m[1;35mCONF_PATHS_STRV[0m[1;39m([0m[32m"udev/rules.d"[0m[1;39m)[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:typedef enum [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:        OP_MATCH,        [0m[35m/[0m[39m* == *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:        OP_NOMATCH,      [0m[35m/[0m[39m* != *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:        OP_ADD,          [0m[35m/[0m[39m* += *[0m[35m/[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/escape.[0m[1;92mc:292[0m[39m-[0m[1;36m362[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:ssize_t [0m[1;35mcunescape_length_with_prefix[0m[1;39m([0m[39mconst char *s, size_t length, const char [0m  [2m                [0m
[2;36m                    [0m         [39m*prefix, UnescapeFlags flags, char **ret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        _cleanup_free_ char *ans = NULL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:        char *t;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        const char *f;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        size_t pl;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        int r;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        [0m[35m/[0m[39m* Undoes C style string escaping, and optionally prefixes it. *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        pl = [0m[1;35mstrlen_ptr[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        ans = [0m[1;35mnew[0m[1;39m([0m[39mchar, pl+length+[0m[1;36m1[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:        if [0m[1;39m([0m[39m!ans[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:                return -ENOMEM;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        if [0m[1;39m([0m[39mprefix[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:                [0m[1;35mmemcpy[0m[1;39m([0m[39mans, prefix, pl[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:        for [0m[1;39m([0m[39mf = s, t = ans + pl; f < s + length; f++[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                size_t remaining;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:                bool eight_bit = false;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:                char32_t u;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:                remaining = s + length - f;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:                [0m[1;35massert[0m[1;39m([0m[39mremaining > [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:                if [0m[1;39m([0m[39m*f != '\\'[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:                        [0m[35m/[0m[39m* A literal, copy verbatim *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:                        *[0m[1;39m([0m[39mt++[0m[1;39m)[0m[39m = *f;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:                        continue;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:                if [0m[1;39m([0m[39mremaining == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:                        if [0m[1;39m([0m[39mflags & UNESCAPE_RELAX[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:                                [0m[35m/[0m[39m* A trailing backslash, copy verbatim *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:                                *[0m[1;39m([0m[39mt++[0m[1;39m)[0m[39m = *f;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:                                continue;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                        return -EINVAL;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:                r = [0m[1;35mcunescape_one[0m[1;39m([0m[39mf + [0m[1;36m1[0m[39m, remaining - [0m[1;36m1[0m[39m, &u, &eight_bit, flags &[0m [2m                [0m
[2;36m                    [0m         [39mUNESCAPE_ACCEPT_NUL[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:                        if [0m[1;39m([0m[39mflags & UNESCAPE_RELAX[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:                                [0m[35m/[0m[39m* Invalid escape code, let's take it literal [0m  [2m                [0m
[2;36m                    [0m         [39mthen *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                                *[0m[1;39m([0m[39mt++[0m[1;39m)[0m[39m = '\\';[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:                                continue;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                        return r;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:                f += r;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:                if [0m[1;39m([0m[39meight_bit[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:                        [0m[35m/[0m[39m* One byte? Set directly as specified *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:                        *[0m[1;39m([0m[39mt++[0m[1;39m)[0m[39m = u;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:                        [0m[35m/[0m[39m* Otherwise encode as multi-byte UTF-[0m[1;36m8[0m[39m *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:                        t += [0m[1;35mutf8_encode_unichar[0m[1;39m([0m[39mt, u[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:        *t = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mt >= ans[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* Let static analyzers know that the answer is [0m      [2m                [0m
[2;36m                    [0m         [39mnon-negative. *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:        *ret = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mans[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        return t - *ret;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1241[0m[39m-[0m[1;36m1294[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1241[0m[39m:static int [0m[1;35mparse_line[0m[1;39m([0m[39mchar **line, char **ret_key, char **ret_attr, [0m           [2m                [0m
[2;36m                    [0m         [39mUdevRuleOperatorType *ret_op, char **ret_value, bool *ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m1242[0m[39m:        char *key_begin, *key_end, *attr, *tmp;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1243[0m[39m:        UdevRuleOperatorType op;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1244[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1245[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1246[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1247[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39m*line[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1248[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_key[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1249[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_op[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1250[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1251[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1252[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1253[0m[39m:        key_begin = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39m*line, WHITESPACE [0m[32m","[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1254[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1255[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mkey_begin[0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1256[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1257[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1258[0m[39m:        for [0m[1;39m([0m[39mkey_end = key_begin; ; key_end++[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1259[0m[39m:                if [0m[1;39m([0m[39mkey_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1260[0m[39m:                        return -EINVAL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1261[0m[39m:                if [0m[1;39m([0m[1;35mstrchr[0m[1;39m([0m[39mWHITESPACE [0m[32m"=[0m[32m{[0m[32m"[0m[39m, key_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1262[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1263[0m[39m:                if [0m[1;39m([0m[1;35mstrchr[0m[1;39m([0m[32m"+-!:"[0m[39m, key_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m && key_end[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[32m'='[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m1264[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1265[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1266[0m[39m:        if [0m[1;39m([0m[39mkey_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'[0m[32m{[0m[32m'[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1267[0m[39m:                attr = key_end + [0m[1;36m1[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1268[0m[39m:                tmp = [0m[1;35mstrchr[0m[1;39m([0m[39mattr, [0m[32m'[0m[32m}[0m[32m'[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1269[0m[39m:                if [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1270[0m[39m:                        return -EINVAL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1271[0m[39m:                *tmp++ = [0m[32m'\0'[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1272[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1273[0m[39m:                attr = NULL;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1274[0m[39m:                tmp = key_end;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1275[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1276[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1277[0m[39m:        tmp = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mtmp, NULL[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1278[0m[39m:        op = [0m[1;35mparse_operator[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1279[0m[39m:        if [0m[1;39m([0m[39mop < [0m[1;36m0[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1280[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1281[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1282[0m[39m:        key_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1283[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1284[0m[39m:        tmp += op == OP_ASSIGN ? [0m[1;36m1[0m[39m : [0m[1;36m2[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1285[0m[39m:        tmp = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mtmp, NULL[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1286[0m[39m:        r = [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mtmp, ret_value, line, [0m                       [2m                [0m
[2;36m                    [0m         [39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1287[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1288[0m[39m:                return r;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1289[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1290[0m[39m:        *ret_key = key_begin;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1291[0m[39m:        *ret_attr = attr;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1292[0m[39m:        *ret_op = op;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1293[0m[39m:        return [0m[1;36m1[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1294[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1567[0m[39m-[0m[1;36m1650[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:int [0m[1;35mudev_rules_parse_file[0m[1;39m([0m[39mUdevRules *rules, const char *filename, bool [0m        [2m                [0m
[2;36m                    [0m         [39mextra_checks, UdevRuleFile **ret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mudev_rule_file_freep[0m[1;39m)[0m[39m UdevRuleFile *rule_file = NULL;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:        _cleanup_free_ char *continuation = NULL, *name = NULL;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:        _cleanup_fclose_ FILE *f = NULL;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:        bool ignore_line = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:        unsigned line_nr = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:        struct stat st;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1575[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mrules[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:        f = [0m[1;35mfopen[0m[1;39m([0m[39mfilename, [0m[32m"re"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:        if [0m[1;39m([0m[39m!f[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1581[0m[39m:                if [0m[1;39m([0m[39mextra_checks[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1582[0m[39m:                        return -errno;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1584[0m[39m:                if [0m[1;39m([0m[39merrno == ENOENT[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1585[0m[39m:                        return [0m[1;36m0[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1586[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1587[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39merrno, [0m[32m"Failed to open %s, ignoring: [0m [2m                [0m
[2;36m                    [0m         [32m%m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:        if [0m[1;39m([0m[1;35mfstat[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m, &st[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39merrno, [0m[32m"Failed to stat %s, ignoring: [0m [2m                [0m
[2;36m                    [0m         [32m%m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:        if [0m[1;39m([0m[1;35mnull_or_empty[0m[1;39m([0m[39m&st[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:                [0m[1;35mlog_debug[0m[1;39m([0m[32m"Skipping empty file: %s"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:                if [0m[1;39m([0m[39mret[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:                        *ret = NULL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:        r = [0m[1;35mhashmap_put_stats_by_path[0m[1;39m([0m[39m&rules->stats_by_path, filename, &st[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to save stat for %s, [0m      [2m                [0m
[2;36m                    [0m         [32mignoring: %m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;35mfd_warn_permissions[0m[1;39m([0m[39mfilename, [0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:        [0m[1;35mlog_debug[0m[1;39m([0m[32m"Reading rules file: %s"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:        name = [0m[1;35mstrdup[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:        if [0m[1;39m([0m[39m!name[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:        rule_file = [0m[1;35mnew[0m[1;39m([0m[39mUdevRuleFile, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:        if [0m[1;39m([0m[39m!rule_file[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:        *rule_file = [0m[1;39m([0m[39mUdevRuleFile[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:                .filename = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:                .rules = rules,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:        [0m[1;35mLIST_APPEND[0m[1;39m([0m[39mrule_files, rules->rule_files, rule_file[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:        for [0m[1;39m([0m[39m;;[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:                _cleanup_free_ char *buf = NULL;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:                size_t len;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:                char *line;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:                r = [0m[1;35mread_line[0m[1;39m([0m[39mf, UDEV_LINE_SIZE, &buf[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:                        return r;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:                if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:                line_nr++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:                line = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mbuf, NULL[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:                [0m[35m/[0m[39m* Lines beginning with [0m[32m'#'[0m[39m are ignored regardless of line [0m    [2m                [0m
[2;36m                    [0m         [39mcontinuation. *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:                if [0m[1;39m([0m[39mline[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'#'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1639[0m[39m:                        continue;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:                len = [0m[1;35mstrlen[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1643[0m[39m:                if [0m[1;39m([0m[39mcontinuation && !ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1644[0m[39m:                        if [0m[1;39m([0m[1;35mstrlen[0m[1;39m([0m[39mcontinuation[0m[1;39m)[0m[39m + len >= UDEV_LINE_SIZE[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1645[0m[39m:                                ignore_line = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1646[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1647[0m[39m:                        if [0m[1;39m([0m[39m![0m[1;35mstrextend[0m[1;39m([0m[39m&continuation, line[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1648[0m[39m:                                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1649[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1650[0m[39m:                        if [0m[1;39m([0m[39m!ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1623[0m[39m-[0m[1;36m1677[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:        for [0m[1;39m([0m[39m;;[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:                _cleanup_free_ char *buf = NULL;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:                size_t len;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:                char *line;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:                r = [0m[1;35mread_line[0m[1;39m([0m[39mf, UDEV_LINE_SIZE, &buf[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:                        return r;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:                if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:                line_nr++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:                line = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mbuf, NULL[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:                [0m[35m/[0m[39m* Lines beginning with [0m[32m'#'[0m[39m are ignored regardless of line [0m    [2m                [0m
[2;36m                    [0m         [39mcontinuation. *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:                if [0m[1;39m([0m[39mline[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'#'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1639[0m[39m:                        continue;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:                len = [0m[1;35mstrlen[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1643[0m[39m:                if [0m[1;39m([0m[39mcontinuation && !ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1644[0m[39m:                        if [0m[1;39m([0m[1;35mstrlen[0m[1;39m([0m[39mcontinuation[0m[1;39m)[0m[39m + len >= UDEV_LINE_SIZE[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1645[0m[39m:                                ignore_line = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1646[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1647[0m[39m:                        if [0m[1;39m([0m[39m![0m[1;35mstrextend[0m[1;39m([0m[39m&continuation, line[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1648[0m[39m:                                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1649[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1650[0m[39m:                        if [0m[1;39m([0m[39m!ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1651[0m[39m:                                line = continuation;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1652[0m[39m:                                len = [0m[1;35mstrlen[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1653[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1654[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1655[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1656[0m[39m:                if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[39m && line[0m[1;39m[[0m[39mlen - [0m[1;36m1[0m[1;39m][0m[39m == '\\'[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1657[0m[39m:                        if [0m[1;39m([0m[39mignore_line[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1658[0m[39m:                                continue;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1659[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1660[0m[39m:                        line[0m[1;39m[[0m[39mlen - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1661[0m[39m:                        if [0m[1;39m([0m[39m!continuation[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1662[0m[39m:                                continuation = [0m[1;35mstrdup[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1663[0m[39m:                                if [0m[1;39m([0m[39m!continuation[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1664[0m[39m:                                        return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1665[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1666[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1667[0m[39m:                        continue;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1668[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1669[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1670[0m[39m:                if [0m[1;39m([0m[39mignore_line[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1671[0m[39m:                        [0m[1;35mlog_file_error[0m[1;39m([0m[39mrule_file, line_nr, [0m[32m"Line is too long, [0m [2m                [0m
[2;36m                    [0m         [32mignored."[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1672[0m[39m:                else if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1673[0m[39m:                        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;35mrule_add_line[0m[1;39m([0m[39mrule_file, line, line_nr, [0m        [2m                [0m
[2;36m                    [0m         [39mextra_checks[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1674[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1675[0m[39m:                continuation = [0m[1;35mmfree[0m[1;39m([0m[39mcontinuation[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1676[0m[39m:                ignore_line = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1677[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/fileio.[0m[1;92mc:1487[0m[39m-[0m[1;36m1608[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1487[0m[39m:int [0m[1;35mread_line_full[0m[1;39m([0m[39mFILE *f, size_t limit, ReadLineFlags flags, char **ret[0m[1;39m)[0m[39m [0m[1;39m{[0m   [2m                [0m
[2;36m                    [0m         [1;36m1488[0m[39m:        _cleanup_free_ char *buffer = NULL;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1489[0m[39m:        size_t n = [0m[1;36m0[0m[39m, count = [0m[1;36m0[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1490[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1491[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1492[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1493[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1494[0m[39m:        [0m[35m/[0m[39m* Something like a bounded version of [0m[1;35mgetline[0m[1;39m([0m[1;39m)[0m[39m.[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1495[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1496[0m[39m:         * Considers EOF, \n, \r and \[0m[1;36m0[0m[39m end of line delimiters [0m[1;39m([0m[39mor [0m            [2m                [0m
[2;36m                    [0m         [39mcombinations of these[0m[1;39m)[0m[39m, and does not include these[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1497[0m[39m:         * delimiters in the string returned. Specifically, recognizes the [0m    [2m                [0m
[2;36m                    [0m         [39mfollowing combinations of markers as line[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1498[0m[39m:         * endings:[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1499[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1500[0m[39m:         *     • \n        [0m[1;39m([0m[39mUNIX[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1501[0m[39m:         *     • \r        [0m[1;39m([0m[39mold MacOS[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1502[0m[39m:         *     • \[0m[1;36m0[0m[39m        [0m[1;39m([0m[39mC strings[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1503[0m[39m:         *     • \n\[0m[1;36m0[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1504[0m[39m:         *     • \r\[0m[1;36m0[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1505[0m[39m:         *     • \r\n      [0m[1;39m([0m[39mWindows[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1506[0m[39m:         *     • \n\r[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1507[0m[39m:         *     • \r\n\[0m[1;36m0[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1508[0m[39m:         *     • \n\r\[0m[1;36m0[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1509[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1510[0m[39m:         * Returns the number of bytes read from the files [0m[1;39m([0m[39mi.e. including [0m    [2m                [0m
[2;36m                    [0m         [39mdelimiters — this hence usually differs from[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1511[0m[39m:         * the number of characters in the returned string[0m[1;39m)[0m[39m. When EOF is hit, [0m [2m                [0m
[2;36m                    [0m         [1;36m0[0m[39m is returned.[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1512[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1513[0m[39m:         * The input parameter limit is the maximum numbers of characters in [0m  [2m                [0m
[2;36m                    [0m         [39mthe returned string, i.e. excluding[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1514[0m[39m:         * delimiters. If the limit is hit we fail and return -ENOBUFS.[0m        [2m                [0m
[2;36m                    [0m         [1;36m1515[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1516[0m[39m:         * If a line shall be skipped ret may be initialized as NULL. *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m1517[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1518[0m[39m:        if [0m[1;39m([0m[39mret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1519[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mGREEDY_REALLOC[0m[1;39m([0m[39mbuffer, [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1520[0m[39m:                        return -ENOMEM;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1521[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1522[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1523[0m[39m:        [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1524[0m[39m:                _unused_ [0m[1;35m_cleanup_[0m[1;39m([0m[39mfunlockfilep[0m[1;39m)[0m[39m FILE *flocked = f;[0m            [2m                [0m
[2;36m                    [0m         [1;36m1525[0m[39m:                EndOfLineMarker previous_eol = EOL_NONE;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1526[0m[39m:                [0m[1;35mflockfile[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1527[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1528[0m[39m:                for [0m[1;39m([0m[39m;;[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1529[0m[39m:                        EndOfLineMarker eol;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1530[0m[39m:                        char c;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1531[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1532[0m[39m:                        if [0m[1;39m([0m[39mn >= limit[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1533[0m[39m:                                return -ENOBUFS;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1534[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1535[0m[39m:                        if [0m[1;39m([0m[39mcount >= INT_MAX[0m[1;39m)[0m[39m [0m[35m/[0m[39m* We couldn't return the [0m       [2m                [0m
[2;36m                    [0m         [39mcounter anymore as [0m[32m"int"[0m[39m, hence refuse this *[0m[35m/[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1536[0m[39m:                                return -ENOBUFS;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1537[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1538[0m[39m:                        r = [0m[1;35msafe_fgetc[0m[1;39m([0m[39mf, &c[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1539[0m[39m:                        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1540[0m[39m:                                return r;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1541[0m[39m:                        if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m[39m [0m[35m/[0m[39m* EOF is definitely EOL *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1542[0m[39m:                                break;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1543[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1544[0m[39m:                        eol = [0m[1;35mcategorize_eol[0m[1;39m([0m[39mc, flags[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1545[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1546[0m[39m:                        if [0m[1;39m([0m[1;35mFLAGS_SET[0m[1;39m([0m[39mprevious_eol, EOL_ZERO[0m[1;39m)[0m[39m ||[0m               [2m                [0m
[2;36m                    [0m         [1;36m1547[0m[39m:                            [0m[1;39m([0m[39meol == EOL_NONE && previous_eol != EOL_NONE[0m[1;39m)[0m[39m ||[0m   [2m                [0m
[2;36m                    [0m         [1;36m1548[0m[39m:                            [0m[1;39m([0m[39meol != EOL_NONE && [0m[1;39m([0m[39mprevious_eol & eol[0m[1;39m)[0m[39m != [0m[1;36m0[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m  [2m                [0m
[2;36m                    [0m         [1;36m1549[0m[39m:                                [0m[35m/[0m[39m* Previous char was a NUL? This is not an [0m    [2m                [0m
[2;36m                    [0m         [39mEOL, but the previous char was? This type of[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1550[0m[39m:                                 * EOL marker has been seen right before?  In [0m [2m                [0m
[2;36m                    [0m         [39meither of these three cases we are[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1551[0m[39m:                                 * done. But first, let's put this character [0m  [2m                [0m
[2;36m                    [0m         [39mback in the queue. [0m[1;39m([0m[39mNote that we have to[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1552[0m[39m:                                 * cast this to [0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39m here as [0m       [2m                [0m
[2;36m                    [0m         [1;35mungetc[0m[1;39m([0m[1;39m)[0m[39m expects a positive [0m[32m'int'[0m[39m, and if we[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1553[0m[39m:                                 * are on an architecture where [0m[32m'char'[0m[39m equals [0m [2m                [0m
[2;36m                    [0m         [32m'signed char'[0m[39m we need to ensure we don't[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1554[0m[39m:                                 * pass a negative value here. That said, to [0m  [2m                [0m
[2;36m                    [0m         [39mcomplicate things further [0m[1;35mungetc[0m[1;39m([0m[1;39m)[0m[39m is[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1555[0m[39m:                                 * actually happy with most negative [0m          [2m                [0m
[2;36m                    [0m         [39mcharacters and implicitly casts them back to[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1556[0m[39m:                                 * positive ones as needed, except for \xff [0m   [2m                [0m
[2;36m                    [0m         [1;39m([0m[39maka [0m[1;36m-1[0m[39m, aka EOF[0m[1;39m)[0m[39m, which it refuses. What a[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1557[0m[39m:                                 * godawful API![0m[1;39m)[0m[39m *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1558[0m[39m:                                [0m[1;35massert_se[0m[1;39m([0m[1;35mungetc[0m[1;39m([0m[1;39m([0m[39munsigned char[0m[1;39m)[0m[39m c, f[0m[1;39m)[0m[39m != [0m     [2m                [0m
[2;36m                    [0m         [39mEOF[0m[1;39m)[0m[39m;[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1559[0m[39m:                                break;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1560[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1561[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1562[0m[39m:                        count++;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1563[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1564[0m[39m:                        if [0m[1;39m([0m[39meol != EOL_NONE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1565[0m[39m:                                [0m[35m/[0m[39m* If we are on a tty, we can't shouldn't wait[0m [2m                [0m
[2;36m                    [0m         [39mfor more input, because that[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1566[0m[39m:                                 * generally means waiting for the user, [0m      [2m                [0m
[2;36m                    [0m         [39minteractively. In the case of a TTY[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:                                 * we expect only \n as the single EOL marker,[0m [2m                [0m
[2;36m                    [0m         [39mso we are in the lucky[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:                                 * position that there is no need to wait. We [0m [2m                [0m
[2;36m                    [0m         [39mcheck this condition last, to[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:                                 * avoid [0m[1;35misatty[0m[1;39m([0m[1;39m)[0m[39m check if not necessary. *[0m[35m/[0m   [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:                                if [0m[1;39m([0m[1;39m([0m[39mflags & [0m                                  [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mREAD_LINE_IS_A_TTY|READ_LINE_NOT_A_TTY[0m[1;39m)[0m[1;39m)[0m[39m == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:                                        int fd;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:                                        fd = [0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1575[0m[39m:                                        if [0m[1;39m([0m[39mfd < [0m[1;36m0[0m[1;39m)[0m[39m [0m[35m/[0m[39m* Maybe an [0m[1;35mfmemopen[0m[1;39m([0m[1;39m)[0m[39m [0m    [2m                [0m
[2;36m                    [0m         [39mstream? Handle this gracefully,[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:                                                     * and don't call [0m[1;35misatty[0m[1;39m([0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mon an invalid fd *[0m[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:                                                flags |= READ_LINE_NOT_A_TTY;[0m  [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:                                        else[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:                                                flags |= [0m[1;35misatty_safe[0m[1;39m([0m[39mfd[0m[1;39m)[0m[39m ? [0m    [2m                [0m
[2;36m                    [0m         [39mREAD_LINE_IS_A_TTY : READ_LINE_NOT_A_TTY;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:                                [0m[1;39m}[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1581[0m[39m:                                if [0m[1;39m([0m[1;35mFLAGS_SET[0m[1;39m([0m[39mflags, READ_LINE_IS_A_TTY[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1582[0m[39m:                                        break;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1584[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1585[0m[39m:                        if [0m[1;39m([0m[39meol != EOL_NONE[0m[1;39m)[0m[39m [0m[1;39m{[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1586[0m[39m:                                previous_eol |= eol;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1587[0m[39m:                                continue;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:                        if [0m[1;39m([0m[39mret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:                                if [0m[1;39m([0m[39m![0m[1;35mGREEDY_REALLOC[0m[1;39m([0m[39mbuffer, n + [0m[1;36m2[0m[1;39m)[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:                                        return -ENOMEM;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:                                buffer[0m[1;39m[[0m[39mn[0m[1;39m][0m[39m = c;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:                        n++;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:        if [0m[1;39m([0m[39mret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:                buffer[0m[1;39m[[0m[39mn[0m[1;39m][0m[39m = [0m[1;36m0[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:                *ret = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mbuffer[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:        return [0m[1;39m([0m[39mint[0m[1;39m)[0m[39m count;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1327[0m[39m-[0m[1;36m1385[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:static int [0m[1;35mrule_add_line[0m[1;39m([0m[39mUdevRuleFile *rule_file, const char *line_str, [0m       [2m                [0m
[2;36m                    [0m         [39munsigned line_nr, bool extra_checks[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mudev_rule_line_freep[0m[1;39m)[0m[39m UdevRuleLine *rule_line = NULL;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:        _cleanup_free_ char *line = NULL;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:        char *p;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mrule_file[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1336[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1337[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1338[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m:        line = [0m[1;35mstrdup[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1340[0m[39m:        if [0m[1;39m([0m[39m!line[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1341[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1342[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1343[0m[39m:        rule_line = [0m[1;35mnew[0m[1;39m([0m[39mUdevRuleLine, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1344[0m[39m:        if [0m[1;39m([0m[39m!rule_line[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1345[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1346[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1347[0m[39m:        *rule_line = [0m[1;39m([0m[39mUdevRuleLine[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1348[0m[39m:                .line = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1349[0m[39m:                .line_number = line_nr,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1350[0m[39m:                .rule_file = rule_file,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1353[0m[39m:        [0m[1;35mLIST_APPEND[0m[1;39m([0m[39mrule_lines, rule_file->rule_lines, rule_line[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1354[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1355[0m[39m:        for [0m[1;39m([0m[39mp = rule_line->line; ![0m[1;35misempty[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m; [0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1356[0m[39m:                char *key, *attr, *value;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1357[0m[39m:                UdevRuleOperatorType op;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1358[0m[39m:                bool is_case_insensitive;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1359[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1360[0m[39m:                if [0m[1;39m([0m[39mextra_checks[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1361[0m[39m:                        [0m[1;35mcheck_token_delimiters[0m[1;39m([0m[39mrule_line, p[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1362[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1363[0m[39m:                r = [0m[1;35mparse_line[0m[1;39m([0m[39m&p, &key, &attr, &op, &value, [0m                  [2m                [0m
[2;36m                    [0m         [39m&is_case_insensitive[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1364[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1365[0m[39m:                        return [0m[1;35mlog_line_error_errno[0m[1;39m([0m[39mrule_line, r, [0m[32m"Invalid [0m    [2m                [0m
[2;36m                    [0m         [32mkey/value pair, ignoring."[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:                if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1369[0m[39m:                r = [0m[1;35mparse_token[0m[1;39m([0m[39mrule_line, key, attr, op, value, [0m              [2m                [0m
[2;36m                    [0m         [39mis_case_insensitive[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:                        return r;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1373[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1374[0m[39m:        if [0m[1;39m([0m[39mrule_line->type == [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1375[0m[39m:                [0m[1;35mlog_line_warning[0m[1;39m([0m[39mrule_line, [0m[32m"The line has no effect, [0m          [2m                [0m
[2;36m                    [0m         [32mignoring."[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m1376[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1377[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1378[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1379[0m[39m:        if [0m[1;39m([0m[39mextra_checks[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1380[0m[39m:                [0m[1;35mcheck_tokens_order[0m[1;39m([0m[39mrule_line[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m1381[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1382[0m[39m:        [0m[1;35msort_tokens[0m[1;39m([0m[39mrule_line[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1383[0m[39m:        [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mrule_line[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1384[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1385[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1140[0m[39m-[0m[1;36m1170[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:int [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mchar *str, char **ret_value, char **ret_endpos, bool[0m [2m                [0m
[2;36m                    [0m         [39m*ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:        char *i, *j, *m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:        bool is_escaped = false, is_case_insensitive = false, is_prefix_match [0m [2m                [0m
[2;36m                    [0m         [39m= false;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_endpos[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:        [0m[35m/[0m[39m* check if string is prefixed with:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:         * - [0m[32m"e"[0m[39m for escaped[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:         * - [0m[32m"i"[0m[39m for case insensitive match[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:         * - [0m[32m"p"[0m[39m for prefix match[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:         * Note any permutation of these options can be set. *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:        for [0m[1;39m([0m[39mconst char *k = str; *k != [0m[32m'"'[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:                pos++;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                if [0m[1;39m([0m[39m*k == [0m[32m'e'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:                        is_escaped = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'i'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:                        is_case_insensitive = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'p'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                        is_prefix_match = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        return -EINVAL; [0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:        [0m[35m/[0m[39m* value must be double quotated *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        if [0m[1;39m([0m[39mstr[0m[1;39m[[0m[39mpos[0m[1;39m][0m[39m != [0m[32m'"'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1174[0m[39m-[0m[1;36m1195[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1174[0m[39m:        if [0m[1;39m([0m[39m!is_escaped[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1175[0m[39m:                [0m[35m/[0m[39m* unescape double quotation [0m[32m'\"'[0m[39m->[0m[32m'"'[0m[39m *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1176[0m[39m:                for [0m[1;39m([0m[39mj = m, i = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++, j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1177[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1178[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1179[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'\\' && i[0m[32m[[0m[32m1[0m[32m][0m[32m == '[0m[39m"'[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1180[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1181[0m[39m:                        *j = *i;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1183[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1184[0m[39m:                 * The return value must be terminated by two subsequent NULs[0m  [2m                [0m
[2;36m                    [0m         [1;36m1185[0m[39m:                 * so it could be safely interpreted as nulstr.[0m                [2m                [0m
[2;36m                    [0m         [1;36m1186[0m[39m:                 *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1196[0m[39m-[0m[1;36m1232[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1196[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1197[0m[39m:                _cleanup_free_ char *unescaped = NULL;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1198[0m[39m:                ssize_t l;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1199[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1200[0m[39m:                [0m[35m/[0m[39m* find the end position of value *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1201[0m[39m:                for [0m[1;39m([0m[39mi = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1202[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == '\\'[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1204[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1205[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1206[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1207[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:                l = [0m[1;35mcunescape_length[0m[1;39m([0m[39mm + [0m[1;36m1[0m[39m, i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m, &unescaped[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1209[0m[39m:                if [0m[1;39m([0m[39ml < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1210[0m[39m:                        return l;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1211[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1212[0m[39m:                [0m[1;35massert[0m[1;39m([0m[39ml <= i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1213[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1214[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1215[0m[39m:                * The return value must be terminated by two subsequent NULs[0m   [2m                [0m
[2;36m                    [0m         [1;36m1216[0m[39m:                * so it could be safely interpreted as nulstr.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1217[0m[39m:                *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1140[0m[39m-[0m[1;36m1239[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:int [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mchar *str, char **ret_value, char **ret_endpos, bool[0m [2m                [0m
[2;36m                    [0m         [39m*ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:        char *i, *j, *m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:        bool is_escaped = false, is_case_insensitive = false, is_prefix_match [0m [2m                [0m
[2;36m                    [0m         [39m= false;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_endpos[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:        [0m[35m/[0m[39m* check if string is prefixed with:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:         * - [0m[32m"e"[0m[39m for escaped[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:         * - [0m[32m"i"[0m[39m for case insensitive match[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:         * - [0m[32m"p"[0m[39m for prefix match[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:         * Note any permutation of these options can be set. *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:        for [0m[1;39m([0m[39mconst char *k = str; *k != [0m[32m'"'[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:                pos++;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                if [0m[1;39m([0m[39m*k == [0m[32m'e'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:                        is_escaped = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'i'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:                        is_case_insensitive = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'p'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                        is_prefix_match = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        return -EINVAL; [0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:        [0m[35m/[0m[39m* value must be double quotated *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        if [0m[1;39m([0m[39mstr[0m[1;39m[[0m[39mpos[0m[1;39m][0m[39m != [0m[32m'"'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:        [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:        m = str + is_escaped + is_case_insensitive + is_prefix_match;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1174[0m[39m:        if [0m[1;39m([0m[39m!is_escaped[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1175[0m[39m:                [0m[35m/[0m[39m* unescape double quotation [0m[32m'\"'[0m[39m->[0m[32m'"'[0m[39m *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1176[0m[39m:                for [0m[1;39m([0m[39mj = m, i = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++, j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1177[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1178[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1179[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'\\' && i[0m[32m[[0m[32m1[0m[32m][0m[32m == '[0m[39m"'[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1180[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1181[0m[39m:                        *j = *i;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1183[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1184[0m[39m:                 * The return value must be terminated by two subsequent NULs[0m  [2m                [0m
[2;36m                    [0m         [1;36m1185[0m[39m:                 * so it could be safely interpreted as nulstr.[0m                [2m                [0m
[2;36m                    [0m         [1;36m1186[0m[39m:                 *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1196[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1197[0m[39m:                _cleanup_free_ char *unescaped = NULL;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1198[0m[39m:                ssize_t l;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1199[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1200[0m[39m:                [0m[35m/[0m[39m* find the end position of value *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1201[0m[39m:                for [0m[1;39m([0m[39mi = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1202[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == '\\'[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1204[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1205[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1206[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1207[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:                l = [0m[1;35mcunescape_length[0m[1;39m([0m[39mm + [0m[1;36m1[0m[39m, i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m, &unescaped[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1209[0m[39m:                if [0m[1;39m([0m[39ml < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1210[0m[39m:                        return l;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1211[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1212[0m[39m:                [0m[1;35massert[0m[1;39m([0m[39ml <= i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1213[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1214[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1215[0m[39m:                * The return value must be terminated by two subsequent NULs[0m   [2m                [0m
[2;36m                    [0m         [1;36m1216[0m[39m:                * so it could be safely interpreted as nulstr.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1217[0m[39m:                *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1233[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1234[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1235[0m[39m:        *ret_value = str;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1236[0m[39m:        *ret_endpos = i + [0m[1;36m1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1237[0m[39m:        *ret_is_case_insensitive = is_case_insensitive;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1238[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1239[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1218[0m[39m-[0m[1;36m1230[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1327[0m[39m-[0m[1;36m1342[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:static int [0m[1;35mrule_add_line[0m[1;39m([0m[39mUdevRuleFile *rule_file, const char *line_str, [0m       [2m                [0m
[2;36m                    [0m         [39munsigned line_nr, bool extra_checks[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mudev_rule_line_freep[0m[1;39m)[0m[39m UdevRuleLine *rule_line = NULL;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:        _cleanup_free_ char *line = NULL;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:        char *p;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mrule_file[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1336[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1337[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1338[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m:        line = [0m[1;35mstrdup[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1340[0m[39m:        if [0m[1;39m([0m[39m!line[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1341[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1342[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1140[0m[39m-[0m[1;36m1173[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:int [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mchar *str, char **ret_value, char **ret_endpos, bool[0m [2m                [0m
[2;36m                    [0m         [39m*ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:        char *i, *j, *m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:        bool is_escaped = false, is_case_insensitive = false, is_prefix_match [0m [2m                [0m
[2;36m                    [0m         [39m= false;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_endpos[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:        [0m[35m/[0m[39m* check if string is prefixed with:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:         * - [0m[32m"e"[0m[39m for escaped[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:         * - [0m[32m"i"[0m[39m for case insensitive match[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:         * - [0m[32m"p"[0m[39m for prefix match[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:         * Note any permutation of these options can be set. *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:        for [0m[1;39m([0m[39mconst char *k = str; *k != [0m[32m'"'[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:                pos++;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                if [0m[1;39m([0m[39m*k == [0m[32m'e'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:                        is_escaped = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'i'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:                        is_case_insensitive = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'p'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                        is_prefix_match = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        return -EINVAL; [0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:        [0m[35m/[0m[39m* value must be double quotated *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        if [0m[1;39m([0m[39mstr[0m[1;39m[[0m[39mpos[0m[1;39m][0m[39m != [0m[32m'"'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:        [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:        m = str + is_escaped + is_case_insensitive + is_prefix_match;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1218[0m[39m-[0m[1;36m1232[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1241[0m[39m-[0m[1;36m1294[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1241[0m[39m:static int [0m[1;35mparse_line[0m[1;39m([0m[39mchar **line, char **ret_key, char **ret_attr, [0m           [2m                [0m
[2;36m                    [0m         [39mUdevRuleOperatorType *ret_op, char **ret_value, bool *ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m    [2m                [0m
[2;36m                    [0m         [1;36m1242[0m[39m:        char *key_begin, *key_end, *attr, *tmp;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1243[0m[39m:        UdevRuleOperatorType op;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1244[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1245[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1246[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1247[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39m*line[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1248[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_key[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1249[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_op[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1250[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1251[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1252[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1253[0m[39m:        key_begin = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39m*line, WHITESPACE [0m[32m","[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1254[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1255[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mkey_begin[0m[1;39m)[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1256[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1257[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1258[0m[39m:        for [0m[1;39m([0m[39mkey_end = key_begin; ; key_end++[0m[1;39m)[0m[39m [0m[1;39m{[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1259[0m[39m:                if [0m[1;39m([0m[39mkey_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1260[0m[39m:                        return -EINVAL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1261[0m[39m:                if [0m[1;39m([0m[1;35mstrchr[0m[1;39m([0m[39mWHITESPACE [0m[32m"=[0m[32m{[0m[32m"[0m[39m, key_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1262[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1263[0m[39m:                if [0m[1;39m([0m[1;35mstrchr[0m[1;39m([0m[32m"+-!:"[0m[39m, key_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[1;39m)[0m[39m && key_end[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m == [0m[32m'='[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m1264[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1265[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1266[0m[39m:        if [0m[1;39m([0m[39mkey_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'[0m[32m{[0m[32m'[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1267[0m[39m:                attr = key_end + [0m[1;36m1[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1268[0m[39m:                tmp = [0m[1;35mstrchr[0m[1;39m([0m[39mattr, [0m[32m'[0m[32m}[0m[32m'[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1269[0m[39m:                if [0m[1;39m([0m[39m!tmp[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1270[0m[39m:                        return -EINVAL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1271[0m[39m:                *tmp++ = [0m[32m'\0'[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1272[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1273[0m[39m:                attr = NULL;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1274[0m[39m:                tmp = key_end;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1275[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1276[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1277[0m[39m:        tmp = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mtmp, NULL[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1278[0m[39m:        op = [0m[1;35mparse_operator[0m[1;39m([0m[39mtmp[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1279[0m[39m:        if [0m[1;39m([0m[39mop < [0m[1;36m0[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1280[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1281[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1282[0m[39m:        key_end[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1283[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1284[0m[39m:        tmp += op == OP_ASSIGN ? [0m[1;36m1[0m[39m : [0m[1;36m2[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1285[0m[39m:        tmp = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mtmp, NULL[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1286[0m[39m:        r = [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mtmp, ret_value, line, [0m                       [2m                [0m
[2;36m                    [0m         [39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1287[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1288[0m[39m:                return r;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1289[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1290[0m[39m:        *ret_key = key_begin;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1291[0m[39m:        *ret_attr = attr;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1292[0m[39m:        *ret_op = op;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m1293[0m[39m:        return [0m[1;36m1[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1294[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1327[0m[39m-[0m[1;36m1372[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:static int [0m[1;35mrule_add_line[0m[1;39m([0m[39mUdevRuleFile *rule_file, const char *line_str, [0m       [2m                [0m
[2;36m                    [0m         [39munsigned line_nr, bool extra_checks[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mudev_rule_line_freep[0m[1;39m)[0m[39m UdevRuleLine *rule_line = NULL;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:        _cleanup_free_ char *line = NULL;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:        char *p;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mrule_file[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1336[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1337[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1338[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m:        line = [0m[1;35mstrdup[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1340[0m[39m:        if [0m[1;39m([0m[39m!line[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1341[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1342[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1343[0m[39m:        rule_line = [0m[1;35mnew[0m[1;39m([0m[39mUdevRuleLine, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1344[0m[39m:        if [0m[1;39m([0m[39m!rule_line[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1345[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1346[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1347[0m[39m:        *rule_line = [0m[1;39m([0m[39mUdevRuleLine[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1348[0m[39m:                .line = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1349[0m[39m:                .line_number = line_nr,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1350[0m[39m:                .rule_file = rule_file,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1353[0m[39m:        [0m[1;35mLIST_APPEND[0m[1;39m([0m[39mrule_lines, rule_file->rule_lines, rule_line[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1354[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1355[0m[39m:        for [0m[1;39m([0m[39mp = rule_line->line; ![0m[1;35misempty[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m; [0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1356[0m[39m:                char *key, *attr, *value;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1357[0m[39m:                UdevRuleOperatorType op;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1358[0m[39m:                bool is_case_insensitive;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1359[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1360[0m[39m:                if [0m[1;39m([0m[39mextra_checks[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1361[0m[39m:                        [0m[1;35mcheck_token_delimiters[0m[1;39m([0m[39mrule_line, p[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1362[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1363[0m[39m:                r = [0m[1;35mparse_line[0m[1;39m([0m[39m&p, &key, &attr, &op, &value, [0m                  [2m                [0m
[2;36m                    [0m         [39m&is_case_insensitive[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1364[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1365[0m[39m:                        return [0m[1;35mlog_line_error_errno[0m[1;39m([0m[39mrule_line, r, [0m[32m"Invalid [0m    [2m                [0m
[2;36m                    [0m         [32mkey/value pair, ignoring."[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:                if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1369[0m[39m:                r = [0m[1;35mparse_token[0m[1;39m([0m[39mrule_line, key, attr, op, value, [0m              [2m                [0m
[2;36m                    [0m         [39mis_case_insensitive[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:                        return r;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1140[0m[39m-[0m[1;36m1239[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:int [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mchar *str, char **ret_value, char **ret_endpos, bool[0m [2m                [0m
[2;36m                    [0m         [39m*ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:        char *i, *j, *m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:        bool is_escaped = false, is_case_insensitive = false, is_prefix_match [0m [2m                [0m
[2;36m                    [0m         [39m= false;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_endpos[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:        [0m[35m/[0m[39m* check if string is prefixed with:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:         * - [0m[32m"e"[0m[39m for escaped[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:         * - [0m[32m"i"[0m[39m for case insensitive match[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:         * - [0m[32m"p"[0m[39m for prefix match[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:         * Note any permutation of these options can be set. *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:        for [0m[1;39m([0m[39mconst char *k = str; *k != [0m[32m'"'[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:                pos++;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                if [0m[1;39m([0m[39m*k == [0m[32m'e'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:                        is_escaped = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'i'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:                        is_case_insensitive = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'p'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                        is_prefix_match = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        return -EINVAL; [0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:        [0m[35m/[0m[39m* value must be double quotated *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        if [0m[1;39m([0m[39mstr[0m[1;39m[[0m[39mpos[0m[1;39m][0m[39m != [0m[32m'"'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:        [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:        m = str + is_escaped + is_case_insensitive + is_prefix_match;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1174[0m[39m:        if [0m[1;39m([0m[39m!is_escaped[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1175[0m[39m:                [0m[35m/[0m[39m* unescape double quotation [0m[32m'\"'[0m[39m->[0m[32m'"'[0m[39m *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1176[0m[39m:                for [0m[1;39m([0m[39mj = m, i = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++, j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1177[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1178[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1179[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'\\' && i[0m[32m[[0m[32m1[0m[32m][0m[32m == '[0m[39m"'[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1180[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1181[0m[39m:                        *j = *i;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1183[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1184[0m[39m:                 * The return value must be terminated by two subsequent NULs[0m  [2m                [0m
[2;36m                    [0m         [1;36m1185[0m[39m:                 * so it could be safely interpreted as nulstr.[0m                [2m                [0m
[2;36m                    [0m         [1;36m1186[0m[39m:                 *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1196[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1197[0m[39m:                _cleanup_free_ char *unescaped = NULL;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1198[0m[39m:                ssize_t l;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1199[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1200[0m[39m:                [0m[35m/[0m[39m* find the end position of value *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1201[0m[39m:                for [0m[1;39m([0m[39mi = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1202[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == '\\'[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1204[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1205[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1206[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1207[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:                l = [0m[1;35mcunescape_length[0m[1;39m([0m[39mm + [0m[1;36m1[0m[39m, i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m, &unescaped[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1209[0m[39m:                if [0m[1;39m([0m[39ml < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1210[0m[39m:                        return l;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1211[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1212[0m[39m:                [0m[1;35massert[0m[1;39m([0m[39ml <= i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1213[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1214[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1215[0m[39m:                * The return value must be terminated by two subsequent NULs[0m   [2m                [0m
[2;36m                    [0m         [1;36m1216[0m[39m:                * so it could be safely interpreted as nulstr.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1217[0m[39m:                *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1233[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1234[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1235[0m[39m:        *ret_value = str;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1236[0m[39m:        *ret_endpos = i + [0m[1;36m1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1237[0m[39m:        *ret_is_case_insensitive = is_case_insensitive;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1238[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1239[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/fuzz-udev-rule-parse-value.[0m[1;92mc:16[0m[39m-[0m[1;36m22[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:        [0m[1;35mfuzz_setup_logging[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        [0m[1;35massert_se[0m[1;39m([0m[39mstr = [0m[1;35mmalloc[0m[1;39m([0m[39msize + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr, data, size[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        str[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        r = [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mstr, &value, &endpos, &is_case_sensitive[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1567[0m[39m-[0m[1;36m1677[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:int [0m[1;35mudev_rules_parse_file[0m[1;39m([0m[39mUdevRules *rules, const char *filename, bool [0m        [2m                [0m
[2;36m                    [0m         [39mextra_checks, UdevRuleFile **ret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mudev_rule_file_freep[0m[1;39m)[0m[39m UdevRuleFile *rule_file = NULL;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:        _cleanup_free_ char *continuation = NULL, *name = NULL;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:        _cleanup_fclose_ FILE *f = NULL;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:        bool ignore_line = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:        unsigned line_nr = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:        struct stat st;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1575[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mrules[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:        f = [0m[1;35mfopen[0m[1;39m([0m[39mfilename, [0m[32m"re"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:        if [0m[1;39m([0m[39m!f[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1581[0m[39m:                if [0m[1;39m([0m[39mextra_checks[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1582[0m[39m:                        return -errno;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1584[0m[39m:                if [0m[1;39m([0m[39merrno == ENOENT[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1585[0m[39m:                        return [0m[1;36m0[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1586[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1587[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39merrno, [0m[32m"Failed to open %s, ignoring: [0m [2m                [0m
[2;36m                    [0m         [32m%m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:        if [0m[1;39m([0m[1;35mfstat[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m, &st[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39merrno, [0m[32m"Failed to stat %s, ignoring: [0m [2m                [0m
[2;36m                    [0m         [32m%m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:        if [0m[1;39m([0m[1;35mnull_or_empty[0m[1;39m([0m[39m&st[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:                [0m[1;35mlog_debug[0m[1;39m([0m[32m"Skipping empty file: %s"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:                if [0m[1;39m([0m[39mret[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:                        *ret = NULL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:        r = [0m[1;35mhashmap_put_stats_by_path[0m[1;39m([0m[39m&rules->stats_by_path, filename, &st[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to save stat for %s, [0m      [2m                [0m
[2;36m                    [0m         [32mignoring: %m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;35mfd_warn_permissions[0m[1;39m([0m[39mfilename, [0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:        [0m[1;35mlog_debug[0m[1;39m([0m[32m"Reading rules file: %s"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:        name = [0m[1;35mstrdup[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:        if [0m[1;39m([0m[39m!name[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:        rule_file = [0m[1;35mnew[0m[1;39m([0m[39mUdevRuleFile, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:        if [0m[1;39m([0m[39m!rule_file[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:        *rule_file = [0m[1;39m([0m[39mUdevRuleFile[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:                .filename = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:                .rules = rules,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:        [0m[1;35mLIST_APPEND[0m[1;39m([0m[39mrule_files, rules->rule_files, rule_file[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:        for [0m[1;39m([0m[39m;;[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:                _cleanup_free_ char *buf = NULL;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:                size_t len;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:                char *line;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:                r = [0m[1;35mread_line[0m[1;39m([0m[39mf, UDEV_LINE_SIZE, &buf[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:                        return r;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:                if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:                line_nr++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:                line = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mbuf, NULL[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:                [0m[35m/[0m[39m* Lines beginning with [0m[32m'#'[0m[39m are ignored regardless of line [0m    [2m                [0m
[2;36m                    [0m         [39mcontinuation. *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:                if [0m[1;39m([0m[39mline[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'#'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1639[0m[39m:                        continue;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:                len = [0m[1;35mstrlen[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1643[0m[39m:                if [0m[1;39m([0m[39mcontinuation && !ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1644[0m[39m:                        if [0m[1;39m([0m[1;35mstrlen[0m[1;39m([0m[39mcontinuation[0m[1;39m)[0m[39m + len >= UDEV_LINE_SIZE[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1645[0m[39m:                                ignore_line = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1646[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1647[0m[39m:                        if [0m[1;39m([0m[39m![0m[1;35mstrextend[0m[1;39m([0m[39m&continuation, line[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1648[0m[39m:                                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1649[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1650[0m[39m:                        if [0m[1;39m([0m[39m!ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1651[0m[39m:                                line = continuation;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1652[0m[39m:                                len = [0m[1;35mstrlen[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1653[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1654[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1655[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1656[0m[39m:                if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[39m && line[0m[1;39m[[0m[39mlen - [0m[1;36m1[0m[1;39m][0m[39m == '\\'[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1657[0m[39m:                        if [0m[1;39m([0m[39mignore_line[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1658[0m[39m:                                continue;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1659[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1660[0m[39m:                        line[0m[1;39m[[0m[39mlen - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1661[0m[39m:                        if [0m[1;39m([0m[39m!continuation[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1662[0m[39m:                                continuation = [0m[1;35mstrdup[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1663[0m[39m:                                if [0m[1;39m([0m[39m!continuation[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1664[0m[39m:                                        return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1665[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1666[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1667[0m[39m:                        continue;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1668[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1669[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1670[0m[39m:                if [0m[1;39m([0m[39mignore_line[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1671[0m[39m:                        [0m[1;35mlog_file_error[0m[1;39m([0m[39mrule_file, line_nr, [0m[32m"Line is too long, [0m [2m                [0m
[2;36m                    [0m         [32mignored."[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1672[0m[39m:                else if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1673[0m[39m:                        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;35mrule_add_line[0m[1;39m([0m[39mrule_file, line, line_nr, [0m        [2m                [0m
[2;36m                    [0m         [39mextra_checks[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1674[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1675[0m[39m:                continuation = [0m[1;35mmfree[0m[1;39m([0m[39mcontinuation[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1676[0m[39m:                ignore_line = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1677[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.h:[0m[1;36m10[0m[39m-[0m[1;36m11[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#define UDEV_LINE_SIZE [0m[1;36m16384[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis[0m                                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter analyzing the code snippets and evaluation report, I've identified the root [0m  [2m                [0m
[2;36m                    [0m         [39mcause of the heap-buffer-overflow vulnerability:[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe overflow occurs in `udev_rule_parse_value` at line [0m[1;36m1223[0m[39m of [0m                     [2m                [0m
[2;36m                    [0m         [39m`src/udev/udev-rules.c`. The function modifies the input buffer in-place and writes[0m [2m                [0m
[2;36m                    [0m         [39madditional bytes for nulstr formatting [0m[1;39m([0m[39mtwo consecutive null terminators so the [0m    [2m                [0m
[2;36m                    [0m         [39mresult can be interpreted as a null-terminated string list[0m[1;39m)[0m[39m. However, the calling [0m  [2m                [0m
[2;36m                    [0m         [39mfunction `rule_add_line` allocates the buffer using `[0m[1;35mstrdup[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m` at line [0m     [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m, which provides exactly `[0m[1;35mstrlen[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m + [0m[1;36m1[0m[39m` bytes - just enough for the [0m    [2m                [0m
[2;36m                    [0m         [39mstring and one null terminator, but NOT enough for the additional writes.[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Space Requirements[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe function writes up to [0m[1;36m3[0m[39m extra bytes beyond the parsed content:[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Non-escaped path [0m[1;39m([0m[39mlines [0m[1;36m1187[0m[39m-[0m[1;36m1194[0m[1;39m)[0m[39m:**[0m                                             [2m                [0m
[2;36m                    [0m         [39m- For prefix match: `j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m`, `j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m`, `j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m` [0m[1;39m([0m[1;36m3[0m[39m bytes[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m         [39m- Otherwise: `j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m`, `j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m` [0m[1;39m([0m[1;36m2[0m[39m bytes[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Escaped path [0m[1;39m([0m[39mlines [0m[1;36m1218[0m[39m-[0m[1;36m1230[0m[1;39m)[0m[39m:**[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- For prefix match: writes at positions `pos + l - [0m[1;36m1[0m[39m`, `pos + l`, and `pos + l + [0m[1;36m1[0m[39m`[0m [2m                [0m
[2;36m                    [0m         [39m- Otherwise: writes at positions `m + l` and `m + l + [0m[1;36m1[0m[39m`[0m                            [2m                [0m
[2;36m                    [0m         [39m- Maximum of [0m[1;36m3[0m[39m bytes beyond the unescaped content[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Overflow Scenario[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mWhen the fuzzer provides input like `ep"abc"` [0m[1;39m([0m[1;36m7[0m[39m bytes[0m[1;39m)[0m[39m:[0m                            [2m                [0m
[2;36m                    [0m         [39m- Buffer allocated: [0m[1;36m8[0m[39m bytes [0m[1;39m([0m[1;36m7[0m[39m + [0m[1;36m1[0m[39m for null terminator[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [39m- `pos = [0m[1;36m2[0m[39m` [0m[1;39m([0m[39mafter [0m[32m'e'[0m[39m and [0m[32m'p'[0m[39m flags[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Unescaped length `l = [0m[1;36m3[0m[39m`[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- Function writes to: `str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = str[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m` [0m[1;39m([0m[39mthe extra null[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [39m- But then it tries to write another null at `str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = str[0m[1;39m[[0m[1;36m2[0m[39m + [0m[1;36m3[0m[39m + [0m[1;36m1[0m[1;39m][0m[39m = [0m  [2m                [0m
[2;36m                    [0m         [39mstr[0m[1;39m[[0m[1;36m6[0m[1;39m][0m[39m` which should be OK[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- However, the actual write at line [0m[1;36m1223[0m[39m is to `str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m` which can extend [0m [2m                [0m
[2;36m                    [0m         [39mto position [0m[1;36m6[0m[39m or [0m[1;36m7[0m[39m, and if the content is at the end of the buffer, this overflows[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mLooking more carefully at the ASAN report: the [0m[1;36m7[0m[39m-byte region is the actual data, [0m   [2m                [0m
[2;36m                    [0m         [39mand the write at offset [0m[1;36m7[0m[39m [0m[1;39m([0m[1;36m0[0m[39m bytes after the [0m[1;36m7[0m[39m-byte region[0m[1;39m)[0m[39m is the overflow.[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Primary Fix: Allocate Extra Space in `rule_add_line`[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** `src/udev/udev-rules.c`, function `rule_add_line`, line [0m[1;36m1339[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Current code:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mline = [0m[1;35mstrdup[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39m!line[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Fix approach:**[0m                                                                   [2m                [0m
[2;36m                    [0m         [39mReplace `strdup` with manual allocation that includes [0m[1;36m3[0m[39m extra bytes for the nulstr [0m [2m                [0m
[2;36m                    [0m         [39mformatting that `udev_rule_parse_value` requires:[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39msize_t len = [0m[1;35mstrlen[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [39mline = [0m[1;35mmalloc[0m[1;39m([0m[39mlen + [0m[1;36m1[0m[39m + [0m[1;36m3[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m +[0m[1;36m1[0m[39m for null terminator, +[0m[1;36m3[0m[39m for nulstr formatting[0m    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39m!line[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m        return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;35mmemcpy[0m[1;39m([0m[39mline, line_str, len + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis ensures that when `udev_rule_parse_value` writes the additional null [0m          [2m                [0m
[2;36m                    [0m         [39mterminators and optional [0m[32m'*'[0m[39m character for prefix matching, there is sufficient [0m    [2m                [0m
[2;36m                    [0m         [39mspace in the buffer.[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Rationale[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal Impact:** This fix only affects the memory allocation in one function [0m [2m                [0m
[2;36m                    [0m         [39mand doesn't change the parsing logic or API.[0m                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Preserves Existing Logic:** The fix maintains all existing functionality of [0m   [2m                [0m
[2;36m                    [0m         [39m`udev_rule_parse_value`, which expects to modify the buffer in-place. No changes to[0m [2m                [0m
[2;36m                    [0m         [39mthe parsing algorithm are needed.[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Sufficient Space:** Adding [0m[1;36m3[0m[39m extra bytes is sufficient because:[0m                [2m                [0m
[2;36m                    [0m         [39m   - Each line is processed once and multiple tokens on the same line are parsed [0m   [2m                [0m
[2;36m                    [0m         [39mleft-to-right[0m                                                                       [2m                [0m
[2;36m                    [0m         [39m   - The extra writes for each value are localized to that value's region within [0m   [2m                [0m
[2;36m                    [0m         [39mthe buffer[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - The worst case is the last token needing [0m[1;36m3[0m[39m extra bytes at the end of the [0m      [2m                [0m
[2;36m                    [0m         [39mbuffer[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m   - Since the parsing compacts the content [0m[1;39m([0m[39mremoving quotes and prefix flags[0m[1;39m)[0m[39m, the[0m [2m                [0m
[2;36m                    [0m         [39mextra [0m[1;36m3[0m[39m bytes at the end are always available[0m                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Memory Overhead:** The overhead is negligible - only [0m[1;36m3[0m[39m extra bytes per line, [0m  [2m                [0m
[2;36m                    [0m         [39mwhich is minimal compared to typical udev rule lengths [0m[1;39m([0m[39mwhich can be up to [0m         [2m                [0m
[2;36m                    [0m         [39mUDEV_LINE_SIZE = [0m[1;36m16384[0m[39m bytes[0m[1;39m)[0m[39m.[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **No Side Effects:** [0m                                                            [2m                [0m
[2;36m                    [0m         [39m   - The extra bytes are only written when needed and are always within the [0m        [2m                [0m
[2;36m                    [0m         [39mallocated region[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m   - The function already writes null terminators, so the extra space just ensures [0m [2m                [0m
[2;36m                    [0m         [39mthey don't overflow[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m   - No other code needs to be aware of this extra padding since it's beyond the [0m   [2m                [0m
[2;36m                    [0m         [39mlogical string content[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Addresses Fuzzer Issue:** This directly fixes the overflow detected by the [0m    [2m                [0m
[2;36m                    [0m         [39mfuzzer, where a [0m[1;36m7[0m[39m-byte input with specific content triggers writes beyond the [0m      [2m                [0m
[2;36m                    [0m         [39mallocated [0m[1;36m8[0m[39m-byte buffer.[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Steps[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Locate `src/udev/udev-rules.c`, function `rule_add_line` at line [0m[1;36m1339[0m            [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Replace the `[0m[1;35mstrdup[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m` call with:[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - Calculate the length: `size_t len = [0m[1;35mstrlen[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;`[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Allocate with padding: `line = [0m[1;35mmalloc[0m[1;39m([0m[39mlen + [0m[1;36m1[0m[39m + [0m[1;36m3[0m[1;39m)[0m[39m;`[0m                           [2m                [0m
[2;36m                    [0m         [39m   - Check for allocation failure: `if [0m[1;39m([0m[39m!line[0m[1;39m)[0m[39m return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;`[0m                   [2m                [0m
[2;36m                    [0m         [39m   - Copy the string: `[0m[1;35mmemcpy[0m[1;39m([0m[39mline, line_str, len + [0m[1;36m1[0m[1;39m)[0m[39m;`[0m                            [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Ensure this change is applied to the initial codebase[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why Not Alternative Approaches[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why not fix in `udev_rule_parse_value`?**[0m                                         [2m                [0m
[2;36m                    [0m         [39m- The function is designed to work in-place for efficiency[0m                          [2m                [0m
[2;36m                    [0m         [39m- Adding buffer size tracking would require changing the API and all callers[0m        [2m                [0m
[2;36m                    [0m         [39m- The function needs to know the buffer size, which is not currently passed[0m         [2m                [0m
[2;36m                    [0m         [39m- This would be a much larger change affecting multiple call sites[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why not use bounds checking in `udev_rule_parse_value`?**[0m                         [2m                [0m
[2;36m                    [0m         [39m- Would require passing buffer size information[0m                                     [2m                [0m
[2;36m                    [0m         [39m- Would complicate the parsing logic[0m                                                [2m                [0m
[2;36m                    [0m         [39m- Would need to handle cases where space is insufficient [0m[1;39m([0m[39merror handling, [0m          [2m                [0m
[2;36m                    [0m         [39mreallocation, etc.[0m[1;39m)[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m- The current design assumes sufficient space is provided by the caller[0m             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why not remove the in-place modification?**[0m                                       [2m                [0m
[2;36m                    [0m         [39m- Would require allocating new buffers for each parsed value[0m                        [2m                [0m
[2;36m                    [0m         [39m- Would change the API and require updating all callers[0m                             [2m                [0m
[2;36m                    [0m         [39m- Would have performance implications[0m                                               [2m                [0m
[2;36m                    [0m         [39m- The current design is intentional for memory efficiency[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Preservation of Existing Functionality[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis fix preserves all existing functionality:[0m                                      [2m                [0m
[2;36m                    [0m         [39m- The parsing logic remains unchanged[0m                                               [2m                [0m
[2;36m                    [0m         [39m- The nulstr format is maintained [0m[1;39m([0m[39mtwo consecutive null terminators[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m- The function API remains the same[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- All existing tests should continue to pass[0m                                        [2m                [0m
[2;36m                    [0m         [39m- The extra [0m[1;36m3[0m[39m bytes are only padding and don't affect the logical content[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Potential Side Effects and Mitigation[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Increased memory usage:** [0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Impact: [0m[1;36m3[0m[39m extra bytes per udev rule line[0m                                          [2m                [0m
[2;36m                    [0m         [39m- Mitigation: Negligible compared to typical line lengths and total memory usage[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Uninitialized bytes:**[0m                                                            [2m                [0m
[2;36m                    [0m         [39m- Impact: The [0m[1;36m3[0m[39m extra bytes beyond the copied string are uninitialized[0m              [2m                [0m
[2;36m                    [0m         [39m- Mitigation: This is acceptable because `udev_rule_parse_value` will write to [0m     [2m                [0m
[2;36m                    [0m         [39mthese bytes before they are ever read. The function always writes at least [0m[1;36m2[0m[39m null [0m  [2m                [0m
[2;36m                    [0m         [39mterminators.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Interaction with continuation lines:**[0m                                            [2m                [0m
[2;36m                    [0m         [39m- Lines [0m[1;36m1643[0m[39m-[0m[1;36m1654[0m[39m handle line continuation using `strextend`[0m                        [2m                [0m
[2;36m                    [0m         [39m- The continuation buffer is allocated separately and `strextend` handles its own [0m  [2m                [0m
[2;36m                    [0m         [39mallocation[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- No impact from this fix since `rule_add_line` receives the final concatenated [0m    [2m                [0m
[2;36m                    [0m         [39mline[0m                                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 07:35:44][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=753738;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=675499;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 07:41:40][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=567699;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=99598;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 07:42:15][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=610864;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=564261;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=117414;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=147668;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:42:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m1.00[0m seconds;               ]8;id=93516;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=149416;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 07:42:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Patching[1m)[0m Started[33m...[0m                             ]8;id=276510;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=373722;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpbrs5zjxw[0m                                                 ]8;id=198079;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=926588;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 07:44:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Patching[1m)[0m Took [1;36m104.91[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=165235;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=171925;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Checking build[1m)[0m Started[33m...[0m                       ]8;id=749534;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=206929;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:44:13][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Checking build[1m)[0m Took [1;36m11.49[0m seconds;             ]8;id=853116;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=648105;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running PoV[1m)[0m Started[33m...[0m                          ]8;id=393864;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=784354;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:44:15][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Running PoV[1m)[0m Took [1;36m2.13[0m seconds; [33mexception[0m=[3;91mFalse[0m ]8;id=936254;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=215154;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Testing[1m)[0m Started[33m...[0m                              ]8;id=167518;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=114156;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m     ]8;id=151442;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=155242;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=640140;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=976974;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:44:16][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.96[0m seconds;               ]8;id=64527;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=352762;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 07:44:18][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=436869;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=58928;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:44:20][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m1.07[0m seconds;               ]8;id=343614;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=329672;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Started[33m...[0m                        ]8;id=305803;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=122919;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 07:44:21][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0msystemd Setting owner[1m)[0m Took [1;36m0.99[0m seconds;               ]8;id=531139;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=232848;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 07:44:22][0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=977630;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=70070;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/src/udev/udev-rules.c                                                         [2m                [0m
[2;36m                    [0m         +++ b/src/udev/udev-rules.c                                                         [2m                [0m
[2;36m                    [0m         @@ [1;36m-1169[0m,[1;36m7[0m +[1;36m1169[0m,[1;36m7[0m @@                                                               [2m                [0m
[2;36m                    [0m                  if [1m([0mstr[1m[[0mpos[1m][0m != [32m'"'[0m[1m)[0m                                                       [2m                [0m
[2;36m                    [0m                          return -EINVAL;                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         -        m = str + is_escaped + is_case_insensitive + is_prefix_match;              [2m                [0m
[2;36m                    [0m         +        m = str + pos;                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                  if [1m([0m!is_escaped[1m)[0m [1m{[0m                                                         [2m                [0m
[2;36m                    [0m                          [35m/[0m* unescape double quotation [32m'\"'[0m->[32m'"'[0m *[35m/[0m                          [2m                [0m
[2;36m                    [0m         @@ [1;36m-1184[0m,[1;36m6[0m +[1;36m1184[0m,[1;36m14[0m @@                                                              [2m                [0m
[2;36m                    [0m                           * The return value must be terminated by two subsequent NULs      [2m                [0m
[2;36m                    [0m                           * so it could be safely interpreted as nulstr.                    [2m                [0m
[2;36m                    [0m                           *[35m/[0m                                                                [2m                [0m
[2;36m                    [0m         +                [35m/[0m* Verify we have space for terminators before the closing quote   [2m                [0m
[2;36m                    [0m         *[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         +                if [1m([0mis_prefix_match[1m)[0m [1m{[0m                                             [2m                [0m
[2;36m                    [0m         +                        if [1m([0mj + [1;36m2[0m > i[1m)[0m                                             [2m                [0m
[2;36m                    [0m         +                                return -EINVAL;                                    [2m                [0m
[2;36m                    [0m         +                [1m}[0m else [1m{[0m                                                           [2m                [0m
[2;36m                    [0m         +                        if [1m([0mj + [1;36m1[0m > i[1m)[0m                                             [2m                [0m
[2;36m                    [0m         +                                return -EINVAL;                                    [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                          if [1m([0mis_prefix_match[1m)[0m[1m{[0m                                              [2m                [0m
[2;36m                    [0m                                  j[1m[[0m[1;36m0[0m[1m][0m = [32m'*'[0m;                                                [2m                [0m
[2;36m                    [0m                                  j[1m[[0m[1;36m1[0m[1m][0m = [32m'\0'[0m;                                               [2m                [0m
[2;36m                    [0m         @@ [1;36m-1215[0m,[1;36m6[0m +[1;36m1223[0m,[1;36m14[0m @@                                                              [2m                [0m
[2;36m                    [0m                          * The return value must be terminated by two subsequent NULs       [2m                [0m
[2;36m                    [0m                          * so it could be safely interpreted as nulstr.                     [2m                [0m
[2;36m                    [0m                          *[35m/[0m                                                                 [2m                [0m
[2;36m                    [0m         +                [35m/[0m* Verify we have space for the unescaped content and terminators  [2m                [0m
[2;36m                    [0m         *[35m/[0m                                                                                  [2m                [0m
[2;36m                    [0m         +                if [1m([0mis_prefix_match[1m)[0m [1m{[0m                                             [2m                [0m
[2;36m                    [0m         +                        if [1m([0mstr + pos + l + [1;36m1[0m > i[1m)[0m                                 [2m                [0m
[2;36m                    [0m         +                                return -EINVAL;                                    [2m                [0m
[2;36m                    [0m         +                [1m}[0m else [1m{[0m                                                           [2m                [0m
[2;36m                    [0m         +                        if [1m([0mm + l + [1;36m1[0m > i[1m)[0m                                         [2m                [0m
[2;36m                    [0m         +                                return -EINVAL;                                    [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                          if [1m([0mis_prefix_match[1m)[0m[1m{[0m                                              [2m                [0m
[2;36m                    [0m                                  [35m/[0m* need more room to make rule glob match *[35m/[0m               [2m                [0m
[2;36m                    [0m                                  [1;35mmemcpy[0m[1m([0mstr + pos - [1;36m1[0m, unescaped, l + [1;36m1[0m[1m)[0m;                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         + [33mFUZZER[0m=[35mfuzz[0m-udev-rule-parse-value                                                 [2m                [0m
[2;36m                    [0m         + shift                                                                             [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -v TESTCASE [32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         + [33mTESTCASE[0m=[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         + [32m'[0m[32m[[0m[32m'[0m [32m'!'[0m -f [35m/[0m[95mtestcase[0m [32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         + [33mRUN_FUZZER_MODE[0m=[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         + export [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         + [33mFUZZING_ENGINE[0m=[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         + export [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         + [33mSKIP_SEED_CORPUS[0m=[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         + run_fuzzer fuzz-udev-rule-parse-value -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         vm.mmap_rnd_bits = [1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m -[33mrss_limit_mb[0m=[1;36m2560[0m -[33mtimeout[0m=[1;36m25[0m -[33mruns[0m=[1;36m100[0m [35m/[0m[95mtestcase[0m  [2m                [0m
[2;36m                    [0m         -[33mtimeout_exitcode[0m=[1;36m0[0m [1m<[0m[39m [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3942423992[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd66a920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7feffd681ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555c7db664e8[0m[39m, [0m[1;36m0x555c7db67ad7[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd681ab8[0m[39m,[0m[1;36m0x7feffd7f33e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555c7db67ad8[0m[39m,[0m[1;36m0x555c7db7d9c8[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555c7d9c61b3[0m[39m bp [0m[1;36m0x7ffedda38030[0m[39m sp [0m[1;36m0x7ffedda38028[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9c61b2[0m[39m in udev_rule_parse_value [0m                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50fe[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555c7d8ec8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsi[0m [2m                [0m
[2;36m                    [0m         [39mgned char const*, unsigned long[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9858cf[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50aa[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in [0m                     [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value[0m                                                               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpn3r1absz[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe initial issue reports a heap-buffer-overflow error detected by AddressSanitizer[0m [2m                [0m
[2;36m                    [0m         [39min the `udev_rule_parse_value` function at line [0m[1;36m1223[0m[39m of `src/udev/udev-rules.c`. [0m   [2m                [0m
[2;36m                    [0m         [39mThe fuzzer [0m[1;39m([0m[39m`fuzz-udev-rule-parse-value`[0m[1;39m)[0m[39m triggers a [0m[1;36m1[0m[39m-byte write overflow when [0m    [2m                [0m
[2;36m                    [0m         [39mprocessing a [0m[1;36m7[0m[39m-byte allocated region. A patch was attempted that modified the [0m      [2m                [0m
[2;36m                    [0m         [39mmemory allocation strategy in a different function [0m[1;39m([0m[39maround line [0m[1;36m1336[0m[1;39m)[0m[39m, replacing [0m   [2m                [0m
[2;36m                    [0m         [39m`strdup` with a manual `malloc` and `memcpy`, allocating an additional [0m[1;36m4[0m[39m bytes [0m     [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`line_len + [0m[1;36m1[0m[39m + [0m[1;36m3[0m[39m`[0m[1;39m)[0m[39m. However, after applying the patch, the same [0m                  [2m                [0m
[2;36m                    [0m         [39mheap-buffer-overflow error persists with identical characteristics, indicating the [0m [2m                [0m
[2;36m                    [0m         [39mpatch did not address the root cause.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Initial Issue[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fuzzer identifies a heap-buffer-overflow occurring at:[0m                          [2m                [0m
[2;36m                    [0m         [39m- **Location**: `[0m[35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m` in [0m   [2m                [0m
[2;36m                    [0m         [39mthe `udev_rule_parse_value` function[0m                                                [2m                [0m
[2;36m                    [0m         [39m- **Type**: WRITE of size [0m[1;36m1[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [39m- **Address**: `[0m[1;36m0x5020000000d7[0m[39m`, which is located [0m[1;36m0[0m[39m bytes after a [0m[1;36m7[0m[39m-byte allocated [0m [2m                [0m
[2;36m                    [0m         [39mregion `[0m[1;39m[[0m[1;36m0x5020000000d0[0m[39m, [0m[1;36m0x5020000000d7[0m[1;39m)[0m[39m`[0m                                           [2m                [0m
[2;36m                    [0m         [39m- **Scariness Score**: [0m[1;36m31[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe allocation trace shows the [0m[1;36m7[0m[39m-byte region was allocated in [0m                      [2m                [0m
[2;36m                    [0m         [39m`LLVMFuzzerTestOneInput` at line [0m[1;36m18[0m[39m of `fuzz-udev-rule-parse-value.c`. The shadow [0m  [2m                [0m
[2;36m                    [0m         [39mbytes indicate this is a heap allocation [0m[1;39m([0m[39m`fa` markers for heap redzones, `[0m[1;36m07[0m[39m` [0m     [2m                [0m
[2;36m                    [0m         [39mindicating [0m[1;36m7[0m[39m bytes partially addressable[0m[1;39m)[0m[39m.[0m                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mKey observations:[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The overflow occurs when writing exactly [0m[1;36m1[0m[39m byte beyond the allocated [0m[1;36m7[0m[39m-byte [0m     [2m                [0m
[2;36m                    [0m         [39mbuffer[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The allocation originates from the fuzzer harness code[0m                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The actual overflow happens in `udev_rule_parse_value` during processing[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Patch Attempt[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch was applied to `src/udev/udev-rules.c` around line [0m[1;36m1336[0m[39m, modifying a [0m     [2m                [0m
[2;36m                    [0m         [39mdifferent section of code than where the overflow occurs [0m[1;39m([0m[39mline [0m[1;36m1223[0m[1;39m)[0m[39m. The changes [0m  [2m                [0m
[2;36m                    [0m         [39mwere:[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Original code [0m[1;39m([0m[39mapproximate[0m[1;39m)[0m[39m:[0m                                                     [2m                [0m
[2;36m                    [0m         [39mline = [0m[1;35mstrdup[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m Modified code:[0m                                                                   [2m                [0m
[2;36m                    [0m         [39msize_t line_len = [0m[1;35mstrlen[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [39mline = [0m[1;35mmalloc[0m[1;39m([0m[39mline_len + [0m[1;36m1[0m[39m + [0m[1;36m3[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39m!line[0m[1;39m)[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m    return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;35mmemcpy[0m[1;39m([0m[39mline, line_str, line_len + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe patch allocates [0m[1;36m4[0m[39m additional bytes [0m[1;39m([0m[39m`line_len + [0m[1;36m1[0m[39m + [0m[1;36m3[0m[39m` instead of `line_len + [0m  [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m` from `strdup`[0m[1;39m)[0m[39m for the `line` variable and uses `memcpy` instead of `strdup`.[0m    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Result After Patch Application[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fuzzer output after applying the patch shows:[0m                                   [2m                [0m
[2;36m                    [0m         [39m- **Identical error**: Same heap-buffer-overflow at the exact same location [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39m`udev_rule_parse_value` at line [0m[1;92m1223:42[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m- **Same address and allocation**: Still a [0m[1;36m7[0m[39m-byte region at `[0m[1;36m0x5020000000d7[0m[39m`[0m        [2m                [0m
[2;36m                    [0m         [39m- **Same allocation source**: Still allocated in `LLVMFuzzerTestOneInput` at line [0m  [2m                [0m
[2;36m                    [0m         [1;36m18[0m                                                                                  [2m                [0m
[2;36m                    [0m         [39m- **Same stack trace**: The call chain remains unchanged[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis indicates the patch had no effect on resolving the issue, suggesting:[0m          [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. The modified code at line [0m[1;36m1336[0m[39m is not part of the execution path that leads to [0m  [2m                [0m
[2;36m                    [0m         [39mthe overflow at line [0m[1;36m1223[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The [0m[1;36m7[0m[39m-byte allocation is created in the fuzzer harness [0m[1;39m([0m[39mline [0m[1;36m18[0m[1;39m)[0m[39m, not in the [0m    [2m                [0m
[2;36m                    [0m         [39mpatched section[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. The overflow occurs during the processing in `udev_rule_parse_value` regardless [0m [2m                [0m
[2;36m                    [0m         [39mof the changes made elsewhere[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas Requiring Investigation[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo understand the complete picture of this issue, the following areas should be [0m    [2m                [0m
[2;36m                    [0m         [39minvestigated:[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **`src/udev/fuzz-udev-rule-parse-value.c` [0m[1;39m([0m[39mline [0m[1;36m18[0m[1;39m)[0m[39m**: Examine how the [0m[1;36m7[0m[39m-byte [0m   [2m                [0m
[2;36m                    [0m         [39mbuffer is allocated in the fuzzer harness and what input data is being prepared for[0m [2m                [0m
[2;36m                    [0m         [39m`udev_rule_parse_value`[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **`src/udev/udev-rules.c` [0m[1;39m([0m[39mline [0m[1;36m1223[0m[1;39m)[0m[39m**: Analyze the exact operation at line [0m    [2m                [0m
[2;36m                    [0m         [1;92m1223:42[0m[39m that performs the [0m[1;36m1[0m[39m-byte write overflow. This is the actual location where [0m [2m                [0m
[2;36m                    [0m         [39mthe buffer boundary violation occurs[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **The relationship between the fuzzer input and buffer allocation**: Understand [0m [2m                [0m
[2;36m                    [0m         [39mhow the fuzzer-provided data size relates to the allocated buffer size and why [0m     [2m                [0m
[2;36m                    [0m         [39mthere's a mismatch[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **`udev_rule_parse_value` function implementation**: Review the complete [0m        [2m                [0m
[2;36m                    [0m         [39mfunction to understand:[0m                                                             [2m                [0m
[2;36m                    [0m         [39m   - What buffer it operates on[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - How it determines write boundaries[0m                                             [2m                [0m
[2;36m                    [0m         [39m   - Whether it correctly accounts for null terminators or other string operations[0m  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **The code path from line [0m[1;36m1336[0m[39m to line [0m[1;36m1223[0m[39m**: Determine if these are in the [0m    [2m                [0m
[2;36m                    [0m         [39msame function or separate execution paths, which would explain why the patch had no[0m [2m                [0m
[2;36m                    [0m         [39meffect[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Input validation**: Check if there's proper validation of input sizes before [0m  [2m                [0m
[2;36m                    [0m         [39mprocessing in `udev_rule_parse_value`[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m[39m-udev-rule-parse-value[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m3942423992[0m                                                              [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd66a920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7feffd681ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555c7db664e8[0m[39m, [0m[1;36m0x555c7db67ad7[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7feffd681ab8[0m[39m,[0m[1;36m0x7feffd7f33e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555c7db67ad8[0m[39m,[0m[1;36m0x555c7db7d9c8[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555c7d9c61b3[0m[39m bp [0m[1;36m0x7ffedda38030[0m[39m sp [0m[1;36m0x7ffedda38028[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9c61b2[0m[39m in udev_rule_parse_value [0m                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50fe[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555c7d8ec8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsi[0m [2m                [0m
[2;36m                    [0m         [39mgned char const*, unsigned long[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555c7d9858cf[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555c7d9c50aa[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555c7da3cab0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555c7da27d25[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555c7da2d7bf[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555c7da58a62[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7feffc700082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in [0m                     [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value[0m                                                               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpn3r1absz[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Additional Issue Log[0m                                                             [2m                [0m
[2;36m                    [0m         [39mHere is the additional issue log after the last patch attempt:[0m                      [2m                [0m
[2;36m                    [0m         [39m<additional_issue>[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZER[0m[39m=[0m[35mfuzz[0m[39m-udev-rule-parse-value[0m                                                 [2m                [0m
[2;36m                    [0m         [39m+ shift[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -v TESTCASE [0m[32m'[0m[32m][0m[32m'[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mTESTCASE[0m[39m=[0m[35m/[0m[95mtestcase[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[32m'[0m[32m[[0m[32m'[0m[39m [0m[32m'!'[0m[39m -f [0m[35m/[0m[95mtestcase[0m[39m [0m[32m'[0m[32m][0m[32m'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mRUN_FUZZER_MODE[0m[39m=[0m[35minteractive[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mFUZZING_ENGINE[0m[39m=[0m[35mlibfuzzer[0m                                                          [2m                [0m
[2;36m                    [0m         [39m+ export [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                         [2m                [0m
[2;36m                    [0m         [39m+ [0m[33mSKIP_SEED_CORPUS[0m[39m=[0m[1;36m1[0m                                                                [2m                [0m
[2;36m                    [0m         [39m+ run_fuzzer fuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m                         [2m                [0m
[2;36m                    [0m         [39mvm.mmap_rnd_bits = [0m[1;36m28[0m                                                               [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m -[0m[33mrss_limit_mb[0m[39m=[0m[1;36m2560[0m[39m -[0m[33mtimeout[0m[39m=[0m[1;36m25[0m[39m -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m [0m[35m/[0m[95mtestcase[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39m-[0m[33mtimeout_exitcode[0m[39m=[0m[1;36m0[0m[39m < [0m[35m/dev/[0m[95mnull[0m                                                     [2m                [0m
[2;36m                    [0m         [39mINFO: Running with entropic power schedule [0m[1;39m([0m[1;36m0xFF[0m[39m, [0m[1;36m100[0m[1;39m)[0m[39m.[0m                             [2m                [0m
[2;36m                    [0m         [39mINFO: Seed: [0m[1;36m137775214[0m                                                               [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m modules   [0m[1;39m([0m[1;36m100226[0m[39m inline [0m[1;36m8[0m[39m-bit counters[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff620920[0m[39m, [0m    [2m                [0m
[2;36m                    [0m         [1;36m0x7f76ff637ab3[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m[1;39m[[0m[1;36m0x555f08d274e8[0m[39m, [0m[1;36m0x555f08d28ad7[0m[1;39m)[0m[39m, [0m                            [2m                [0m
[2;36m                    [0m         [39mINFO: Loaded [0m[1;36m2[0m[39m PC tables [0m[1;39m([0m[1;36m100226[0m[39m PCs[0m[1;39m)[0m[39m: [0m[1;36m94611[0m[39m [0m[1;39m[[0m[1;36m0x7f76ff637ab8[0m[39m,[0m[1;36m0x7f76ff7a93e8[0m[1;39m)[0m[39m, [0m[1;36m5615[0m[39m [0m [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x555f08d28ad8[0m[39m,[0m[1;36m0x555f08d3e9c8[0m[1;39m)[0m[39m, [0m                                                   [2m                [0m
[2;36m                    [0m         [35m/out/[0m[95mfuzz-udev-rule-parse-value[0m[39m: Running [0m[1;36m1[0m[39m inputs [0m[1;36m100[0m[39m [0m[1;35mtime[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m each.[0m                 [2m                [0m
[2;36m                    [0m         [39mRunning: [0m[35m/[0m[95mtestcase[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m=================================================================[0m                   [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ERROR: AddressSanitizer: heap-buffer-overflow on address [0m[1;36m0x5020000000d7[0m[39m at pc[0m [2m                [0m
[2;36m                    [0m         [1;36m0x555f08b871b3[0m[39m bp [0m[1;36m0x7ffd3c6efd30[0m[39m sp [0m[1;36m0x7ffd3c6efd28[0m                                  [2m                [0m
[2;36m                    [0m         [39mWRITE of size [0m[1;36m1[0m[39m at [0m[1;36m0x5020000000d7[0m[39m thread T0[0m                                         [2m                [0m
[2;36m                    [0m         [39mSCARINESS: [0m[1;36m31[0m[39m [0m[1;39m([0m[1;36m1[0m[39m-byte-write-heap-buffer-overflow[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b871b2[0m[39m in udev_rule_parse_value [0m                                     [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m                         [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860fe[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m22:13[0m           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m7[0m[39m [0m[1;36m0x555f08aad8bd[0m[39m in _start [0m[1;39m([0m[35m/out/[0m[95mfuzz-udev-rule-parse-value+0x9a8bd[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsi[0m [2m                [0m
[2;36m                    [0m         [39mgned char const*, unsigned long[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m0x5020000000d7[0m[39m is located [0m[1;36m0[0m[39m bytes after [0m[1;36m7[0m[39m-byte region [0m                              [2m                [0m
[2;36m                    [0m         [1;39m[[0m[1;36m0x5020000000d0[0m[39m,[0m[1;36m0x5020000000d7[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mallocated by thread T0 here:[0m                                                        [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m0[0m[39m [0m[1;36m0x555f08b468cf[0m[39m in malloc [0m                                                    [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/asan/[0m[95masan_malloc_linux.cpp[0m[39m:[0m[1;92m68:3[0m                   [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m1[0m[39m [0m[1;36m0x555f08b860aa[0m[39m in LLVMFuzzerTestOneInput [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mfuzz-udev-rule-parse-value.c[0m[39m:[0m[1;92m18:9[0m            [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m2[0m[39m [0m[1;36m0x555f08bfdad0[0m[39m in fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsigned char const*, [0m     [2m                [0m
[2;36m                    [0m         [39munsigned long[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerLoop.cpp[0m[39m:[0m[1;92m614:13[0m       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m3[0m[39m [0m[1;36m0x555f08be8d45[0m[39m in fuzzer::[0m[1;35mRunOneTest[0m[1;39m([0m[39mfuzzer::Fuzzer*, char const*, unsigned [0m [2m                [0m
[2;36m                    [0m         [39mlong[0m[1;39m)[0m[39m [0m[35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m327:6[0m               [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m4[0m[39m [0m[1;36m0x555f08bee7df[0m[39m in fuzzer::[0m[1;35mFuzzerDriver[0m[1;39m([0m[39mint*, char***, int [0m[1;39m([0m[39m*[0m[1;39m)[0m[1;39m([0m[39munsigned char [0m [2m                [0m
[2;36m                    [0m         [39mconst*, unsigned long[0m[1;39m)[0m[1;39m)[0m[39m [0m                                                            [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerDriver.cpp[0m[39m:[0m[1;92m862:9[0m                     [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m5[0m[39m [0m[1;36m0x555f08c19a82[0m[39m in main [0m                                                      [2m                [0m
[2;36m                    [0m         [35m/src/llvm-project/compiler-rt/lib/fuzzer/[0m[95mFuzzerMain.cpp[0m[39m:[0m[1;92m20:10[0m                       [2m                [0m
[2;36m                    [0m         [39m    #[0m[1;36m6[0m[39m [0m[1;36m0x7f76fe6b6082[0m[39m in __libc_start_main [0m                                         [2m                [0m
[2;36m                    [0m         [1;39m([0m[35m/lib/x86_64-linux-gnu/[0m[95mlibc.so.6+0x24082[0m[1;39m)[0m[39m [0m[1;39m([0m[39mBuildId: [0m                                [2m                [0m
[2;36m                    [0m         [39m5792732f783158c66fb4f3756458ca24e46e827d[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mDEDUP_TOKEN: [0m                                                                       [2m                [0m
[2;36m                    [0m         [39m__interceptor_malloc--LLVMFuzzerTestOneInput--fuzzer::Fuzzer::[0m[1;35mExecuteCallback[0m[1;39m([0m[39munsig[0m [2m                [0m
[2;36m                    [0m         [39mned char const*, unsigned long[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [39mSUMMARY: AddressSanitizer: heap-buffer-overflow [0m                                    [2m                [0m
[2;36m                    [0m         [35m/work/build/../../src/systemd/src/udev/[0m[95mudev-rules.c[0m[39m:[0m[1;92m1223:42[0m[39m in [0m                     [2m                [0m
[2;36m                    [0m         [39mudev_rule_parse_value[0m                                                               [2m                [0m
[2;36m                    [0m         [39mShadow bytes around the buggy address:[0m                                              [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501ffffffe80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff00[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x501fffffff80[0m[39m: [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m00[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000000[0m[39m: fa fa [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa fa fa [0m[1;36m00[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m=>[0m[1;36m0x502000000080[0m[39m: fa fa [0m[1;36m06[0m[39m fa fa fa [0m[1;36m06[0m[39m fa fa fa[0m[1;39m[[0m[1;36m07[0m[1;39m][0m[39mfa fa fa [0m[1;36m02[0m[39m fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000100[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000180[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000200[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000280[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39m  [0m[1;36m0x502000000300[0m[39m: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa[0m                   [2m                [0m
[2;36m                    [0m         [39mShadow byte legend [0m[1;39m([0m[39mone shadow byte represents [0m[1;36m8[0m[39m application bytes[0m[1;39m)[0m[39m:[0m                [2m                [0m
[2;36m                    [0m         [39m  Addressable:           [0m[1;36m00[0m                                                         [2m                [0m
[2;36m                    [0m         [39m  Partially addressable: [0m[1;36m01[0m[39m [0m[1;36m02[0m[39m [0m[1;36m03[0m[39m [0m[1;36m04[0m[39m [0m[1;36m05[0m[39m [0m[1;36m06[0m[39m [0m[1;36m07[0m[39m [0m                                      [2m                [0m
[2;36m                    [0m         [39m  Heap left redzone:       fa[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Freed heap region:       fd[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack left redzone:      f1[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack mid redzone:       f2[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack right redzone:     f3[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack after return:      f5[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Stack use after scope:   f8[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global redzone:          f9[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Global init order:       f6[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Poisoned by user:        f7[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Container overflow:      fc[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Array cookie:            ac[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Intra object redzone:    bb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  ASan internal:           fe[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Left alloca redzone:     ca[0m                                                       [2m                [0m
[2;36m                    [0m         [39m  Right alloca redzone:    cb[0m                                                       [2m                [0m
[2;36m                    [0m         [39m==[0m[1;36m18[0m[39m==ABORTING[0m                                                                      [2m                [0m
[2;36m                    [0m         [39msubprocess command returned a non-zero exit status: [0m[1;36m1[0m                               [2m                [0m
[2;36m                    [0m         [39mINFO:__main__:Running: docker run --privileged --shm-[0m[33msize[0m[39m=[0m[35m2g[0m[39m --platform linux/amd64[0m [2m                [0m
[2;36m                    [0m         [39m--rm -i -e [0m[33mHELPER[0m[39m=[0m[3;92mTrue[0m[39m -e [0m[33mARCHITECTURE[0m[39m=[0m[35mx86_64[0m[39m -v [0m                                   [2m                [0m
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m[39m:[0m[35m/[0m[95mout[0m[39m -v [0m      [2m                [0m
[2;36m                    [0m         [35m/tmp/[0m[95mtmpdvkbzrwu[0m[39m:[0m[35m/[0m[95mtestcase[0m[39m -t ghcr.io/aixcc-finals/base-runner:v1.[0m[1;36m3.0[0m[39m reproduce [0m    [2m                [0m
[2;36m                    [0m         [39mfuzz-udev-rule-parse-value -[0m[33mruns[0m[39m=[0m[1;36m100[0m[39m.[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95madditional_issue[0m[39m>[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Notes[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- All patch attempts are applied to the initial codebase. Reapply the the previous [0m [2m                [0m
[2;36m                    [0m         [39mpatches if needed.[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- If multiple different issues are present, all the issues must be resolved in a [0m   [2m                [0m
[2;36m                    [0m         [39msingle patch attempt.[0m                                                               [2m                [0m
[2;36m                    [0m         [39m- Try different approaches to resolve the issues.[0m                                   [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/fuzz-udev-rule-parse-value.[0m[1;92mc:1[0m[39m-[0m[1;36m30[0m                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:[0m[35m/[0m[39m* SPDX-License-Identifier: LGPL-[0m[1;36m2.1[0m[39m-or-later *[0m[35m/[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:#include <string.h>[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:#include [0m[32m"alloc-util.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:#include [0m[32m"fuzz.h"[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:#include [0m[32m"udev-rules.h"[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:int [0m[1;35mLLVMFuzzerTestOneInput[0m[1;39m([0m[39mconst uint8_t *data, size_t size[0m[1;39m)[0m[39m [0m[1;39m{[0m                    [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:        _cleanup_free_ char *str = NULL;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:        int r;[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:        char *value = [0m[1;35mUINT_TO_PTR[0m[1;39m([0m[1;36m0x12345678[0m[39mU[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:        char *endpos = [0m[1;35mUINT_TO_PTR[0m[1;39m([0m[1;36m0x87654321[0m[39mU[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:        bool is_case_sensitive;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:        [0m[1;35mfuzz_setup_logging[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        [0m[1;35massert_se[0m[1;39m([0m[39mstr = [0m[1;35mmalloc[0m[1;39m([0m[39msize + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr, data, size[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        str[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        r = [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mstr, &value, &endpos, &is_case_sensitive[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:                [0m[35m/[0m[39m* not modified on failure *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[39mvalue == [0m[1;35mUINT_TO_PTR[0m[1;39m([0m[1;36m0x12345678[0m[39mU[0m[1;39m)[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[39mendpos == [0m[1;35mUINT_TO_PTR[0m[1;39m([0m[1;36m0x87654321[0m[39mU[0m[1;39m)[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[39mendpos <= str + size[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:                [0m[1;35massert_se[0m[1;39m([0m[39mendpos > str + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1140[0m[39m-[0m[1;36m1239[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:int [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mchar *str, char **ret_value, char **ret_endpos, bool[0m [2m                [0m
[2;36m                    [0m         [39m*ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:        char *i, *j, *m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:        bool is_escaped = false, is_case_insensitive = false, is_prefix_match [0m [2m                [0m
[2;36m                    [0m         [39m= false;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_endpos[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:        [0m[35m/[0m[39m* check if string is prefixed with:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:         * - [0m[32m"e"[0m[39m for escaped[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:         * - [0m[32m"i"[0m[39m for case insensitive match[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:         * - [0m[32m"p"[0m[39m for prefix match[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:         * Note any permutation of these options can be set. *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:        for [0m[1;39m([0m[39mconst char *k = str; *k != [0m[32m'"'[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:                pos++;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                if [0m[1;39m([0m[39m*k == [0m[32m'e'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:                        is_escaped = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'i'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:                        is_case_insensitive = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'p'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                        is_prefix_match = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        return -EINVAL; [0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:        [0m[35m/[0m[39m* value must be double quotated *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        if [0m[1;39m([0m[39mstr[0m[1;39m[[0m[39mpos[0m[1;39m][0m[39m != [0m[32m'"'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:        [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:        m = str + is_escaped + is_case_insensitive + is_prefix_match;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1174[0m[39m:        if [0m[1;39m([0m[39m!is_escaped[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1175[0m[39m:                [0m[35m/[0m[39m* unescape double quotation [0m[32m'\"'[0m[39m->[0m[32m'"'[0m[39m *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1176[0m[39m:                for [0m[1;39m([0m[39mj = m, i = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++, j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1177[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1178[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1179[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'\\' && i[0m[32m[[0m[32m1[0m[32m][0m[32m == '[0m[39m"'[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1180[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1181[0m[39m:                        *j = *i;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1183[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1184[0m[39m:                 * The return value must be terminated by two subsequent NULs[0m  [2m                [0m
[2;36m                    [0m         [1;36m1185[0m[39m:                 * so it could be safely interpreted as nulstr.[0m                [2m                [0m
[2;36m                    [0m         [1;36m1186[0m[39m:                 *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1196[0m[39m:        [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1197[0m[39m:                _cleanup_free_ char *unescaped = NULL;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1198[0m[39m:                ssize_t l;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1199[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1200[0m[39m:                [0m[35m/[0m[39m* find the end position of value *[0m[35m/[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1201[0m[39m:                for [0m[1;39m([0m[39mi = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++[0m[1;39m)[0m[39m [0m[1;39m{[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1202[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == '\\'[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1203[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1204[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1205[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1206[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1207[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1208[0m[39m:                l = [0m[1;35mcunescape_length[0m[1;39m([0m[39mm + [0m[1;36m1[0m[39m, i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[39m, [0m[1;36m0[0m[39m, &unescaped[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m1209[0m[39m:                if [0m[1;39m([0m[39ml < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1210[0m[39m:                        return l;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1211[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1212[0m[39m:                [0m[1;35massert[0m[1;39m([0m[39ml <= i - [0m[1;39m([0m[39mm + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1213[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1214[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1215[0m[39m:                * The return value must be terminated by two subsequent NULs[0m   [2m                [0m
[2;36m                    [0m         [1;36m1216[0m[39m:                * so it could be safely interpreted as nulstr.[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1217[0m[39m:                *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1233[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1234[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1235[0m[39m:        *ret_value = str;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1236[0m[39m:        *ret_endpos = i + [0m[1;36m1[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1237[0m[39m:        *ret_is_case_insensitive = is_case_insensitive;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1238[0m[39m:        return [0m[1;36m0[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1239[0m[39m:[0m[1;39m}[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1140[0m[39m-[0m[1;36m1173[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:int [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mchar *str, char **ret_value, char **ret_endpos, bool[0m [2m                [0m
[2;36m                    [0m         [39m*ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:        char *i, *j, *m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:        bool is_escaped = false, is_case_insensitive = false, is_prefix_match [0m [2m                [0m
[2;36m                    [0m         [39m= false;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_endpos[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:        [0m[35m/[0m[39m* check if string is prefixed with:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:         * - [0m[32m"e"[0m[39m for escaped[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:         * - [0m[32m"i"[0m[39m for case insensitive match[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:         * - [0m[32m"p"[0m[39m for prefix match[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:         * Note any permutation of these options can be set. *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:        for [0m[1;39m([0m[39mconst char *k = str; *k != [0m[32m'"'[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:                pos++;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                if [0m[1;39m([0m[39m*k == [0m[32m'e'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:                        is_escaped = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'i'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:                        is_case_insensitive = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'p'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                        is_prefix_match = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        return -EINVAL; [0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:        [0m[35m/[0m[39m* value must be double quotated *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        if [0m[1;39m([0m[39mstr[0m[1;39m[[0m[39mpos[0m[1;39m][0m[39m != [0m[32m'"'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:        [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:        m = str + is_escaped + is_case_insensitive + is_prefix_match;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1174[0m[39m-[0m[1;36m1195[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1174[0m[39m:        if [0m[1;39m([0m[39m!is_escaped[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1175[0m[39m:                [0m[35m/[0m[39m* unescape double quotation [0m[32m'\"'[0m[39m->[0m[32m'"'[0m[39m *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1176[0m[39m:                for [0m[1;39m([0m[39mj = m, i = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++, j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1177[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1178[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1179[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'\\' && i[0m[32m[[0m[32m1[0m[32m][0m[32m == '[0m[39m"'[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1180[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1181[0m[39m:                        *j = *i;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1183[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1184[0m[39m:                 * The return value must be terminated by two subsequent NULs[0m  [2m                [0m
[2;36m                    [0m         [1;36m1185[0m[39m:                 * so it could be safely interpreted as nulstr.[0m                [2m                [0m
[2;36m                    [0m         [1;36m1186[0m[39m:                 *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1218[0m[39m-[0m[1;36m1232[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1327[0m[39m-[0m[1;36m1372[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:static int [0m[1;35mrule_add_line[0m[1;39m([0m[39mUdevRuleFile *rule_file, const char *line_str, [0m       [2m                [0m
[2;36m                    [0m         [39munsigned line_nr, bool extra_checks[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mudev_rule_line_freep[0m[1;39m)[0m[39m UdevRuleLine *rule_line = NULL;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:        _cleanup_free_ char *line = NULL;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:        char *p;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mrule_file[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1336[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1337[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1338[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m:        line = [0m[1;35mstrdup[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1340[0m[39m:        if [0m[1;39m([0m[39m!line[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1341[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1342[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1343[0m[39m:        rule_line = [0m[1;35mnew[0m[1;39m([0m[39mUdevRuleLine, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1344[0m[39m:        if [0m[1;39m([0m[39m!rule_line[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1345[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1346[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1347[0m[39m:        *rule_line = [0m[1;39m([0m[39mUdevRuleLine[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1348[0m[39m:                .line = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1349[0m[39m:                .line_number = line_nr,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1350[0m[39m:                .rule_file = rule_file,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1353[0m[39m:        [0m[1;35mLIST_APPEND[0m[1;39m([0m[39mrule_lines, rule_file->rule_lines, rule_line[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1354[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1355[0m[39m:        for [0m[1;39m([0m[39mp = rule_line->line; ![0m[1;35misempty[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m; [0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1356[0m[39m:                char *key, *attr, *value;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1357[0m[39m:                UdevRuleOperatorType op;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1358[0m[39m:                bool is_case_insensitive;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1359[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1360[0m[39m:                if [0m[1;39m([0m[39mextra_checks[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1361[0m[39m:                        [0m[1;35mcheck_token_delimiters[0m[1;39m([0m[39mrule_line, p[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1362[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1363[0m[39m:                r = [0m[1;35mparse_line[0m[1;39m([0m[39m&p, &key, &attr, &op, &value, [0m                  [2m                [0m
[2;36m                    [0m         [39m&is_case_insensitive[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1364[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1365[0m[39m:                        return [0m[1;35mlog_line_error_errno[0m[1;39m([0m[39mrule_line, r, [0m[32m"Invalid [0m    [2m                [0m
[2;36m                    [0m         [32mkey/value pair, ignoring."[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:                if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1369[0m[39m:                r = [0m[1;35mparse_token[0m[1;39m([0m[39mrule_line, key, attr, op, value, [0m              [2m                [0m
[2;36m                    [0m         [39mis_case_insensitive[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:                        return r;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1284[0m[39m-[0m[1;36m1288[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1284[0m[39m:        tmp += op == OP_ASSIGN ? [0m[1;36m1[0m[39m : [0m[1;36m2[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1285[0m[39m:        tmp = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mtmp, NULL[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1286[0m[39m:        r = [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mtmp, ret_value, line, [0m                       [2m                [0m
[2;36m                    [0m         [39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1287[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1288[0m[39m:                return r;[0m                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1140[0m[39m-[0m[1;36m1173[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:int [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mchar *str, char **ret_value, char **ret_endpos, bool[0m [2m                [0m
[2;36m                    [0m         [39m*ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:        char *i, *j, *m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:        bool is_escaped = false, is_case_insensitive = false, is_prefix_match [0m [2m                [0m
[2;36m                    [0m         [39m= false;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_endpos[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:        [0m[35m/[0m[39m* check if string is prefixed with:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:         * - [0m[32m"e"[0m[39m for escaped[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:         * - [0m[32m"i"[0m[39m for case insensitive match[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:         * - [0m[32m"p"[0m[39m for prefix match[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:         * Note any permutation of these options can be set. *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:        for [0m[1;39m([0m[39mconst char *k = str; *k != [0m[32m'"'[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:                pos++;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                if [0m[1;39m([0m[39m*k == [0m[32m'e'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:                        is_escaped = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'i'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:                        is_case_insensitive = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'p'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                        is_prefix_match = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        return -EINVAL; [0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:        [0m[35m/[0m[39m* value must be double quotated *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        if [0m[1;39m([0m[39mstr[0m[1;39m[[0m[39mpos[0m[1;39m][0m[39m != [0m[32m'"'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:        [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:        m = str + is_escaped + is_case_insensitive + is_prefix_match;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1187[0m[39m-[0m[1;36m1195[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1218[0m[39m-[0m[1;36m1232[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/basic/escape.[0m[1;92mc:292[0m[39m-[0m[1;36m362[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m292[0m[39m:ssize_t [0m[1;35mcunescape_length_with_prefix[0m[1;39m([0m[39mconst char *s, size_t length, const char [0m  [2m                [0m
[2;36m                    [0m         [39m*prefix, UnescapeFlags flags, char **ret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m293[0m[39m:        _cleanup_free_ char *ans = NULL;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m294[0m[39m:        char *t;[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m295[0m[39m:        const char *f;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m296[0m[39m:        size_t pl;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m297[0m[39m:        int r;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m298[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m299[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39ms[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m300[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m301[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m302[0m[39m:        [0m[35m/[0m[39m* Undoes C style string escaping, and optionally prefixes it. *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m303[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m304[0m[39m:        pl = [0m[1;35mstrlen_ptr[0m[1;39m([0m[39mprefix[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m305[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m306[0m[39m:        ans = [0m[1;35mnew[0m[1;39m([0m[39mchar, pl+length+[0m[1;36m1[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m307[0m[39m:        if [0m[1;39m([0m[39m!ans[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m308[0m[39m:                return -ENOMEM;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m309[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m310[0m[39m:        if [0m[1;39m([0m[39mprefix[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m311[0m[39m:                [0m[1;35mmemcpy[0m[1;39m([0m[39mans, prefix, pl[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m312[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m313[0m[39m:        for [0m[1;39m([0m[39mf = s, t = ans + pl; f < s + length; f++[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m314[0m[39m:                size_t remaining;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m315[0m[39m:                bool eight_bit = false;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m316[0m[39m:                char32_t u;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m317[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m318[0m[39m:                remaining = s + length - f;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m319[0m[39m:                [0m[1;35massert[0m[1;39m([0m[39mremaining > [0m[1;36m0[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m320[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m321[0m[39m:                if [0m[1;39m([0m[39m*f != '\\'[0m[1;39m)[0m[39m [0m[1;39m{[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m322[0m[39m:                        [0m[35m/[0m[39m* A literal, copy verbatim *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;36m323[0m[39m:                        *[0m[1;39m([0m[39mt++[0m[1;39m)[0m[39m = *f;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m324[0m[39m:                        continue;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m325[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m326[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m327[0m[39m:                if [0m[1;39m([0m[39mremaining == [0m[1;36m1[0m[1;39m)[0m[39m [0m[1;39m{[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m328[0m[39m:                        if [0m[1;39m([0m[39mflags & UNESCAPE_RELAX[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m329[0m[39m:                                [0m[35m/[0m[39m* A trailing backslash, copy verbatim *[0m[35m/[0m       [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:                                *[0m[1;39m([0m[39mt++[0m[1;39m)[0m[39m = *f;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:                                continue;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:                        return -EINVAL;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:                r = [0m[1;35mcunescape_one[0m[1;39m([0m[39mf + [0m[1;36m1[0m[39m, remaining - [0m[1;36m1[0m[39m, &u, &eight_bit, flags &[0m [2m                [0m
[2;36m                    [0m         [39mUNESCAPE_ACCEPT_NUL[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:                        if [0m[1;39m([0m[39mflags & UNESCAPE_RELAX[0m[1;39m)[0m[39m [0m[1;39m{[0m                           [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:                                [0m[35m/[0m[39m* Invalid escape code, let's take it literal [0m  [2m                [0m
[2;36m                    [0m         [39mthen *[0m[35m/[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                                *[0m[1;39m([0m[39mt++[0m[1;39m)[0m[39m = '\\';[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:                                continue;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:                        return r;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:                f += r;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:                if [0m[1;39m([0m[39meight_bit[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:                        [0m[35m/[0m[39m* One byte? Set directly as specified *[0m[35m/[0m               [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:                        *[0m[1;39m([0m[39mt++[0m[1;39m)[0m[39m = u;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:                        [0m[35m/[0m[39m* Otherwise encode as multi-byte UTF-[0m[1;36m8[0m[39m *[0m[35m/[0m              [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:                        t += [0m[1;35mutf8_encode_unichar[0m[1;39m([0m[39mt, u[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:        *t = [0m[1;36m0[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mt >= ans[0m[1;39m)[0m[39m; [0m[35m/[0m[39m* Let static analyzers know that the answer is [0m      [2m                [0m
[2;36m                    [0m         [39mnon-negative. *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:        *ret = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mans[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        return t - *ret;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:[0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1567[0m[39m-[0m[1;36m1677[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:int [0m[1;35mudev_rules_parse_file[0m[1;39m([0m[39mUdevRules *rules, const char *filename, bool [0m        [2m                [0m
[2;36m                    [0m         [39mextra_checks, UdevRuleFile **ret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mudev_rule_file_freep[0m[1;39m)[0m[39m UdevRuleFile *rule_file = NULL;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:        _cleanup_free_ char *continuation = NULL, *name = NULL;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:        _cleanup_fclose_ FILE *f = NULL;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:        bool ignore_line = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:        unsigned line_nr = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:        struct stat st;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1575[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mrules[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:        f = [0m[1;35mfopen[0m[1;39m([0m[39mfilename, [0m[32m"re"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:        if [0m[1;39m([0m[39m!f[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1581[0m[39m:                if [0m[1;39m([0m[39mextra_checks[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1582[0m[39m:                        return -errno;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1584[0m[39m:                if [0m[1;39m([0m[39merrno == ENOENT[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1585[0m[39m:                        return [0m[1;36m0[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1586[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1587[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39merrno, [0m[32m"Failed to open %s, ignoring: [0m [2m                [0m
[2;36m                    [0m         [32m%m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:        if [0m[1;39m([0m[1;35mfstat[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m, &st[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39merrno, [0m[32m"Failed to stat %s, ignoring: [0m [2m                [0m
[2;36m                    [0m         [32m%m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:        if [0m[1;39m([0m[1;35mnull_or_empty[0m[1;39m([0m[39m&st[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:                [0m[1;35mlog_debug[0m[1;39m([0m[32m"Skipping empty file: %s"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:                if [0m[1;39m([0m[39mret[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:                        *ret = NULL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:        r = [0m[1;35mhashmap_put_stats_by_path[0m[1;39m([0m[39m&rules->stats_by_path, filename, &st[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to save stat for %s, [0m      [2m                [0m
[2;36m                    [0m         [32mignoring: %m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;35mfd_warn_permissions[0m[1;39m([0m[39mfilename, [0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:        [0m[1;35mlog_debug[0m[1;39m([0m[32m"Reading rules file: %s"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:        name = [0m[1;35mstrdup[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:        if [0m[1;39m([0m[39m!name[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:        rule_file = [0m[1;35mnew[0m[1;39m([0m[39mUdevRuleFile, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:        if [0m[1;39m([0m[39m!rule_file[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:        *rule_file = [0m[1;39m([0m[39mUdevRuleFile[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:                .filename = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:                .rules = rules,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:        [0m[1;35mLIST_APPEND[0m[1;39m([0m[39mrule_files, rules->rule_files, rule_file[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:        for [0m[1;39m([0m[39m;;[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:                _cleanup_free_ char *buf = NULL;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:                size_t len;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:                char *line;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:                r = [0m[1;35mread_line[0m[1;39m([0m[39mf, UDEV_LINE_SIZE, &buf[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:                        return r;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:                if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:                line_nr++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:                line = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mbuf, NULL[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:                [0m[35m/[0m[39m* Lines beginning with [0m[32m'#'[0m[39m are ignored regardless of line [0m    [2m                [0m
[2;36m                    [0m         [39mcontinuation. *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:                if [0m[1;39m([0m[39mline[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'#'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1639[0m[39m:                        continue;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:                len = [0m[1;35mstrlen[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1643[0m[39m:                if [0m[1;39m([0m[39mcontinuation && !ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1644[0m[39m:                        if [0m[1;39m([0m[1;35mstrlen[0m[1;39m([0m[39mcontinuation[0m[1;39m)[0m[39m + len >= UDEV_LINE_SIZE[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1645[0m[39m:                                ignore_line = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1646[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1647[0m[39m:                        if [0m[1;39m([0m[39m![0m[1;35mstrextend[0m[1;39m([0m[39m&continuation, line[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1648[0m[39m:                                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1649[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1650[0m[39m:                        if [0m[1;39m([0m[39m!ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1651[0m[39m:                                line = continuation;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1652[0m[39m:                                len = [0m[1;35mstrlen[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1653[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1654[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1655[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1656[0m[39m:                if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[39m && line[0m[1;39m[[0m[39mlen - [0m[1;36m1[0m[1;39m][0m[39m == '\\'[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1657[0m[39m:                        if [0m[1;39m([0m[39mignore_line[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1658[0m[39m:                                continue;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1659[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1660[0m[39m:                        line[0m[1;39m[[0m[39mlen - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1661[0m[39m:                        if [0m[1;39m([0m[39m!continuation[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1662[0m[39m:                                continuation = [0m[1;35mstrdup[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1663[0m[39m:                                if [0m[1;39m([0m[39m!continuation[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1664[0m[39m:                                        return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1665[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1666[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1667[0m[39m:                        continue;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1668[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1669[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1670[0m[39m:                if [0m[1;39m([0m[39mignore_line[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1671[0m[39m:                        [0m[1;35mlog_file_error[0m[1;39m([0m[39mrule_file, line_nr, [0m[32m"Line is too long, [0m [2m                [0m
[2;36m                    [0m         [32mignored."[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1672[0m[39m:                else if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1673[0m[39m:                        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;35mrule_add_line[0m[1;39m([0m[39mrule_file, line, line_nr, [0m        [2m                [0m
[2;36m                    [0m         [39mextra_checks[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1674[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1675[0m[39m:                continuation = [0m[1;35mmfree[0m[1;39m([0m[39mcontinuation[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1676[0m[39m:                ignore_line = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1677[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.h:[0m[1;36m10[0m[39m-[0m[1;36m11[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:#define UDEV_LINE_SIZE [0m[1;36m16384[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1187[0m[39m-[0m[1;36m1195[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1218[0m[39m-[0m[1;36m1232[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/fuzz-udev-rule-parse-value.[0m[1;92mc:16[0m[39m-[0m[1;36m22[0m                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:        [0m[1;35mfuzz_setup_logging[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:        [0m[1;35massert_se[0m[1;39m([0m[39mstr = [0m[1;35mmalloc[0m[1;39m([0m[39msize + [0m[1;36m1[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr, data, size[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:        str[0m[1;39m[[0m[39msize[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:        r = [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mstr, &value, &endpos, &is_case_sensitive[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1140[0m[39m-[0m[1;36m1173[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1140[0m[39m:int [0m[1;35mudev_rule_parse_value[0m[1;39m([0m[39mchar *str, char **ret_value, char **ret_endpos, bool[0m [2m                [0m
[2;36m                    [0m         [39m*ret_is_case_insensitive[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1141[0m[39m:        char *i, *j, *m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1142[0m[39m:        bool is_escaped = false, is_case_insensitive = false, is_prefix_match [0m [2m                [0m
[2;36m                    [0m         [39m= false;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m1143[0m[39m:        int pos = [0m[1;36m0[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1144[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1145[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mstr[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1146[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_value[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1147[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_endpos[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1148[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mret_is_case_insensitive[0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1149[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1150[0m[39m:        [0m[35m/[0m[39m* check if string is prefixed with:[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1151[0m[39m:         * - [0m[32m"e"[0m[39m for escaped[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1152[0m[39m:         * - [0m[32m"i"[0m[39m for case insensitive match[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1153[0m[39m:         * - [0m[32m"p"[0m[39m for prefix match[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1154[0m[39m:         *[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1155[0m[39m:         * Note any permutation of these options can be set. *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:        for [0m[1;39m([0m[39mconst char *k = str; *k != [0m[32m'"'[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:                pos++;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                if [0m[1;39m([0m[39m*k == [0m[32m'e'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:                        is_escaped = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'i'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:                        is_case_insensitive = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'p'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                        is_prefix_match = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        return -EINVAL; [0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:        [0m[35m/[0m[39m* value must be double quotated *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        if [0m[1;39m([0m[39mstr[0m[1;39m[[0m[39mpos[0m[1;39m][0m[39m != [0m[32m'"'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:        [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:        m = str + is_escaped + is_case_insensitive + is_prefix_match;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1218[0m[39m-[0m[1;36m1232[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1156[0m[39m-[0m[1;36m1173[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1156[0m[39m:        for [0m[1;39m([0m[39mconst char *k = str; *k != [0m[32m'"'[0m[39m; k++[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1157[0m[39m:                pos++;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1158[0m[39m:                if [0m[1;39m([0m[39m*k == [0m[32m'e'[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1159[0m[39m:                        is_escaped = true;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1160[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'i'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1161[0m[39m:                        is_case_insensitive = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1162[0m[39m:                else if [0m[1;39m([0m[39m*k == [0m[32m'p'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1163[0m[39m:                        is_prefix_match = true;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1164[0m[39m:                else[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1165[0m[39m:                        return -EINVAL; [0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1166[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1167[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1168[0m[39m:        [0m[35m/[0m[39m* value must be double quotated *[0m[35m/[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1169[0m[39m:        if [0m[1;39m([0m[39mstr[0m[1;39m[[0m[39mpos[0m[1;39m][0m[39m != [0m[32m'"'[0m[1;39m)[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1170[0m[39m:                return -EINVAL;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1171[0m[39m:        [0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:        m = str + is_escaped + is_case_insensitive + is_prefix_match;[0m          [2m                [0m
[2;36m                    [0m         [1;36m1173[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1218[0m[39m-[0m[1;36m1224[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1187[0m[39m-[0m[1;36m1195[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1174[0m[39m-[0m[1;36m1182[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1174[0m[39m:        if [0m[1;39m([0m[39m!is_escaped[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1175[0m[39m:                [0m[35m/[0m[39m* unescape double quotation [0m[32m'\"'[0m[39m->[0m[32m'"'[0m[39m *[0m[35m/[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1176[0m[39m:                for [0m[1;39m([0m[39mj = m, i = m + [0m[1;36m1[0m[39m; *i != [0m[32m'"'[0m[39m; i++, j++[0m[1;39m)[0m[39m [0m[1;39m{[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1177[0m[39m:                        if [0m[1;39m([0m[39m*i == [0m[32m'\0'[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1178[0m[39m:                                return -EINVAL;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1179[0m[39m:                        if [0m[1;39m([0m[39mi[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'\\' && i[0m[32m[[0m[32m1[0m[32m][0m[32m == '[0m[39m"'[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1180[0m[39m:                                i++;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1181[0m[39m:                        *j = *i;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1327[0m[39m-[0m[1;36m1372[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1327[0m[39m:static int [0m[1;35mrule_add_line[0m[1;39m([0m[39mUdevRuleFile *rule_file, const char *line_str, [0m       [2m                [0m
[2;36m                    [0m         [39munsigned line_nr, bool extra_checks[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1328[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mudev_rule_line_freep[0m[1;39m)[0m[39m UdevRuleLine *rule_line = NULL;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1329[0m[39m:        _cleanup_free_ char *line = NULL;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1330[0m[39m:        char *p;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1331[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1332[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1333[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mrule_file[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1334[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1335[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1336[0m[39m:        if [0m[1;39m([0m[1;35misempty[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1337[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1338[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1339[0m[39m:        line = [0m[1;35mstrdup[0m[1;39m([0m[39mline_str[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1340[0m[39m:        if [0m[1;39m([0m[39m!line[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1341[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1342[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1343[0m[39m:        rule_line = [0m[1;35mnew[0m[1;39m([0m[39mUdevRuleLine, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1344[0m[39m:        if [0m[1;39m([0m[39m!rule_line[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1345[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1346[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1347[0m[39m:        *rule_line = [0m[1;39m([0m[39mUdevRuleLine[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1348[0m[39m:                .line = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1349[0m[39m:                .line_number = line_nr,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1350[0m[39m:                .rule_file = rule_file,[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m1351[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1352[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1353[0m[39m:        [0m[1;35mLIST_APPEND[0m[1;39m([0m[39mrule_lines, rule_file->rule_lines, rule_line[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m1354[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1355[0m[39m:        for [0m[1;39m([0m[39mp = rule_line->line; ![0m[1;35misempty[0m[1;39m([0m[39mp[0m[1;39m)[0m[39m; [0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1356[0m[39m:                char *key, *attr, *value;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1357[0m[39m:                UdevRuleOperatorType op;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1358[0m[39m:                bool is_case_insensitive;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1359[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1360[0m[39m:                if [0m[1;39m([0m[39mextra_checks[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1361[0m[39m:                        [0m[1;35mcheck_token_delimiters[0m[1;39m([0m[39mrule_line, p[0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m1362[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1363[0m[39m:                r = [0m[1;35mparse_line[0m[1;39m([0m[39m&p, &key, &attr, &op, &value, [0m                  [2m                [0m
[2;36m                    [0m         [39m&is_case_insensitive[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1364[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1365[0m[39m:                        return [0m[1;35mlog_line_error_errno[0m[1;39m([0m[39mrule_line, r, [0m[32m"Invalid [0m    [2m                [0m
[2;36m                    [0m         [32mkey/value pair, ignoring."[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1366[0m[39m:                if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1367[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1368[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1369[0m[39m:                r = [0m[1;35mparse_token[0m[1;39m([0m[39mrule_line, key, attr, op, value, [0m              [2m                [0m
[2;36m                    [0m         [39mis_case_insensitive[0m[1;39m)[0m[39m;[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m1370[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1371[0m[39m:                        return r;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1372[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1567[0m[39m-[0m[1;36m1677[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1567[0m[39m:int [0m[1;35mudev_rules_parse_file[0m[1;39m([0m[39mUdevRules *rules, const char *filename, bool [0m        [2m                [0m
[2;36m                    [0m         [39mextra_checks, UdevRuleFile **ret[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1568[0m[39m:        [0m[1;35m_cleanup_[0m[1;39m([0m[39mudev_rule_file_freep[0m[1;39m)[0m[39m UdevRuleFile *rule_file = NULL;[0m        [2m                [0m
[2;36m                    [0m         [1;36m1569[0m[39m:        _cleanup_free_ char *continuation = NULL, *name = NULL;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1570[0m[39m:        _cleanup_fclose_ FILE *f = NULL;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1571[0m[39m:        bool ignore_line = false;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1572[0m[39m:        unsigned line_nr = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m1573[0m[39m:        struct stat st;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1574[0m[39m:        int r;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1575[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1576[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mrules[0m[1;39m)[0m[39m;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1577[0m[39m:        [0m[1;35massert[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1578[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1579[0m[39m:        f = [0m[1;35mfopen[0m[1;39m([0m[39mfilename, [0m[32m"re"[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m1580[0m[39m:        if [0m[1;39m([0m[39m!f[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1581[0m[39m:                if [0m[1;39m([0m[39mextra_checks[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1582[0m[39m:                        return -errno;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1583[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1584[0m[39m:                if [0m[1;39m([0m[39merrno == ENOENT[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1585[0m[39m:                        return [0m[1;36m0[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1586[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1587[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39merrno, [0m[32m"Failed to open %s, ignoring: [0m [2m                [0m
[2;36m                    [0m         [32m%m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1588[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1589[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1590[0m[39m:        if [0m[1;39m([0m[1;35mfstat[0m[1;39m([0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[39m, &st[0m[1;39m)[0m[39m < [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m1591[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39merrno, [0m[32m"Failed to stat %s, ignoring: [0m [2m                [0m
[2;36m                    [0m         [32m%m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1592[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1593[0m[39m:        if [0m[1;39m([0m[1;35mnull_or_empty[0m[1;39m([0m[39m&st[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1594[0m[39m:                [0m[1;35mlog_debug[0m[1;39m([0m[32m"Skipping empty file: %s"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m1595[0m[39m:                if [0m[1;39m([0m[39mret[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1596[0m[39m:                        *ret = NULL;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1597[0m[39m:                return [0m[1;36m0[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1598[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1599[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1600[0m[39m:        r = [0m[1;35mhashmap_put_stats_by_path[0m[1;39m([0m[39m&rules->stats_by_path, filename, &st[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m1601[0m[39m:        if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1602[0m[39m:                return [0m[1;35mlog_warning_errno[0m[1;39m([0m[39mr, [0m[32m"Failed to save stat for %s, [0m      [2m                [0m
[2;36m                    [0m         [32mignoring: %m"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m1603[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1604[0m[39m:        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;35mfd_warn_permissions[0m[1;39m([0m[39mfilename, [0m[1;35mfileno[0m[1;39m([0m[39mf[0m[1;39m)[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m1605[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1606[0m[39m:        [0m[1;35mlog_debug[0m[1;39m([0m[32m"Reading rules file: %s"[0m[39m, filename[0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m1607[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1608[0m[39m:        name = [0m[1;35mstrdup[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1609[0m[39m:        if [0m[1;39m([0m[39m!name[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1610[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1611[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1612[0m[39m:        rule_file = [0m[1;35mnew[0m[1;39m([0m[39mUdevRuleFile, [0m[1;36m1[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1613[0m[39m:        if [0m[1;39m([0m[39m!rule_file[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m1614[0m[39m:                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1615[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1616[0m[39m:        *rule_file = [0m[1;39m([0m[39mUdevRuleFile[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1617[0m[39m:                .filename = [0m[1;35mTAKE_PTR[0m[1;39m([0m[39mname[0m[1;39m)[0m[39m,[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1618[0m[39m:                .rules = rules,[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m1619[0m[39m:        [0m[1;39m}[0m[39m;[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m1620[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1621[0m[39m:        [0m[1;35mLIST_APPEND[0m[1;39m([0m[39mrule_files, rules->rule_files, rule_file[0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m1622[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1623[0m[39m:        for [0m[1;39m([0m[39m;;[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1624[0m[39m:                _cleanup_free_ char *buf = NULL;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1625[0m[39m:                size_t len;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1626[0m[39m:                char *line;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1627[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1628[0m[39m:                r = [0m[1;35mread_line[0m[1;39m([0m[39mf, UDEV_LINE_SIZE, &buf[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1629[0m[39m:                if [0m[1;39m([0m[39mr < [0m[1;36m0[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1630[0m[39m:                        return r;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1631[0m[39m:                if [0m[1;39m([0m[39mr == [0m[1;36m0[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m1632[0m[39m:                        break;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m1633[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1634[0m[39m:                line_nr++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1635[0m[39m:                line = [0m[1;35mskip_leading_chars[0m[1;39m([0m[39mbuf, NULL[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m1636[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1637[0m[39m:                [0m[35m/[0m[39m* Lines beginning with [0m[32m'#'[0m[39m are ignored regardless of line [0m    [2m                [0m
[2;36m                    [0m         [39mcontinuation. *[0m[35m/[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m1638[0m[39m:                if [0m[1;39m([0m[39mline[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m == [0m[32m'#'[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1639[0m[39m:                        continue;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1640[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1641[0m[39m:                len = [0m[1;35mstrlen[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1642[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1643[0m[39m:                if [0m[1;39m([0m[39mcontinuation && !ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1644[0m[39m:                        if [0m[1;39m([0m[1;35mstrlen[0m[1;39m([0m[39mcontinuation[0m[1;39m)[0m[39m + len >= UDEV_LINE_SIZE[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m1645[0m[39m:                                ignore_line = true;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1646[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1647[0m[39m:                        if [0m[1;39m([0m[39m![0m[1;35mstrextend[0m[1;39m([0m[39m&continuation, line[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1648[0m[39m:                                return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m1649[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1650[0m[39m:                        if [0m[1;39m([0m[39m!ignore_line[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m1651[0m[39m:                                line = continuation;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1652[0m[39m:                                len = [0m[1;35mstrlen[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1653[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1654[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1655[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1656[0m[39m:                if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[39m && line[0m[1;39m[[0m[39mlen - [0m[1;36m1[0m[1;39m][0m[39m == '\\'[0m[1;39m)[0m[39m [0m[1;39m{[0m                        [2m                [0m
[2;36m                    [0m         [1;36m1657[0m[39m:                        if [0m[1;39m([0m[39mignore_line[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1658[0m[39m:                                continue;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m1659[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1660[0m[39m:                        line[0m[1;39m[[0m[39mlen - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m1661[0m[39m:                        if [0m[1;39m([0m[39m!continuation[0m[1;39m)[0m[39m [0m[1;39m{[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1662[0m[39m:                                continuation = [0m[1;35mstrdup[0m[1;39m([0m[39mline[0m[1;39m)[0m[39m;[0m                   [2m                [0m
[2;36m                    [0m         [1;36m1663[0m[39m:                                if [0m[1;39m([0m[39m!continuation[0m[1;39m)[0m                             [2m                [0m
[2;36m                    [0m         [1;36m1664[0m[39m:                                        return [0m[1;35mlog_oom[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m1665[0m[39m:                        [0m[1;39m}[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m1666[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1667[0m[39m:                        continue;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1668[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1669[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1670[0m[39m:                if [0m[1;39m([0m[39mignore_line[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m1671[0m[39m:                        [0m[1;35mlog_file_error[0m[1;39m([0m[39mrule_file, line_nr, [0m[32m"Line is too long, [0m [2m                [0m
[2;36m                    [0m         [32mignored."[0m[1;39m)[0m[39m;[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m1672[0m[39m:                else if [0m[1;39m([0m[39mlen > [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m1673[0m[39m:                        [0m[1;39m([0m[39mvoid[0m[1;39m)[0m[39m [0m[1;35mrule_add_line[0m[1;39m([0m[39mrule_file, line, line_nr, [0m        [2m                [0m
[2;36m                    [0m         [39mextra_checks[0m[1;39m)[0m[39m;[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m1674[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1675[0m[39m:                continuation = [0m[1;35mmfree[0m[1;39m([0m[39mcontinuation[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m1676[0m[39m:                ignore_line = false;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1677[0m[39m:        [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1172[0m[39m-[0m[1;36m1172[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1172[0m[39m:        m = str + is_escaped + is_case_insensitive + is_prefix_match;[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1182[0m[39m-[0m[1;36m1195[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1182[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1183[0m[39m:                [0m[35m/[0m[39m*[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1184[0m[39m:                 * The return value must be terminated by two subsequent NULs[0m  [2m                [0m
[2;36m                    [0m         [1;36m1185[0m[39m:                 * so it could be safely interpreted as nulstr.[0m                [2m                [0m
[2;36m                    [0m         [1;36m1186[0m[39m:                 *[0m[35m/[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m1187[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1188[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m1189[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1190[0m[39m:                        j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1191[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1192[0m[39m:                        j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1193[0m[39m:                        j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1194[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1195[0m[39m:                str = m;            [0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39msrc/udev/udev-rules.[0m[1;92mc:1217[0m[39m-[0m[1;36m1232[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1217[0m[39m:                *[0m[35m/[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m1218[0m[39m:                if [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m1219[0m[39m:                        [0m[35m/[0m[39m* need more room to make rule glob match *[0m[35m/[0m           [2m                [0m
[2;36m                    [0m         [1;36m1220[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mstr + pos - [0m[1;36m1[0m[39m, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m1221[0m[39m:                        str[0m[1;39m[[0m[39mpos + l - [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'*'[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m1222[0m[39m:                        str[0m[1;39m[[0m[39mpos + l[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m1223[0m[39m:                        str[0m[1;39m[[0m[39mpos + l + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m1224[0m[39m:                        m = str + pos - [0m[1;36m1[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m1225[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m1226[0m[39m:                [0m[1;39m}[0m[39m else [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1227[0m[39m:                        [0m[1;35mmemcpy[0m[1;39m([0m[39mm, unescaped, l + [0m[1;36m1[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m1228[0m[39m:                        m[0m[1;39m[[0m[39ml[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m1229[0m[39m:                        m[0m[1;39m[[0m[39ml + [0m[1;36m1[0m[1;39m][0m[39m = [0m[32m'\0'[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m1230[0m[39m:                [0m[1;39m}[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m1231[0m[39m:                str = m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m1232[0m[39m:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Updated Analysis with Retrieved Code[0m                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mNow that I have the complete `udev_rule_parse_value` function, I can see the exact [0m [2m                [0m
[2;36m                    [0m         [39missue and formulate a precise fix.[0m                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Key Observations[0m                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Line [0m[1;36m1172[0m[39m is WRONG**: `m = str + is_escaped + is_case_insensitive + [0m           [2m                [0m
[2;36m                    [0m         [39mis_prefix_match;`[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m   - This adds boolean values [0m[1;39m([0m[1;36m0[0m[39m or [0m[1;36m1[0m[1;39m)[0m[39m as integers, which gives incorrect pointer [0m  [2m                [0m
[2;36m                    [0m         [39marithmetic[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m   - Should be: `m = str + pos;` where `pos` is the count of flag characters before[0m [2m                [0m
[2;36m                    [0m         [39mthe quote[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Buffer overflow mechanics**:[0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - **Non-escaped path [0m[1;39m([0m[39mlines [0m[1;36m1187[0m[39m-[0m[1;36m1190[0m[1;39m)[0m[39m**: After copying content, writes at [0m      [2m                [0m
[2;36m                    [0m         [39m`j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m`, `j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m`, `j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m`[0m                                                              [2m                [0m
[2;36m                    [0m         [39m   - **Escaped path [0m[1;39m([0m[39mlines [0m[1;36m1220[0m[39m-[0m[1;36m1223[0m[1;39m)[0m[39m**: Writes from `str + pos - [0m[1;36m1[0m[39m` to `str + pos [0m [2m                [0m
[2;36m                    [0m         [39m+ l + [0m[1;36m1[0m[39m`[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m   - Both paths assume sufficient buffer space exists beyond the content[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **The closing quote position `i`**: After both paths find the closing quote:[0m     [2m                [0m
[2;36m                    [0m         [39m   - Non-escaped: line [0m[1;36m1176[0m[39m loop ends when `*i == [0m[32m'"'[0m[39m`[0m                              [2m                [0m
[2;36m                    [0m         [39m   - Escaped: line [0m[1;36m1201[0m[39m loop finds where `*i == [0m[32m'"'[0m[39m`[0m                                [2m                [0m
[2;36m                    [0m         [39m   - `i` points to the closing quote, and `i + [0m[1;36m1[0m[39m` is returned as `ret_endpos`[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Buffer bounds**: The terminator writes must not exceed the position of the [0m    [2m                [0m
[2;36m                    [0m         [39mclosing quote `i`, since:[0m                                                           [2m                [0m
[2;36m                    [0m         [39m   - The input string continues after the closing quote [0m[1;39m([0m[39mor ends with null[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m   - Writing beyond `i` may corrupt subsequent data or overflow the buffer[0m          [2m                [0m
[2;36m                    [0m         [39m   - With tight allocations, `i + [0m[1;36m1[0m[39m` or `i + [0m[1;36m2[0m[39m` may be at/beyond buffer end[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Root Cause[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe function has TWO distinct bugs:[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Bug [0m[1;36m1[0m[39m [0m[1;39m([0m[39mLine [0m[1;36m1172[0m[1;39m)[0m[39m**: Incorrect pointer calculation[0m                                [2m                [0m
[2;36m                    [0m         [39m- `m = str + is_escaped + is_case_insensitive + is_prefix_match` is wrong[0m           [2m                [0m
[2;36m                    [0m         [39m- Should be `m = str + pos` to correctly point after the flags and at the opening [0m  [2m                [0m
[2;36m                    [0m         [39mquote[0m                                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Bug [0m[1;36m2[0m[39m [0m[1;39m([0m[39mLines [0m[1;36m1187[0m[39m-[0m[1;36m1190[0m[39m, [0m[1;36m1220[0m[39m-[0m[1;36m1223[0m[1;39m)[0m[39m**: No bounds checking for terminator writes[0m    [2m                [0m
[2;36m                    [0m         [39m- The function writes terminators assuming space exists[0m                             [2m                [0m
[2;36m                    [0m         [39m- With `is_prefix_match`, needs [0m[1;36m3[0m[39m bytes after content [0m[1;39m([0m[39mfor `*`, `\[0m[1;36m0[0m[39m`, `\[0m[1;36m0[0m[39m`[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [39m- Must verify writes don't exceed available buffer space[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Comprehensive Fix Strategy[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m1[0m[39m: Fix the pointer calculation [0m[1;39m([0m[39mLine [0m[1;36m1172[0m[1;39m)[0m[39m**[0m                                 [2m                [0m
[2;36m                    [0m         [39mReplace:[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mm = str + is_escaped + is_case_insensitive + is_prefix_match;[0m                       [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39mWith:[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [39mm = str + pos;[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m2[0m[39m: Add bounds checking for non-escaped path [0m[1;39m([0m[39mLines [0m[1;36m1187[0m[39m-[0m[1;36m1190[0m[1;39m)[0m[39m**[0m              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter the copy loop ends at line [0m[1;36m1182[0m[39m, we have:[0m                                     [2m                [0m
[2;36m                    [0m         [39m- `j` points to where we want to write terminators[0m                                  [2m                [0m
[2;36m                    [0m         [39m- `i` points to the closing quote[0m                                                   [2m                [0m
[2;36m                    [0m         [39m- We need to write at `j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m`, `j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m`, `j[0m[1;39m[[0m[1;36m2[0m[1;39m][0m[39m` [0m[1;39m([0m[1;36m3[0m[39m bytes for prefix_match[0m[1;39m)[0m[39m or `j[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m`, [0m [2m                [0m
[2;36m                    [0m         [39m`j[0m[1;39m[[0m[1;36m1[0m[1;39m][0m[39m` [0m[1;39m([0m[1;36m2[0m[39m bytes otherwise[0m[1;39m)[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd a check before line [0m[1;36m1187[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[39m* Verify we have space for terminators before the closing quote *[0m[35m/[0m                 [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mj + [0m[1;36m2[0m[39m > i[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m        return -EINVAL;  [0m[35m/[0m[39m* Not enough space for *, \[0m[1;36m0[0m[39m, \[0m[1;36m0[0m[39m *[0m[35m/[0m                       [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mj + [0m[1;36m1[0m[39m > i[0m[1;39m)[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m        return -EINVAL;  [0m[35m/[0m[39m* Not enough space for \[0m[1;36m0[0m[39m, \[0m[1;36m0[0m[39m *[0m[35m/[0m                          [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Step [0m[1;36m3[0m[39m: Add bounds checking for escaped path [0m[1;39m([0m[39mLines [0m[1;36m1218[0m[39m-[0m[1;36m1223[0m[1;39m)[0m[39m**[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mBefore line [0m[1;36m1218[0m[39m, we know:[0m                                                          [2m                [0m
[2;36m                    [0m         [39m- `i` points to the closing quote [0m[1;39m([0m[39mfound at line [0m[1;36m1201[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [39m- We want to write from `str + pos - [0m[1;36m1[0m[39m` to `str + pos + l + [0m[1;36m1[0m[39m` for prefix_match[0m     [2m                [0m
[2;36m                    [0m         [39m- Or from `m` to `m + l + [0m[1;36m1[0m[39m` for non-prefix_match[0m                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAdd a check before line [0m[1;36m1218[0m[39m:[0m                                                       [2m                [0m
[2;36m                    [0m         [39m```c[0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[39m* Verify we have space for the unescaped content and terminators *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mis_prefix_match[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                              [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[39m* We write from str[0m[1;39m[[0m[39mpos-[0m[1;36m1[0m[1;39m][0m[39m to str[0m[1;39m[[0m[39mpos+l+[0m[1;36m1[0m[1;39m][0m[39m, need pos+l+[0m[1;36m1[0m[39m < i *[0m[35m/[0m                [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mstr + pos + l + [0m[1;36m1[0m[39m > i[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        return -EINVAL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;39m}[0m[39m else [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[39m* We write from m to m[0m[1;39m[[0m[39ml+[0m[1;36m1[0m[1;39m][0m[39m, need m+l+[0m[1;36m1[0m[39m < i *[0m[35m/[0m                                 [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mm + l + [0m[1;36m1[0m[39m > i[0m[1;39m)[0m                                                              [2m                [0m
[2;36m                    [0m         [39m        return -EINVAL;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Why This Fix Works[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Fixes the pointer bug**: Correcting line [0m[1;36m1172[0m[39m ensures `m` points to the [0m       [2m                [0m
[2;36m                    [0m         [39mcorrect position [0m[1;39m([0m[39mafter flags, at opening quote[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Prevents buffer overflow**: The bounds checks ensure:[0m                          [2m                [0m
[2;36m                    [0m         [39m   - All writes stay within the input string boundaries[0m                             [2m                [0m
[2;36m                    [0m         [39m   - The closing quote position `i` acts as the upper bound[0m                         [2m                [0m
[2;36m                    [0m         [39m   - Invalid inputs [0m[1;39m([0m[39mtoo tight buffers[0m[1;39m)[0m[39m return `-EINVAL` instead of overflowing[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves existing logic**: [0m                                                   [2m                [0m
[2;36m                    [0m         [39m   - The function still modifies buffers in-place[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Return values and semantics remain unchanged[0m                                   [2m                [0m
[2;36m                    [0m         [39m   - Valid inputs with sufficient space work as before[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Handles both paths**: Both escaped and non-escaped paths are protected[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Compatible with fuzzing**: The fuzzer will get `-EINVAL` for problematic [0m      [2m                [0m
[2;36m                    [0m         [39minputs instead of crashes[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Side Effects and Mitigation[0m                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential side effect**: Some previously [0m[32m"working"[0m[39m inputs might now return [0m       [2m                [0m
[2;36m                    [0m         [39m`-EINVAL` if they were relying on buffer overflow into padding/slack space.[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation**: This is actually desired behavior - those inputs were invalid and [0m  [2m                [0m
[2;36m                    [0m         [39mthe overflow was a bug. Rejecting them is correct.[0m                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**No impact on production**: Legitimate udev rules from files will have sufficient [0m [2m                [0m
[2;36m                    [0m         [39mspace because:[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m- Lines are read with `UDEV_LINE_SIZE` [0m[1;39m([0m[1;36m16384[0m[1;39m)[0m[39m maximum[0m                              [2m                [0m
[2;36m                    [0m         [39m- Real rules don't typically hit the exact boundary conditions[0m                      [2m                [0m
[2;36m                    [0m         [39m- The overflow was always a latent bug[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Implementation Notes[0m                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix must be applied to the initial codebase since all patches start from the [0m   [2m                [0m
[2;36m                    [0m         [39minitial state. The changes are:[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Line [0m[1;36m1172[0m[39m: Fix pointer arithmetic[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. After line [0m[1;36m1182[0m[39m: Add bounds check for non-escaped path[0m                           [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Before line [0m[1;36m1218[0m[39m: Add bounds check for escaped path[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThese changes are minimal, surgical, and directly address the root cause without [0m   [2m                [0m
[2;36m                    [0m         [39maltering the function's design or breaking existing functionality.[0m                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=719673;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=306457;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m3[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=359515;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=540364;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmp3kywn7cw[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/systemd_systemd-full-001_syst[0m [2m               [0m
[2;36m                    [0m         [35memd-001/[0m[95magent-output-1768290262.168525[0m                                               [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/systemd_systemd-full-001_systemd-[1;36m001.[0mtoml           [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-systemd[0m          [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 07:44:24][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95msystemd[0m        ]8;id=425125;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=652878;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=876541;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=219925;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95msystemd[0m               [2m               [0m
[2;36m[01/13/26 07:44:25][0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=102543;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=251008;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95msystemd[0m                [2m               [0m
