{
  "project_name": "tika",
  "vulnerability_identifier": "tika_tk-full-01_vuln_6",
  "source_directory": "/home/qqor/crete/.cache/official-afc-tika",
  "llm_usage": {
    "total_cost": 3.3756749999999993,
    "prompt_tokens": 988750,
    "completion_tokens": 27295
  },
  "variant": "sound",
  "diff": "--- a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java\n+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java\n@@ -30,6 +30,11 @@\n  */\n public class TikaUntar {\n \n+    static boolean isDescendant(Path root, Path descendant) {\n+        return descendant.toAbsolutePath().normalize()\n+                .startsWith(root.toAbsolutePath().normalize());\n+    }\n+\n     public static void main(String[] args) throws IOException {\n         Path inputFile = Paths.get(args[0]);\n         Path extractDir = Paths.get(args[1]);\n@@ -40,7 +45,12 @@\n \n             while (tae != null) {\n                 if (tae.isFile()) {\n-                    Path target = extractDir.resolve(tae.getName()).normalize();\n+                    Path target = extractDir.resolve(tae.getName());\n+                    if (!isDescendant(extractDir, target)) {\n+                        System.err.println(\"Warning: Skipping entry outside extraction directory: \" + tae.getName());\n+                        tae = tais.getNextEntry();\n+                        continue;\n+                    }\n                     if (!Files.isDirectory(target.getParent())) {\n                         Files.createDirectories(target.getParent());\n                     }\n",
  "stdout": "",
  "stderr": ""
}