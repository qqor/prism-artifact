--- a/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
+++ b/tika-app/src/main/java/org/apache/tika/cli/TikaUntar.java
@@ -30,6 +30,11 @@
  */
 public class TikaUntar {
 
+    static boolean isDescendant(Path root, Path descendant) {
+        return descendant.toAbsolutePath().normalize()
+                .startsWith(root.toAbsolutePath().normalize());
+    }
+
     public static void main(String[] args) throws IOException {
         Path inputFile = Paths.get(args[0]);
         Path extractDir = Paths.get(args[1]);
@@ -40,7 +45,12 @@
 
             while (tae != null) {
                 if (tae.isFile()) {
-                    Path target = extractDir.resolve(tae.getName()).normalize();
+                    Path target = extractDir.resolve(tae.getName());
+                    if (!isDescendant(extractDir, target)) {
+                        System.err.println("Warning: Skipping entry outside extraction directory: " + tae.getName());
+                        tae = tais.getNextEntry();
+                        continue;
+                    }
                     if (!Files.isDirectory(target.getParent())) {
                         Files.createDirectories(target.getParent());
                     }
