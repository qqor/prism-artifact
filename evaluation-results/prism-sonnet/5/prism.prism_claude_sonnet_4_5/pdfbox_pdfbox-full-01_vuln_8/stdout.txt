[2;36m[01/13/26 06:29:28][0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=513512;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=970335;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpw51exo80[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_8/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768285768.7989693[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_8.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Started[33m...[0m ]8;id=335683;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=762240;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:30:57][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Building Cached for CLEAN environment[1m)[0m Took      ]8;id=435143;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=660504;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [1;36m89.16[0m seconds; [33mexception[0m=[3;91mFalse[0m                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m   ]8;id=607138;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=503552;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                    [0m         Started[33m...[0m                                                                     [2m                     [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running tests for Cached for CLEAN environment[1m)[0m  ]8;id=905730;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=836078;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m                                            [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Setting timeouts                                                                       ]8;id=842154;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=489951;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#85\[2m85[0m]8;;\
[2;36m                    [0m           - build: [1;36m600[0m [1m([0moriginal: [1;36m89[0m[1m)[0m                                                          [2m             [0m
[2;36m                    [0m           - run tests: [1;36m600[0m [1m([0moriginal: [1;36m0[0m[1m)[0m                                                       [2m             [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=205212;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=439520;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:30:58][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=61798;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=640047;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 06:31:00][0m[2;36m [0m[34mINFO    [0m Successfully created Cached for CLEAN environment                                    ]8;id=391648;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=548966;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#256\[2m256[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Current environments: [1m[[0m[32m'CLEAN -> Cached'[0m[1m][0m                                            ]8;id=638905;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py\[2moss_fuzz.py[0m]8;;\[2m:[0m]8;id=260265;file:///home/user/crete/packages/crete/framework/environment_pool/services/oss_fuzz.py#265\[2m265[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.START -> TeamStatus.EVALUATE                    ]8;id=706439;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=881370;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m0[0m, patch status: PatchStatus.INITIALIZED[1m)[0m                                  [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=714844;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=418888;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:31:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m1.09[0m seconds;                ]8;id=112187;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=313776;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=856159;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=125879;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:31:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.90[0m seconds;                ]8;id=339370;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=498278;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 06:31:33][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=547608;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=953193;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:31:34][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.89[0m seconds;                ]8;id=367141;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=605405;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running a pov[1m)[0m Started[33m...[0m                         ]8;id=942626;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=903402;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:32:05][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running a pov[1m)[0m Took [1;36m30.62[0m seconds;               ]8;id=769132;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=669390;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;92mTrue[0m                                                                [2m                      [0m
[2;36m                   [0m[2;36m [0m[33mWARNING [0m Crash analysis results is empty. This should not happen.                              ]8;id=479846;file:///home/user/crete/packages/crete/commons/crash_analysis/functions/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=777608;file:///home/user/crete/packages/crete/commons/crash_analysis/functions/__init__.py#41\[2m41[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=666167;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=150076;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:32:06][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.88[0m seconds;                ]8;id=617412;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=523245;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 06:32:37][0m[2;36m [0m[34mINFO    [0m Found jstack output at                                                                ]8;id=858138;file:///home/user/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=964020;file:///home/user/crete/packages/crete/framework/analyzer/services/jvm_timeout_stacktrace/__init__.py#43\[2m43[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/pdfbox/[0m[95mjstack.txt[0m       [2m              [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=469288;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=688984;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.VULNERABLE                                                              [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Patch [33mResult[0m===                                                                  [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===[33mIssue[0m===                                                                         [2m                [0m
[2;36m                    [0m         ERROR: libFuzzer: timeout                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mReport[0m===                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Analysis [33mReport[0m===                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m[01/13/26 06:32:58][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.ANALYZE                  ]8;id=19185;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=469738;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 06:38:07][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.ANALYZE -> TeamStatus.[1;33mPATCH[0m                     ]8;id=120870;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=793676;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m[01/13/26 06:39:00][0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.[1;33mPATCH[0m -> TeamStatus.EVALUATE                    ]8;id=473781;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=174431;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m1[0m, patch status: PatchStatus.VULNERABLE[1m)[0m                                   [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=109286;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=821278;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:39:01][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.95[0m seconds;                ]8;id=179485;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=534053;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Started[33m...[0m                              ]8;id=486818;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=380561;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Checking valid diff: [35m/tmp/[0m[95mtmpploz7au3[0m                                                 ]8;id=364243;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py\[2mdefault.py[0m]8;;\[2m:[0m]8;id=142941;file:///home/user/crete/packages/crete/framework/environment/services/oss_fuzz/default.py#173\[2m173[0m]8;;\
[2;36m[01/13/26 06:40:02][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Patching[1m)[0m Took [1;36m61.16[0m seconds; [33mexception[0m=[3;91mFalse[0m    ]8;id=950202;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=608269;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Started[33m...[0m                        ]8;id=887505;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=200442;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:40:17][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Checking build[1m)[0m Took [1;36m14.49[0m seconds;              ]8;id=236314;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=228323;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Started[33m...[0m                           ]8;id=687674;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=351358;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:40:23][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Running PoV[1m)[0m Took [1;36m6.18[0m seconds; [33mexception[0m=[3;91mFalse[0m  ]8;id=641827;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=9868;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Started[33m...[0m                               ]8;id=478857;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=370499;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Testing[1m)[0m Took [1;36m0.00[0m seconds; [33mexception[0m=[3;91mFalse[0m      ]8;id=214797;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=865279;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=410698;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=964269;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:40:24][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.91[0m seconds;                ]8;id=833534;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=990030;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=775536;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=515227;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:40:25][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.93[0m seconds;                ]8;id=501729;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=714782;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m[01/13/26 06:40:26][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Started[33m...[0m                         ]8;id=688665;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=979298;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#9\[2m9[0m]8;;\
[2;36m[01/13/26 06:40:27][0m[2;36m [0m[34mINFO    [0m [1m[[0mlogging_performance[1m][0m[1m([0mpdfbox Setting owner[1m)[0m Took [1;36m0.87[0m seconds;                ]8;id=212719;file:///home/user/crete/packages/crete/commons/logging/context_managers.py\[2mcontext_managers.py[0m]8;;\[2m:[0m]8;id=391157;file:///home/user/crete/packages/crete/commons/logging/context_managers.py#23\[2m23[0m]8;;\
[2;36m                    [0m         [33mexception[0m=[3;91mFalse[0m                                                               [2m                      [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m ===Evaluator [33mResult[0m===                                                              ]8;id=344997;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py\[2mevaluator.py[0m]8;;\[2m:[0m]8;id=908273;file:///home/user/crete/packages/crete/framework/agent/services/prism/teams/evaluation/evaluator.py#204\[2m204[0m]8;;\
[2;36m                    [0m         PatchStatus.SOUND                                                                   [2m                [0m
[2;36m                    [0m         ===Evaluator [33mDiff[0m===                                                                [2m                [0m
[2;36m                    [0m         --- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java               [2m                [0m
[2;36m                    [0m         +++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java               [2m                [0m
[2;36m                    [0m         @@ [1;36m-219[0m,[1;36m7[0m +[1;36m219[0m,[1;36m9[0m @@                                                                 [2m                [0m
[2;36m                    [0m                                      || [1;35mlexer.peekToken[0m[1m([0m[1m)[0m[1;35m.getText[0m[1m([0m[1m)[0m[1;35m.equals[0m[1m([0m[32m"readonly"[0m[1m)[0m      [2m                [0m
[2;36m                    [0m                                      || [1;35mlexer.peekToken[0m[1m([0m[1m)[0m[1;35m.getText[0m[1m([0m[1m)[0m[1;35m.equals[0m[1m([0m[32m"def"[0m[1m)[0m[1m)[0m[1m)[0m[1m)[0m        [2m                [0m
[2;36m                    [0m                      [1m{[0m                                                                      [2m                [0m
[2;36m                    [0m         -                [1;35mlexer.nextToken[0m[1m([0m[1m)[0m;                                                 [2m                [0m
[2;36m                    [0m         +                if [1m([0m[1;35mlexer.nextToken[0m[1m([0m[1m)[0m == null[1m)[0m [1m{[0m                                   [2m                [0m
[2;36m                    [0m         +                    throw new [1;35mIOException[0m[1m([0m[32m"Should have found dup, readonly or [0m     [2m                [0m
[2;36m                    [0m         [32mdef?! EOF?"[0m[1m)[0m;                                                                       [2m                [0m
[2;36m                    [0m         +                [1m}[0m                                                                  [2m                [0m
[2;36m                    [0m                      [1m}[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                      Map[1m<[0m[1;95mInteger[0m[39m, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                     [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-640[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m642[0m[39m,[0m[1;36m9[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [39m                 && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                       [2m                [0m
[2;36m                    [0m         [39m+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"EOF? Should have found CharStrings"[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                [2m                [0m
[2;36m                    [0m         [39m+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-180[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m180[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m     private final class PageIterator implements Iterator<PDPage>[0m                   [2m                [0m
[2;36m                    [0m         [39m     [0m[1;39m{[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m         private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m+        private Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m         private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-205[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m206[0m[39m,[0m[1;36m11[0m[39m @@[0m                                                                [2m                [0m
[2;36m                    [0m         [39m          *[0m[35m/[0m                                                                        [2m                [0m
[2;36m                    [0m         [39m         private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                             [2m                [0m
[2;36m                    [0m         [39m+                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [39m+                return Collections.EMPTY_LIST;[0m                                     [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m                 return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m              [2m                [0m
[2;36m                    [0m         [39m+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m              [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-23[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m23[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m import java.util.Map;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m import java.util.Optional;[0m                                                         [2m                [0m
[2;36m                    [0m         [39m import java.util.Map.Entry;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m+import java.util.Set;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m [0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m import org.apache.logging.log4j.LogManager;[0m                                        [2m                [0m
[2;36m                    [0m         [39m import org.apache.logging.log4j.Logger;[0m                                            [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-98[0m[39m,[0m[1;36m17[0m[39m +[0m[1;36m99[0m[39m,[0m[1;36m19[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m         [0m[1;39m}[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [39m         long prev = startXrefOffset;[0m                                               [2m                [0m
[2;36m                    [0m         [39m-        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m              [2m                [0m
[2;36m                    [0m         [39m-        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [39m         [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m        [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m+        Set<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                       [2m                [0m
[2;36m                    [0m         [39m         COSDictionary trailer = null;[0m                                              [2m                [0m
[2;36m                    [0m         [39m-        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [39m-        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m-            lastPrev = prev;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m+        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                           [2m                [0m
[2;36m                    [0m         [39m+        [0m[1;39m{[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m save expected position for loop detection[0m                           [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                   [2m                [0m
[2;36m                    [0m         [39m             [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [39m+            [0m[35m/[0m[35m/[0m[39m save current position as well due to skipped spaces[0m                 [2m                [0m
[2;36m                    [0m         [39m+            [0m[1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [39m             [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                       [2m                [0m
[2;36m                    [0m         [39m             if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m@@ [0m[1;36m-170[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m173[0m[39m,[0m[1;36m7[0m[39m @@[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m                     [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [39m                 [0m[1;39m}[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m-            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m+            if [0m[1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m                                            [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m{[0m                                                                      [2m                [0m
[2;36m                    [0m         [39m                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [39m             [0m[1;39m}[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Patch [0m[33mResult[0m[39m===[0m                                                                  [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===[0m[33mIssue[0m[39m===[0m                                                                         [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m===Evaluation [0m[33mReport[0m[39m===[0m                                                             [2m                [0m
[2;36m                    [0m         [39m# Evaluation Report[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Summary[0m                                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA timeout error has been encountered during libFuzzer execution, indicating that [0m   [2m                [0m
[2;36m                    [0m         [39mthe fuzzing process exceeded its allocated time limit while processing a particular[0m [2m                [0m
[2;36m                    [0m         [39minput. This suggests the presence of a performance issue or potentially infinite [0m   [2m                [0m
[2;36m                    [0m         [39mloop condition in the code under test.[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Description[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### What the Issue Is[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe error [0m[32m"libFuzzer: timeout"[0m[39m occurs when libFuzzer, a coverage-guided fuzzing [0m    [2m                [0m
[2;36m                    [0m         [39mengine, detects that the target code has taken longer than the configured timeout [0m  [2m                [0m
[2;36m                    [0m         [39mthreshold to process a given input. By default, libFuzzer terminates execution [0m     [2m                [0m
[2;36m                    [0m         [39mafter a certain duration [0m[1;39m([0m[39mtypically [0m[1;36m1200[0m[39m seconds or as configured[0m[1;39m)[0m[39m to prevent [0m      [2m                [0m
[2;36m                    [0m         [39minfinite loops or extremely slow execution paths from blocking the fuzzing [0m         [2m                [0m
[2;36m                    [0m         [39mcampaign.[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Nature of the Problem[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis is a **Denial of Service [0m[1;39m([0m[39mDoS[0m[1;39m)[0m[39m vulnerability** or a **performance/algorithmic [0m [2m                [0m
[2;36m                    [0m         [39mcomplexity issue**. When triggered by specific inputs, the code exhibits one or [0m    [2m                [0m
[2;36m                    [0m         [39mmore of the following behaviors:[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- Enters an infinite or extremely long-running loop[0m                                 [2m                [0m
[2;36m                    [0m         [39m- Exhibits exponential or otherwise poor algorithmic complexity[0m                     [2m                [0m
[2;36m                    [0m         [39m- Encounters resource exhaustion that causes extreme slowdown[0m                       [2m                [0m
[2;36m                    [0m         [39m- Contains blocking operations or deadlocks[0m                                         [2m                [0m
[2;36m                    [0m         [39m- Performs excessive recursive calls leading to very deep call stacks[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Important Observations[0m                                                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Reproducibility**: The timeout is reproducible with specific fuzzer-generated [0m [2m                [0m
[2;36m                    [0m         [39minput, meaning there is a deterministic code path that leads to the timeout [0m        [2m                [0m
[2;36m                    [0m         [39mcondition[0m                                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Security Implications**: While this may appear as a performance issue, timeout[0m [2m                [0m
[2;36m                    [0m         [39mvulnerabilities can be exploited to cause denial of service in production systems, [0m [2m                [0m
[2;36m                    [0m         [39mmaking them a security concern[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Fuzzer Behavior**: libFuzzer successfully identified an input that triggers [0m   [2m                [0m
[2;36m                    [0m         [39mabnormal execution time, demonstrating the effectiveness of fuzzing in discovering [0m [2m                [0m
[2;36m                    [0m         [39medge cases that might not be caught by traditional testing[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Areas for Investigation[0m                                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mTo gain a holistic understanding of this issue, the following components should be [0m [2m                [0m
[2;36m                    [0m         [39minvestigated:[0m                                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Input Processing Logic**: Examine the code paths responsible for parsing and [0m  [2m                [0m
[2;36m                    [0m         [39mprocessing input data, particularly:[0m                                                [2m                [0m
[2;36m                    [0m         [39m   - Input validation and sanitization routines[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Parsing logic for complex data structures[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - State machines or control flow that depends on input values[0m                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Loop Constructs**: Identify all loops in the codebase that:[0m                    [2m                [0m
[2;36m                    [0m         [39m   - Have termination conditions dependent on input data[0m                            [2m                [0m
[2;36m                    [0m         [39m   - Perform nested iterations[0m                                                      [2m                [0m
[2;36m                    [0m         [39m   - Could potentially iterate an unbounded or very large number of times[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Recursive Functions**: Review recursive function calls that might:[0m             [2m                [0m
[2;36m                    [0m         [39m   - Have base cases dependent on input values[0m                                      [2m                [0m
[2;36m                    [0m         [39m   - Lack proper depth limiting[0m                                                     [2m                [0m
[2;36m                    [0m         [39m   - Exhibit exponential complexity characteristics[0m                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Algorithmic Complexity**: Analyze algorithms used in the codebase for:[0m         [2m                [0m
[2;36m                    [0m         [39m   - Time complexity [0m[1;39m([0m[1;35mO[0m[1;39m([0m[39mn²[0m[1;39m)[0m[39m, [0m[1;35mO[0m[1;39m([0m[39mn³[0m[1;39m)[0m[39m, [0m[1;35mO[0m[1;39m([0m[39m2ⁿ[0m[1;39m)[0m[39m, etc.[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [39m   - Space complexity that might cause memory thrashing[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Known problematic patterns [0m[1;39m([0m[39me.g., nested loops over large datasets[0m[1;39m)[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Resource Management**: Check for:[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Blocking I/O operations[0m                                                        [2m                [0m
[2;36m                    [0m         [39m   - Synchronization primitives [0m[1;39m([0m[39mmutexes, semaphores[0m[1;39m)[0m[39m that could deadlock[0m           [2m                [0m
[2;36m                    [0m         [39m   - Memory allocation patterns that might trigger excessive garbage collection or [0m [2m                [0m
[2;36m                    [0m         [39mswapping[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **The Fuzzing Harness**: While not the root cause, review the harness to [0m        [2m                [0m
[2;36m                    [0m         [39munderstand:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - What input format is being tested[0m                                              [2m                [0m
[2;36m                    [0m         [39m   - Which API entry points are being fuzzed[0m                                        [2m                [0m
[2;36m                    [0m         [39m   - Any timeout configurations that might be too restrictive[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m. **Crash/Timeout Artifacts**: Examine the specific input that triggered the [0m      [2m                [0m
[2;36m                    [0m         [39mtimeout to:[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m   - Identify patterns in the problematic input[0m                                     [2m                [0m
[2;36m                    [0m         [39m   - Minimize the input to find the smallest reproducer[0m                             [2m                [0m
[2;36m                    [0m         [39m   - Understand which input characteristics trigger the issue[0m                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Initial Issue Log[0m                                                                [2m                [0m
[2;36m                    [0m         [39mHere is the initial issue log of the codebase:[0m                                      [2m                [0m
[2;36m                    [0m         [39m<issue>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mERROR: libFuzzer: timeout[0m                                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95missue[0m[39m>[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m===Analysis [0m[33mReport[0m[39m===[0m                                                               [2m                [0m
[2;36m                    [0m         [39m# Analysis Report[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Snippets[0m                                                           [2m                [0m
[2;36m                    [0m         [39m<code_snippets>[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:20[0m[39m-[0m[1;36m27[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import org.apache.fontbox.encoding.StandardEncoding;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.HashMap;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:41[0m[39m-[0m[1;36m74[0m               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m41:f[0m[39minal class Type1Parser[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    [0m[35m/[0m[35m/[0m[39m constants for encryption[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:    private static final int EEXEC_KEY = [0m[1;36m55665[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:    private static final int CHARSTRING_KEY = [0m[1;36m4330[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[35m/[0m[39m state[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    private Type1Lexer lexer;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:    private Type1Font font;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:     * Parses a Type [0m[1;36m1[0m[39m font and returns a Type1Font class which represents it.[0m   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * @param segment1 Segment [0m[1;36m1[0m[39m: ASCII[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     * @param segment2 Segment [0m[1;36m2[0m[39m: Binary[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    public Type1Font [0m[1;35mparse[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m segment1, byte[0m[1;39m[[0m[1;39m][0m[39m segment2[0m[1;39m)[0m[39m throws IOException[0m  [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:        font = new [0m[1;35mType1Font[0m[1;39m([0m[39msegment1, segment2[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        try[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:            [0m[1;35mparseASCII[0m[1;39m([0m[39msegment1[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        catch [0m[1;39m([0m[39mNumberFormatException ex[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[39mex[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        if [0m[1;39m([0m[39msegment2.length > [0m[1;36m0[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:            [0m[1;35mparseBinary[0m[1;39m([0m[39msegment2[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        return font;[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:192[0m[39m-[0m[1;36m239[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    private void [0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            String name = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"StandardEncoding"[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                font.encoding = StandardEncoding.INSTANCE;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unknown encoding: "[0m[39m + name[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[35m/[0m[35m/[0m[39m [0m[1;36m0[0m[39m [0m[1;36m1[0m[39m [0m[1;36m255[0m[39m [0m[1;39m{[0m[1;36m1[0m[39m index exch [0m[35m/[0m[95m.notdef[0m[39m put [0m[1;39m}[0m[39m for[0m                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[35m/[0m[35m/[0m[39m we have to check [0m[32m"readonly"[0m[39m and [0m[32m"def"[0m[39m too[0m                        [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            [0m[35m/[0m[35m/[0m[39m as some fonts don't provide any dup-values, see PDFBOX-[0m[1;36m2134[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            while [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                    [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                int code = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"put"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                [0m[1;35mcodeToName.put[0m[1;39m([0m[39mcode, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            font.encoding = new [0m[1;35mBuiltInEncoding[0m[1;39m([0m[39mcodeToName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:635[0m[39m-[0m[1;36m650[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have [0m[32m"2 index"[0m[39m here, others have [0m[32m"end noaccess put"[0m       [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:        [0m[35m/[0m[35m/[0m[39m sometimes followed by [0m[32m"put"[0m[39m. Either way, we just skip until[0m          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:        [0m[35m/[0m[35m/[0m[39m the [0m[35m/[0m[95mCharStrings[0m[39m dict is found[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:        while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:        [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL, [0m[32m"CharStrings"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        [0m[1;35mreadCharStrings[0m[1;39m([0m[39mlenIV[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:22[0m[39m-[0m[1;36m26[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.nio.BufferUnderflowException;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.nio.ByteBuffer;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.logging.log4j.Logger;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.logging.log4j.LogManager;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Lexer.jav[0m[1;92ma:45[0m[39m-[0m[1;36m96[0m                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m45:c[0m[39mlass Type1Lexer[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:     * Log instance.[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mType1Lexer.class[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    private final ByteBuffer buffer;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    private Token aheadToken;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:    private int openParens = [0m[1;36m0[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:     * Constructs a new Type1Lexer given a header-less .pfb segment.[0m             [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:     * @param bytes Header-less .pfb segment[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * @throws IOException[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    [0m[1;35mType1Lexer[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        buffer = [0m[1;35mByteBuffer.wrap[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:     * Returns the next token and consumes it.[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * @return The next token.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    public Token [0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        Token curToken = aheadToken;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[35m/[0m[35m/[0m[95mSystem.out.println[0m[1;39m([0m[39mcurToken[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m for debugging[0m                         [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        aheadToken = [0m[1;35mreadToken[0m[1;39m([0m[39mcurToken[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        return curToken;[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * Returns the next token without consuming it.[0m                              [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     * @return The next token[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    public Token [0m[1;35mpeekToken[0m[1;39m([0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        return aheadToken;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Checks if the kind of the next token equals the given one without [0m        [2m                [0m
[2;36m                    [0m         [39mconsuming it.[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * [0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @return true if the kind of the next token equals the given one[0m           [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public boolean [0m[1;35mpeekKind[0m[1;39m([0m[39mToken.Kind kind[0m[1;39m)[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        return aheadToken != null && [0m[1;35maheadToken.getKind[0m[1;39m([0m[1;39m)[0m[39m == kind;[0m               [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:115[0m[39m-[0m[1;36m130[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:            Token token = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            if [0m[1;39m([0m[39mtoken == null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.NAME &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m([0m[32m"currentdict"[0m[1;35m.equals[0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m || [0m                      [2m                [0m
[2;36m                    [0m         [32m"end"[0m[1;35m.equals[0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            [0m[35m/[0m[35m/[0m[39m key/value[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:330[0m[39m-[0m[1;36m365[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:               ![0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:                [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:            [0m[35m/[0m[35m/[0m[39m simple value[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:            String key = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:            List<Token> value = [0m[1;35mreadDictValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            [0m[1;35mdict.put[0m[1;39m([0m[39mkey, value[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"end"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:        return dict;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:556[0m[39m-[0m[1;36m565[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m556[0m[39m:        Token peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m557[0m[39m:        while [0m[1;39m([0m[39mpeekToken != null && ![0m[32m"Private"[0m[1;35m.equals[0m[1;39m([0m[1;35mpeekToken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m558[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m559[0m[39m:            [0m[35m/[0m[35m/[0m[39m for a more thorough validation, the presence of [0m[32m"begin"[0m[39m before [0m  [2m                [0m
[2;36m                    [0m         [39mPrivate[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m560[0m[39m:            [0m[35m/[0m[35m/[0m[39m determines how code before and following charstrings should look[0m [2m                [0m
[2;36m                    [0m         [1;36m561[0m[39m:            [0m[35m/[0m[35m/[0m[39m it is not currently checked anyway[0m                               [2m                [0m
[2;36m                    [0m         [1;36m562[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m563[0m[39m:            peekToken = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m564[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m565[0m[39m:        if [0m[1;39m([0m[39mpeekToken == null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:469[0m[39m-[0m[1;36m536[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:    private List<Token> [0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                           [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        List<Token> value = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        int openProc = [0m[1;36m1[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Malformed procedure: missing token"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                openProc++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:            Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:            [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:            if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_PROC[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                openProc--;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39mopenProc == [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:        Token executeonly = [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:        if [0m[1;39m([0m[39mexecuteonly != null[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:            [0m[1;35mvalue.add[0m[1;39m([0m[39mexecuteonly[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        return value;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:     * Reads a procedure but without returning anything.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:    private void [0m[1;35mreadProcVoid[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        int openProc = [0m[1;36m1[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Malformed procedure: missing token"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:                openProc++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:            Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:            if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_PROC[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:                openProc--;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:                if [0m[1;39m([0m[39mopenProc == [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:        [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:706[0m[39m-[0m[1;36m743[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:    private void [0m[1;35mreadSubrs[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                        [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:            [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:            if [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                  [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            Token index = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:            int j = [0m[1;35mindex.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:            if [0m[1;39m([0m[39mj < [0m[1;35mfont.subrs.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[1;35mfont.subrs.set[0m[1;39m([0m[39mj, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, CHARSTRING_KEY,[0m [2m                [0m
[2;36m                    [0m         [39mlenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mreadPut[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:777[0m[39m-[0m[1;36m813[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:    private void [0m[1;35mreadCharStrings[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                  [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dict"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:        [0m[35m/[0m[35m/[0m[39m could actually be a sequence ending in [0m[32m"CharStrings begin"[0m[39m, too[0m      [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:        [0m[35m/[0m[35m/[0m[39m instead of the [0m[32m"dup begin"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:                [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:            [0m[35m/[0m[35m/[0m[39m key/value[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:            String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:            [0m[1;35mfont.charstrings.put[0m[1;39m([0m[39mname, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mCHARSTRING_KEY, lenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:            [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have one [0m[32m"end"[0m[39m, others two[0m                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"end"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:        [0m[35m/[0m[35m/[0m[39m since checking ends here, this does not matter [0m[33m...[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:        [0m[35m/[0m[35m/[0m[39m more thorough checking would see whether there is [0m[32m"begin"[0m[39m before [0m    [2m                [0m
[2;36m                    [0m         [35m/[0m[95mPrivate[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:        [0m[35m/[0m[35m/[0m[39m and expect a [0m[32m"def"[0m[39m somewhere, otherwise a [0m[32m"put"[0m                      [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_3/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m15[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java [0m     [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index c995d96e2..c4a973ade [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-219[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m219[0m[39m,[0m[1;36m9[0m[39m @@ final class Type1Parser[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:             [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+                if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Should have found dup, readonly or [0m  [2m                [0m
[2;36m                    [0m         [32mdef?! EOF?"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:+                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:             [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:             Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_4/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m16[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java [0m     [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index a979cfbdb..c8e7e1e1c [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-643[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m643[0m[39m,[0m[1;36m10[0m[39m @@ final class Type1Parser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:         while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                 && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:         [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+            if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"EOF? Should have found CharStrings"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:+            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:         [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.jav[0m[1;92ma:180[0m[39m-[0m[1;36m230[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    private final class PageIterator implements Iterator<PDPage>[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            while [0m[1;39m([0m[39m![0m[1;35mkids.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                List<COSDictionary> newKids = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                for [0m[1;39m([0m[39mCOSDictionary kid : kids[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                    [0m[1;35mnewKids.addAll[0m[1;39m([0m[1;35menqueueKids[0m[1;39m([0m[39mkid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                kids = newKids;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:         * This takes a node, and, if it is a page adds it to the queue.[0m        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:         * If it is a PageTreeNode, it returns the children for that node.[0m      [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:         *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:         * @param node[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:         * @return[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                if [0m[1;39m([0m[39mnode != null && [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mCOSName.PAGE.equals[0m[1;39m([0m[1;35mnode.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    [0m[1;35mqueue.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[1;35mLOG.error[0m[1;39m([0m[32m"Page skipped due to an invalid or missing type [0m  [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m,[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                            [0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m([0m[39mnode == null ? [0m[32m"[0m[32m([0m[32mnull[0m[32m)[0m[32m"[0m[39m : [0m                   [2m                [0m
[2;36m                    [0m         [1;35mnode.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            return Collections.EMPTY_LIST;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        public boolean [0m[1;35mhasNext[0m[1;39m([0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            return ![0m[1;35mqueue.isEmpty[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.jav[0m[1;92ma:95[0m[39m-[0m[1;36m180[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            startXrefOffset = fixedOffset;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        long prev = startXrefOffset;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m     [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        COSDictionary trailer = null;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            lastPrev = prev;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                [0m[35m/[0m[35m/[0m[39m xref table and trailer[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[35m/[0m[35m/[0m[39m use existing parser to parse xref table[0m                      [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mparseXrefTable[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m || ![0m[1;35mparseTrailer[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Expected trailer object at offset "[0m  [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                [0m[1;35mif[0m[1;39m([0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:                    int streamOffset = [0m[1;35mtrailer.getInt[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                    [0m[35m/[0m[35m/[0m[39m check the xref stream reference[0m                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:                    fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                    if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != streamOffset[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"/XRefStm offset [0m[32m{[0m[32m}[0m[32m is incorrect, corrected to[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                                fixedOffset[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                        streamOffset = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mfixedOffset;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                        [0m[1;35mtrailer.setInt[0m[1;39m([0m[39mCOSName.XREF_STM, streamOffset[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:                    if [0m[1;39m([0m[39mstreamOffset > [0m[1;36m0[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                        [0m[1;35msource.seek[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                        [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                        try[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                            [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                            [0m[1;35mdocument.setHasHybridXRef[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                        catch [0m[1;39m([0m[39mIOException ex[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                            [0m[1;35mLOG.error[0m[1;39m([0m[32m"Failed to parse /XRefStm at offset "[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [39mstreamOffset, ex[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                        [0m[1;35mLOG.error[0m[1;39m([0m[32m"Skipped XRef stream due to a corrupt offset:[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                prev = [0m[1;35mtrailer.getLong[0m[1;39m([0m[39mCOSName.PREV[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[35m/[0m[35m/[0m[39m parse xref stream[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                prev = [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, true[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            if [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[35m/[0m[35m/[0m[39m check the xref table reference[0m                               [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != prev[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                    prev = fixedOffset;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                    [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[35m/[0m[35m/[0m[39m ---- build valid xrefs out of the xref chain[0m                         [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;35mxrefTrailerResolver.setStartxref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        trailer = [0m[1;35mxrefTrailerResolver.getTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Font.jav[0m[1;92ma:20[0m[39m-[0m[1;36m35[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.awt.geom.GeneralPath;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import java.util.Collections;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import java.util.LinkedHashMap;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import java.util.concurrent.ConcurrentHashMap;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.fontbox.FontBoxFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.fontbox.EncodedFont;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.fontbox.cff.Type1CharString;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.fontbox.cff.Type1CharStringParser;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.fontbox.encoding.Encoding;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.fontbox.pfb.PfbParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.fontbox.util.BoundingBox;[0m                                      [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Font.jav[0m[1;92ma:52[0m[39m-[0m[1;36m86[0m                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mInputStream pfbStream[0m[1;39m)[0m[39m throws [0m         [2m                [0m
[2;36m                    [0m         [39mIOException[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbStream[0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     * Constructs a new Type1Font object from a .pfb stream.[0m                     [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:     * @param pfbBytes .pfb data, including headers[0m                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:     * @return a type1 font[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     * @throws IOException if something went wrong[0m                               [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    public static Type1Font [0m[1;35mcreateWithPFB[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m pfbBytes[0m[1;39m)[0m[39m throws IOException[0m    [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        PfbParser pfb = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbBytes[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[1;35mpfb.getSegment1[0m[1;39m([0m[1;39m)[0m[39m, [0m[1;35mpfb.getSegment2[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     * Constructs a new Type1Font object from two header-less .pfb segments.[0m     [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:     *[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:     * @param segment1 The first segment, without header[0m                         [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:     * @param segment2 The second segment, without header[0m                        [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * @return A new Type1Font instance[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * @throws IOException if something went wrong[0m                               [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    public static Type1Font [0m[1;35mcreateWithSegments[0m[1;39m([0m[39mbyte[0m[1;39m[[0m[1;39m][0m[39m segment1, byte[0m[1;39m[[0m[1;39m][0m[39m segment2[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mthrows IOException[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:        Type1Parser parser = new [0m[1;35mType1Parser[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:        return [0m[1;35mparser.parse[0m[1;39m([0m[39msegment1, segment2[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/pfb/PfbParser.jav[0m[1;92ma:37[0m[39m-[0m[1;36m117[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:public class PfbParser [0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPfbParser.class[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:     * the pfb header length.[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:     * [0m[1;39m([0m[39mstart-marker [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, ascii-[0m[35m/[0m[95mbinary-marker[0m[39m [0m[1;39m([0m[1;36m1[0m[39m byte[0m[1;39m)[0m[39m, size [0m[1;39m([0m[1;36m4[0m[39m byte[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:     * [0m[1;36m3[0m[39m*[0m[1;36m6[0m[39m == [0m[1;36m18[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:    private static final int PFB_[0m[1;33mHEAD[0m[39mER_LENGTH = [0m[1;36m18[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:     * the start marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:    private static final int START_MARKER = [0m[1;36m0x80[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:     * the ascii marker.[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m55[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    private static final int ASCII_MARKER = [0m[1;36m0x01[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:     * the binary marker.[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:    private static final int BINARY_MARKER = [0m[1;36m0x02[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:     * the EOF marker.[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    private static final int EOF_MARKER = [0m[1;36m0x03[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:     * Heuristically chosen max length to buffer a Type1 font[0m                    [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:    private static final long MAX_LENGTH = 100_000_000;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:     * the parsed pfb-data.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:    private byte[0m[1;39m[[0m[1;39m][0m[39m pfbdata;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:     * the lengths of the records [0m[1;39m([0m[39mASCII, BINARY, ASCII[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:    private final int[0m[1;39m[[0m[1;39m][0m[39m lengths = new int[0m[1;39m[[0m[1;36m3[0m[1;39m][0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m[35m/[0m[35m/[0m[39m sample [0m[1;39m([0m[39mpfb-file[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[35m/[0m[39m [0m[1;36m00000000[0m[39m [0m[1;36m80[0m[39m [0m[1;36m01[0m[39m 8b [0m[1;36m15[0m[39m  [0m[1;36m00[0m[39m [0m[1;36m00[0m[39m [0m[1;36m25[0m[39m [0m[1;36m21[0m[39m  [0m[1;36m50[0m[39m [0m[1;36m53[0m[39m 2d [0m[1;36m41[0m[39m  [0m[1;36m64[0m[39m 6f [0m[1;36m62[0m[39m [0m[1;36m65[0m[39m  [0m             [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:    [0m[35m/[0m[35m/[0m[39m          [0m[33m...[0m[33m...[0m[39m%!PS-Adobe[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:     * @param filename  the file name[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m91[0m[39m:     * @throws IOException if an IO-error occurs.[0m                                [2m                [0m
[2;36m                    [0m         [1;36m92[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m93[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal String filename[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m94[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        [0m[1;35mthis[0m[1;39m([0m[1;35mFiles.readAllBytes[0m[1;39m([0m[1;35mPaths.get[0m[1;39m([0m[39mfilename[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:     * Create a new object.[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:     * @param in   The input.[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal InputStream in[0m[1;39m)[0m[39m throws IOException [0m                  [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m pfb = [0m[1;35min.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mpfb[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:     * Create a new object.[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:     * @param bytes   The input.[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:     * @throws IOException if an IO-error occurs.[0m                               [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:    public [0m[1;35mPfbParser[0m[1;39m([0m[39mfinal byte[0m[1;39m[[0m[1;39m][0m[39m bytes[0m[1;39m)[0m[39m throws IOException[0m                     [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        [0m[1;35mparsePfb[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:58[0m[39m-[0m[1;36m90[0m          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:public class PDType1Font extends PDSimpleFont implements PDVectorFont[0m            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:[0m[1;39m{[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:    private static final Logger LOG = [0m[1;35mLogManager.getLogger[0m[1;39m([0m[39mPDType1Font.class[0m[1;39m)[0m[39m;[0m   [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:    [0m[35m/[0m[35m/[0m[39m alternative names for glyphs which are commonly encountered[0m               [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:    private static final Map<String, String> ALT_NAMES = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:    private static final int PFB_START_MARKER = [0m[1;36m0x80[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:    static[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:        [0m[1;35mALT_NAMES.put[0m[1;39m([0m[32m"ff"[0m[39m, [0m[32m"f_f"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;35mALT_NAMES.put[0m[1;39m([0m[32m"ffi"[0m[39m, [0m[32m"f_f_i"[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        [0m[1;35mALT_NAMES.put[0m[1;39m([0m[32m"ffl"[0m[39m, [0m[32m"f_f_l"[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;35mALT_NAMES.put[0m[1;39m([0m[32m"fi"[0m[39m, [0m[32m"f_i"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:        [0m[1;35mALT_NAMES.put[0m[1;39m([0m[32m"fl"[0m[39m, [0m[32m"f_l"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;35mALT_NAMES.put[0m[1;39m([0m[32m"st"[0m[39m, [0m[32m"s_t"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:        [0m[1;35mALT_NAMES.put[0m[1;39m([0m[32m"IJ"[0m[39m, [0m[32m"I_J"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[1;35mALT_NAMES.put[0m[1;39m([0m[32m"ij"[0m[39m, [0m[32m"i_j"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        [0m[1;35mALT_NAMES.put[0m[1;39m([0m[32m"ellipsis"[0m[39m, [0m[32m"elipsis"[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m misspelled in ArialMT[0m           [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:    [0m[1;39m}[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m79[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m80[0m[39m:     * embedded font.[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m81[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m82[0m[39m:    private final Type1Font type1font;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m83[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m84[0m[39m:    [0m[35m/[0m[39m**[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m85[0m[39m:     * embedded or system font for rendering.[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m86[0m[39m:     *[0m[35m/[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m87[0m[39m:    private final FontBoxFont genericFont;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m88[0m[39m:    [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m89[0m[39m:    private final boolean isEmbedded;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m90[0m[39m:    private final boolean isDamaged;[0m                                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1Font.jav[0m[1;92ma:206[0m[39m-[0m[1;36m246[0m        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            PDStream fontFile = [0m[1;35mfd.getFontFile[0m[1;39m([0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            if [0m[1;39m([0m[39mfontFile != null[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:                try[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:                    COSStream stream = [0m[1;35mfontFile.getCOSObject[0m[1;39m([0m[1;39m)[0m[39m;[0m                 [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:                    int length1 = [0m[1;35mstream.getInt[0m[1;39m([0m[39mCOSName.LENGTH1[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:                    int length2 = [0m[1;35mstream.getInt[0m[1;39m([0m[39mCOSName.LENGTH2[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                    [0m[35m/[0m[35m/[0m[39m repair Length1 and Length2 if necessary[0m                  [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    byte[0m[1;39m[[0m[1;39m][0m[39m bytes = [0m[1;35mfontFile.toByteArray[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                    if [0m[1;39m([0m[39mbytes.length == [0m[1;36m0[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Font data unavailable"[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                    length1 = [0m[1;35mrepairLength1[0m[1;39m([0m[39mbytes, length1[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                    length2 = [0m[1;35mrepairLength2[0m[1;39m([0m[39mbytes, length1, length2[0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:                    if [0m[1;39m([0m[1;39m([0m[39mbytes[0m[1;39m[[0m[1;36m0[0m[1;39m][0m[39m & [0m[1;36m0xff[0m[1;39m)[0m[39m == PFB_START_MARKER[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:                        [0m[35m/[0m[35m/[0m[39m some bad files embed the entire PFB, see PDFBOX-[0m[1;36m2607[0m [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                        t1 = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mbytes[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                        [0m[35m/[0m[35m/[0m[39m the PFB embedded as two segments back-to-back[0m        [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                        if [0m[1;39m([0m[39mlength1 < [0m[1;36m0[0m[39m || length1 > length1 + length2[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:                            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Invalid length data, actual [0m [2m                [0m
[2;36m                    [0m         [32mlength: "[0m[39m +[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:                                    bytes.length + [0m[32m", /Length1: "[0m[39m + length1 + [0m  [2m                [0m
[2;36m                    [0m         [32m", /Length2: "[0m[39m + length2[0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment1 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, [0m[1;36m0[0m[39m, [0m         [2m                [0m
[2;36m                    [0m         [39mlength1[0m[1;39m)[0m[39m;[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:                        byte[0m[1;39m[[0m[1;39m][0m[39m segment2 = [0m[1;35mArrays.copyOfRange[0m[1;39m([0m[39mbytes, length1, [0m   [2m                [0m
[2;36m                    [0m         [39mlength1 + length2[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m240[0m[39m:                        [0m[35m/[0m[35m/[0m[39m empty streams are simply ignored[0m                     [2m                [0m
[2;36m                    [0m         [1;36m241[0m[39m:                        if [0m[1;39m([0m[39mlength1 > [0m[1;36m0[0m[39m && length2 > [0m[1;36m0[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m242[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m243[0m[39m:                            t1 = [0m[1;35mType1Font.createWithSegments[0m[1;39m([0m[39msegment1, [0m        [2m                [0m
[2;36m                    [0m         [39msegment2[0m[1;39m)[0m[39m;[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m244[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m245[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m246[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_3/vuln.yaml:[0m[1;36m1[0m[39m-[0m[1;36m29[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:metadata_spec_version: v1[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:name: Infinite loops in type [0m[1;36m1[0m[39m font parser[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m5:a[0m[39muthor: Tim Allison[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m7:de[0m[39mtails:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:    cwes:[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:        - CWE-[0m[1;36m835[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:        - CWE-[0m[1;36m834[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:    description: >[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:        A crafted PDF can trigger and infinite loop in Type [0m[1;36m1[0m[39m font parser.[0m       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:    locations:[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:        - path_from_root: [0m                                                       [2m                [0m
[2;36m                    [0m         [32m'fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java'[0m                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:          startLine: [0m[1;36m217[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:          startColumn: [0m[1;36m13[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:          endLine: [0m[1;36m223[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:          endColumn: [0m[1;36m14[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:pov:[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:    blob: [0m[32m'data.bin'[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:    harness: [0m[32m'PDFExtractTextFuzzer'[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:patch:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    good: [0m[32m'good_patch.diff'[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    bad: [0m[32m'bad_patch.diff'[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_4/vuln.yaml:[0m[1;36m1[0m[39m-[0m[1;36m29[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:metadata_spec_version: v1[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:name: Infinite loops in type [0m[1;36m1[0m[39m font parser[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m5:a[0m[39muthor: Tim Allison[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m7:de[0m[39mtails:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:    cwes:[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:        - CWE-[0m[1;36m835[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:        - CWE-[0m[1;36m834[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:    description: >[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:        A crafted PDF can trigger an infinite loop in Type [0m[1;36m1[0m[39m font parser.[0m        [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:    locations:[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:        - path_from_root: [0m                                                       [2m                [0m
[2;36m                    [0m         [32m'fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java'[0m                   [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:          startLine: [0m[1;36m640[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:          startColumn: [0m[1;36m9[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:          endLine: [0m[1;36m644[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:          endColumn: [0m[1;36m10[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:pov:[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:    blob: [0m[32m'data.bin'[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:    harness: [0m[32m'PDFExtractTextFuzzer'[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:patch:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:    good: [0m[32m'good_patch.diff'[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:    bad: [0m[32m'bad_patch.diff'[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_7/vuln.yaml:[0m[1;36m1[0m[39m-[0m[1;36m28[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:metadata_spec_version: v1[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:name: PageTrees -> PageForests[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m5:a[0m[39muthor: Tim Allison[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m7:de[0m[39mtails:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:  cwes:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:    - CWE-[0m[1;36m834[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:  description: >[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:    A PDF with a crafted page tree can cause a StackOverflow.[0m                    [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:  locations:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:    - path_from_root: [0m                                                           [2m                [0m
[2;36m                    [0m         [32m'pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java'[0m                    [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:      startLine: [0m[1;36m186[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:      startColumn: [0m[1;36m13[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:      endLine: [0m[1;36m225[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:      endColumn: [0m[1;36m10[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:pov:[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:  blob: [0m[32m'data.bin'[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:  harness: [0m[32m'PDFExtractTextFuzzer'[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:patch:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:  good: [0m[32m'good_patch.diff'[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  bad: [0m[32m'bad_patch.diff'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_8/vuln.yaml:[0m[1;36m1[0m[39m-[0m[1;36m28[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:metadata_spec_version: v1[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:name: Ye olde infinite XRefs[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m5:a[0m[39muthor: Tim Allison[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;92m7:de[0m[39mtails:[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:  cwes:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:    - CWE-[0m[1;36m834[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:  description: >[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:    A PDF with a crafted XRef table can cause an infinite loop.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:  locations:[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:    - path_from_root: [0m                                                           [2m                [0m
[2;36m                    [0m         [32m'pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java'[0m                  [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:      startLine: [0m[1;36m102[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:      startColumn: [0m[1;36m9[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:      endLine: [0m[1;36m176[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:      endColumn: [0m[1;36m14[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:pov:[0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:  blob: [0m[32m'data.bin'[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:  harness: [0m[32m'PDFExtractTextFuzzer'[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:patch:[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:  good: [0m[32m'good_patch.diff'[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:  bad: [0m[32m'bad_patch.diff'[0m                                                          [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:192[0m[39m-[0m[1;36m239[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    private void [0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            String name = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"StandardEncoding"[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                font.encoding = StandardEncoding.INSTANCE;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unknown encoding: "[0m[39m + name[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[35m/[0m[35m/[0m[39m [0m[1;36m0[0m[39m [0m[1;36m1[0m[39m [0m[1;36m255[0m[39m [0m[1;39m{[0m[1;36m1[0m[39m index exch [0m[35m/[0m[95m.notdef[0m[39m put [0m[1;39m}[0m[39m for[0m                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[35m/[0m[35m/[0m[39m we have to check [0m[32m"readonly"[0m[39m and [0m[32m"def"[0m[39m too[0m                        [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            [0m[35m/[0m[35m/[0m[39m as some fonts don't provide any dup-values, see PDFBOX-[0m[1;36m2134[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            while [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                    [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                int code = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"put"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                [0m[1;35mcodeToName.put[0m[1;39m([0m[39mcode, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            font.encoding = new [0m[1;35mBuiltInEncoding[0m[1;39m([0m[39mcodeToName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:635[0m[39m-[0m[1;36m650[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have [0m[32m"2 index"[0m[39m here, others have [0m[32m"end noaccess put"[0m       [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:        [0m[35m/[0m[35m/[0m[39m sometimes followed by [0m[32m"put"[0m[39m. Either way, we just skip until[0m          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:        [0m[35m/[0m[35m/[0m[39m the [0m[35m/[0m[95mCharStrings[0m[39m dict is found[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:        while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:        [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL, [0m[32m"CharStrings"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        [0m[1;35mreadCharStrings[0m[1;39m([0m[39mlenIV[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_3/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m15[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java [0m     [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index c995d96e2..c4a973ade [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-219[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m219[0m[39m,[0m[1;36m9[0m[39m @@ final class Type1Parser[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:             [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+                if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Should have found dup, readonly or [0m  [2m                [0m
[2;36m                    [0m         [32mdef?! EOF?"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:+                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:             [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:             Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_4/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m16[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java [0m     [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index a979cfbdb..c8e7e1e1c [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-643[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m643[0m[39m,[0m[1;36m10[0m[39m @@ final class Type1Parser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:         while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                 && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:         [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+            if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"EOF? Should have found CharStrings"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:+            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:         [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.jav[0m[1;92ma:180[0m[39m-[0m[1;36m230[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    private final class PageIterator implements Iterator<PDPage>[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            while [0m[1;39m([0m[39m![0m[1;35mkids.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                List<COSDictionary> newKids = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                for [0m[1;39m([0m[39mCOSDictionary kid : kids[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                    [0m[1;35mnewKids.addAll[0m[1;39m([0m[1;35menqueueKids[0m[1;39m([0m[39mkid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                kids = newKids;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:         * This takes a node, and, if it is a page adds it to the queue.[0m        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:         * If it is a PageTreeNode, it returns the children for that node.[0m      [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:         *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:         * @param node[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:         * @return[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                if [0m[1;39m([0m[39mnode != null && [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mCOSName.PAGE.equals[0m[1;39m([0m[1;35mnode.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    [0m[1;35mqueue.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[1;35mLOG.error[0m[1;39m([0m[32m"Page skipped due to an invalid or missing type [0m  [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m,[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                            [0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m([0m[39mnode == null ? [0m[32m"[0m[32m([0m[32mnull[0m[32m)[0m[32m"[0m[39m : [0m                   [2m                [0m
[2;36m                    [0m         [1;35mnode.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            return Collections.EMPTY_LIST;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        public boolean [0m[1;35mhasNext[0m[1;39m([0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            return ![0m[1;35mqueue.isEmpty[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_7/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m25[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java [0m      [2m                [0m
[2;36m                    [0m         [39mb/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index 949b259c3..f4a3c6f66 [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-180[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m180[0m[39m,[0m[1;36m7[0m[39m @@ public class PDPageTree implements COSObjectable, [0m            [2m                [0m
[2;36m                    [0m         [39mIterable<PDPage>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:     private final class PageIterator implements Iterator<PDPage>[0m                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:     [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:         private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+        private Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:         private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:@@ [0m[1;36m-205[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m205[0m[39m,[0m[1;36m11[0m[39m @@ public class PDPageTree implements COSObjectable, [0m          [2m                [0m
[2;36m                    [0m         [39mIterable<PDPage>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:          *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:+            if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:+                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+                return Collections.EMPTY_LIST;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:+            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:+            [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:             if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                 return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.jav[0m[1;92ma:95[0m[39m-[0m[1;36m180[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            startXrefOffset = fixedOffset;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        long prev = startXrefOffset;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m     [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        COSDictionary trailer = null;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            lastPrev = prev;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                [0m[35m/[0m[35m/[0m[39m xref table and trailer[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[35m/[0m[35m/[0m[39m use existing parser to parse xref table[0m                      [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mparseXrefTable[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m || ![0m[1;35mparseTrailer[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Expected trailer object at offset "[0m  [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                [0m[1;35mif[0m[1;39m([0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:                    int streamOffset = [0m[1;35mtrailer.getInt[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                    [0m[35m/[0m[35m/[0m[39m check the xref stream reference[0m                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:                    fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                    if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != streamOffset[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"/XRefStm offset [0m[32m{[0m[32m}[0m[32m is incorrect, corrected to[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                                fixedOffset[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                        streamOffset = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mfixedOffset;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                        [0m[1;35mtrailer.setInt[0m[1;39m([0m[39mCOSName.XREF_STM, streamOffset[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:                    if [0m[1;39m([0m[39mstreamOffset > [0m[1;36m0[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                        [0m[1;35msource.seek[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                        [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                        try[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                            [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                            [0m[1;35mdocument.setHasHybridXRef[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                        catch [0m[1;39m([0m[39mIOException ex[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                            [0m[1;35mLOG.error[0m[1;39m([0m[32m"Failed to parse /XRefStm at offset "[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [39mstreamOffset, ex[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                        [0m[1;35mLOG.error[0m[1;39m([0m[32m"Skipped XRef stream due to a corrupt offset:[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                prev = [0m[1;35mtrailer.getLong[0m[1;39m([0m[39mCOSName.PREV[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[35m/[0m[35m/[0m[39m parse xref stream[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                prev = [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, true[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            if [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[35m/[0m[35m/[0m[39m check the xref table reference[0m                               [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != prev[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                    prev = fixedOffset;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                    [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[35m/[0m[35m/[0m[39m ---- build valid xrefs out of the xref chain[0m                         [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;35mxrefTrailerResolver.setStartxref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        trailer = [0m[1;35mxrefTrailerResolver.getTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_8/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m54[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java [0m    [2m                [0m
[2;36m                    [0m         [39mb/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index e8b53efc4..97bc49a2a [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-23[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m23[0m[39m,[0m[1;36m7[0m[39m @@ import java.util.HashSet;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: import java.util.Optional;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: import java.util.Map.Entry;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:+import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: import org.apache.logging.log4j.LogManager;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: import org.apache.logging.log4j.Logger;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:@@ [0m[1;36m-98[0m[39m,[0m[1;36m17[0m[39m +[0m[1;36m99[0m[39m,[0m[1;36m19[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:         [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:         [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         long prev = startXrefOffset;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:-        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m           [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:-        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:         [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m     [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+        Set<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:         COSDictionary trailer = null;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:-        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:+        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:-            lastPrev = prev;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:+            [0m[35m/[0m[35m/[0m[39m save expected position for loop detection[0m                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:+            [0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:             [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:             [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:             [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:             [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:+            [0m[35m/[0m[35m/[0m[39m save current position as well due to skipped spaces[0m              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:+            [0m[1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:             [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:             if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:@@ [0m[1;36m-120[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m123[0m[39m,[0m[1;36m7[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:                             + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:                 [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                 trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:-                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:+                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                 [0m[1;35mif[0m[1;39m([0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                 [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                     int streamOffset = [0m[1;35mtrailer.getInt[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:@@ [0m[1;36m-170[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m173[0m[39m,[0m[1;36m7[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                     [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                 [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:-            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:+            if [0m[1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1FontEmbedder.jav[0m[1;92ma:19[0m[39m-[0m[1;36m36[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:import java.io.IOException;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:import java.io.InputStream;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:import java.util.ArrayList;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:import java.util.List;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:import org.apache.fontbox.afm.FontMetrics;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:import org.apache.fontbox.encoding.BuiltInEncoding;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:import org.apache.fontbox.pfb.PfbParser;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:import org.apache.fontbox.type1.Type1Font;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:import org.apache.fontbox.util.BoundingBox;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:import org.apache.pdfbox.cos.COSArray;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:import org.apache.pdfbox.cos.COSDictionary;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:import org.apache.pdfbox.cos.COSName;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:import org.apache.pdfbox.pdmodel.PDDocument;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:import org.apache.pdfbox.pdmodel.common.PDRectangle;[0m                             [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:import org.apache.pdfbox.pdmodel.common.PDStream;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:import org.apache.pdfbox.pdmodel.font.encoding.Encoding;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:import org.apache.pdfbox.pdmodel.font.encoding.GlyphList;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:import org.apache.pdfbox.pdmodel.font.encoding.Type1Encoding;[0m                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/font/PDType1FontEmbedder.jav[0m[1;92ma:56[0m[39m-[0m[1;36m78[0m  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m56[0m[39m:    [0m[1;35mPDType1FontEmbedder[0m[1;39m([0m[39mPDDocument doc, COSDictionary dict, InputStream [0m         [2m                [0m
[2;36m                    [0m         [39mpfbStream,[0m                                                                          [2m                [0m
[2;36m                    [0m         [1;36m57[0m[39m:                        Encoding encoding[0m[1;39m)[0m[39m throws IOException[0m                    [2m                [0m
[2;36m                    [0m         [1;36m58[0m[39m:    [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m59[0m[39m:        [0m[1;35mdict.setItem[0m[1;39m([0m[39mCOSName.SUBTYPE, COSName.TYPE1[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m60[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m61[0m[39m:        [0m[35m/[0m[35m/[0m[39m read the pfb[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m62[0m[39m:        byte[0m[1;39m[[0m[1;39m][0m[39m pfbBytes = [0m[1;35mpfbStream.readAllBytes[0m[1;39m([0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m63[0m[39m:        PfbParser pfbParser = new [0m[1;35mPfbParser[0m[1;39m([0m[39mpfbBytes[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m64[0m[39m:        type1 = [0m[1;35mType1Font.createWithPFB[0m[1;39m([0m[39mpfbBytes[0m[1;39m)[0m[39m;[0m                               [2m                [0m
[2;36m                    [0m         [1;36m65[0m[39m:        [0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m66[0m[39m:        if [0m[1;39m([0m[39mencoding == null[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m67[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m68[0m[39m:            fontEncoding = [0m[1;35mType1Encoding.fromFontBox[0m[1;39m([0m[1;35mtype1.getEncoding[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m       [2m                [0m
[2;36m                    [0m         [1;36m69[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m70[0m[39m:        else[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m71[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m72[0m[39m:            fontEncoding = encoding;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m73[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m74[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m75[0m[39m:        [0m[35m/[0m[35m/[0m[39m build font descriptor[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m76[0m[39m:        PDFontDescriptor fd = [0m[1;35mbuildFontDescriptor[0m[1;39m([0m[39mtype1[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m77[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m78[0m[39m:        PDStream fontStream = new [0m[1;35mPDStream[0m[1;39m([0m[39mdoc, [0m[1;35mpfbParser.getInputStream[0m[1;39m([0m[1;39m)[0m[39m, [0m     [2m                [0m
[2;36m                    [0m         [39mCOSName.FLATE_DECODE[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:115[0m[39m-[0m[1;36m130[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:            Token token = [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:            if [0m[1;39m([0m[39mtoken == null[0m[1;39m)[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:            if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.NAME &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m([0m[32m"currentdict"[0m[1;35m.equals[0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m || [0m                      [2m                [0m
[2;36m                    [0m         [32m"end"[0m[1;35m.equals[0m[1;39m([0m[1;35mtoken.getText[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:            [0m[35m/[0m[35m/[0m[39m key/value[0m                                                        [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:330[0m[39m-[0m[1;36m365[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m330[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m331[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m332[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m333[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m334[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m335[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m336[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m337[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m338[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m339[0m[39m:               ![0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m340[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m341[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m342[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m343[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m344[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m345[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m346[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m347[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m348[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m349[0m[39m:                [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m350[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m351[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m352[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m353[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m354[0m[39m:            [0m[35m/[0m[35m/[0m[39m simple value[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m355[0m[39m:            String key = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                         [2m                [0m
[2;36m                    [0m         [1;36m356[0m[39m:            List<Token> value = [0m[1;35mreadDictValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                [2m                [0m
[2;36m                    [0m         [1;36m357[0m[39m:            [0m[1;35mdict.put[0m[1;39m([0m[39mkey, value[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m358[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m359[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m360[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"end"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m361[0m[39m:        [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m362[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m363[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m364[0m[39m:        return dict;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m365[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:469[0m[39m-[0m[1;36m536[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m469[0m[39m:    private List<Token> [0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                           [2m                [0m
[2;36m                    [0m         [1;36m470[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m471[0m[39m:        List<Token> value = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m472[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m473[0m[39m:        int openProc = [0m[1;36m1[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m474[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m475[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m476[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m477[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m478[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Malformed procedure: missing token"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m479[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m480[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m481[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m482[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m483[0m[39m:                openProc++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m484[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m485[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m486[0m[39m:            Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m487[0m[39m:            [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m488[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m489[0m[39m:            if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_PROC[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m490[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m491[0m[39m:                openProc--;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m492[0m[39m:                if [0m[1;39m([0m[39mopenProc == [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m493[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m494[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m495[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m496[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m497[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m498[0m[39m:        Token executeonly = [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m               [2m                [0m
[2;36m                    [0m         [1;36m499[0m[39m:        if [0m[1;39m([0m[39mexecuteonly != null[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m500[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m501[0m[39m:            [0m[1;35mvalue.add[0m[1;39m([0m[39mexecuteonly[0m[1;39m)[0m[39m;[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m502[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m503[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m504[0m[39m:        return value;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m505[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m506[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m507[0m[39m:    [0m[35m/[0m[39m**[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m508[0m[39m:     * Reads a procedure but without returning anything.[0m                        [2m                [0m
[2;36m                    [0m         [1;36m509[0m[39m:     *[0m[35m/[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m510[0m[39m:    private void [0m[1;35mreadProcVoid[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m511[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m512[0m[39m:        int openProc = [0m[1;36m1[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m513[0m[39m:        while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m514[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m515[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m516[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m517[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Malformed procedure: missing token"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m518[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m519[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_PROC[0m[1;39m)[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m520[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m521[0m[39m:                openProc++;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m522[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m523[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m524[0m[39m:            Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m525[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m526[0m[39m:            if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_PROC[0m[1;39m)[0m                              [2m                [0m
[2;36m                    [0m         [1;36m527[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m528[0m[39m:                openProc--;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m529[0m[39m:                if [0m[1;39m([0m[39mopenProc == [0m[1;36m0[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m530[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m531[0m[39m:                    break;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m532[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m533[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m534[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m535[0m[39m:        [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"executeonly"[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m536[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:706[0m[39m-[0m[1;36m743[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m706[0m[39m:    private void [0m[1;35mreadSubrs[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                        [2m                [0m
[2;36m                    [0m         [1;36m707[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m708[0m[39m:        [0m[35m/[0m[35m/[0m[39m allocate size [0m[1;39m([0m[39marray indexes may not be in-order[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m709[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m710[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m711[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m712[0m[39m:            [0m[1;35mfont.subrs.add[0m[1;39m([0m[39mnull[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m713[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m714[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m715[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m716[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m717[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m718[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m719[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m720[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m721[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m722[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m723[0m[39m:            if [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m724[0m[39m:                  [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m725[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m726[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m727[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m728[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m729[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m730[0m[39m:            Token index = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m731[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m732[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m733[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m734[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m735[0m[39m:            int j = [0m[1;35mindex.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m736[0m[39m:            if [0m[1;39m([0m[39mj < [0m[1;35mfont.subrs.size[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m737[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m738[0m[39m:                [0m[1;35mfont.subrs.set[0m[1;39m([0m[39mj, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, CHARSTRING_KEY,[0m [2m                [0m
[2;36m                    [0m         [39mlenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m739[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m740[0m[39m:            [0m[1;35mreadPut[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m741[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m742[0m[39m:        [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m743[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:777[0m[39m-[0m[1;36m813[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m777[0m[39m:    private void [0m[1;35mreadCharStrings[0m[1;39m([0m[39mint lenIV[0m[1;39m)[0m[39m throws IOException[0m                  [2m                [0m
[2;36m                    [0m         [1;36m778[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m779[0m[39m:        int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m780[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dict"[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m781[0m[39m:        [0m[35m/[0m[35m/[0m[39m could actually be a sequence ending in [0m[32m"CharStrings begin"[0m[39m, too[0m      [2m                [0m
[2;36m                    [0m         [1;36m782[0m[39m:        [0m[35m/[0m[35m/[0m[39m instead of the [0m[32m"dup begin"[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m783[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m784[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"begin"[0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m785[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m786[0m[39m:        for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m787[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m788[0m[39m:            [0m[35m/[0m[35m/[0m[39m premature end[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m789[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m790[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m791[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m792[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m793[0m[39m:            if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m794[0m[39m:                [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"end"[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;36m795[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m796[0m[39m:                break;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m797[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m798[0m[39m:            [0m[35m/[0m[35m/[0m[39m key/value[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m799[0m[39m:            String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m800[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m801[0m[39m:            [0m[35m/[0m[35m/[0m[39m RD[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m802[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m803[0m[39m:            Token charstring = [0m[1;35mread[0m[1;39m([0m[39mToken.CHARSTRING[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m804[0m[39m:            [0m[1;35mfont.charstrings.put[0m[1;39m([0m[39mname, [0m[1;35mdecrypt[0m[1;39m([0m[1;35mcharstring.getData[0m[1;39m([0m[1;39m)[0m[39m, [0m           [2m                [0m
[2;36m                    [0m         [39mCHARSTRING_KEY, lenIV[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m805[0m[39m:            [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m806[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m807[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m808[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have one [0m[32m"end"[0m[39m, others two[0m                                [2m                [0m
[2;36m                    [0m         [1;36m809[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"end"[0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m810[0m[39m:        [0m[35m/[0m[35m/[0m[39m since checking ends here, this does not matter [0m[33m...[0m[39m.[0m                  [2m                [0m
[2;36m                    [0m         [1;36m811[0m[39m:        [0m[35m/[0m[35m/[0m[39m more thorough checking would see whether there is [0m[32m"begin"[0m[39m before [0m    [2m                [0m
[2;36m                    [0m         [35m/[0m[95mPrivate[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m812[0m[39m:        [0m[35m/[0m[35m/[0m[39m and expect a [0m[32m"def"[0m[39m somewhere, otherwise a [0m[32m"put"[0m                      [2m                [0m
[2;36m                    [0m         [1;36m813[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:382[0m[39m-[0m[1;36m432[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m382[0m[39m:    private List<Token> [0m[1;35mreadValue[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                          [2m                [0m
[2;36m                    [0m         [1;36m383[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m384[0m[39m:        List<Token> value = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m385[0m[39m:        Token token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m386[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m387[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m388[0m[39m:            return value;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m389[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m390[0m[39m:        [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m391[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m392[0m[39m:        if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.START_ARRAY[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [1;36m393[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m394[0m[39m:            int openArray = [0m[1;36m1[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m395[0m[39m:            while [0m[1;39m([0m[39mtrue[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m396[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m397[0m[39m:                if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m398[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m399[0m[39m:                    return value;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m400[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m401[0m[39m:                if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_ARRAY[0m[1;39m)[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [1;36m402[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m403[0m[39m:                    openArray++;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m404[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m405[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m406[0m[39m:                token = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m407[0m[39m:                [0m[1;35mvalue.add[0m[1;39m([0m[39mtoken[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m408[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m409[0m[39m:                if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.END_ARRAY[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;36m410[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m411[0m[39m:                    openArray--;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m412[0m[39m:                    if [0m[1;39m([0m[39mopenArray == [0m[1;36m0[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m413[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m414[0m[39m:                        break;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m415[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m416[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m417[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m418[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m419[0m[39m:        else if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.START_PROC[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m420[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m421[0m[39m:            [0m[1;35mvalue.addAll[0m[1;39m([0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m422[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m423[0m[39m:        else if [0m[1;39m([0m[1;35mtoken.getKind[0m[1;39m([0m[1;39m)[0m[39m == Token.START_DICT[0m[1;39m)[0m                           [2m                [0m
[2;36m                    [0m         [1;36m424[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m425[0m[39m:            [0m[35m/[0m[35m/[0m[39m skip [0m[32m"/GlyphNames2HostCode << >> def"[0m                            [2m                [0m
[2;36m                    [0m         [1;36m426[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.END_DICT[0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m427[0m[39m:            return value;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m428[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m429[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m430[0m[39m:        [0m[1;35mreadPostScriptWrapper[0m[1;39m([0m[39mvalue[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m431[0m[39m:        return value;[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m432[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:746[0m[39m-[0m[1;36m771[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m746[0m[39m:    private void [0m[1;35mreadOtherSubrs[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                            [2m                [0m
[2;36m                    [0m         [1;36m747[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m748[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m749[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m750[0m[39m:            throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Missing start token of OtherSubrs [0m           [2m                [0m
[2;36m                    [0m         [32mprocedure"[0m[1;39m)[0m[39m;[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m751[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m752[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.START_ARRAY[0m[1;39m)[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m753[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m754[0m[39m:            [0m[1;35mreadValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m755[0m[39m:            [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m756[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m757[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m758[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m759[0m[39m:            int length = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m760[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m761[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m762[0m[39m:            for [0m[1;39m([0m[39mint i = [0m[1;36m0[0m[39m; i < length; i++[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m763[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m764[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m765[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m index[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m766[0m[39m:                [0m[1;35mreadValue[0m[1;39m([0m[1;39m)[0m[39m; [0m[35m/[0m[35m/[0m[39m PostScript[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m767[0m[39m:                [0m[1;35mreadPut[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m768[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m769[0m[39m:            [0m[1;35mreadDef[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m770[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m771[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/README.m[0m[1;92md:1[0m[39m-[0m[1;36m11[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m:# What design decisions were considered for this challenge?[0m                       [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:Unlike with commons-compress, where we focused on individual challenges,[0m          [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:we wanted to add a large number of vulnerabilities into on large full repository [0m [2m                [0m
[2;36m                    [0m         [39mscan.[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:# Why this set of vulnerabilities?[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:While there's a heavy focus on the Type1 font parser, there are vulnerabilities[0m   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:that also focus on general structure of the PDF file.[0m                             [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:[0m                                                                                  [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:# Delta vs Full and why?[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:See above. We wanted at least one challenge to be a full repository challenge [0m   [2m                [0m
[2;36m                    [0m         [39mwith a [0m                                                                             [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:large number of vulnerabilities.[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/challenge.yaml:[0m[1;36m17[0m[39m-[0m[1;36m18[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:timeouts: [0m[32m'enabled'[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/challenge.yaml:[0m[1;36m36[0m[39m-[0m[1;36m44[0m                                                         [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:# harness fuzz targets available for this challenge[0m                              [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:harnesses:[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:    - [0m[32m'DomXfaParserFuzzer'[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:    - [0m[32m'DomXmpParserFuzzer'[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:    - [0m[32m'PDFExtractTextFuzzer'[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:    - [0m[32m'PDFStreamParserFuzzer'[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:    - [0m[32m'PDFWriteReadFuzzer'[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:    - [0m[32m'PDFOCRFuzzer'[0m                                                             [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:192[0m[39m-[0m[1;36m239[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:    private void [0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m throws IOException[0m                              [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:        if [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            String name = [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:            if [0m[1;39m([0m[1;35mname.equals[0m[1;39m([0m[32m"StandardEncoding"[0m[1;39m)[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:                font.encoding = StandardEncoding.INSTANCE;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Unknown encoding: "[0m[39m + name[0m[1;39m)[0m[39m;[0m             [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:        else[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"array"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:            [0m[35m/[0m[35m/[0m[39m [0m[1;36m0[0m[39m [0m[1;36m1[0m[39m [0m[1;36m255[0m[39m [0m[1;39m{[0m[1;36m1[0m[39m index exch [0m[35m/[0m[95m.notdef[0m[39m put [0m[1;39m}[0m[39m for[0m                         [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:            [0m[35m/[0m[35m/[0m[39m we have to check [0m[32m"readonly"[0m[39m and [0m[32m"def"[0m[39m too[0m                        [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:            [0m[35m/[0m[35m/[0m[39m as some fonts don't provide any dup-values, see PDFBOX-[0m[1;36m2134[0m      [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:            while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                    && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m               [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m   [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                            || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                              [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:            Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:            while [0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m &&[0m                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:                    [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[1;39m)[0m                  [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"dup"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:                int code = [0m[1;35mread[0m[1;39m([0m[39mToken.INTEGER[0m[1;39m)[0m[1;35m.intValue[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m231[0m[39m:                String name = [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m232[0m[39m:                [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"put"[0m[1;39m)[0m[39m;[0m                                        [2m                [0m
[2;36m                    [0m         [1;36m233[0m[39m:                [0m[1;35mcodeToName.put[0m[1;39m([0m[39mcode, name[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m234[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m235[0m[39m:            font.encoding = new [0m[1;35mBuiltInEncoding[0m[1;39m([0m[39mcodeToName[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m236[0m[39m:            [0m[1;35mreadMaybe[0m[1;39m([0m[39mToken.NAME, [0m[32m"readonly"[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m237[0m[39m:            [0m[1;35mread[0m[1;39m([0m[39mToken.NAME, [0m[32m"def"[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m238[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m239[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mfontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:635[0m[39m-[0m[1;36m650[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m635[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m636[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m637[0m[39m:        [0m[35m/[0m[35m/[0m[39m some fonts have [0m[32m"2 index"[0m[39m here, others have [0m[32m"end noaccess put"[0m       [2m                [0m
[2;36m                    [0m         [1;36m638[0m[39m:        [0m[35m/[0m[35m/[0m[39m sometimes followed by [0m[32m"put"[0m[39m. Either way, we just skip until[0m          [2m                [0m
[2;36m                    [0m         [1;36m639[0m[39m:        [0m[35m/[0m[35m/[0m[39m the [0m[35m/[0m[95mCharStrings[0m[39m dict is found[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m640[0m[39m:        while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m641[0m[39m:                && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m          [2m                [0m
[2;36m                    [0m         [1;36m642[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m643[0m[39m:            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m644[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m645[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m646[0m[39m:        [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m647[0m[39m:        [0m[1;35mread[0m[1;39m([0m[39mToken.LITERAL, [0m[32m"CharStrings"[0m[1;39m)[0m[39m;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m648[0m[39m:        [0m[1;35mreadCharStrings[0m[1;39m([0m[39mlenIV[0m[1;39m)[0m[39m;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m649[0m[39m:    [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m650[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.jav[0m[1;92ma:180[0m[39m-[0m[1;36m230[0m              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:    private final class PageIterator implements Iterator<PDPage>[0m                [2m                [0m
[2;36m                    [0m         [1;36m181[0m[39m:    [0m[1;39m{[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m182[0m[39m:        private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m183[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m184[0m[39m:        private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m185[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m186[0m[39m:            List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m187[0m[39m:            while [0m[1;39m([0m[39m![0m[1;35mkids.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m188[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m189[0m[39m:                List<COSDictionary> newKids = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m190[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m191[0m[39m:                for [0m[1;39m([0m[39mCOSDictionary kid : kids[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m192[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m193[0m[39m:                    [0m[1;35mnewKids.addAll[0m[1;39m([0m[1;35menqueueKids[0m[1;39m([0m[39mkid[0m[1;39m)[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m194[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m195[0m[39m:                kids = newKids;[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m196[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m197[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m198[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m199[0m[39m:        [0m[35m/[0m[39m**[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m200[0m[39m:         * This takes a node, and, if it is a page adds it to the queue.[0m        [2m                [0m
[2;36m                    [0m         [1;36m201[0m[39m:         * If it is a PageTreeNode, it returns the children for that node.[0m      [2m                [0m
[2;36m                    [0m         [1;36m202[0m[39m:         *[0m                                                                      [2m                [0m
[2;36m                    [0m         [1;36m203[0m[39m:         * @param node[0m                                                          [2m                [0m
[2;36m                    [0m         [1;36m204[0m[39m:         * @return[0m                                                              [2m                [0m
[2;36m                    [0m         [1;36m205[0m[39m:         *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m206[0m[39m:        private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m207[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m208[0m[39m:            if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m209[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m210[0m[39m:                return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m211[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m212[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m213[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m214[0m[39m:                if [0m[1;39m([0m[39mnode != null && [0m                                            [2m                [0m
[2;36m                    [0m         [1;35mCOSName.PAGE.equals[0m[1;39m([0m[1;35mnode.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m215[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m216[0m[39m:                    [0m[1;35mqueue.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m217[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m218[0m[39m:                else[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m219[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m220[0m[39m:                    [0m[1;35mLOG.error[0m[1;39m([0m[32m"Page skipped due to an invalid or missing type [0m  [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m,[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m221[0m[39m:                            [0m[1;39m([0m[1;39m)[0m[39m -> [0m[1;39m([0m[39mnode == null ? [0m[32m"[0m[32m([0m[32mnull[0m[32m)[0m[32m"[0m[39m : [0m                   [2m                [0m
[2;36m                    [0m         [1;35mnode.getCOSName[0m[1;39m([0m[39mCOSName.TYPE[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m222[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m223[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m224[0m[39m:            return Collections.EMPTY_LIST;[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m225[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m226[0m[39m:[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m227[0m[39m:        @Override[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m228[0m[39m:        public boolean [0m[1;35mhasNext[0m[1;39m([0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m229[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m230[0m[39m:            return ![0m[1;35mqueue.isEmpty[0m[1;39m([0m[1;39m)[0m[39m;[0m                                            [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39mpdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.jav[0m[1;92ma:95[0m[39m-[0m[1;36m180[0m             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m95[0m[39m:        if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[1;39m)[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m96[0m[39m:        [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m97[0m[39m:            startXrefOffset = fixedOffset;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m98[0m[39m:        [0m[1;39m}[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m99[0m[39m:        [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m100[0m[39m:        long prev = startXrefOffset;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m101[0m[39m:        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m           [2m                [0m
[2;36m                    [0m         [1;36m102[0m[39m:        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m103[0m[39m:        [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m     [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m104[0m[39m:        COSDictionary trailer = null;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m105[0m[39m:        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m106[0m[39m:        [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m107[0m[39m:            lastPrev = prev;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m108[0m[39m:            [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m109[0m[39m:            [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m110[0m[39m:            [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m111[0m[39m:            [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m112[0m[39m:            [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m113[0m[39m:            if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m114[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m115[0m[39m:                [0m[35m/[0m[35m/[0m[39m xref table and trailer[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m116[0m[39m:                [0m[35m/[0m[35m/[0m[39m use existing parser to parse xref table[0m                      [2m                [0m
[2;36m                    [0m         [1;36m117[0m[39m:                if [0m[1;39m([0m[39m![0m[1;35mparseXrefTable[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m || ![0m[1;35mparseTrailer[0m[1;39m([0m[1;39m)[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [1;36m118[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m119[0m[39m:                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Expected trailer object at offset "[0m  [2m                [0m
[2;36m                    [0m         [1;36m120[0m[39m:                            + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m121[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m122[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m123[0m[39m:                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m124[0m[39m:                [0m[1;35mif[0m[1;39m([0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m125[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m126[0m[39m:                    int streamOffset = [0m[1;35mtrailer.getInt[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m127[0m[39m:                    [0m[35m/[0m[35m/[0m[39m check the xref stream reference[0m                          [2m                [0m
[2;36m                    [0m         [1;36m128[0m[39m:                    fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [1;36m129[0m[39m:                    if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != streamOffset[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m130[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m131[0m[39m:                        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"/XRefStm offset [0m[32m{[0m[32m}[0m[32m is incorrect, corrected to[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset,[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m132[0m[39m:                                fixedOffset[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m133[0m[39m:                        streamOffset = [0m[1;39m([0m[39mint[0m[1;39m)[0m[39mfixedOffset;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m134[0m[39m:                        [0m[1;35mtrailer.setInt[0m[1;39m([0m[39mCOSName.XREF_STM, streamOffset[0m[1;39m)[0m[39m;[0m         [2m                [0m
[2;36m                    [0m         [1;36m135[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m136[0m[39m:                    if [0m[1;39m([0m[39mstreamOffset > [0m[1;36m0[0m[1;39m)[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m137[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m138[0m[39m:                        [0m[1;35msource.seek[0m[1;39m([0m[39mstreamOffset[0m[1;39m)[0m[39m;[0m                              [2m                [0m
[2;36m                    [0m         [1;36m139[0m[39m:                        [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m140[0m[39m:                        try[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m141[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m142[0m[39m:                            [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, false[0m[1;39m)[0m[39m;[0m                    [2m                [0m
[2;36m                    [0m         [1;36m143[0m[39m:                            [0m[1;35mdocument.setHasHybridXRef[0m[1;39m([0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m144[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m145[0m[39m:                        catch [0m[1;39m([0m[39mIOException ex[0m[1;39m)[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m146[0m[39m:                        [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m147[0m[39m:                            [0m[1;35mLOG.error[0m[1;39m([0m[32m"Failed to parse /XRefStm at offset "[0m[39m + [0m  [2m                [0m
[2;36m                    [0m         [39mstreamOffset, ex[0m[1;39m)[0m[39m;[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m148[0m[39m:                        [0m[1;39m}[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m149[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m150[0m[39m:                    else[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m151[0m[39m:                    [0m[1;39m{[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m152[0m[39m:                        [0m[1;35mLOG.error[0m[1;39m([0m[32m"Skipped XRef stream due to a corrupt offset:[0m [2m                [0m
[2;36m                    [0m         [32m{[0m[32m}[0m[32m"[0m[39m, streamOffset[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m153[0m[39m:                    [0m[1;39m}[0m                                                           [2m                [0m
[2;36m                    [0m         [1;36m154[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m155[0m[39m:                prev = [0m[1;35mtrailer.getLong[0m[1;39m([0m[39mCOSName.PREV[0m[1;39m)[0m[39m;[0m                           [2m                [0m
[2;36m                    [0m         [1;36m156[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m157[0m[39m:            else[0m                                                                [2m                [0m
[2;36m                    [0m         [1;36m158[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m159[0m[39m:                [0m[35m/[0m[35m/[0m[39m parse xref stream[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m160[0m[39m:                prev = [0m[1;35mparseXrefObjStream[0m[1;39m([0m[39mprev, true[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;36m161[0m[39m:                trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m162[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m163[0m[39m:            if [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m164[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m165[0m[39m:                [0m[35m/[0m[35m/[0m[39m check the xref table reference[0m                               [2m                [0m
[2;36m                    [0m         [1;36m166[0m[39m:                fixedOffset = [0m[1;35mcheckXRefOffset[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m167[0m[39m:                if [0m[1;39m([0m[39mfixedOffset > [0m[1;36m-1[0m[39m && fixedOffset != prev[0m[1;39m)[0m                    [2m                [0m
[2;36m                    [0m         [1;36m168[0m[39m:                [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m169[0m[39m:                    prev = fixedOffset;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m170[0m[39m:                    [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m171[0m[39m:                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m172[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m173[0m[39m:            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m174[0m[39m:            [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m175[0m[39m:                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m176[0m[39m:            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m177[0m[39m:        [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m178[0m[39m:        [0m[35m/[0m[35m/[0m[39m ---- build valid xrefs out of the xref chain[0m                         [2m                [0m
[2;36m                    [0m         [1;36m179[0m[39m:        [0m[1;35mxrefTrailerResolver.setStartxref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m180[0m[39m:        trailer = [0m[1;35mxrefTrailerResolver.getTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m                             [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_3/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m15[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java [0m     [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index c995d96e2..c4a973ade [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-219[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m219[0m[39m,[0m[1;36m9[0m[39m @@ final class Type1Parser[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m    [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                             || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m      [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:             [0m[1;39m{[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-                [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+                if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+                    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Should have found dup, readonly or [0m  [2m                [0m
[2;36m                    [0m         [32mdef?! EOF?"[0m[1;39m)[0m[39m;[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:+                [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:             [0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:             Map<Integer, String> codeToName = new HashMap<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_4/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m16[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java [0m     [2m                [0m
[2;36m                    [0m         [39mb/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m                   [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index a979cfbdb..c8e7e1e1c [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java[0m             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-643[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m643[0m[39m,[0m[1;36m10[0m[39m @@ final class Type1Parser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:         while [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                   [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:                 && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:         [0m[1;39m{[0m                                                                        [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-            [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+[0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:+            if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:+                throw new [0m[1;35mIOException[0m[1;39m([0m[32m"EOF? Should have found CharStrings"[0m[1;39m)[0m[39m;[0m    [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:+            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:         [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         [0m[35m/[0m[35m/[0m[39m CharStrings dict[0m                                                     [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_7/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m25[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java [0m      [2m                [0m
[2;36m                    [0m         [39mb/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m                    [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index 949b259c3..f4a3c6f66 [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java[0m              [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-180[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m180[0m[39m,[0m[1;36m7[0m[39m @@ public class PDPageTree implements COSObjectable, [0m            [2m                [0m
[2;36m                    [0m         [39mIterable<PDPage>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m:     private final class PageIterator implements Iterator<PDPage>[0m                 [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m:     [0m[1;39m{[0m                                                                            [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m:         private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m           [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:-[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m:+        private Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m:         private [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                                [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:             List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                       [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:@@ [0m[1;36m-205[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m205[0m[39m,[0m[1;36m11[0m[39m @@ public class PDPageTree implements COSObjectable, [0m          [2m                [0m
[2;36m                    [0m         [39mIterable<PDPage>[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:          *[0m[35m/[0m                                                                     [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         private List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m             [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:+            if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:+                [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m            [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+                return Collections.EMPTY_LIST;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:+            [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:+            [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:             if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:                 return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<code>[0m                                                                              [2m                [0m
[2;36m                    [0m         [39m.aixcc/vulns/vuln_8/patches/good_patch.di[0m[1;92mff:1[0m[39m-[0m[1;36m54[0m                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [1;92m1:d[0m[39miff --git a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java [0m    [2m                [0m
[2;36m                    [0m         [39mb/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m                  [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m:index e8b53efc4..97bc49a2a [0m[1;36m100644[0m                                                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m:--- a/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m            [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m:+++ b/pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java[0m            [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m:@@ [0m[1;36m-23[0m[39m,[0m[1;36m6[0m[39m +[0m[1;36m23[0m[39m,[0m[1;36m7[0m[39m @@ import java.util.HashSet;[0m                                       [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m: import java.util.Map;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m7[0m[39m: import java.util.Optional;[0m                                                       [2m                [0m
[2;36m                    [0m         [1;36m8[0m[39m: import java.util.Map.Entry;[0m                                                      [2m                [0m
[2;36m                    [0m         [1;36m9[0m[39m:+import java.util.Set;[0m                                                            [2m                [0m
[2;36m                    [0m         [1;36m10[0m[39m: [0m                                                                                [2m                [0m
[2;36m                    [0m         [1;36m11[0m[39m: import org.apache.logging.log4j.LogManager;[0m                                     [2m                [0m
[2;36m                    [0m         [1;36m12[0m[39m: import org.apache.logging.log4j.Logger;[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m13[0m[39m:@@ [0m[1;36m-98[0m[39m,[0m[1;36m17[0m[39m +[0m[1;36m99[0m[39m,[0m[1;36m19[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m14[0m[39m:         [0m[1;39m}[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m15[0m[39m:         [0m[1;35mdocument.setStartXref[0m[1;39m([0m[39mstartXrefOffset[0m[1;39m)[0m[39m;[0m                                 [2m                [0m
[2;36m                    [0m         [1;36m16[0m[39m:         long prev = startXrefOffset;[0m                                            [2m                [0m
[2;36m                    [0m         [1;36m17[0m[39m:-        [0m[35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m           [2m                [0m
[2;36m                    [0m         [1;36m18[0m[39m:-        long lastPrev = [0m[1;36m-1[0m[39m;[0m                                                     [2m                [0m
[2;36m                    [0m         [1;36m19[0m[39m:         [0m[35m/[0m[35m/[0m[39m ---- parse whole chain of xref tables/object streams using PREV [0m     [2m                [0m
[2;36m                    [0m         [39mreference[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m20[0m[39m:+        Set<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m21[0m[39m:         COSDictionary trailer = null;[0m                                           [2m                [0m
[2;36m                    [0m         [1;36m22[0m[39m:-        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m         [1;36m23[0m[39m:+        while [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                        [2m                [0m
[2;36m                    [0m         [1;36m24[0m[39m:         [0m[1;39m{[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m25[0m[39m:-            lastPrev = prev;[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m26[0m[39m:+            [0m[35m/[0m[35m/[0m[39m save expected position for loop detection[0m                        [2m                [0m
[2;36m                    [0m         [1;36m27[0m[39m:+            [0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m28[0m[39m:             [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m29[0m[39m:             [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [1;36m30[0m[39m:             [0m[35m/[0m[35m/[0m[39m skip white spaces[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m31[0m[39m:             [0m[1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [1;36m32[0m[39m:+            [0m[35m/[0m[35m/[0m[39m save current position as well due to skipped spaces[0m              [2m                [0m
[2;36m                    [0m         [1;36m33[0m[39m:+            [0m[1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                  [2m                [0m
[2;36m                    [0m         [1;36m34[0m[39m:             [0m[35m/[0m[35m/[0m[39m -- parse xref[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m35[0m[39m:             if [0m[1;39m([0m[1;35msource.peek[0m[1;39m([0m[1;39m)[0m[39m == X[0m[1;39m)[0m                                             [2m                [0m
[2;36m                    [0m         [1;36m36[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m37[0m[39m:@@ [0m[1;36m-120[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m123[0m[39m,[0m[1;36m7[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m38[0m[39m:                             + [0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [1;36m39[0m[39m:                 [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m40[0m[39m:                 trailer = [0m[1;35mxrefTrailerResolver.getCurrentTrailer[0m[1;39m([0m[1;39m)[0m[39m;[0m              [2m                [0m
[2;36m                    [0m         [1;36m41[0m[39m:-                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects [0m                                                                 [2m                [0m
[2;36m                    [0m         [1;36m42[0m[39m:+                [0m[35m/[0m[35m/[0m[39m check for a XRef stream, it may contain some object ids of [0m  [2m                [0m
[2;36m                    [0m         [39mcompressed objects[0m                                                                  [2m                [0m
[2;36m                    [0m         [1;36m43[0m[39m:                 [0m[1;35mif[0m[1;39m([0m[1;35mtrailer.containsKey[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[1;39m)[0m                       [2m                [0m
[2;36m                    [0m         [1;36m44[0m[39m:                 [0m[1;39m{[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m45[0m[39m:                     int streamOffset = [0m[1;35mtrailer.getInt[0m[1;39m([0m[39mCOSName.XREF_STM[0m[1;39m)[0m[39m;[0m        [2m                [0m
[2;36m                    [0m         [1;36m46[0m[39m:@@ [0m[1;36m-170[0m[39m,[0m[1;36m7[0m[39m +[0m[1;36m173[0m[39m,[0m[1;36m7[0m[39m @@ public class XrefParser[0m                                      [2m                [0m
[2;36m                    [0m         [1;36m47[0m[39m:                     [0m[1;35mtrailer.setLong[0m[1;39m([0m[39mCOSName.PREV, prev[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [1;36m48[0m[39m:                 [0m[1;39m}[0m                                                               [2m                [0m
[2;36m                    [0m         [1;36m49[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m50[0m[39m:-            if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m         [1;36m51[0m[39m:+            if [0m[1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m                                         [2m                [0m
[2;36m                    [0m         [1;36m52[0m[39m:             [0m[1;39m{[0m                                                                   [2m                [0m
[2;36m                    [0m         [1;36m53[0m[39m:                 throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m          [2m                [0m
[2;36m                    [0m         [1;36m54[0m[39m:             [0m[1;39m}[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode[0m[39m>[0m                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mcode_snippets[0m[39m>[0m                                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m<fix_strategy>[0m                                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Analysis of the Evaluation Report[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe evaluation report describes a **libFuzzer timeout error**, indicating that the [0m [2m                [0m
[2;36m                    [0m         [39mfuzzing process exceeded its time limit. This is a classic symptom of infinite [0m     [2m                [0m
[2;36m                    [0m         [39mloops or extremely poor algorithmic complexity in the code under test. The timeout [0m [2m                [0m
[2;36m                    [0m         [39msuggests a **Denial of Service [0m[1;39m([0m[39mDoS[0m[1;39m)[0m[39m vulnerability** [0m[1;39m([0m[39mCWE-[0m[1;36m834[0m[39m, CWE-[0m[1;36m835[0m[1;39m)[0m[39m.[0m            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mBased on the provided code snippets and vulnerability metadata, four specific [0m      [2m                [0m
[2;36m                    [0m         [39minfinite loop vulnerabilities have been identified in the Apache PDFBox codebase:[0m   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **vuln_3**: Infinite loop in `[0m[1;35mType1Parser.readEncoding[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m217[0m[39m-[0m[1;36m223[0m[1;39m)[0m        [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **vuln_4**: Infinite loop in `[0m[1;35mType1Parser.parseBinary[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mlines [0m[1;36m640[0m[39m-[0m[1;36m644[0m[1;39m)[0m         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **vuln_7**: Infinite loop in `PDPageTree.PageIterator` [0m[1;39m([0m[39mlines [0m[1;36m186[0m[39m-[0m[1;36m225[0m[1;39m)[0m           [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **vuln_8**: Infinite loop in `XrefParser` xref table parsing [0m[1;39m([0m[39mlines [0m[1;36m102[0m[39m-[0m[1;36m176[0m[1;39m)[0m     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAll of these vulnerabilities can be triggered by malformed PDFs during fuzzing, [0m    [2m                [0m
[2;36m                    [0m         [39mleading to the observed timeout.[0m                                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Root Cause Analysis[0m                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Type1Parser Infinite Loops [0m[1;39m([0m[39mvuln_3 & vuln_4[0m[1;39m)[0m                                    [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause:** [0m                                                                    [2m                [0m
[2;36m                    [0m         [39mBoth locations have while loops that search for specific tokens but fail to handle [0m [2m                [0m
[2;36m                    [0m         [39mEOF conditions:[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m vuln_3 [0m[1;39m([0m[39mline [0m[1;36m217[0m[39m-[0m[1;36m223[0m[39m in readEncoding[0m[1;39m)[0m[39m:[0m                                           [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m[39m && [0m                                             [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m[39m ||[0m                               [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m[39m ||[0m                          [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m ← No null check![0m                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m vuln_4 [0m[1;39m([0m[39mline [0m[1;36m640[0m[39m-[0m[1;36m644[0m[39m in parseBinary[0m[1;39m)[0m[39m:[0m                                            [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m[39m &&[0m                                           [2m                [0m
[2;36m                    [0m         [39m         [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m ← No null check![0m                                         [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Why it causes infinite loops:**[0m                                                   [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. When the lexer reaches EOF, `[0m[1;35mpeekToken[0m[1;39m([0m[1;39m)[0m[39m` returns `null`[0m                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. The loop condition `![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m && [0m[33m...[0m[1;39m)[0m[39m` evaluates to `true` when [0m     [2m                [0m
[2;36m                    [0m         [39m`[0m[1;35mpeekToken[0m[1;39m([0m[1;39m)[0m[39m` is null [0m[1;39m([0m[39mbecause `[0m[1;35mpeekKind[0m[1;39m([0m[1;39m)[0m[39m` returns false for null[0m[1;39m)[0m                 [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. `[0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m` returns null but the loop continues indefinitely[0m                   [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. The loop never exits, consuming null tokens forever[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Established Patterns in Codebase:**[0m                                               [2m                [0m
[2;36m                    [0m         [39mThe codebase already has correct EOF handling patterns in multiple locations:[0m       [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m476[0m[1;39m)[0m[39m: `if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m throw new [0m               [2m                [0m
[2;36m                    [0m         [1;35mIOException[0m[1;39m([0m[33m...[0m[1;39m)[0m[39m`[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mreadProcVoid[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m515[0m[1;39m)[0m[39m: Same pattern[0m                                         [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mreadValue[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m397[0m[1;39m)[0m[39m: `if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m return value;`[0m          [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mreadSubrs[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m719[0m[1;39m)[0m[39m: `if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m break;`[0m                 [2m                [0m
[2;36m                    [0m         [39m- `[0m[1;35mreadCharStrings[0m[1;39m([0m[1;39m)[0m[39m` [0m[1;39m([0m[39mline [0m[1;36m789[0m[1;39m)[0m[39m: `if [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m break;`[0m           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe vulnerable locations failed to follow these established patterns.[0m               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### PDPageTree Infinite Loop [0m[1;39m([0m[39mvuln_7[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mThe page tree iterator traverses PDF page tree nodes without cycle detection:[0m       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate [0m[1;35mPageIterator[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m[39m [0m[1;39m{[0m                                          [2m                [0m
[2;36m                    [0m         [39m    List<COSDictionary> kids = [0m[1;35menqueueKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                   [2m                [0m
[2;36m                    [0m         [39m    while [0m[1;39m([0m[39m![0m[1;35mkids.isEmpty[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                       [2m                [0m
[2;36m                    [0m         [39m        List<COSDictionary> newKids = new ArrayList<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                            [2m                [0m
[2;36m                    [0m         [39m        for [0m[1;39m([0m[39mCOSDictionary kid : kids[0m[1;39m)[0m[39m [0m[1;39m{[0m                                            [2m                [0m
[2;36m                    [0m         [39m            [0m[1;35mnewKids.addAll[0m[1;39m([0m[1;35menqueueKids[0m[1;39m([0m[39mkid[0m[1;39m)[0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m ← No cycle detection![0m             [2m                [0m
[2;36m                    [0m         [39m        [0m[1;39m}[0m                                                                           [2m                [0m
[2;36m                    [0m         [39m        kids = newKids;[0m                                                             [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mA malformed PDF with circular page tree references [0m[1;39m([0m[39me.g., node A → node B → node A[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39mcauses infinite iteration as the same nodes are enqueued repeatedly.[0m                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### XrefParser Infinite Loop [0m[1;39m([0m[39mvuln_8[0m[1;39m)[0m                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Root Cause:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39mThe xref table parser has inadequate cycle detection:[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mlong lastPrev = [0m[1;36m-1[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m[39m [0m[1;39m{[0m                                              [2m                [0m
[2;36m                    [0m         [39m    lastPrev = prev;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m processing [0m[33m...[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    prev = [0m[1;35mtrailer.getLong[0m[1;39m([0m[39mCOSName.PREV[0m[1;39m)[0m[39m;[0m                                           [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                         [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m                      [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThis only detects immediate self-references [0m[1;39m([0m[39mA→A[0m[1;39m)[0m[39m but misses longer cycles [0m[1;39m([0m[39mA→B→A [0m  [2m                [0m
[2;36m                    [0m         [39mor A→B→C→A[0m[1;39m)[0m[39m.[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Fix Strategy[0m                                                                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Strategy Overview[0m                                                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mApply four targeted patches to fix the infinite loop vulnerabilities while [0m         [2m                [0m
[2;36m                    [0m         [39mpreserving all existing functionality:[0m                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Type1Parser vuln_3 & vuln_4**: Add null checks after `[0m[1;35mnextToken[0m[1;39m([0m[1;39m)[0m[39m` calls in [0m   [2m                [0m
[2;36m                    [0m         [39mwhile loops[0m                                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **PDPageTree vuln_7**: Add cycle detection using a `Set<COSDictionary>` to track[0m [2m                [0m
[2;36m                    [0m         [39mvisited nodes[0m                                                                       [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **XrefParser vuln_8**: Replace single-value tracking with `Set<Long>` for [0m       [2m                [0m
[2;36m                    [0m         [39mcomprehensive cycle detection[0m                                                       [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m### Detailed Implementation Steps[0m                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### **Patch [0m[1;36m1[0m[39m: Fix [0m[1;35mType1Parser.readEncoding[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mvuln_3[0m[1;39m)[0m[39m**[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File:** `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java`[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Line [0m[1;36m222[0m[39m in the `[0m[1;35mreadEncoding[0m[1;39m([0m[1;39m)[0m[39m` method[0m                               [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Change:**[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m BEFORE:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m        && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m                || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m                || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m AFTER:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.NAME[0m[1;39m)[0m                                                 [2m                [0m
[2;36m                    [0m         [39m        && [0m[1;39m([0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"dup"[0m[1;39m)[0m                               [2m                [0m
[2;36m                    [0m         [39m                || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"readonly"[0m[1;39m)[0m                   [2m                [0m
[2;36m                    [0m         [39m                || [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"def"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                     [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"Should have found dup, readonly or def?! EOF?"[0m[1;39m)[0m[39m;[0m     [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Minimal change: only adds [0m[1;36m3[0m[39m lines[0m                                                 [2m                [0m
[2;36m                    [0m         [39m- Follows the pattern from `[0m[1;35mreadProc[0m[1;39m([0m[1;39m)[0m[39m` and `[0m[1;35mreadProcVoid[0m[1;39m([0m[1;39m)[0m[39m`[0m                        [2m                [0m
[2;36m                    [0m         [39m- Throws descriptive `IOException` that clearly indicates the expected tokens and [0m  [2m                [0m
[2;36m                    [0m         [39mthe EOF condition[0m                                                                   [2m                [0m
[2;36m                    [0m         [39m- Maintains all existing logic while preventing infinite loops[0m                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### **Patch [0m[1;36m2[0m[39m: Fix [0m[1;35mType1Parser.parseBinary[0m[1;39m([0m[1;39m)[0m[39m [0m[1;39m([0m[39mvuln_4[0m[1;39m)[0m[39m**[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File:** `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.java`[0m         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Line [0m[1;36m643[0m[39m in the `[0m[1;35mparseBinary[0m[1;39m([0m[1;39m)[0m[39m` method[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Change:**[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m BEFORE:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m        && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m AFTER:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39m![0m[1;39m([0m[1;35mlexer.peekKind[0m[1;39m([0m[39mToken.LITERAL[0m[1;39m)[0m                                              [2m                [0m
[2;36m                    [0m         [39m        && [0m[1;35mlexer.peekToken[0m[1;39m([0m[1;39m)[0m[1;35m.getText[0m[1;39m([0m[1;39m)[0m[1;35m.equals[0m[1;39m([0m[32m"CharStrings"[0m[1;39m)[0m[1;39m)[0m[1;39m)[0m                      [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mlexer.nextToken[0m[1;39m([0m[1;39m)[0m[39m == null[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                [2m                [0m
[2;36m                    [0m         [39m        throw new [0m[1;35mIOException[0m[1;39m([0m[32m"EOF? Should have found CharStrings"[0m[1;39m)[0m[39m;[0m                [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Same pattern as vuln_3 fix[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Clear error message indicating what was expected[0m                                  [2m                [0m
[2;36m                    [0m         [39m- Prevents infinite loop while maintaining parsing logic[0m                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### **Patch [0m[1;36m3[0m[39m: Fix PDPageTree.PageIterator [0m[1;39m([0m[39mvuln_7[0m[1;39m)[0m[39m**[0m                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File:** `pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.java`[0m          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Lines [0m[1;36m182[0m[39m and [0m[1;36m206[0m[39m in the `PageIterator` inner class[0m                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes:**[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add member variable at line [0m[1;36m182[0m[39m:[0m                                                 [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate final class PageIterator implements Iterator<PDPage>[0m                        [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    private final Queue<COSDictionary> queue = new ArrayDeque<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                  [2m                [0m
[2;36m                    [0m         [39m    private Set<COSDictionary> seen = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;  [0m[35m/[0m[35m/[0m[39m ← ADD THIS[0m               [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of class[0m                                                            [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Add cycle check at the start of `[0m[1;35menqueueKids[0m[1;39m([0m[1;39m)[0m[39m` method [0m[1;39m([0m[39mafter line [0m[1;36m206[0m[1;39m)[0m[39m:[0m         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mprivate List<COSDictionary> [0m[1;35menqueueKids[0m[1;39m([0m[39mCOSDictionary node[0m[1;39m)[0m                         [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35mseen.contains[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m[39m [0m[1;39m{[0m                                                      [2m                [0m
[2;36m                    [0m         [39m        [0m[1;35mLOG.warn[0m[1;39m([0m[32m"Found an infinite loop in the page tree"[0m[1;39m)[0m[39m;[0m                        [2m                [0m
[2;36m                    [0m         [39m        return Collections.EMPTY_LIST;[0m                                              [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mseen.add[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [39m    if [0m[1;39m([0m[1;35misPageTreeNode[0m[1;39m([0m[39mnode[0m[1;39m)[0m[1;39m)[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m{[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m        return [0m[1;35mgetKids[0m[1;39m([0m[39mnode[0m[1;39m)[0m[39m;[0m                                                       [2m                [0m
[2;36m                    [0m         [39m    [0m[1;39m}[0m                                                                               [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m [0m[33m...[0m[39m rest of method[0m                                                           [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Standard graph cycle detection using a `Set`[0m                                      [2m                [0m
[2;36m                    [0m         [39m- Non-breaking: returns empty list when cycle detected, allowing parsing to [0m        [2m                [0m
[2;36m                    [0m         [39mcontinue[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- Logs warning for debugging purposes[0m                                               [2m                [0m
[2;36m                    [0m         [39m- Tracks all visited nodes, detecting cycles of any length[0m                          [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Note:** Ensure the import statement for `HashSet` exists:[0m                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mimport java.util.HashSet;[0m                                                           [2m                [0m
[2;36m                    [0m         [39mimport java.util.Set;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m#### **Patch [0m[1;36m4[0m[39m: Fix XrefParser cycle detection [0m[1;39m([0m[39mvuln_8[0m[1;39m)[0m[39m**[0m                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**File:** `pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.java`[0m        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Location:** Lines [0m[1;36m100[0m[39m-[0m[1;36m177[0m[39m in the xref parsing loop[0m                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Changes:**[0m                                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. Add import at the top of the file [0m[1;39m([0m[39mafter line [0m[1;36m23[0m[1;39m)[0m[39m:[0m                               [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [39mimport java.util.Set;[0m                                                               [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. Replace the `lastPrev` variable with `prevSet` [0m[1;39m([0m[39mlines [0m[1;36m100[0m[39m-[0m[1;36m102[0m[1;39m)[0m[39m:[0m                  [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m BEFORE:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mlong prev = startXrefOffset;[0m                                                        [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[95mlastPrev[0m[39m prevents potential infinite loops in crafted files[0m                       [2m                [0m
[2;36m                    [0m         [39mlong lastPrev = [0m[1;36m-1[0m[39m;[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m AFTER:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mlong prev = startXrefOffset;[0m                                                        [2m                [0m
[2;36m                    [0m         [39mSet<Long> prevSet = new HashSet<>[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. Modify the while loop condition [0m[1;39m([0m[39mline [0m[1;36m105[0m[1;39m)[0m[39m:[0m                                      [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m BEFORE:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[39m && prev != lastPrev[0m[1;39m)[0m                                                [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m AFTER:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. Replace `lastPrev = prev;` at line [0m[1;36m107[0m[39m with cycle tracking:[0m                      [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m BEFORE:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    lastPrev = prev;[0m                                                                [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m    [0m                                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m AFTER:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mwhile [0m[1;39m([0m[39mprev > [0m[1;36m0[0m[1;39m)[0m                                                                    [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m save expected position for loop detection[0m                                    [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35mprevSet.add[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m    [0m[35m/[0m[35m/[0m[39m seek to xref table[0m                                                           [2m                [0m
[2;36m                    [0m         [39m    [0m[1;35msource.seek[0m[1;39m([0m[39mprev[0m[1;39m)[0m[39m;[0m                                                              [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. Add position tracking after skipping spaces [0m[1;39m([0m[39mafter line [0m[1;36m111[0m[1;39m)[0m[39m:[0m                    [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m skip white spaces[0m                                                                [2m                [0m
[2;36m                    [0m         [1;35mparser.skipSpaces[0m[1;39m([0m[1;39m)[0m[39m;[0m                                                                [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m save current position as well due to skipped spaces[0m                              [2m                [0m
[2;36m                    [0m         [1;35mprevSet.add[0m[1;39m([0m[1;35msource.getPosition[0m[1;39m([0m[1;39m)[0m[1;39m)[0m[39m;[0m                                                  [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. Replace the cycle check at line [0m[1;36m173[0m[39m-[0m[1;36m176[0m[39m:[0m                                         [2m                [0m
[2;36m                    [0m         [39m```java[0m                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m BEFORE:[0m                                                                          [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[39mprev == lastPrev[0m[1;39m)[0m                                                               [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [35m/[0m[35m/[0m[39m AFTER:[0m                                                                           [2m                [0m
[2;36m                    [0m         [39mif [0m[1;39m([0m[1;35mprevSet.contains[0m[1;39m([0m[39mprev[0m[1;39m)[0m[1;39m)[0m                                                         [2m                [0m
[2;36m                    [0m         [1;39m{[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m    throw new [0m[1;35mIOException[0m[1;39m([0m[32m"/Prev loop at offset "[0m[39m + prev[0m[1;39m)[0m[39m;[0m                          [2m                [0m
[2;36m                    [0m         [1;39m}[0m                                                                                   [2m                [0m
[2;36m                    [0m         [39m```[0m                                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Justification:**[0m                                                                  [2m                [0m
[2;36m                    [0m         [39m- Replaces inadequate single-value cycle detection with comprehensive Set-based [0m    [2m                [0m
[2;36m                    [0m         [39mtracking[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- Detects cycles of any length [0m[1;39m([0m[39mA→A, A→B→A, A→B→C→A, etc.[0m[1;39m)[0m                          [2m                [0m
[2;36m                    [0m         [39m- Also tracks position after skipping spaces to handle edge cases[0m                   [2m                [0m
[2;36m                    [0m         [39m- Maintains the same error message for consistency[0m                                  [2m                [0m
[2;36m                    [0m         [39m- No changes to functional logic, only improves cycle detection[0m                     [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Why This is the Optimal Approach[0m                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **Minimal and Focused**: Each patch targets only the vulnerable code without [0m    [2m                [0m
[2;36m                    [0m         [39mmodifying surrounding logic[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Consistent with Codebase**: All fixes follow patterns already established in [0m  [2m                [0m
[2;36m                    [0m         [39mother parts of the codebase[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m3[0m[39m. **Preserves Functionality**: No changes to parsing logic, only adds safety [0m      [2m                [0m
[2;36m                    [0m         [39mchecks[0m                                                                              [2m                [0m
[2;36m                    [0m         [1;36m4[0m[39m. **Clear Error Messages**: Each fix provides descriptive error messages for [0m      [2m                [0m
[2;36m                    [0m         [39mdebugging[0m                                                                           [2m                [0m
[2;36m                    [0m         [1;36m5[0m[39m. **Non-Breaking**: The patches handle error conditions gracefully without [0m        [2m                [0m
[2;36m                    [0m         [39maffecting valid input processing[0m                                                    [2m                [0m
[2;36m                    [0m         [1;36m6[0m[39m. **Security-Focused**: Directly addresses DoS vulnerabilities [0m[1;39m([0m[39mCWE-[0m[1;36m834[0m[39m, CWE-[0m[1;36m835[0m[1;39m)[0m[39m [0m [2m                [0m
[2;36m                    [0m         [39mthat can cause timeouts[0m                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## How It Addresses the Evaluation Report[0m                                           [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe timeout error reported by libFuzzer is caused by infinite loops when processing[0m [2m                [0m
[2;36m                    [0m         [39mmalicious PDFs. These four patches directly eliminate all infinite loop conditions:[0m [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m- **Type1Parser fixes** prevent infinite loops when parsing malformed Type1 fonts [0m  [2m                [0m
[2;36m                    [0m         [39mby detecting EOF[0m                                                                    [2m                [0m
[2;36m                    [0m         [39m- **PDPageTree fix** prevents infinite loops when traversing circular page tree [0m    [2m                [0m
[2;36m                    [0m         [39mstructures[0m                                                                          [2m                [0m
[2;36m                    [0m         [39m- **XrefParser fix** prevents infinite loops when following circular xref table [0m    [2m                [0m
[2;36m                    [0m         [39mchains[0m                                                                              [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mAfter applying these patches, the fuzzer should no longer encounter timeouts on [0m    [2m                [0m
[2;36m                    [0m         [39mthese code paths.[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Potential Side Effects and Mitigation[0m                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Potential Side Effects:**[0m                                                         [2m                [0m
[2;36m                    [0m         [1;36m1[0m[39m. **More IOExceptions thrown**: Previously infinite loops now throw exceptions[0m     [2m                [0m
[2;36m                    [0m         [1;36m2[0m[39m. **Incomplete parsing of damaged fonts**: Some partially damaged fonts might fail[0m [2m                [0m
[2;36m                    [0m         [39mto parse completely[0m                                                                 [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Mitigation:**[0m                                                                     [2m                [0m
[2;36m                    [0m         [39m- The error messages are descriptive, helping users understand what went wrong[0m      [2m                [0m
[2;36m                    [0m         [39m- Existing try-catch blocks in calling code [0m[1;39m([0m[39me.g., `PDType1Font` constructor[0m[1;39m)[0m[39m [0m      [2m                [0m
[2;36m                    [0m         [39malready handle `IOException` gracefully[0m                                             [2m                [0m
[2;36m                    [0m         [39m- The changes align with the existing error handling strategy in the codebase [0m      [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mfail-fast on malformed input[0m[1;39m)[0m                                                      [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m**Testing Recommendations:**[0m                                                        [2m                [0m
[2;36m                    [0m         [39m- Verify that valid PDFs and fonts continue to parse correctly[0m                      [2m                [0m
[2;36m                    [0m         [39m- Test edge cases: truncated files, empty segments, etc.[0m                            [2m                [0m
[2;36m                    [0m         [39m- Confirm that the fuzzer no longer times out on the previously problematic inputs[0m  [2m                [0m
[2;36m                    [0m         [39m- Check that error messages are informative[0m                                         [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m## Relevant Code Ranges Used[0m                                                        [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mThe fix strategy is based on analysis of the following code ranges:[0m                 [2m                [0m
[2;36m                    [0m         [39m- `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:192[0m[39m-[0m[1;36m239[0m[39m` [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mvuln_3[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:635[0m[39m-[0m[1;36m650[0m[39m` [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mvuln_4[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m         [39m- `pdfbox/src/main/java/org/apache/pdfbox/pdmodel/PDPageTree.jav[0m[1;92ma:180[0m[39m-[0m[1;36m230[0m[39m` [0m[1;39m([0m[39mvuln_7[0m[1;39m)[0m [2m                [0m
[2;36m                    [0m         [39m- `pdfbox/src/main/java/org/apache/pdfbox/pdfparser/XrefParser.jav[0m[1;92ma:95[0m[39m-[0m[1;36m180[0m[39m` [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mvuln_8[0m[1;39m)[0m                                                                            [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39mPlus reference implementations showing correct patterns:[0m                            [2m                [0m
[2;36m                    [0m         [39m- `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:469[0m[39m-[0m[1;36m536[0m[39m` [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mreadProc/readProcVoid[0m[1;39m)[0m                                                             [2m                [0m
[2;36m                    [0m         [39m- `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:706[0m[39m-[0m[1;36m743[0m[39m` [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mreadSubrs[0m[1;39m)[0m                                                                         [2m                [0m
[2;36m                    [0m         [39m- `fontbox/src/main/java/org/apache/fontbox/type1/Type1Parser.jav[0m[1;92ma:777[0m[39m-[0m[1;36m813[0m[39m` [0m        [2m                [0m
[2;36m                    [0m         [1;39m([0m[39mreadCharStrings[0m[1;39m)[0m                                                                   [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m                                                                                             [2m                [0m
[2;36m                    [0m         [39m<[0m[35m/[0m[95mfix_strategy[0m[1m>[0m                                                                     [2m                [0m
[2;36m                    [0m         ===Evaluation [33mEnd[0m===                                                                [2m                [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Prism Supervisor Routing: TeamStatus.EVALUATE -> TeamStatus.END                      ]8;id=317454;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=560954;file:///home/user/crete/packages/crete/framework/agent/services/prism/__init__.py#160\[2m160[0m]8;;\
[2;36m                    [0m         [1m([0mn evals: [1;36m2[0m, patch status: PatchStatus.SOUND[1m)[0m                                        [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Building environment                                                                 ]8;id=207957;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py\[2m__init__.py[0m]8;;\[2m:[0m]8;id=591983;file:///home/user/crete/packages/crete/framework/context_builder/services/aixcc/__init__.py#132\[2m132[0m]8;;\
[2;36m                    [0m         - Cache directory: [35m/tmp/[0m[95mtmpw51exo80[0m                                                  [2m               [0m
[2;36m                    [0m         - Max timeout: [1;36m1800[0m                                                                  [2m               [0m
[2;36m                    [0m         - Output directory:                                                                  [2m               [0m
[2;36m                    [0m         [35m/home/user/crete/reports/prism.prism_claude_sonnet_4_5/pdfbox_pdfbox-full-01_vuln_8/[0m [2m               [0m
[2;36m                    [0m         [95magent-output-1768286427.9250002[0m                                                      [2m               [0m
[2;36m                    [0m         - Detection toml file:                                                               [2m               [0m
[2;36m                    [0m         scripts/benchmark/afc-delta-full/pdfbox_pdfbox-full-01_vuln_8.toml                   [2m               [0m
[2;36m                    [0m         - Challenge project directory: [35m/home/user/crete/.cache/[0m[95mofficial-afc-pdfbox[0m           [2m               [0m
[2;36m                    [0m                                                                                              [2m               [0m
[2;36m[01/13/26 06:40:30][0m[2;36m [0m[34mINFO    [0m Deleting environments directory: [35m/home/user/crete/.cache/environments/[0m[95mpdfbox[0m         ]8;id=15460;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=909927;file:///home/user/crete/scripts/benchmark/__main__.py#300\[2m300[0m]8;;\
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted work directory:                                                              ]8;id=609704;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=284342;file:///home/user/crete/scripts/benchmark/__main__.py#314\[2m314[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/work/[0m[95mpdfbox[0m                [2m               [0m
[2;36m                   [0m[2;36m [0m[34mINFO    [0m Deleted out directory:                                                               ]8;id=128880;file:///home/user/crete/scripts/benchmark/__main__.py\[2m__main__.py[0m]8;;\[2m:[0m]8;id=454987;file:///home/user/crete/scripts/benchmark/__main__.py#321\[2m321[0m]8;;\
[2;36m                    [0m         [35m/home/user/crete/packages/python_oss_fuzz/.oss_fuzz/build/out/[0m[95mpdfbox[0m                 [2m               [0m
